<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Modern classical statistics | R 통계분석</title>
  <meta name="description" content="7 Modern classical statistics | R 통계분석" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Modern classical statistics | R 통계분석" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Modern classical statistics | R 통계분석" />
  
  
  

<meta name="author" content="psnam" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="progchapter.html"/>
<link rel="next" href="regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="preamble.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://datatellme.github.io">Data Tell Me Something</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>안녕하세요</a></li>
<li class="chapter" data-level="1" data-path="Introduction.html"><a href="Introduction.html"><i class="fa fa-check"></i><b>1</b> 들어가며</a>
<ul>
<li class="chapter" data-level="1.1" data-path="Introduction.html"><a href="Introduction.html#whatR"><i class="fa fa-check"></i><b>1.1</b> R이란?</a></li>
<li class="chapter" data-level="1.2" data-path="Introduction.html"><a href="Introduction.html#Rinstallation"><i class="fa fa-check"></i><b>1.2</b> R 설치하기</a></li>
<li class="chapter" data-level="1.3" data-path="Introduction.html"><a href="Introduction.html#RStudioinstallation"><i class="fa fa-check"></i><b>1.3</b> RStudio 설치하기</a></li>
<li class="chapter" data-level="1.4" data-path="Introduction.html"><a href="Introduction.html#LaTeXinstallation"><i class="fa fa-check"></i><b>1.4</b> 레이텍 설치하기</a></li>
<li class="chapter" data-level="1.5" data-path="Introduction.html"><a href="Introduction.html#packageinstallation"><i class="fa fa-check"></i><b>1.5</b> Packages 설치하기</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="thebasics.html"><a href="thebasics.html"><i class="fa fa-check"></i><b>2</b> 기본</a>
<ul>
<li class="chapter" data-level="2.1" data-path="thebasics.html"><a href="thebasics.html#rstudio-살펴보기"><i class="fa fa-check"></i><b>2.1</b> RStudio 살펴보기</a></li>
<li class="chapter" data-level="2.2" data-path="thebasics.html"><a href="thebasics.html#runningcode"><i class="fa fa-check"></i><b>2.2</b> R 코드 실행하기</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="thebasics.html"><a href="thebasics.html#r-스크립트"><i class="fa fa-check"></i><b>2.2.1</b> R 스크립트</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="thebasics.html"><a href="thebasics.html#varsandfuncs"><i class="fa fa-check"></i><b>2.3</b> 변수와 함수</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="thebasics.html"><a href="thebasics.html#데이터-저장"><i class="fa fa-check"></i><b>2.3.1</b> 데이터 저장</a></li>
<li class="chapter" data-level="2.3.2" data-path="thebasics.html"><a href="thebasics.html#변수-이름"><i class="fa fa-check"></i><b>2.3.2</b> 변수 이름</a></li>
<li class="chapter" data-level="2.3.3" data-path="thebasics.html"><a href="thebasics.html#벡터와-데이터프레임"><i class="fa fa-check"></i><b>2.3.3</b> 벡터와 데이터프레임</a></li>
<li class="chapter" data-level="2.3.4" data-path="thebasics.html"><a href="thebasics.html#함수"><i class="fa fa-check"></i><b>2.3.4</b> 함수</a></li>
<li class="chapter" data-level="2.3.5" data-path="thebasics.html"><a href="thebasics.html#maths"><i class="fa fa-check"></i><b>2.3.5</b> 수학연산</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="thebasics.html"><a href="thebasics.html#descstats"><i class="fa fa-check"></i><b>2.4</b> 기술통계</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="thebasics.html"><a href="thebasics.html#숫자-데이터"><i class="fa fa-check"></i><b>2.4.1</b> 숫자 데이터</a></li>
<li class="chapter" data-level="2.4.2" data-path="thebasics.html"><a href="thebasics.html#catdata1"><i class="fa fa-check"></i><b>2.4.2</b> 명목 데이터</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="thebasics.html"><a href="thebasics.html#그래프와-숫자-데이터"><i class="fa fa-check"></i><b>2.5</b> 그래프와 숫자 데이터</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="thebasics.html"><a href="thebasics.html#나의-그래프"><i class="fa fa-check"></i><b>2.5.1</b> 나의 그래프</a></li>
<li class="chapter" data-level="2.5.2" data-path="thebasics.html"><a href="thebasics.html#색과-형태-및-축"><i class="fa fa-check"></i><b>2.5.2</b> 색과 형태 및 축</a></li>
<li class="chapter" data-level="2.5.3" data-path="thebasics.html"><a href="thebasics.html#축의-한계와-스케일"><i class="fa fa-check"></i><b>2.5.3</b> 축의 한계와 스케일</a></li>
<li class="chapter" data-level="2.5.4" data-path="thebasics.html"><a href="thebasics.html#comparinggroups"><i class="fa fa-check"></i><b>2.5.4</b> 그룹 비교</a></li>
<li class="chapter" data-level="2.5.5" data-path="thebasics.html"><a href="thebasics.html#박스-그래풀럿"><i class="fa fa-check"></i><b>2.5.5</b> 박스 그래풀럿</a></li>
<li class="chapter" data-level="2.5.6" data-path="thebasics.html"><a href="thebasics.html#히스토그램"><i class="fa fa-check"></i><b>2.5.6</b> 히스토그램</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="thebasics.html"><a href="thebasics.html#catdata2"><i class="fa fa-check"></i><b>2.6</b> 그래프와 명목 데인터</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="thebasics.html"><a href="thebasics.html#막대-그래프"><i class="fa fa-check"></i><b>2.6.1</b> 막대 그래프</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="thebasics.html"><a href="thebasics.html#그래프-저장"><i class="fa fa-check"></i><b>2.7</b> 그래프 저장</a></li>
<li class="chapter" data-level="2.8" data-path="thebasics.html"><a href="thebasics.html#troubleshooting"><i class="fa fa-check"></i><b>2.8</b> 오류 문제 해결</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datachapter.html"><a href="datachapter.html"><i class="fa fa-check"></i><b>3</b> Transforming, summarising, and analysing data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="datachapter.html"><a href="datachapter.html#data-frames-and-data-types"><i class="fa fa-check"></i><b>3.1</b> Data frames and data types</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="datachapter.html"><a href="datachapter.html#types-and-structures"><i class="fa fa-check"></i><b>3.1.1</b> Types and structures</a></li>
<li class="chapter" data-level="3.1.2" data-path="datachapter.html"><a href="datachapter.html#typesoftables"><i class="fa fa-check"></i><b>3.1.2</b> Types of tables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datachapter.html"><a href="datachapter.html#findingpoints"><i class="fa fa-check"></i><b>3.2</b> Vectors in data frames</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="datachapter.html"><a href="datachapter.html#accessingelements"><i class="fa fa-check"></i><b>3.2.1</b> Accessing vectors and elements</a></li>
<li class="chapter" data-level="3.2.2" data-path="datachapter.html"><a href="datachapter.html#use-your-dollars"><i class="fa fa-check"></i><b>3.2.2</b> Use your dollars</a></li>
<li class="chapter" data-level="3.2.3" data-path="datachapter.html"><a href="datachapter.html#conditionsintro"><i class="fa fa-check"></i><b>3.2.3</b> Using conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="datachapter.html"><a href="datachapter.html#paths"><i class="fa fa-check"></i><b>3.3</b> Importing data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="datachapter.html"><a href="datachapter.html#importing-csv-files"><i class="fa fa-check"></i><b>3.3.1</b> Importing csv files</a></li>
<li class="chapter" data-level="3.3.2" data-path="datachapter.html"><a href="datachapter.html#file-paths"><i class="fa fa-check"></i><b>3.3.2</b> File paths</a></li>
<li class="chapter" data-level="3.3.3" data-path="datachapter.html"><a href="datachapter.html#importing-excel-files"><i class="fa fa-check"></i><b>3.3.3</b> Importing Excel files</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="datachapter.html"><a href="datachapter.html#saving-and-exporting-your-data"><i class="fa fa-check"></i><b>3.4</b> Saving and exporting your data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="datachapter.html"><a href="datachapter.html#exporting-data"><i class="fa fa-check"></i><b>3.4.1</b> Exporting data</a></li>
<li class="chapter" data-level="3.4.2" data-path="datachapter.html"><a href="datachapter.html#saving-and-loading-r-data"><i class="fa fa-check"></i><b>3.4.2</b> Saving and loading R data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="datachapter.html"><a href="datachapter.html#rstudio-projects"><i class="fa fa-check"></i><b>3.5</b> RStudio projects</a></li>
<li class="chapter" data-level="3.6" data-path="datachapter.html"><a href="datachapter.html#firstttest"><i class="fa fa-check"></i><b>3.6</b> Running a t-test</a></li>
<li class="chapter" data-level="3.7" data-path="datachapter.html"><a href="datachapter.html#firstlm"><i class="fa fa-check"></i><b>3.7</b> Fitting a linear regression model</a></li>
<li class="chapter" data-level="3.8" data-path="datachapter.html"><a href="datachapter.html#grouped"><i class="fa fa-check"></i><b>3.8</b> Grouped summaries</a></li>
<li class="chapter" data-level="3.9" data-path="datachapter.html"><a href="datachapter.html#pipes"><i class="fa fa-check"></i><b>3.9</b> Using <code>%&gt;%</code> pipes</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="datachapter.html"><a href="datachapter.html#ceci-nest-pas-une-pipe"><i class="fa fa-check"></i><b>3.9.1</b> <em>Ceci n’est pas une pipe</em></a></li>
<li class="chapter" data-level="3.9.2" data-path="datachapter.html"><a href="datachapter.html#aliases-and-placeholders"><i class="fa fa-check"></i><b>3.9.2</b> Aliases and placeholders</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="datachapter.html"><a href="datachapter.html#flavours-of-r-base-and-tidyverse"><i class="fa fa-check"></i><b>3.10</b> Flavours of R: base and tidyverse</a></li>
<li class="chapter" data-level="3.11" data-path="datachapter.html"><a href="datachapter.html#ethicalguidelines"><i class="fa fa-check"></i><b>3.11</b> Ethics and good statistical practice</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>4</b> Exploratory data analysis and unsupervised learning</a>
<ul>
<li class="chapter" data-level="4.1" data-path="eda.html"><a href="eda.html#rmarkdown"><i class="fa fa-check"></i><b>4.1</b> Reports with R Markdown</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="eda.html"><a href="eda.html#a-first-example"><i class="fa fa-check"></i><b>4.1.1</b> A first example</a></li>
<li class="chapter" data-level="4.1.2" data-path="eda.html"><a href="eda.html#formatting-text"><i class="fa fa-check"></i><b>4.1.2</b> Formatting text</a></li>
<li class="chapter" data-level="4.1.3" data-path="eda.html"><a href="eda.html#lists-tables-and-images"><i class="fa fa-check"></i><b>4.1.3</b> Lists, tables, and images</a></li>
<li class="chapter" data-level="4.1.4" data-path="eda.html"><a href="eda.html#code-chunks"><i class="fa fa-check"></i><b>4.1.4</b> Code chunks</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="eda.html"><a href="eda.html#themes"><i class="fa fa-check"></i><b>4.2</b> Customising <code>ggplot2</code> plots</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="eda.html"><a href="eda.html#using-themes"><i class="fa fa-check"></i><b>4.2.1</b> Using themes</a></li>
<li class="chapter" data-level="4.2.2" data-path="eda.html"><a href="eda.html#colourpalettes"><i class="fa fa-check"></i><b>4.2.2</b> Colour palettes</a></li>
<li class="chapter" data-level="4.2.3" data-path="eda.html"><a href="eda.html#theme-settings"><i class="fa fa-check"></i><b>4.2.3</b> Theme settings</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="eda.html"><a href="eda.html#exploring-distributions"><i class="fa fa-check"></i><b>4.3</b> Exploring distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="eda.html"><a href="eda.html#density-plots-and-frequency-polygons"><i class="fa fa-check"></i><b>4.3.1</b> Density plots and frequency polygons</a></li>
<li class="chapter" data-level="4.3.2" data-path="eda.html"><a href="eda.html#asking-questions"><i class="fa fa-check"></i><b>4.3.2</b> Asking questions</a></li>
<li class="chapter" data-level="4.3.3" data-path="eda.html"><a href="eda.html#violin-plots"><i class="fa fa-check"></i><b>4.3.3</b> Violin plots</a></li>
<li class="chapter" data-level="4.3.4" data-path="eda.html"><a href="eda.html#patchwork"><i class="fa fa-check"></i><b>4.3.4</b> Combine multiple plots into a single graphic</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="eda.html"><a href="eda.html#outliers-and-missing-data"><i class="fa fa-check"></i><b>4.4</b> Outliers and missing data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="eda.html"><a href="eda.html#detecting-outliers"><i class="fa fa-check"></i><b>4.4.1</b> Detecting outliers</a></li>
<li class="chapter" data-level="4.4.2" data-path="eda.html"><a href="eda.html#labelling-outliers"><i class="fa fa-check"></i><b>4.4.2</b> Labelling outliers</a></li>
<li class="chapter" data-level="4.4.3" data-path="eda.html"><a href="eda.html#missing-data"><i class="fa fa-check"></i><b>4.4.3</b> Missing data</a></li>
<li class="chapter" data-level="4.4.4" data-path="eda.html"><a href="eda.html#exploring-data"><i class="fa fa-check"></i><b>4.4.4</b> Exploring data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="eda.html"><a href="eda.html#trends-in-scatterplots"><i class="fa fa-check"></i><b>4.5</b> Trends in scatterplots</a></li>
<li class="chapter" data-level="4.6" data-path="eda.html"><a href="eda.html#tsplots"><i class="fa fa-check"></i><b>4.6</b> Exploring time series</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="eda.html"><a href="eda.html#annotations-and-reference-lines"><i class="fa fa-check"></i><b>4.6.1</b> Annotations and reference lines</a></li>
<li class="chapter" data-level="4.6.2" data-path="eda.html"><a href="eda.html#longitudinal-data"><i class="fa fa-check"></i><b>4.6.2</b> Longitudinal data</a></li>
<li class="chapter" data-level="4.6.3" data-path="eda.html"><a href="eda.html#path-plots"><i class="fa fa-check"></i><b>4.6.3</b> Path plots</a></li>
<li class="chapter" data-level="4.6.4" data-path="eda.html"><a href="eda.html#spaghetti-plots"><i class="fa fa-check"></i><b>4.6.4</b> Spaghetti plots</a></li>
<li class="chapter" data-level="4.6.5" data-path="eda.html"><a href="eda.html#stlsec"><i class="fa fa-check"></i><b>4.6.5</b> Seasonal plots and decompositions</a></li>
<li class="chapter" data-level="4.6.6" data-path="eda.html"><a href="eda.html#detecting-changepoints"><i class="fa fa-check"></i><b>4.6.6</b> Detecting changepoints</a></li>
<li class="chapter" data-level="4.6.7" data-path="eda.html"><a href="eda.html#interactivets"><i class="fa fa-check"></i><b>4.6.7</b> Interactive time series plots</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="eda.html"><a href="eda.html#polar"><i class="fa fa-check"></i><b>4.7</b> Using polar coordinates</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="eda.html"><a href="eda.html#visualising-periodic-data"><i class="fa fa-check"></i><b>4.7.1</b> Visualising periodic data</a></li>
<li class="chapter" data-level="4.7.2" data-path="eda.html"><a href="eda.html#pie-charts"><i class="fa fa-check"></i><b>4.7.2</b> Pie charts</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="eda.html"><a href="eda.html#visualising-multiple-variables"><i class="fa fa-check"></i><b>4.8</b> Visualising multiple variables</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="eda.html"><a href="eda.html#scatterplotmatrix"><i class="fa fa-check"></i><b>4.8.1</b> Scatterplot matrices</a></li>
<li class="chapter" data-level="4.8.2" data-path="eda.html"><a href="eda.html#d-scatterplots"><i class="fa fa-check"></i><b>4.8.2</b> 3D scatterplots</a></li>
<li class="chapter" data-level="4.8.3" data-path="eda.html"><a href="eda.html#correlograms"><i class="fa fa-check"></i><b>4.8.3</b> Correlograms</a></li>
<li class="chapter" data-level="4.8.4" data-path="eda.html"><a href="eda.html#adding-more-variables-to-scatterplots"><i class="fa fa-check"></i><b>4.8.4</b> Adding more variables to scatterplots</a></li>
<li class="chapter" data-level="4.8.5" data-path="eda.html"><a href="eda.html#overplotting"><i class="fa fa-check"></i><b>4.8.5</b> Overplotting</a></li>
<li class="chapter" data-level="4.8.6" data-path="eda.html"><a href="eda.html#categorical-data"><i class="fa fa-check"></i><b>4.8.6</b> Categorical data</a></li>
<li class="chapter" data-level="4.8.7" data-path="eda.html"><a href="eda.html#putting-it-all-together"><i class="fa fa-check"></i><b>4.8.7</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="eda.html"><a href="eda.html#pca"><i class="fa fa-check"></i><b>4.9</b> Principal component analysis</a></li>
<li class="chapter" data-level="4.10" data-path="eda.html"><a href="eda.html#clustering"><i class="fa fa-check"></i><b>4.10</b> Cluster analysis</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="eda.html"><a href="eda.html#hierarchical-clustering"><i class="fa fa-check"></i><b>4.10.1</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="4.10.2" data-path="eda.html"><a href="eda.html#heatmaps-and-clustering-variables"><i class="fa fa-check"></i><b>4.10.2</b> Heatmaps and clustering variables</a></li>
<li class="chapter" data-level="4.10.3" data-path="eda.html"><a href="eda.html#centroid"><i class="fa fa-check"></i><b>4.10.3</b> Centroid-based clustering</a></li>
<li class="chapter" data-level="4.10.4" data-path="eda.html"><a href="eda.html#fuzzy-clustering"><i class="fa fa-check"></i><b>4.10.4</b> Fuzzy clustering</a></li>
<li class="chapter" data-level="4.10.5" data-path="eda.html"><a href="eda.html#modelbasedclustering"><i class="fa fa-check"></i><b>4.10.5</b> Model-based clustering</a></li>
<li class="chapter" data-level="4.10.6" data-path="eda.html"><a href="eda.html#comparing-clusters"><i class="fa fa-check"></i><b>4.10.6</b> Comparing clusters</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="eda.html"><a href="eda.html#exploratory-factor-analysis"><i class="fa fa-check"></i><b>4.11</b> Exploratory factor analysis</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="eda.html"><a href="eda.html#factor-analysis"><i class="fa fa-check"></i><b>4.11.1</b> Factor analysis</a></li>
<li class="chapter" data-level="4.11.2" data-path="eda.html"><a href="eda.html#lca"><i class="fa fa-check"></i><b>4.11.2</b> Latent class analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="messychapter.html"><a href="messychapter.html"><i class="fa fa-check"></i><b>5</b> Dealing with messy data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="messychapter.html"><a href="messychapter.html#coercion"><i class="fa fa-check"></i><b>5.1</b> Changing data types</a></li>
<li class="chapter" data-level="5.2" data-path="messychapter.html"><a href="messychapter.html#lists2"><i class="fa fa-check"></i><b>5.2</b> Working with lists</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="messychapter.html"><a href="messychapter.html#splitvector"><i class="fa fa-check"></i><b>5.2.1</b> Splitting vectors into lists</a></li>
<li class="chapter" data-level="5.2.2" data-path="messychapter.html"><a href="messychapter.html#collapsing-lists-into-vectors"><i class="fa fa-check"></i><b>5.2.2</b> Collapsing lists into vectors</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="messychapter.html"><a href="messychapter.html#working-with-numbers"><i class="fa fa-check"></i><b>5.3</b> Working with numbers</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="messychapter.html"><a href="messychapter.html#rounding-numbers"><i class="fa fa-check"></i><b>5.3.1</b> Rounding numbers</a></li>
<li class="chapter" data-level="5.3.2" data-path="messychapter.html"><a href="messychapter.html#sums-and-means-in-data-frames"><i class="fa fa-check"></i><b>5.3.2</b> Sums and means in data frames</a></li>
<li class="chapter" data-level="5.3.3" data-path="messychapter.html"><a href="messychapter.html#rle"><i class="fa fa-check"></i><b>5.3.3</b> Summaries of series of numbers</a></li>
<li class="chapter" data-level="5.3.4" data-path="messychapter.html"><a href="messychapter.html#scientific-notation-1e-03"><i class="fa fa-check"></i><b>5.3.4</b> Scientific notation <code>1e-03</code></a></li>
<li class="chapter" data-level="5.3.5" data-path="messychapter.html"><a href="messychapter.html#floatingpoints"><i class="fa fa-check"></i><b>5.3.5</b> Floating point arithmetics</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="messychapter.html"><a href="messychapter.html#factors"><i class="fa fa-check"></i><b>5.4</b> Working with factors</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="messychapter.html"><a href="messychapter.html#creating-factors"><i class="fa fa-check"></i><b>5.4.1</b> Creating factors</a></li>
<li class="chapter" data-level="5.4.2" data-path="messychapter.html"><a href="messychapter.html#factorlevels"><i class="fa fa-check"></i><b>5.4.2</b> Changing factor levels</a></li>
<li class="chapter" data-level="5.4.3" data-path="messychapter.html"><a href="messychapter.html#changing-the-order-of-levels"><i class="fa fa-check"></i><b>5.4.3</b> Changing the order of levels</a></li>
<li class="chapter" data-level="5.4.4" data-path="messychapter.html"><a href="messychapter.html#combining-levels"><i class="fa fa-check"></i><b>5.4.4</b> Combining levels</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="messychapter.html"><a href="messychapter.html#strings"><i class="fa fa-check"></i><b>5.5</b> Working with strings</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="messychapter.html"><a href="messychapter.html#concatenating-strings"><i class="fa fa-check"></i><b>5.5.1</b> Concatenating strings</a></li>
<li class="chapter" data-level="5.5.2" data-path="messychapter.html"><a href="messychapter.html#changing-case"><i class="fa fa-check"></i><b>5.5.2</b> Changing case</a></li>
<li class="chapter" data-level="5.5.3" data-path="messychapter.html"><a href="messychapter.html#regexp"><i class="fa fa-check"></i><b>5.5.3</b> Finding patterns using regular expressions</a></li>
<li class="chapter" data-level="5.5.4" data-path="messychapter.html"><a href="messychapter.html#sub"><i class="fa fa-check"></i><b>5.5.4</b> Substitution</a></li>
<li class="chapter" data-level="5.5.5" data-path="messychapter.html"><a href="messychapter.html#splitting-strings"><i class="fa fa-check"></i><b>5.5.5</b> Splitting strings</a></li>
<li class="chapter" data-level="5.5.6" data-path="messychapter.html"><a href="messychapter.html#variable-names"><i class="fa fa-check"></i><b>5.5.6</b> Variable names</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="messychapter.html"><a href="messychapter.html#datetime"><i class="fa fa-check"></i><b>5.6</b> Working with dates and times</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="messychapter.html"><a href="messychapter.html#date-formats"><i class="fa fa-check"></i><b>5.6.1</b> Date formats</a></li>
<li class="chapter" data-level="5.6.2" data-path="messychapter.html"><a href="messychapter.html#plotting-with-dates"><i class="fa fa-check"></i><b>5.6.2</b> Plotting with dates</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="messychapter.html"><a href="messychapter.html#data-manipulation-with-data.table-dplyr-and-tidyr"><i class="fa fa-check"></i><b>5.7</b> Data manipulation with <code>data.table</code>, <code>dplyr</code>, and <code>tidyr</code></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="messychapter.html"><a href="messychapter.html#dtbasics"><i class="fa fa-check"></i><b>5.7.1</b> <code>data.table</code> and tidyverse syntax basics</a></li>
<li class="chapter" data-level="5.7.2" data-path="messychapter.html"><a href="messychapter.html#modifyvar"><i class="fa fa-check"></i><b>5.7.2</b> Modifying a variable</a></li>
<li class="chapter" data-level="5.7.3" data-path="messychapter.html"><a href="messychapter.html#computing-a-new-variable-based-on-existing-variables"><i class="fa fa-check"></i><b>5.7.3</b> Computing a new variable based on existing variables</a></li>
<li class="chapter" data-level="5.7.4" data-path="messychapter.html"><a href="messychapter.html#renaming-a-variable"><i class="fa fa-check"></i><b>5.7.4</b> Renaming a variable</a></li>
<li class="chapter" data-level="5.7.5" data-path="messychapter.html"><a href="messychapter.html#removing-a-variable"><i class="fa fa-check"></i><b>5.7.5</b> Removing a variable</a></li>
<li class="chapter" data-level="5.7.6" data-path="messychapter.html"><a href="messychapter.html#recodedplyr"><i class="fa fa-check"></i><b>5.7.6</b> Recoding <code>factor</code> levels</a></li>
<li class="chapter" data-level="5.7.7" data-path="messychapter.html"><a href="messychapter.html#grouped2"><i class="fa fa-check"></i><b>5.7.7</b> Grouped summaries</a></li>
<li class="chapter" data-level="5.7.8" data-path="messychapter.html"><a href="messychapter.html#fillNA"><i class="fa fa-check"></i><b>5.7.8</b> Filling in missing values</a></li>
<li class="chapter" data-level="5.7.9" data-path="messychapter.html"><a href="messychapter.html#chaining-commands-together"><i class="fa fa-check"></i><b>5.7.9</b> Chaining commands together</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="messychapter.html"><a href="messychapter.html#filtering"><i class="fa fa-check"></i><b>5.8</b> Filtering: select rows</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="messychapter.html"><a href="messychapter.html#filtering-using-row-numbers"><i class="fa fa-check"></i><b>5.8.1</b> Filtering using row numbers</a></li>
<li class="chapter" data-level="5.8.2" data-path="messychapter.html"><a href="messychapter.html#conditions2"><i class="fa fa-check"></i><b>5.8.2</b> Filtering using conditions</a></li>
<li class="chapter" data-level="5.8.3" data-path="messychapter.html"><a href="messychapter.html#selecting-rows-at-random"><i class="fa fa-check"></i><b>5.8.3</b> Selecting rows at random</a></li>
<li class="chapter" data-level="5.8.4" data-path="messychapter.html"><a href="messychapter.html#using-regular-expressions-to-select-rows"><i class="fa fa-check"></i><b>5.8.4</b> Using regular expressions to select rows</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="messychapter.html"><a href="messychapter.html#subsetting-select-columns"><i class="fa fa-check"></i><b>5.9</b> Subsetting: select columns</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="messychapter.html"><a href="messychapter.html#selecting-a-single-column"><i class="fa fa-check"></i><b>5.9.1</b> Selecting a single column</a></li>
<li class="chapter" data-level="5.9.2" data-path="messychapter.html"><a href="messychapter.html#selecting-multiple-columns"><i class="fa fa-check"></i><b>5.9.2</b> Selecting multiple columns</a></li>
<li class="chapter" data-level="5.9.3" data-path="messychapter.html"><a href="messychapter.html#using-regular-expressions-to-select-columns"><i class="fa fa-check"></i><b>5.9.3</b> Using regular expressions to select columns</a></li>
<li class="chapter" data-level="5.9.4" data-path="messychapter.html"><a href="messychapter.html#subsetusingcn"><i class="fa fa-check"></i><b>5.9.4</b> Subsetting using column numbers</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="messychapter.html"><a href="messychapter.html#sorting"><i class="fa fa-check"></i><b>5.10</b> Sorting</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="messychapter.html"><a href="messychapter.html#changing-the-column-order"><i class="fa fa-check"></i><b>5.10.1</b> Changing the column order</a></li>
<li class="chapter" data-level="5.10.2" data-path="messychapter.html"><a href="messychapter.html#changing-the-row-order"><i class="fa fa-check"></i><b>5.10.2</b> Changing the row order</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="messychapter.html"><a href="messychapter.html#reshaping"><i class="fa fa-check"></i><b>5.11</b> Reshaping data</a>
<ul>
<li class="chapter" data-level="5.11.1" data-path="messychapter.html"><a href="messychapter.html#from-long-to-wide"><i class="fa fa-check"></i><b>5.11.1</b> From long to wide</a></li>
<li class="chapter" data-level="5.11.2" data-path="messychapter.html"><a href="messychapter.html#from-wide-to-long"><i class="fa fa-check"></i><b>5.11.2</b> From wide to long</a></li>
<li class="chapter" data-level="5.11.3" data-path="messychapter.html"><a href="messychapter.html#splittingcolumns"><i class="fa fa-check"></i><b>5.11.3</b> Splitting columns</a></li>
<li class="chapter" data-level="5.11.4" data-path="messychapter.html"><a href="messychapter.html#merging-columns"><i class="fa fa-check"></i><b>5.11.4</b> Merging columns</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="messychapter.html"><a href="messychapter.html#mergedata"><i class="fa fa-check"></i><b>5.12</b> Merging data from multiple tables</a>
<ul>
<li class="chapter" data-level="5.12.1" data-path="messychapter.html"><a href="messychapter.html#binds"><i class="fa fa-check"></i><b>5.12.1</b> Binds</a></li>
<li class="chapter" data-level="5.12.2" data-path="messychapter.html"><a href="messychapter.html#merging-tables-using-keys"><i class="fa fa-check"></i><b>5.12.2</b> Merging tables using keys</a></li>
<li class="chapter" data-level="5.12.3" data-path="messychapter.html"><a href="messychapter.html#inner-and-outer-joins"><i class="fa fa-check"></i><b>5.12.3</b> Inner and outer joins</a></li>
<li class="chapter" data-level="5.12.4" data-path="messychapter.html"><a href="messychapter.html#semijoins"><i class="fa fa-check"></i><b>5.12.4</b> Semijoins and antijoins</a></li>
</ul></li>
<li class="chapter" data-level="5.13" data-path="messychapter.html"><a href="messychapter.html#scraping-data-from-websites"><i class="fa fa-check"></i><b>5.13</b> Scraping data from websites</a></li>
<li class="chapter" data-level="5.14" data-path="messychapter.html"><a href="messychapter.html#commontasks"><i class="fa fa-check"></i><b>5.14</b> Other commons tasks</a>
<ul>
<li class="chapter" data-level="5.14.1" data-path="messychapter.html"><a href="messychapter.html#deleting-variables"><i class="fa fa-check"></i><b>5.14.1</b> Deleting variables</a></li>
<li class="chapter" data-level="5.14.2" data-path="messychapter.html"><a href="messychapter.html#foreign"><i class="fa fa-check"></i><b>5.14.2</b> Importing data from other statistical packages</a></li>
<li class="chapter" data-level="5.14.3" data-path="messychapter.html"><a href="messychapter.html#importing-data-from-databases"><i class="fa fa-check"></i><b>5.14.3</b> Importing data from databases</a></li>
<li class="chapter" data-level="5.14.4" data-path="messychapter.html"><a href="messychapter.html#importing-data-from-json-files"><i class="fa fa-check"></i><b>5.14.4</b> Importing data from JSON files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="progchapter.html"><a href="progchapter.html"><i class="fa fa-check"></i><b>6</b> R programming</a>
<ul>
<li class="chapter" data-level="6.1" data-path="progchapter.html"><a href="progchapter.html#functions"><i class="fa fa-check"></i><b>6.1</b> Functions</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="progchapter.html"><a href="progchapter.html#createfunctions"><i class="fa fa-check"></i><b>6.1.1</b> Creating functions</a></li>
<li class="chapter" data-level="6.1.2" data-path="progchapter.html"><a href="progchapter.html#local-and-global-variables"><i class="fa fa-check"></i><b>6.1.2</b> Local and global variables</a></li>
<li class="chapter" data-level="6.1.3" data-path="progchapter.html"><a href="progchapter.html#willfunctionwork"><i class="fa fa-check"></i><b>6.1.3</b> Will your function work?</a></li>
<li class="chapter" data-level="6.1.4" data-path="progchapter.html"><a href="progchapter.html#more-on-arguments"><i class="fa fa-check"></i><b>6.1.4</b> More on arguments</a></li>
<li class="chapter" data-level="6.1.5" data-path="progchapter.html"><a href="progchapter.html#namespaces"><i class="fa fa-check"></i><b>6.1.5</b> Namespaces</a></li>
<li class="chapter" data-level="6.1.6" data-path="progchapter.html"><a href="progchapter.html#sourcing-other-scripts"><i class="fa fa-check"></i><b>6.1.6</b> Sourcing other scripts</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="progchapter.html"><a href="progchapter.html#morepipes"><i class="fa fa-check"></i><b>6.2</b> More on pipes</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="progchapter.html"><a href="progchapter.html#ce-ne-sont-pas-non-plus-des-pipes"><i class="fa fa-check"></i><b>6.2.1</b> <em>Ce ne sont pas non plus des pipes</em></a></li>
<li class="chapter" data-level="6.2.2" data-path="progchapter.html"><a href="progchapter.html#writing-functions-with-pipes"><i class="fa fa-check"></i><b>6.2.2</b> Writing functions with pipes</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="progchapter.html"><a href="progchapter.html#conditions"><i class="fa fa-check"></i><b>6.3</b> Checking conditions</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="progchapter.html"><a href="progchapter.html#if-and-else"><i class="fa fa-check"></i><b>6.3.1</b> <code>if</code> and <code>else</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="progchapter.html"><a href="progchapter.html#section"><i class="fa fa-check"></i><b>6.3.2</b> <code>&amp;</code> &amp; <code>&amp;&amp;</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="progchapter.html"><a href="progchapter.html#ifelse"><i class="fa fa-check"></i><b>6.3.3</b> <code>ifelse</code></a></li>
<li class="chapter" data-level="6.3.4" data-path="progchapter.html"><a href="progchapter.html#switch"><i class="fa fa-check"></i><b>6.3.4</b> <code>switch</code></a></li>
<li class="chapter" data-level="6.3.5" data-path="progchapter.html"><a href="progchapter.html#failing-gracefully"><i class="fa fa-check"></i><b>6.3.5</b> Failing gracefully</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="progchapter.html"><a href="progchapter.html#loopsection"><i class="fa fa-check"></i><b>6.4</b> Iteration using loops</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="progchapter.html"><a href="progchapter.html#forloops"><i class="fa fa-check"></i><b>6.4.1</b> <code>for</code> loops</a></li>
<li class="chapter" data-level="6.4.2" data-path="progchapter.html"><a href="progchapter.html#nestedloops"><i class="fa fa-check"></i><b>6.4.2</b> Loops within loops</a></li>
<li class="chapter" data-level="6.4.3" data-path="progchapter.html"><a href="progchapter.html#beepr"><i class="fa fa-check"></i><b>6.4.3</b> Keeping track of what’s happening</a></li>
<li class="chapter" data-level="6.4.4" data-path="progchapter.html"><a href="progchapter.html#lists"><i class="fa fa-check"></i><b>6.4.4</b> Loops and lists</a></li>
<li class="chapter" data-level="6.4.5" data-path="progchapter.html"><a href="progchapter.html#whileloop"><i class="fa fa-check"></i><b>6.4.5</b> <code>while</code> loops</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="progchapter.html"><a href="progchapter.html#vectorloops"><i class="fa fa-check"></i><b>6.5</b> Iteration using vectorisation and functionals</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="progchapter.html"><a href="progchapter.html#a-first-example-with-apply"><i class="fa fa-check"></i><b>6.5.1</b> A first example with <code>apply</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="progchapter.html"><a href="progchapter.html#variations-on-a-theme"><i class="fa fa-check"></i><b>6.5.2</b> Variations on a theme</a></li>
<li class="chapter" data-level="6.5.3" data-path="progchapter.html"><a href="progchapter.html#purrr"><i class="fa fa-check"></i><b>6.5.3</b> <code>purrr</code></a></li>
<li class="chapter" data-level="6.5.4" data-path="progchapter.html"><a href="progchapter.html#specialised-functions"><i class="fa fa-check"></i><b>6.5.4</b> Specialised functions</a></li>
<li class="chapter" data-level="6.5.5" data-path="progchapter.html"><a href="progchapter.html#exploring-data-with-functionals"><i class="fa fa-check"></i><b>6.5.5</b> Exploring data with functionals</a></li>
<li class="chapter" data-level="6.5.6" data-path="progchapter.html"><a href="progchapter.html#keep-calm-and-carry-on"><i class="fa fa-check"></i><b>6.5.6</b> Keep calm and carry on</a></li>
<li class="chapter" data-level="6.5.7" data-path="progchapter.html"><a href="progchapter.html#multiiter"><i class="fa fa-check"></i><b>6.5.7</b> Iterating over multiple variables</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="progchapter.html"><a href="progchapter.html#measureperformance"><i class="fa fa-check"></i><b>6.6</b> Measuring code performance</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="progchapter.html"><a href="progchapter.html#timing-functions"><i class="fa fa-check"></i><b>6.6.1</b> Timing functions</a></li>
<li class="chapter" data-level="6.6.2" data-path="progchapter.html"><a href="progchapter.html#measuring-memory-usage---and-a-note-on-compilation"><i class="fa fa-check"></i><b>6.6.2</b> Measuring memory usage - and a note on compilation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modchapter.html"><a href="modchapter.html"><i class="fa fa-check"></i><b>7</b> Modern classical statistics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modchapter.html"><a href="modchapter.html#simulation"><i class="fa fa-check"></i><b>7.1</b> Simulation and distributions</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="modchapter.html"><a href="modchapter.html#generating-random-numbers"><i class="fa fa-check"></i><b>7.1.1</b> Generating random numbers</a></li>
<li class="chapter" data-level="7.1.2" data-path="modchapter.html"><a href="modchapter.html#distfunctions"><i class="fa fa-check"></i><b>7.1.2</b> Some common distributions</a></li>
<li class="chapter" data-level="7.1.3" data-path="modchapter.html"><a href="modchapter.html#assessing-distributional-assumptions"><i class="fa fa-check"></i><b>7.1.3</b> Assessing distributional assumptions</a></li>
<li class="chapter" data-level="7.1.4" data-path="modchapter.html"><a href="modchapter.html#monte-carlo-integration"><i class="fa fa-check"></i><b>7.1.4</b> Monte Carlo integration</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="modchapter.html"><a href="modchapter.html#ttest"><i class="fa fa-check"></i><b>7.2</b> Student’s t-test revisited</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="modchapter.html"><a href="modchapter.html#oldschoolt"><i class="fa fa-check"></i><b>7.2.1</b> The old-school t-test</a></li>
<li class="chapter" data-level="7.2.2" data-path="modchapter.html"><a href="modchapter.html#permutation-tests"><i class="fa fa-check"></i><b>7.2.2</b> Permutation tests</a></li>
<li class="chapter" data-level="7.2.3" data-path="modchapter.html"><a href="modchapter.html#the-bootstrap"><i class="fa fa-check"></i><b>7.2.3</b> The bootstrap</a></li>
<li class="chapter" data-level="7.2.4" data-path="modchapter.html"><a href="modchapter.html#saving-the-output"><i class="fa fa-check"></i><b>7.2.4</b> Saving the output</a></li>
<li class="chapter" data-level="7.2.5" data-path="modchapter.html"><a href="modchapter.html#multipletesting"><i class="fa fa-check"></i><b>7.2.5</b> Multiple testing</a></li>
<li class="chapter" data-level="7.2.6" data-path="modchapter.html"><a href="modchapter.html#hotellingst2"><i class="fa fa-check"></i><b>7.2.6</b> Multivariate testing with Hotelling’s <span class="math inline">\(T^2\)</span></a></li>
<li class="chapter" data-level="7.2.7" data-path="modchapter.html"><a href="modchapter.html#sample-size-computations-for-the-t-test"><i class="fa fa-check"></i><b>7.2.7</b> Sample size computations for the t-test</a></li>
<li class="chapter" data-level="7.2.8" data-path="modchapter.html"><a href="modchapter.html#a-bayesian-approach"><i class="fa fa-check"></i><b>7.2.8</b> A Bayesian approach</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="modchapter.html"><a href="modchapter.html#other-common-hypothesis-tests-and-confidence-intervals"><i class="fa fa-check"></i><b>7.3</b> Other common hypothesis tests and confidence intervals</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="modchapter.html"><a href="modchapter.html#nonparametric-tests-of-location"><i class="fa fa-check"></i><b>7.3.1</b> Nonparametric tests of location</a></li>
<li class="chapter" data-level="7.3.2" data-path="modchapter.html"><a href="modchapter.html#tests-for-correlation"><i class="fa fa-check"></i><b>7.3.2</b> Tests for correlation</a></li>
<li class="chapter" data-level="7.3.3" data-path="modchapter.html"><a href="modchapter.html#chi2-tests"><i class="fa fa-check"></i><b>7.3.3</b> <span class="math inline">\(\chi^2\)</span>-tests</a></li>
<li class="chapter" data-level="7.3.4" data-path="modchapter.html"><a href="modchapter.html#confprop"><i class="fa fa-check"></i><b>7.3.4</b> Confidence intervals for proportions</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="modchapter.html"><a href="modchapter.html#ethicsinference"><i class="fa fa-check"></i><b>7.4</b> Ethical issues in statistical inference</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="modchapter.html"><a href="modchapter.html#p-hacking-and-the-file-drawer-problem"><i class="fa fa-check"></i><b>7.4.1</b> p-hacking and the file-drawer problem</a></li>
<li class="chapter" data-level="7.4.2" data-path="modchapter.html"><a href="modchapter.html#reproducibility"><i class="fa fa-check"></i><b>7.4.2</b> Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="modchapter.html"><a href="modchapter.html#simeval"><i class="fa fa-check"></i><b>7.5</b> Evaluating statistical methods using simulation</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="modchapter.html"><a href="modchapter.html#comparing-estimators"><i class="fa fa-check"></i><b>7.5.1</b> Comparing estimators</a></li>
<li class="chapter" data-level="7.5.2" data-path="modchapter.html"><a href="modchapter.html#simtypeI"><i class="fa fa-check"></i><b>7.5.2</b> Type I error rate of hypothesis tests</a></li>
<li class="chapter" data-level="7.5.3" data-path="modchapter.html"><a href="modchapter.html#simpower"><i class="fa fa-check"></i><b>7.5.3</b> Power of hypothesis tests</a></li>
<li class="chapter" data-level="7.5.4" data-path="modchapter.html"><a href="modchapter.html#powerlocation"><i class="fa fa-check"></i><b>7.5.4</b> Power of some tests of location</a></li>
<li class="chapter" data-level="7.5.5" data-path="modchapter.html"><a href="modchapter.html#simadvice"><i class="fa fa-check"></i><b>7.5.5</b> Some advice on simulation studies</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="modchapter.html"><a href="modchapter.html#sscus"><i class="fa fa-check"></i><b>7.6</b> Sample size computations using simulation</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="modchapter.html"><a href="modchapter.html#simcorpower"><i class="fa fa-check"></i><b>7.6.1</b> Writing your own simulation</a></li>
<li class="chapter" data-level="7.6.2" data-path="modchapter.html"><a href="modchapter.html#the-wilcoxon-mann-whitney-test"><i class="fa fa-check"></i><b>7.6.2</b> The Wilcoxon-Mann-Whitney test</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="modchapter.html"><a href="modchapter.html#bootstrap"><i class="fa fa-check"></i><b>7.7</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="modchapter.html"><a href="modchapter.html#a-general-approach"><i class="fa fa-check"></i><b>7.7.1</b> A general approach</a></li>
<li class="chapter" data-level="7.7.2" data-path="modchapter.html"><a href="modchapter.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>7.7.2</b> Bootstrap confidence intervals</a></li>
<li class="chapter" data-level="7.7.3" data-path="modchapter.html"><a href="modchapter.html#intervalinversion"><i class="fa fa-check"></i><b>7.7.3</b> Bootstrap hypothesis tests</a></li>
<li class="chapter" data-level="7.7.4" data-path="modchapter.html"><a href="modchapter.html#parametricbootstrap"><i class="fa fa-check"></i><b>7.7.4</b> The parametric bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="modchapter.html"><a href="modchapter.html#reporting-statistical-results"><i class="fa fa-check"></i><b>7.8</b> Reporting statistical results</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="modchapter.html"><a href="modchapter.html#what-should-you-include"><i class="fa fa-check"></i><b>7.8.1</b> What should you include?</a></li>
<li class="chapter" data-level="7.8.2" data-path="modchapter.html"><a href="modchapter.html#citing-r-packages"><i class="fa fa-check"></i><b>7.8.2</b> Citing R packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>8</b> Regression models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="regression.html"><a href="regression.html#linearmodels"><i class="fa fa-check"></i><b>8.1</b> Linear models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="regression.html"><a href="regression.html#fitting-linear-models"><i class="fa fa-check"></i><b>8.1.1</b> Fitting linear models</a></li>
<li class="chapter" data-level="8.1.2" data-path="regression.html"><a href="regression.html#interactions-and-polynomial-terms"><i class="fa fa-check"></i><b>8.1.2</b> Interactions and polynomial terms</a></li>
<li class="chapter" data-level="8.1.3" data-path="regression.html"><a href="regression.html#dummy-variables"><i class="fa fa-check"></i><b>8.1.3</b> Dummy variables</a></li>
<li class="chapter" data-level="8.1.4" data-path="regression.html"><a href="regression.html#model-diagnostics"><i class="fa fa-check"></i><b>8.1.4</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.1.5" data-path="regression.html"><a href="regression.html#transformations"><i class="fa fa-check"></i><b>8.1.5</b> Transformations</a></li>
<li class="chapter" data-level="8.1.6" data-path="regression.html"><a href="regression.html#alternatives-to-lm"><i class="fa fa-check"></i><b>8.1.6</b> Alternatives to <code>lm</code></a></li>
<li class="chapter" data-level="8.1.7" data-path="regression.html"><a href="regression.html#regbootstrap"><i class="fa fa-check"></i><b>8.1.7</b> Bootstrap confidence intervals for regression coefficients</a></li>
<li class="chapter" data-level="8.1.8" data-path="regression.html"><a href="regression.html#broom"><i class="fa fa-check"></i><b>8.1.8</b> Alternative summaries with <code>broom</code></a></li>
<li class="chapter" data-level="8.1.9" data-path="regression.html"><a href="regression.html#stepwise"><i class="fa fa-check"></i><b>8.1.9</b> Variable selection</a></li>
<li class="chapter" data-level="8.1.10" data-path="regression.html"><a href="regression.html#prediction"><i class="fa fa-check"></i><b>8.1.10</b> Prediction</a></li>
<li class="chapter" data-level="8.1.11" data-path="regression.html"><a href="regression.html#multipredict"><i class="fa fa-check"></i><b>8.1.11</b> Prediction for multiple datasets</a></li>
<li class="chapter" data-level="8.1.12" data-path="regression.html"><a href="regression.html#ANOVA"><i class="fa fa-check"></i><b>8.1.12</b> ANOVA</a></li>
<li class="chapter" data-level="8.1.13" data-path="regression.html"><a href="regression.html#bayeslm"><i class="fa fa-check"></i><b>8.1.13</b> Bayesian estimation of linear models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="regression.html"><a href="regression.html#ethical-issues-in-regression-modelling"><i class="fa fa-check"></i><b>8.2</b> Ethical issues in regression modelling</a></li>
<li class="chapter" data-level="8.3" data-path="regression.html"><a href="regression.html#generalised-linear-models"><i class="fa fa-check"></i><b>8.3</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="regression.html"><a href="regression.html#logreg"><i class="fa fa-check"></i><b>8.3.1</b> Modelling proportions: Logistic regression</a></li>
<li class="chapter" data-level="8.3.2" data-path="regression.html"><a href="regression.html#bootstrap-confidence-intervals-1"><i class="fa fa-check"></i><b>8.3.2</b> Bootstrap confidence intervals</a></li>
<li class="chapter" data-level="8.3.3" data-path="regression.html"><a href="regression.html#model-diagnostics-1"><i class="fa fa-check"></i><b>8.3.3</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.3.4" data-path="regression.html"><a href="regression.html#prediction-1"><i class="fa fa-check"></i><b>8.3.4</b> Prediction</a></li>
<li class="chapter" data-level="8.3.5" data-path="regression.html"><a href="regression.html#modelling-count-data"><i class="fa fa-check"></i><b>8.3.5</b> Modelling count data</a></li>
<li class="chapter" data-level="8.3.6" data-path="regression.html"><a href="regression.html#modelling-rates"><i class="fa fa-check"></i><b>8.3.6</b> Modelling rates</a></li>
<li class="chapter" data-level="8.3.7" data-path="regression.html"><a href="regression.html#bayesian-estimation-of-generalised-linear-models"><i class="fa fa-check"></i><b>8.3.7</b> Bayesian estimation of generalised linear models</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="regression.html"><a href="regression.html#mixedmodels"><i class="fa fa-check"></i><b>8.4</b> Mixed models</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="regression.html"><a href="regression.html#fitting-a-linear-mixed-model"><i class="fa fa-check"></i><b>8.4.1</b> Fitting a linear mixed model</a></li>
<li class="chapter" data-level="8.4.2" data-path="regression.html"><a href="regression.html#model-diagnostics-2"><i class="fa fa-check"></i><b>8.4.2</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.4.3" data-path="regression.html"><a href="regression.html#lmmbootstrap"><i class="fa fa-check"></i><b>8.4.3</b> Bootstrapping</a></li>
<li class="chapter" data-level="8.4.4" data-path="regression.html"><a href="regression.html#nested-random-effects-and-multilevelhierarchical-models"><i class="fa fa-check"></i><b>8.4.4</b> Nested random effects and multilevel/hierarchical models</a></li>
<li class="chapter" data-level="8.4.5" data-path="regression.html"><a href="regression.html#anova-with-random-effects"><i class="fa fa-check"></i><b>8.4.5</b> ANOVA with random effects</a></li>
<li class="chapter" data-level="8.4.6" data-path="regression.html"><a href="regression.html#generalised-linear-mixed-models"><i class="fa fa-check"></i><b>8.4.6</b> Generalised linear mixed models</a></li>
<li class="chapter" data-level="8.4.7" data-path="regression.html"><a href="regression.html#bayesian-estimation-of-mixed-models"><i class="fa fa-check"></i><b>8.4.7</b> Bayesian estimation of mixed models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="regression.html"><a href="regression.html#survival"><i class="fa fa-check"></i><b>8.5</b> Survival analysis</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="regression.html"><a href="regression.html#comparing-groups"><i class="fa fa-check"></i><b>8.5.1</b> Comparing groups</a></li>
<li class="chapter" data-level="8.5.2" data-path="regression.html"><a href="regression.html#the-cox-proportional-hazards-model"><i class="fa fa-check"></i><b>8.5.2</b> The Cox proportional hazards model</a></li>
<li class="chapter" data-level="8.5.3" data-path="regression.html"><a href="regression.html#accelerated-failure-time-models"><i class="fa fa-check"></i><b>8.5.3</b> Accelerated failure time models</a></li>
<li class="chapter" data-level="8.5.4" data-path="regression.html"><a href="regression.html#bayesian-survival-analysis"><i class="fa fa-check"></i><b>8.5.4</b> Bayesian survival analysis</a></li>
<li class="chapter" data-level="8.5.5" data-path="regression.html"><a href="regression.html#multivariate-survival-analysis"><i class="fa fa-check"></i><b>8.5.5</b> Multivariate survival analysis</a></li>
<li class="chapter" data-level="8.5.6" data-path="regression.html"><a href="regression.html#power-estimates-for-the-logrank-test"><i class="fa fa-check"></i><b>8.5.6</b> Power estimates for the logrank test</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="regression.html"><a href="regression.html#left-censored-data-and-nondetects"><i class="fa fa-check"></i><b>8.6</b> Left-censored data and nondetects</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="regression.html"><a href="regression.html#estimation"><i class="fa fa-check"></i><b>8.6.1</b> Estimation</a></li>
<li class="chapter" data-level="8.6.2" data-path="regression.html"><a href="regression.html#tests-of-means"><i class="fa fa-check"></i><b>8.6.2</b> Tests of means</a></li>
<li class="chapter" data-level="8.6.3" data-path="regression.html"><a href="regression.html#censored-regression"><i class="fa fa-check"></i><b>8.6.3</b> Censored regression</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="regression.html"><a href="regression.html#creating-matched-samples"><i class="fa fa-check"></i><b>8.7</b> Creating matched samples</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="regression.html"><a href="regression.html#propensity-score-matching"><i class="fa fa-check"></i><b>8.7.1</b> Propensity score matching</a></li>
<li class="chapter" data-level="8.7.2" data-path="regression.html"><a href="regression.html#stepwise-matching"><i class="fa fa-check"></i><b>8.7.2</b> Stepwise matching</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mlchapter.html"><a href="mlchapter.html"><i class="fa fa-check"></i><b>9</b> Predictive modelling and machine learning</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mlchapter.html"><a href="mlchapter.html#evaluating-predictive-models"><i class="fa fa-check"></i><b>9.1</b> Evaluating predictive models</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="mlchapter.html"><a href="mlchapter.html#evaluating-regression-models"><i class="fa fa-check"></i><b>9.1.1</b> Evaluating regression models</a></li>
<li class="chapter" data-level="9.1.2" data-path="mlchapter.html"><a href="mlchapter.html#test-training-splits"><i class="fa fa-check"></i><b>9.1.2</b> Test-training splits</a></li>
<li class="chapter" data-level="9.1.3" data-path="mlchapter.html"><a href="mlchapter.html#loocv"><i class="fa fa-check"></i><b>9.1.3</b> Leave-one-out cross-validation and <code>caret</code></a></li>
<li class="chapter" data-level="9.1.4" data-path="mlchapter.html"><a href="mlchapter.html#kfoldcv"><i class="fa fa-check"></i><b>9.1.4</b> k-fold cross-validation</a></li>
<li class="chapter" data-level="9.1.5" data-path="mlchapter.html"><a href="mlchapter.html#twinned-observations"><i class="fa fa-check"></i><b>9.1.5</b> Twinned observations</a></li>
<li class="chapter" data-level="9.1.6" data-path="mlchapter.html"><a href="mlchapter.html#bootstrapping"><i class="fa fa-check"></i><b>9.1.6</b> Bootstrapping</a></li>
<li class="chapter" data-level="9.1.7" data-path="mlchapter.html"><a href="mlchapter.html#classifieraccuracy"><i class="fa fa-check"></i><b>9.1.7</b> Evaluating classification models</a></li>
<li class="chapter" data-level="9.1.8" data-path="mlchapter.html"><a href="mlchapter.html#decisionboundaries"><i class="fa fa-check"></i><b>9.1.8</b> Visualising decision boundaries</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="mlchapter.html"><a href="mlchapter.html#ethical-issues-in-predictive-modelling"><i class="fa fa-check"></i><b>9.2</b> Ethical issues in predictive modelling</a></li>
<li class="chapter" data-level="9.3" data-path="mlchapter.html"><a href="mlchapter.html#modellingchallenges"><i class="fa fa-check"></i><b>9.3</b> Challenges in predictive modelling</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mlchapter.html"><a href="mlchapter.html#imbalanced"><i class="fa fa-check"></i><b>9.3.1</b> Handling class imbalance</a></li>
<li class="chapter" data-level="9.3.2" data-path="mlchapter.html"><a href="mlchapter.html#varimportance"><i class="fa fa-check"></i><b>9.3.2</b> Assessing variable importance</a></li>
<li class="chapter" data-level="9.3.3" data-path="mlchapter.html"><a href="mlchapter.html#extrapolation"><i class="fa fa-check"></i><b>9.3.3</b> Extrapolation</a></li>
<li class="chapter" data-level="9.3.4" data-path="mlchapter.html"><a href="mlchapter.html#missing-data-and-imputation"><i class="fa fa-check"></i><b>9.3.4</b> Missing data and imputation</a></li>
<li class="chapter" data-level="9.3.5" data-path="mlchapter.html"><a href="mlchapter.html#endless-waiting"><i class="fa fa-check"></i><b>9.3.5</b> Endless waiting</a></li>
<li class="chapter" data-level="9.3.6" data-path="mlchapter.html"><a href="mlchapter.html#overfittingtestset"><i class="fa fa-check"></i><b>9.3.6</b> Overfitting to the test set</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mlchapter.html"><a href="mlchapter.html#regularised"><i class="fa fa-check"></i><b>9.4</b> Regularised regression models</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="mlchapter.html"><a href="mlchapter.html#ridge-regression"><i class="fa fa-check"></i><b>9.4.1</b> Ridge regression</a></li>
<li class="chapter" data-level="9.4.2" data-path="mlchapter.html"><a href="mlchapter.html#lasso"><i class="fa fa-check"></i><b>9.4.2</b> The lasso</a></li>
<li class="chapter" data-level="9.4.3" data-path="mlchapter.html"><a href="mlchapter.html#elastic-net"><i class="fa fa-check"></i><b>9.4.3</b> Elastic net</a></li>
<li class="chapter" data-level="9.4.4" data-path="mlchapter.html"><a href="mlchapter.html#choosing-the-best-model"><i class="fa fa-check"></i><b>9.4.4</b> Choosing the best model</a></li>
<li class="chapter" data-level="9.4.5" data-path="mlchapter.html"><a href="mlchapter.html#regularised-mixed-models"><i class="fa fa-check"></i><b>9.4.5</b> Regularised mixed models</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="mlchapter.html"><a href="mlchapter.html#mlmethods"><i class="fa fa-check"></i><b>9.5</b> Machine learning models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mlchapter.html"><a href="mlchapter.html#decisiontrees"><i class="fa fa-check"></i><b>9.5.1</b> Decision trees</a></li>
<li class="chapter" data-level="9.5.2" data-path="mlchapter.html"><a href="mlchapter.html#randomforests"><i class="fa fa-check"></i><b>9.5.2</b> Random forests</a></li>
<li class="chapter" data-level="9.5.3" data-path="mlchapter.html"><a href="mlchapter.html#boosted-trees"><i class="fa fa-check"></i><b>9.5.3</b> Boosted trees</a></li>
<li class="chapter" data-level="9.5.4" data-path="mlchapter.html"><a href="mlchapter.html#model-trees"><i class="fa fa-check"></i><b>9.5.4</b> Model trees</a></li>
<li class="chapter" data-level="9.5.5" data-path="mlchapter.html"><a href="mlchapter.html#discriminant-analysis"><i class="fa fa-check"></i><b>9.5.5</b> Discriminant analysis</a></li>
<li class="chapter" data-level="9.5.6" data-path="mlchapter.html"><a href="mlchapter.html#support-vector-machines"><i class="fa fa-check"></i><b>9.5.6</b> Support vector machines</a></li>
<li class="chapter" data-level="9.5.7" data-path="mlchapter.html"><a href="mlchapter.html#nearest-neighbours-classifiers"><i class="fa fa-check"></i><b>9.5.7</b> Nearest neighbours classifiers</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="mlchapter.html"><a href="mlchapter.html#tsforecast"><i class="fa fa-check"></i><b>9.6</b> Forecasting time series</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="mlchapter.html"><a href="mlchapter.html#decomposition"><i class="fa fa-check"></i><b>9.6.1</b> Decomposition</a></li>
<li class="chapter" data-level="9.6.2" data-path="mlchapter.html"><a href="mlchapter.html#forecasting-using-arima-models"><i class="fa fa-check"></i><b>9.6.2</b> Forecasting using ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="mlchapter.html"><a href="mlchapter.html#deploying-models"><i class="fa fa-check"></i><b>9.7</b> Deploying models</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="mlchapter.html"><a href="mlchapter.html#creating-apis-with-plumber"><i class="fa fa-check"></i><b>9.7.1</b> Creating APIs with <code>plumber</code></a></li>
<li class="chapter" data-level="9.7.2" data-path="mlchapter.html"><a href="mlchapter.html#different-types-of-output"><i class="fa fa-check"></i><b>9.7.2</b> Different types of output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="advancedchapter.html"><a href="advancedchapter.html"><i class="fa fa-check"></i><b>10</b> Advanced topics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="advancedchapter.html"><a href="advancedchapter.html#moreonpackages"><i class="fa fa-check"></i><b>10.1</b> More on packages</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="advancedchapter.html"><a href="advancedchapter.html#loading-and-auto-installing-packages"><i class="fa fa-check"></i><b>10.1.1</b> Loading and auto-installing packages</a></li>
<li class="chapter" data-level="10.1.2" data-path="advancedchapter.html"><a href="advancedchapter.html#updating-r-and-your-packages"><i class="fa fa-check"></i><b>10.1.2</b> Updating R and your packages</a></li>
<li class="chapter" data-level="10.1.3" data-path="advancedchapter.html"><a href="advancedchapter.html#alternative-repositories"><i class="fa fa-check"></i><b>10.1.3</b> Alternative repositories</a></li>
<li class="chapter" data-level="10.1.4" data-path="advancedchapter.html"><a href="advancedchapter.html#removing-packages"><i class="fa fa-check"></i><b>10.1.4</b> Removing packages</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="advancedchapter.html"><a href="advancedchapter.html#parallel"><i class="fa fa-check"></i><b>10.2</b> Speeding up computations with parallelisation</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="advancedchapter.html"><a href="advancedchapter.html#parallelising-for-loops"><i class="fa fa-check"></i><b>10.2.1</b> Parallelising <code>for</code> loops</a></li>
<li class="chapter" data-level="10.2.2" data-path="advancedchapter.html"><a href="advancedchapter.html#parallelising-functionals"><i class="fa fa-check"></i><b>10.2.2</b> Parallelising functionals</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="advancedchapter.html"><a href="advancedchapter.html#linearalgebra"><i class="fa fa-check"></i><b>10.3</b> Linear algebra and matrices</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="advancedchapter.html"><a href="advancedchapter.html#creating-matrices"><i class="fa fa-check"></i><b>10.3.1</b> Creating matrices</a></li>
<li class="chapter" data-level="10.3.2" data-path="advancedchapter.html"><a href="advancedchapter.html#sparse-matrices"><i class="fa fa-check"></i><b>10.3.2</b> Sparse matrices</a></li>
<li class="chapter" data-level="10.3.3" data-path="advancedchapter.html"><a href="advancedchapter.html#matrix-operations"><i class="fa fa-check"></i><b>10.3.3</b> Matrix operations</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="advancedchapter.html"><a href="advancedchapter.html#integration"><i class="fa fa-check"></i><b>10.4</b> Integration with other programming languages</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-c"><i class="fa fa-check"></i><b>10.4.1</b> Integration with C++</a></li>
<li class="chapter" data-level="10.4.2" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-python"><i class="fa fa-check"></i><b>10.4.2</b> Integration with Python</a></li>
<li class="chapter" data-level="10.4.3" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-tensorflow-and-pytorch"><i class="fa fa-check"></i><b>10.4.3</b> Integration with Tensorflow and PyTorch</a></li>
<li class="chapter" data-level="10.4.4" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-spark"><i class="fa fa-check"></i><b>10.4.4</b> Integration with Spark</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="errorchapter.html"><a href="errorchapter.html"><i class="fa fa-check"></i><b>11</b> Debugging</a>
<ul>
<li class="chapter" data-level="11.1" data-path="errorchapter.html"><a href="errorchapter.html#debugging"><i class="fa fa-check"></i><b>11.1</b> Debugging</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="errorchapter.html"><a href="errorchapter.html#find-out-where-the-error-occured-with-traceback"><i class="fa fa-check"></i><b>11.1.1</b> Find out where the error occured with <code>traceback</code></a></li>
<li class="chapter" data-level="11.1.2" data-path="errorchapter.html"><a href="errorchapter.html#interactive-debugging-of-functions-with-debug"><i class="fa fa-check"></i><b>11.1.2</b> Interactive debugging of functions with <code>debug</code></a></li>
<li class="chapter" data-level="11.1.3" data-path="errorchapter.html"><a href="errorchapter.html#investigate-the-environment-with-recover"><i class="fa fa-check"></i><b>11.1.3</b> Investigate the environment with <code>recover</code></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="errorchapter.html"><a href="errorchapter.html#commonerrors"><i class="fa fa-check"></i><b>11.2</b> Common error messages</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="errorchapter.html"><a href="errorchapter.html#section-1"><i class="fa fa-check"></i><b>11.2.1</b> <code>+</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="errorchapter.html"><a href="errorchapter.html#could-not-find-function"><i class="fa fa-check"></i><b>11.2.2</b> <code>could not find function</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="errorchapter.html"><a href="errorchapter.html#object-not-found"><i class="fa fa-check"></i><b>11.2.3</b> <code>object not found</code></a></li>
<li class="chapter" data-level="11.2.4" data-path="errorchapter.html"><a href="errorchapter.html#cannot-open-the-connection-and-no-such-file-or-directory"><i class="fa fa-check"></i><b>11.2.4</b> <code>cannot open the connection</code> and <code>No such file or directory</code></a></li>
<li class="chapter" data-level="11.2.5" data-path="errorchapter.html"><a href="errorchapter.html#invalid-description-argument"><i class="fa fa-check"></i><b>11.2.5</b> <code>invalid 'description' argument</code></a></li>
<li class="chapter" data-level="11.2.6" data-path="errorchapter.html"><a href="errorchapter.html#missing-value-where-truefalse-needed"><i class="fa fa-check"></i><b>11.2.6</b> <code>missing value where TRUE/FALSE needed</code></a></li>
<li class="chapter" data-level="11.2.7" data-path="errorchapter.html"><a href="errorchapter.html#unexpected-in-..."><i class="fa fa-check"></i><b>11.2.7</b> <code>unexpected '=' in ...</code></a></li>
<li class="chapter" data-level="11.2.8" data-path="errorchapter.html"><a href="errorchapter.html#attempt-to-apply-non-function"><i class="fa fa-check"></i><b>11.2.8</b> <code>attempt to apply non-function</code></a></li>
<li class="chapter" data-level="11.2.9" data-path="errorchapter.html"><a href="errorchapter.html#undefined-columns-selected"><i class="fa fa-check"></i><b>11.2.9</b> <code>undefined columns selected</code></a></li>
<li class="chapter" data-level="11.2.10" data-path="errorchapter.html"><a href="errorchapter.html#subscript-out-of-bounds"><i class="fa fa-check"></i><b>11.2.10</b> <code>subscript out of bounds</code></a></li>
<li class="chapter" data-level="11.2.11" data-path="errorchapter.html"><a href="errorchapter.html#object-of-type-closure-is-not-subsettable"><i class="fa fa-check"></i><b>11.2.11</b> <code>Object of type ‘closure’ is not subsettable</code></a></li>
<li class="chapter" data-level="11.2.12" data-path="errorchapter.html"><a href="errorchapter.html#operator-is-invalid-for-atomic-vectors"><i class="fa fa-check"></i><b>11.2.12</b> <code>$ operator is invalid for atomic vectors</code></a></li>
<li class="chapter" data-level="11.2.13" data-path="errorchapter.html"><a href="errorchapter.html#list-object-cannot-be-coerced-to-type-double"><i class="fa fa-check"></i><b>11.2.13</b> <code>(list) object cannot be coerced to type ‘double’</code></a></li>
<li class="chapter" data-level="11.2.14" data-path="errorchapter.html"><a href="errorchapter.html#arguments-imply-differing-number-of-rows"><i class="fa fa-check"></i><b>11.2.14</b> <code>arguments imply differing number of rows</code></a></li>
<li class="chapter" data-level="11.2.15" data-path="errorchapter.html"><a href="errorchapter.html#non-numeric-argument-to-a-binary-operator"><i class="fa fa-check"></i><b>11.2.15</b> <code>non-numeric argument to a binary operator</code></a></li>
<li class="chapter" data-level="11.2.16" data-path="errorchapter.html"><a href="errorchapter.html#non-numeric-argument-to-mathematical-function"><i class="fa fa-check"></i><b>11.2.16</b> <code>non-numeric argument to mathematical function</code></a></li>
<li class="chapter" data-level="11.2.17" data-path="errorchapter.html"><a href="errorchapter.html#cannot-allocate-vector-of-size-..."><i class="fa fa-check"></i><b>11.2.17</b> <code>cannot allocate vector of size ...</code></a></li>
<li class="chapter" data-level="11.2.18" data-path="errorchapter.html"><a href="errorchapter.html#error-in-plot.new-figure-margins-too-large"><i class="fa fa-check"></i><b>11.2.18</b> <code>Error in plot.new() : figure margins too large</code></a></li>
<li class="chapter" data-level="11.2.19" data-path="errorchapter.html"><a href="errorchapter.html#error-in-.call.graphicsc_palette2-.callc_palette2-null-invalid-graphics-state"><i class="fa fa-check"></i><b>11.2.19</b> <code>Error in .Call.graphics(C_palette2, .Call(C_palette2, NULL)) : invalid graphics state</code></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="errorchapter.html"><a href="errorchapter.html#commonwarnings"><i class="fa fa-check"></i><b>11.3</b> Common warning messages</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="errorchapter.html"><a href="errorchapter.html#replacement-has-...-rows-..."><i class="fa fa-check"></i><b>11.3.1</b> <code>replacement has ... rows ...</code></a></li>
<li class="chapter" data-level="11.3.2" data-path="errorchapter.html"><a href="errorchapter.html#iferror"><i class="fa fa-check"></i><b>11.3.2</b> <code>the condition has length &gt; 1 and only the first element will be used</code></a></li>
<li class="chapter" data-level="11.3.3" data-path="errorchapter.html"><a href="errorchapter.html#number-of-items-to-replace-is-not-a-multiple-of-replacement-length"><i class="fa fa-check"></i><b>11.3.3</b> <code>number of items to replace is not a multiple of replacement length</code></a></li>
<li class="chapter" data-level="11.3.4" data-path="errorchapter.html"><a href="errorchapter.html#longer-object-length-is-not-a-multiple-of-shorter-object-length"><i class="fa fa-check"></i><b>11.3.4</b> <code>longer object length is not a multiple of shorter object length</code></a></li>
<li class="chapter" data-level="11.3.5" data-path="errorchapter.html"><a href="errorchapter.html#nas-introduced-by-coercion"><i class="fa fa-check"></i><b>11.3.5</b> <code>NAs introduced by coercion</code></a></li>
<li class="chapter" data-level="11.3.6" data-path="errorchapter.html"><a href="errorchapter.html#package-is-not-available-for-r-version-4.x.x"><i class="fa fa-check"></i><b>11.3.6</b> <code>package is not available (for R version 4.x.x)</code></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="errorchapter.html"><a href="errorchapter.html#installationmessages"><i class="fa fa-check"></i><b>11.4</b> Messages printed when installing <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mathschap.html"><a href="mathschap.html"><i class="fa fa-check"></i><b>12</b> Mathematical appendix</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mathschap.html"><a href="mathschap.html#bootstrapcimaths"><i class="fa fa-check"></i><b>12.1</b> Bootstrap confidence intervals</a></li>
<li class="chapter" data-level="12.2" data-path="mathschap.html"><a href="mathschap.html#confintequal"><i class="fa fa-check"></i><b>12.2</b> The equivalence between confidence intervals and hypothesis tests</a></li>
<li class="chapter" data-level="12.3" data-path="mathschap.html"><a href="mathschap.html#twotypesofpvalues"><i class="fa fa-check"></i><b>12.3</b> Two types of p-values</a></li>
<li class="chapter" data-level="12.4" data-path="mathschap.html"><a href="mathschap.html#deviance"><i class="fa fa-check"></i><b>12.4</b> Deviance tests</a></li>
<li class="chapter" data-level="12.5" data-path="mathschap.html"><a href="mathschap.html#regreg"><i class="fa fa-check"></i><b>12.5</b> Regularised regression</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>13</b> Solutions to exercises</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutionsch2"><i class="fa fa-check"></i>Chapter 2</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutionsch3"><i class="fa fa-check"></i>Chapter 3</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutionsch4"><i class="fa fa-check"></i>Chapter 4</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch5solutions"><i class="fa fa-check"></i>Chapter 5</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch6solutions"><i class="fa fa-check"></i>Chapter 6</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch7solutions"><i class="fa fa-check"></i>Chapter 7</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch7bsolutions"><i class="fa fa-check"></i>Chapter 8</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch8solutions"><i class="fa fa-check"></i>Chapter 9</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>Bibliography</a>
<ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references1"><i class="fa fa-check"></i>Further reading</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references2"><i class="fa fa-check"></i>Online resources</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references3"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="divider"></li>
<li>&copy; 2023 psnam</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R 통계분석</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modchapter" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Modern classical statistics<a href="modchapter.html#modchapter" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>“Modern classical” may sound like a contradiction, but it is in fact anything but. Classical statistics covers topics like estimation, quantification of uncertainty, and hypothesis testing - all of which are at the heart of data analysis. Since the advent of modern computers, much has happened in this field that has yet to make it to the standard textbooks of introductory courses in statistics. This chapter attempts to bridge part of that gap by dealing with those classical topics, but with a modern approach that uses more recent advances in statistical theory and computational methods. Particular focus is put on how simulation can be used for analyses and for evaluating the properties of statistical procedures.</p>
<p>Whenever it is feasible, our aim in this chapter and the next is to:</p>
<ul>
<li>Use hypothesis tests that are based on permutations or the bootstrap rather than tests based on strict assumptions about the distribution of the data or asymptotic distributions,</li>
<li>To complement estimates and hypothesis tests with computing confidence intervals based on sound methods (including the bootstrap),</li>
<li>Offer easy-to-use Bayesian methods as an alternative to frequentist tools.</li>
</ul>
<p>After reading this chapter, you will be able to use R to:</p>
<ul>
<li>Generate random numbers,</li>
<li>Perform simulations to assess the performance of statistical methods,</li>
<li>Perform hypothesis tests,</li>
<li>Compute confidence intervals,</li>
<li>Make sample size computations,</li>
<li>Report statistical results.</li>
</ul>
<div id="simulation" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Simulation and distributions<a href="modchapter.html#simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A <em>random variable</em> is a variable whose value describes the outcome of a random phenomenon. A (probability) <em>distribution</em> is a mathematical function that describes the probability of different outcomes for a random variable. Random variables and distributions are at the heart of probability theory and most, if not all, statistical models.</p>
<p>As we shall soon see, they are also invaluable tools when evaluating statistical methods. A key component of modern statistical work is <em>simulation</em>, in which we generate artificial data that can be used both in the analysis of real data (e.g. in permutation tests and bootstrap confidence intervals, topics that we’ll explore in this chapter) and for assessing different methods. Simulation is possible only because we can generate random numbers, so let’s begin by having a look at how we can generate random numbers in R.</p>
<div id="generating-random-numbers" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Generating random numbers<a href="modchapter.html#generating-random-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The function <code>sample</code> can be used to randomly draw a number of elements from a vector. For instance, we can use it to draw 2 random numbers from the first ten integers: <span class="math inline">\(1, 2, \ldots, 9, 10\)</span>:</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="modchapter.html#cb690-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">2</span>)</span></code></pre></div>
<p>Try running the above code multiple times. You’ll get different results each time, because each time it runs the random number generator is in a different <em>state</em>. In most cases, this is desirable (if the results were the same each time we used <code>sample</code>, it wouldn’t be random), but not if we want to replicate a result at some later stage.</p>
<p>When we are concerned about reproducibility, we can use <code>set.seed</code> to fix the state of the random number generator:</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="modchapter.html#cb691-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Each run generates different results:</span></span>
<span id="cb691-2"><a href="modchapter.html#cb691-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">2</span>); <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb691-3"><a href="modchapter.html#cb691-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-4"><a href="modchapter.html#cb691-4" aria-hidden="true" tabindex="-1"></a><span class="co"># To get the same result each time, set the seed to a</span></span>
<span id="cb691-5"><a href="modchapter.html#cb691-5" aria-hidden="true" tabindex="-1"></a><span class="co"># number of your choice:</span></span>
<span id="cb691-6"><a href="modchapter.html#cb691-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>); <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb691-7"><a href="modchapter.html#cb691-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">314</span>); <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">2</span>)</span></code></pre></div>
<p>We often want to use simulated data from a probability distribution, such as the normal distribution. The normal distribution is defined by its mean <span class="math inline">\(\mu\)</span> and its variance <span class="math inline">\(\sigma^2\)</span> (or, equivalently, its standard deviation <span class="math inline">\(\sigma\)</span>). There are special functions for generating data from different distributions - for the normal distribution it is called <code>rnorm</code>. We specify the number of observations that we want to generate (<code>n</code>) and the parameters of the distribution (the mean <code>mu</code> and the standard deviation <code>sigma</code>):</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="modchapter.html#cb692-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mu =</span> <span class="dv">2</span>, <span class="at">sigma =</span> <span class="dv">1</span>)</span>
<span id="cb692-2"><a href="modchapter.html#cb692-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb692-3"><a href="modchapter.html#cb692-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A shorter version:</span></span>
<span id="cb692-4"><a href="modchapter.html#cb692-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span></code></pre></div>
<p>Similarly, there are functions that can be used compute the quantile function, density function, and cumulative distribution function (CDF) of the normal distribution. Here are some examples for a normal distribution with mean 2 and standard deviation 1:</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="modchapter.html#cb693-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.9</span>, <span class="dv">2</span>, <span class="dv">1</span>)    <span class="co"># Upper 90 % quantile of distribution</span></span>
<span id="cb693-2"><a href="modchapter.html#cb693-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="fl">2.5</span>, <span class="dv">2</span>, <span class="dv">1</span>)    <span class="co"># Density function f(2.5)</span></span>
<span id="cb693-3"><a href="modchapter.html#cb693-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">2.5</span>, <span class="dv">2</span>, <span class="dv">1</span>)    <span class="co"># Cumulative distribution function F(2.5)</span></span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch7exc1" class="exercise"><strong>Exercise 7.1  </strong></span>Sampling can be done with or without <em>replacement</em>. If replacement is used, an observation can be drawn more than once. Check the documentation for <code>sample</code>. How can you change the settings to sample with replacement? Draw 5 random numbers from the first ten integers, with replacement.</p>
</div>
<p><a href="solutions.html#ch7solutions1">(Click here to go to the solution.)</a></p>
</div>
<div id="distfunctions" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Some common distributions<a href="modchapter.html#distfunctions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, we provide the syntax for random number generation, quantile functions, density/probability functions and cumulative distribution functions for some of the most commonly used distributions. This section is mainly intended as a reference, for you to look up when you need to use one of these distributions - so there is no need to run all the code chunks below right now.</p>
<p>Normal distribution <span class="math inline">\(N(\mu, \sigma^2)\)</span> with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>:</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="modchapter.html#cb694-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(n, mu, sigma)    <span class="co"># Generate n random numbers</span></span>
<span id="cb694-2"><a href="modchapter.html#cb694-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.95</span>, mu, sigma) <span class="co"># Upper 95 % quantile of distribution</span></span>
<span id="cb694-3"><a href="modchapter.html#cb694-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(x, mu, sigma)    <span class="co"># Density function f(x)</span></span>
<span id="cb694-4"><a href="modchapter.html#cb694-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(x, mu, sigma)    <span class="co"># Cumulative distribution function F(X)</span></span></code></pre></div>
<p>Continuous uniform distribution <span class="math inline">\(U(a,b)\)</span> on the interval <span class="math inline">\((a,b)\)</span>, with mean <span class="math inline">\(\frac{a+b}{2}\)</span> and variance <span class="math inline">\(\frac{(b-a)^2}{12}\)</span>:</p>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="modchapter.html#cb695-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(n, a, b)    <span class="co"># Generate n random numbers</span></span>
<span id="cb695-2"><a href="modchapter.html#cb695-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qunif</span>(<span class="fl">0.95</span>, a, b) <span class="co"># Upper 95 % quantile of distribution</span></span>
<span id="cb695-3"><a href="modchapter.html#cb695-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dunif</span>(x, a, b)    <span class="co"># Density function f(x)</span></span>
<span id="cb695-4"><a href="modchapter.html#cb695-4" aria-hidden="true" tabindex="-1"></a><span class="fu">punif</span>(x, a, b)    <span class="co"># Cumulative distribution function F(X)</span></span></code></pre></div>
<p>Exponential distribution <span class="math inline">\(Exp(m)\)</span> with mean <span class="math inline">\(m\)</span> and variance <span class="math inline">\(m^2\)</span>:</p>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="modchapter.html#cb696-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rexp</span>(n, <span class="dv">1</span><span class="sc">/</span>m)    <span class="co"># Generate n random numbers</span></span>
<span id="cb696-2"><a href="modchapter.html#cb696-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qexp</span>(<span class="fl">0.95</span>, <span class="dv">1</span><span class="sc">/</span>m) <span class="co"># Upper 95 % quantile of distribution</span></span>
<span id="cb696-3"><a href="modchapter.html#cb696-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dexp</span>(x, <span class="dv">1</span><span class="sc">/</span>m)    <span class="co"># Density function f(x)</span></span>
<span id="cb696-4"><a href="modchapter.html#cb696-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pexp</span>(x, <span class="dv">1</span><span class="sc">/</span>m)    <span class="co"># Cumulative distribution function F(X)</span></span></code></pre></div>
<p>Gamma distribution <span class="math inline">\(\Gamma(\alpha, \beta)\)</span> with mean <span class="math inline">\(\frac{\alpha}{\beta}\)</span> and variance <span class="math inline">\(\frac{\alpha}{\beta^2}\)</span>:</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="modchapter.html#cb697-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rgamma</span>(n, alpha, beta)    <span class="co"># Generate n random numbers</span></span>
<span id="cb697-2"><a href="modchapter.html#cb697-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qgamma</span>(<span class="fl">0.95</span>, alpha, beta) <span class="co"># Upper 95 % quantile of distribution</span></span>
<span id="cb697-3"><a href="modchapter.html#cb697-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dgamma</span>(x, alpha, beta)    <span class="co"># Density function f(x)</span></span>
<span id="cb697-4"><a href="modchapter.html#cb697-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pgamma</span>(x, alpha, beta)    <span class="co"># Cumulative distribution function F(X)</span></span></code></pre></div>
<p>Lognormal distribution <span class="math inline">\(LN(\mu, \sigma^2)\)</span> with mean <span class="math inline">\(\exp(\mu+\sigma^2/2)\)</span> and variance <span class="math inline">\((\exp(\sigma^2)-1)\exp(2\mu+\sigma^2)\)</span>:</p>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="modchapter.html#cb698-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rlnorm</span>(n, mu, sigma)    <span class="co"># Generate n random numbers</span></span>
<span id="cb698-2"><a href="modchapter.html#cb698-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qlnorm</span>(<span class="fl">0.95</span>, mu, sigma) <span class="co"># Upper 95 % quantile of distribution</span></span>
<span id="cb698-3"><a href="modchapter.html#cb698-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dlnorm</span>(x, mu, sigma)    <span class="co"># Density function f(x)</span></span>
<span id="cb698-4"><a href="modchapter.html#cb698-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plnorm</span>(x, mu, sigma)    <span class="co"># Cumulative distribution function F(X)</span></span></code></pre></div>
<p>t-distribution <span class="math inline">\(t(\nu)\)</span> with mean 0 (for <span class="math inline">\(\nu&gt;1\)</span>) and variance <span class="math inline">\(\frac{\nu}{\nu-2}\)</span> (for <span class="math inline">\(\nu&gt;2\)</span>):</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="modchapter.html#cb699-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rt</span>(n, nu)    <span class="co"># Generate n random numbers</span></span>
<span id="cb699-2"><a href="modchapter.html#cb699-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="fl">0.95</span>, nu) <span class="co"># Upper 95 % quantile of distribution</span></span>
<span id="cb699-3"><a href="modchapter.html#cb699-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dt</span>(x, nu)    <span class="co"># Density function f(x)</span></span>
<span id="cb699-4"><a href="modchapter.html#cb699-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(x, nu)    <span class="co"># Cumulative distribution function F(X)</span></span></code></pre></div>
<p>Chi-squared distribution <span class="math inline">\(\chi^2(k)\)</span> with mean <span class="math inline">\(k\)</span> and variance <span class="math inline">\(2k\)</span>:</p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="modchapter.html#cb700-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rchisq</span>(n, k)    <span class="co"># Generate n random numbers</span></span>
<span id="cb700-2"><a href="modchapter.html#cb700-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qchisq</span>(<span class="fl">0.95</span>, k) <span class="co"># Upper 95 % quantile of distribution</span></span>
<span id="cb700-3"><a href="modchapter.html#cb700-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dchisq</span>(x, k)    <span class="co"># Density function f(x)</span></span>
<span id="cb700-4"><a href="modchapter.html#cb700-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(x, k)    <span class="co"># Cumulative distribution function F(X)</span></span></code></pre></div>
<p>F-distribution <span class="math inline">\(F(d_1, d_2)\)</span> with mean <span class="math inline">\(\frac{d_2}{d_2-2}\)</span> (for <span class="math inline">\(d_2&gt;2\)</span>) and variance <span class="math inline">\(\frac{2d_2^2(d_1+d_2-2)}{d_1(d_2-2)^2(d_2-4)}\)</span> (for <span class="math inline">\(d_2&gt;4\)</span>):</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="modchapter.html#cb701-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rf</span>(n, d1, d2)    <span class="co"># Generate n random numbers</span></span>
<span id="cb701-2"><a href="modchapter.html#cb701-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qf</span>(<span class="fl">0.95</span>, d1, d2) <span class="co"># Upper 95 % quantile of distribution</span></span>
<span id="cb701-3"><a href="modchapter.html#cb701-3" aria-hidden="true" tabindex="-1"></a><span class="fu">df</span>(x, d1, d2)    <span class="co"># Density function f(x)</span></span>
<span id="cb701-4"><a href="modchapter.html#cb701-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(x, d1, d2)    <span class="co"># Cumulative distribution function F(X)</span></span></code></pre></div>
<p>Beta distribution <span class="math inline">\(Beta(\alpha,\beta)\)</span> with mean <span class="math inline">\(\frac{\alpha}{\alpha+\beta}\)</span> and variance <span class="math inline">\(\frac{\alpha \beta}{(\alpha+\beta)^2 (\alpha+\beta+1)}\)</span>:</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="modchapter.html#cb702-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbeta</span>(n, alpha, beta)    <span class="co"># Generate n random numbers</span></span>
<span id="cb702-2"><a href="modchapter.html#cb702-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qbeta</span>(<span class="fl">0.95</span>, alpha, beta) <span class="co"># Upper 95 % quantile of distribution</span></span>
<span id="cb702-3"><a href="modchapter.html#cb702-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dbeta</span>(x, alpha, beta)    <span class="co"># Density function f(x)</span></span>
<span id="cb702-4"><a href="modchapter.html#cb702-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pbeta</span>(x, alpha, beta)    <span class="co"># Cumulative distribution function F(X)</span></span></code></pre></div>
<p>Binomial distribution <span class="math inline">\(Bin(n,p)\)</span> with mean <span class="math inline">\(np\)</span> and variance <span class="math inline">\(np(1-p)\)</span>:</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="modchapter.html#cb703-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(n, n, p)    <span class="co"># Generate n random numbers</span></span>
<span id="cb703-2"><a href="modchapter.html#cb703-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qbinom</span>(<span class="fl">0.95</span>, n, p) <span class="co"># Upper 95 % quantile of distribution</span></span>
<span id="cb703-3"><a href="modchapter.html#cb703-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(x, n, p)    <span class="co"># Probability function f(x)</span></span>
<span id="cb703-4"><a href="modchapter.html#cb703-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(x, n, p)    <span class="co"># Cumulative distribution function F(X)</span></span></code></pre></div>
<p>Poisson distribution <span class="math inline">\(Po(\lambda)\)</span> with mean <span class="math inline">\(\lambda\)</span> and variance <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="modchapter.html#cb704-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpois</span>(n, lambda)    <span class="co"># Generate n random numbers</span></span>
<span id="cb704-2"><a href="modchapter.html#cb704-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qpois</span>(<span class="fl">0.95</span>, lambda) <span class="co"># Upper 95 % quantile of distribution</span></span>
<span id="cb704-3"><a href="modchapter.html#cb704-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(x, lambda)    <span class="co"># Probability function f(x)</span></span>
<span id="cb704-4"><a href="modchapter.html#cb704-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(x, lambda)    <span class="co"># Cumulative distribution function F(X)</span></span></code></pre></div>
<p>Negative binomial distribution <span class="math inline">\(NegBin(r, p)\)</span> with mean <span class="math inline">\(\frac{rp}{1-p}\)</span> and variance <span class="math inline">\(\frac{rp}{(1-p)^2}\)</span>:</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="modchapter.html#cb705-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnbinom</span>(n, r, p)    <span class="co"># Generate n random numbers</span></span>
<span id="cb705-2"><a href="modchapter.html#cb705-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qnbinom</span>(<span class="fl">0.95</span>, r, p) <span class="co"># Upper 95 % quantile of distribution</span></span>
<span id="cb705-3"><a href="modchapter.html#cb705-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dnbinom</span>(x, r, p)    <span class="co"># Probability function f(x)</span></span>
<span id="cb705-4"><a href="modchapter.html#cb705-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pnbinom</span>(x, r, p)    <span class="co"># Cumulative distribution function F(X)</span></span></code></pre></div>
<p>Multivariate normal distribution with mean vector <span class="math inline">\(\mu\)</span> and covariance matrix <span class="math inline">\(\Sigma\)</span>:</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="modchapter.html#cb706-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb706-2"><a href="modchapter.html#cb706-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mvrnorm</span>(n, mu, Sigma) <span class="co"># Generate n random numbers</span></span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch7exc2" class="exercise"><strong>Exercise 7.2  </strong></span>Use <code>runif</code> and (at least) one of <code>round</code>, <code>ceiling</code> and <code>floor</code> to generate observations from a discrete random variable on the integers <span class="math inline">\(1, 2, 3, 4, 5, 6, 7, 8, 9, 10\)</span>.</p>
</div>
<p><a href="solutions.html#ch7solutions2">(Click here to go to the solution.)</a></p>
</div>
<div id="assessing-distributional-assumptions" class="section level3 hasAnchor" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Assessing distributional assumptions<a href="modchapter.html#assessing-distributional-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So how can we know that the functions for generating random observations from distributions work? And when working with real data, how can we know what distribution fits the data? One answer is that we can visually compare the distribution of the generated (or real) data to the target distribution. This can for instance be done by comparing a histogram of the data to the target distribution’s density function.</p>
<p>To do so, we must add <code>aes(y = ..density..))</code> to the call to <code>geom_histogram</code>, which rescales the histogram to have area 1 (just like a density function has). We can then add the density function using <code>geom_function</code>:</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="modchapter.html#cb707-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data from a normal distribution with mean 10 and</span></span>
<span id="cb707-2"><a href="modchapter.html#cb707-2" aria-hidden="true" tabindex="-1"></a><span class="co"># standard deviation 1</span></span>
<span id="cb707-3"><a href="modchapter.html#cb707-3" aria-hidden="true" tabindex="-1"></a>generated_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">normal_data =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">10</span>, <span class="dv">1</span>))</span>
<span id="cb707-4"><a href="modchapter.html#cb707-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb707-5"><a href="modchapter.html#cb707-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb707-6"><a href="modchapter.html#cb707-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to histogram:</span></span>
<span id="cb707-7"><a href="modchapter.html#cb707-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(generated_data, <span class="fu">aes</span>(<span class="at">x =</span> normal_data)) <span class="sc">+</span></span>
<span id="cb707-8"><a href="modchapter.html#cb707-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">y =</span> ..density..)) <span class="sc">+</span></span>
<span id="cb707-9"><a href="modchapter.html#cb707-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_function</span>(<span class="at">fun =</span> dnorm, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb707-10"><a href="modchapter.html#cb707-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(generated_data<span class="sc">$</span>normal_data), </span>
<span id="cb707-11"><a href="modchapter.html#cb707-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sd =</span> <span class="fu">sd</span>(generated_data<span class="sc">$</span>normal_data)))</span></code></pre></div>
<p>Try increasing the number of observations generated. As the number of observations increase, the histogram should start to look more and more like the density function.</p>
<p>We could also add a density estimate for the generated data, to further aid the eye here - we’d expect this to be close to the theoretical density function:</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="modchapter.html#cb708-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to density estimate:</span></span>
<span id="cb708-2"><a href="modchapter.html#cb708-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(generated_data, <span class="fu">aes</span>(<span class="at">x =</span> normal_data)) <span class="sc">+</span></span>
<span id="cb708-3"><a href="modchapter.html#cb708-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">y =</span> ..density..)) <span class="sc">+</span></span>
<span id="cb708-4"><a href="modchapter.html#cb708-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_density</span>(<span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb708-5"><a href="modchapter.html#cb708-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_function</span>(<span class="at">fun =</span> dnorm, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb708-6"><a href="modchapter.html#cb708-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(generated_data<span class="sc">$</span>normal_data), </span>
<span id="cb708-7"><a href="modchapter.html#cb708-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">sd =</span> <span class="fu">sd</span>(generated_data<span class="sc">$</span>normal_data)))</span></code></pre></div>
<p>If instead we wished to compare the distribution of the data to a <span class="math inline">\(\chi^2\)</span> distribution, we would change the value of <code>fun</code> and <code>args</code> in <code>geom_function</code> accordingly:</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="modchapter.html#cb709-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to density estimate:</span></span>
<span id="cb709-2"><a href="modchapter.html#cb709-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(generated_data, <span class="fu">aes</span>(<span class="at">x =</span> normal_data)) <span class="sc">+</span></span>
<span id="cb709-3"><a href="modchapter.html#cb709-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">y =</span> ..density..)) <span class="sc">+</span></span>
<span id="cb709-4"><a href="modchapter.html#cb709-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_density</span>(<span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb709-5"><a href="modchapter.html#cb709-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_function</span>(<span class="at">fun =</span> dchisq, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb709-6"><a href="modchapter.html#cb709-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">args =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="fu">mean</span>(generated_data<span class="sc">$</span>normal_data)))</span></code></pre></div>
<p>Note that the values of <code>args</code> have changed. <code>args</code> should always be a list containing values for the parameters of the distribution: <code>mu</code> and <code>sigma</code> for the normal distribution and <code>df</code> for the <span class="math inline">\(\chi^2\)</span> distribution (the same as in Section <a href="modchapter.html#distfunctions">7.1.2</a>).</p>
<p>Another option is to draw a quantile-quantile plot, or Q-Q plot for short, which compares the theoretical quantiles of a distribution to the empirical quantiles of the data, showing each observation as a point. If the data follows the theorised distribution, then the points should lie more or less along a straight line.</p>
<p>To draw a Q-Q plot for a normal distribution, we use the geoms <code>geom_qq</code> and <code>geom_qq_line</code>:</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="modchapter.html#cb710-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Q-Q plot for normality:</span></span>
<span id="cb710-2"><a href="modchapter.html#cb710-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(generated_data, <span class="fu">aes</span>(<span class="at">sample =</span> normal_data)) <span class="sc">+</span></span>
<span id="cb710-3"><a href="modchapter.html#cb710-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_qq</span>() <span class="sc">+</span> <span class="fu">geom_qq_line</span>()</span></code></pre></div>
<p>For all other distributions, we must provide the quantile function of the distribution (many of which can be found in Section <a href="modchapter.html#distfunctions">7.1.2</a>):</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="modchapter.html#cb711-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Q-Q plot for the lognormal distribution:</span></span>
<span id="cb711-2"><a href="modchapter.html#cb711-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(generated_data, <span class="fu">aes</span>(<span class="at">sample =</span> normal_data)) <span class="sc">+</span></span>
<span id="cb711-3"><a href="modchapter.html#cb711-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_qq</span>(<span class="at">distribution =</span> qlnorm) <span class="sc">+</span></span>
<span id="cb711-4"><a href="modchapter.html#cb711-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_qq_line</span>(<span class="at">distribution =</span> qlnorm)</span></code></pre></div>
<p>Q-Q-plots can be a little difficult to read. There will always be points deviating from the line - in fact, that’s expected. So how much must they deviate before we rule out a distributional assumption? Particularly when working with real data, I like to compare the Q-Q-plot of my data to Q-Q-plots of simulated samples from the assumed distribution, to get a feel for what kind of deviations can appear if the distributional assumption holds. Here’s an example of how to do this, for the normal distribution:</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="modchapter.html#cb712-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at solar radiation data for May from the airquality</span></span>
<span id="cb712-2"><a href="modchapter.html#cb712-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dataset:</span></span>
<span id="cb712-3"><a href="modchapter.html#cb712-3" aria-hidden="true" tabindex="-1"></a>May <span class="ot">&lt;-</span> airquality[airquality<span class="sc">$</span>Month <span class="sc">==</span> <span class="dv">5</span>,]</span>
<span id="cb712-4"><a href="modchapter.html#cb712-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-5"><a href="modchapter.html#cb712-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Q-Q-plot for the solar radiation data, and store</span></span>
<span id="cb712-6"><a href="modchapter.html#cb712-6" aria-hidden="true" tabindex="-1"></a><span class="co"># it in a list:</span></span>
<span id="cb712-7"><a href="modchapter.html#cb712-7" aria-hidden="true" tabindex="-1"></a>qqplots <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">ggplot</span>(May, <span class="fu">aes</span>(<span class="at">sample =</span> Solar.R)) <span class="sc">+</span></span>
<span id="cb712-8"><a href="modchapter.html#cb712-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span> <span class="fu">geom_qq_line</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Actual data&quot;</span>))</span>
<span id="cb712-9"><a href="modchapter.html#cb712-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-10"><a href="modchapter.html#cb712-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the sample size n: </span></span>
<span id="cb712-11"><a href="modchapter.html#cb712-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(May<span class="sc">$</span>Temp))</span>
<span id="cb712-12"><a href="modchapter.html#cb712-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-13"><a href="modchapter.html#cb712-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 8 new datasets of size n from a normal distribution.</span></span>
<span id="cb712-14"><a href="modchapter.html#cb712-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Then draw Q-Q-plots for these and store them in the list:</span></span>
<span id="cb712-15"><a href="modchapter.html#cb712-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb712-16"><a href="modchapter.html#cb712-16" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb712-17"><a href="modchapter.html#cb712-17" aria-hidden="true" tabindex="-1"></a>    generated_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">normal_data =</span> <span class="fu">rnorm</span>(n, <span class="dv">10</span>, <span class="dv">1</span>))</span>
<span id="cb712-18"><a href="modchapter.html#cb712-18" aria-hidden="true" tabindex="-1"></a>    qqplots[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(generated_data, <span class="fu">aes</span>(<span class="at">sample =</span> normal_data)) <span class="sc">+</span></span>
<span id="cb712-19"><a href="modchapter.html#cb712-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_qq</span>() <span class="sc">+</span> <span class="fu">geom_qq_line</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Simulated data&quot;</span>)</span>
<span id="cb712-20"><a href="modchapter.html#cb712-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb712-21"><a href="modchapter.html#cb712-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-22"><a href="modchapter.html#cb712-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resulting Q-Q-plots side-by-side:</span></span>
<span id="cb712-23"><a href="modchapter.html#cb712-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb712-24"><a href="modchapter.html#cb712-24" aria-hidden="true" tabindex="-1"></a>(qqplots[[<span class="dv">1</span>]] <span class="sc">+</span> qqplots[[<span class="dv">2</span>]] <span class="sc">+</span> qqplots[[<span class="dv">3</span>]]) <span class="sc">/</span></span>
<span id="cb712-25"><a href="modchapter.html#cb712-25" aria-hidden="true" tabindex="-1"></a>  (qqplots[[<span class="dv">4</span>]] <span class="sc">+</span> qqplots[[<span class="dv">5</span>]] <span class="sc">+</span> qqplots[[<span class="dv">6</span>]]) <span class="sc">/</span></span>
<span id="cb712-26"><a href="modchapter.html#cb712-26" aria-hidden="true" tabindex="-1"></a>  (qqplots[[<span class="dv">7</span>]] <span class="sc">+</span> qqplots[[<span class="dv">8</span>]] <span class="sc">+</span> qqplots[[<span class="dv">9</span>]])</span></code></pre></div>
<p>You can run the code several times, to get more examples of what Q-Q-plots can look like when the distributional assumption holds. In this case, the tail points in the Q-Q-plot for the solar radiation data deviate from the line more than the tail points in most simulated examples do, and personally, I’d be reluctant to assume that the data comes from a normal distribution.</p>
<p><span class="math display">\[\sim\]</span>
::: {.exercise #ch7exc3}
Investigate the sleeping times in the <code>msleep</code> data from the <code>ggplot2</code> package. Do they appear to follow a normal distribution? A lognormal distribution?</p>
<p>:::
<a href="solutions.html#ch7solutions3">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch7exc4" class="exercise"><strong>Exercise 7.3  </strong></span>Another approach to assessing distributional assumptions for real data is to use formal hypothesis tests. One example is the Shapiro-Wilk test for normality, available in <code>shapiro.test</code>. The null hypothesis is that the data comes from a normal distribution, and the alternative is that it doesn’t (meaning that a low p-value is supposed to imply non-normality).</p>
<ol style="list-style-type: decimal">
<li><p>Apply <code>shapiro.test</code> to the sleeping times in the <code>msleep</code> dataset. According to the Shapiro-Wilk test, is the data normally distributed?</p></li>
<li><p>Generate 2,000 observations from a <span class="math inline">\(\chi^2(100)\)</span> distribution. Compare the histogram of the generated data to the density function of a normal distribution. Are they similar? What are the results when you apply the Shapiro-Wilk test to the data?</p></li>
</ol>
</div>
<p><a href="solutions.html#ch7solutions4">(Click here to go to the solution.)</a></p>
</div>
<div id="monte-carlo-integration" class="section level3 hasAnchor" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> Monte Carlo integration<a href="modchapter.html#monte-carlo-integration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this chapter, we will use simulation to compute p-values and confidence intervals, to compare different statistical methods, and to perform sample size computations. Another important use of simulation is in <em>Monte Carlo integration</em>, in which random numbers are used for numerical integration. It plays an important role in for instance statistical physics, computational biology, computational linguistics, and Bayesian statistics; fields that require the computation of complicated integrals.</p>
<p>To create an example of Monte Carlo integration, let’s start by writing a function, <code>circle</code>, that defines a quarter-circle on the unit square. We will then plot it using the geom <code>geom_function</code>:</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="modchapter.html#cb713-1" aria-hidden="true" tabindex="-1"></a>circle <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb713-2"><a href="modchapter.html#cb713-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb713-3"><a href="modchapter.html#cb713-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb713-4"><a href="modchapter.html#cb713-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb713-5"><a href="modchapter.html#cb713-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb713-6"><a href="modchapter.html#cb713-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb713-7"><a href="modchapter.html#cb713-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_function</span>(<span class="at">fun =</span> circle)</span></code></pre></div>
<p>Let’s say that we are interest in computing the area under quarter-circle. We can highlight the area in our plot using <code>geom_area</code>:</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="modchapter.html#cb714-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">1e-4</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb714-2"><a href="modchapter.html#cb714-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb714-3"><a href="modchapter.html#cb714-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="fu">ifelse</span>(x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">circle</span>(x)<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span>, <span class="fu">circle</span>(x), <span class="dv">0</span>)),</span>
<span id="cb714-4"><a href="modchapter.html#cb714-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb714-5"><a href="modchapter.html#cb714-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_function</span>(<span class="at">fun =</span> circle)</span></code></pre></div>
<p>To find the area, we will generate a large number of random points uniformly in the unit square. By the law of large numbers, the proportion of points that end up under the quarter-circle should be close to the area under the quarter-circle<a href="#fn48" class="footnote-ref" id="fnref48"><sup>48</sup></a>. To do this, we generate 10,000 random values for the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> coordinates of each point using the <span class="math inline">\(U(0,1)\)</span> distribution, that is, using <code>runif</code>:</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="modchapter.html#cb715-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb715-2"><a href="modchapter.html#cb715-2" aria-hidden="true" tabindex="-1"></a>unif_points <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">runif</span>(B), <span class="at">y =</span> <span class="fu">runif</span>(B))</span></code></pre></div>
<p>Next, we add the points to our plot:</p>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="modchapter.html#cb716-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(unif_points, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb716-2"><a href="modchapter.html#cb716-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb716-3"><a href="modchapter.html#cb716-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="fu">ifelse</span>(x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">circle</span>(x)<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span>, <span class="fu">circle</span>(x), <span class="dv">0</span>)),</span>
<span id="cb716-4"><a href="modchapter.html#cb716-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">+</span></span>
<span id="cb716-5"><a href="modchapter.html#cb716-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>,</span>
<span id="cb716-6"><a href="modchapter.html#cb716-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour =</span> <span class="fu">ifelse</span>(unif_points<span class="sc">$</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> unif_points<span class="sc">$</span>y<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span>,</span>
<span id="cb716-7"><a href="modchapter.html#cb716-7" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb716-8"><a href="modchapter.html#cb716-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_function</span>(<span class="at">fun =</span> circle)</span></code></pre></div>
<p>Note the order in which we placed the geoms - we plot the points after the area so that the pink colour won’t cover the points, and the function after the points so that the points won’t cover the curve.</p>
<p>To estimate the area, we compute the proportion of points that are below the curve:</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="modchapter.html#cb717-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(unif_points<span class="sc">$</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> unif_points<span class="sc">$</span>y<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span>)</span></code></pre></div>
<p>In this case, we can also compute the area exactly: <span class="math inline">\(\int_0^1\sqrt{1-x^2}dx=\pi/4=0.7853\ldots\)</span>. For more complicated integrals, however, numerical integration methods like Monte Carlo integration may be required. That being said, there are better numerical integration methods for low-dimensional integrals like this one. Monte Carlo integration is primarily used for higher-dimensional integrals, where other techniques fail.</p>
</div>
</div>
<div id="ttest" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Student’s t-test revisited<a href="modchapter.html#ttest" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For decades teachers all over the world have been telling the story of William Sealy Gosset: the head brewer at Guinness who derived the formulas used for the t-test and, following company policy, published the results under the pseudonym “Student”.</p>
<p>Gosset’s work was hugely important, but the passing of time has rendered at least parts of it largely obsolete. His distributional formulas were derived out of necessity: lacking the computer power that we have available to us today, he was forced to impose the assumption of normality on the data, in order to derive the formulas he needed to be able to carry out his analyses. Today we can use simulation to carry out analyses with fewer assumptions. As an added bonus, these simulation techniques often happen to result in statistical methods with better performance than Student’s t-test and other similar methods.</p>
<div id="oldschoolt" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> The old-school t-test<a href="modchapter.html#oldschoolt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <em>really</em> old-school way of performing a t-test - the way statistical pioneers like Gosset and Fisher would have done it - is to look up p-values using tables covering several pages. There haven’t really been any excuses for doing that since the advent of the personal computer though, so let’s not go further into that. The “modern” version of the old-school t-test uses numerical evaluation of the formulas for Student’s t-distribution to compute p-values and confidence intervals. Before we delve into more modern approaches, let’s look at how we can run an old-school t-test in R.</p>
<p>In Section <a href="datachapter.html#firstttest">3.6</a> we used <code>t.test</code> to run a t-test to see if there is a difference in how long carnivores and herbivores sleep, using the <code>msleep</code> data from <code>ggplot2</code><a href="#fn49" class="footnote-ref" id="fnref49"><sup>49</sup></a>. First, we subtracted a subset of the data corresponding to carnivores and herbivores, and then we ran the test. There are in fact several different ways of doing this, and it is probably a good idea to have a look at them.</p>
<p>In the approach used in Section <a href="datachapter.html#firstttest">3.6</a> we created two vectors, using bracket notation, and then used those as arguments for <code>t.test</code>:</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="modchapter.html#cb718-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb718-2"><a href="modchapter.html#cb718-2" aria-hidden="true" tabindex="-1"></a>carnivores <span class="ot">&lt;-</span> msleep[msleep<span class="sc">$</span>vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span>,]</span>
<span id="cb718-3"><a href="modchapter.html#cb718-3" aria-hidden="true" tabindex="-1"></a>herbivores <span class="ot">&lt;-</span> msleep[msleep<span class="sc">$</span>vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>,]</span>
<span id="cb718-4"><a href="modchapter.html#cb718-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(carnivores<span class="sc">$</span>sleep_total, herbivores<span class="sc">$</span>sleep_total)</span></code></pre></div>
<p>Alternatively, we could have used formula notation, as we e.g. did for the linear model in Section <a href="datachapter.html#firstlm">3.7</a>. We’d then have to use the <code>data</code> argument in <code>t.test</code> to supply the data. By using <code>subset</code>, we can do the subsetting simultaneously:</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="modchapter.html#cb719-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sleep_total <span class="sc">~</span> vore, <span class="at">data =</span> </span>
<span id="cb719-2"><a href="modchapter.html#cb719-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">subset</span>(msleep, vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span> <span class="sc">|</span> vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>))</span></code></pre></div>
<p>Unless we are interested in keeping the vectors <code>carnivores</code> and <code>herbivores</code> for other purposes, this latter approach is arguably more elegant.</p>
<p>Speaking of elegance, the <code>data</code> argument also makes it easy to run a t-test using pipes. Here is an example, where we use <code>filter</code> from <code>dplyr</code> to do the subsetting:</p>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="modchapter.html#cb720-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb720-2"><a href="modchapter.html#cb720-2" aria-hidden="true" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span> <span class="fu">filter</span>(vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span> <span class="sc">|</span> vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb720-3"><a href="modchapter.html#cb720-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">t.test</span>(sleep_total <span class="sc">~</span> vore, <span class="at">data =</span> .)</span></code></pre></div>
<p>We could also use the <code>magrittr</code> pipe <code>%$%</code> from Section <a href="progchapter.html#morepipes">6.2</a> to pass the variables from the filtered subset of <code>msleep</code>, avoiding the <code>data</code> argument:</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="modchapter.html#cb721-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb721-2"><a href="modchapter.html#cb721-2" aria-hidden="true" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span> <span class="fu">filter</span>(vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span> <span class="sc">|</span> vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>) <span class="sc">%$%</span> </span>
<span id="cb721-3"><a href="modchapter.html#cb721-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">t.test</span>(sleep_total <span class="sc">~</span> vore)</span></code></pre></div>
<p>There are even more options than this - the point that I’m trying to make here is that like most functions in R, you can use functions for classical statistics in many different ways. In what follows, I will show you one or two of these, but don’t hesitate to try out other approaches if they seem better to you.</p>
<p>What we just did above was a two-sided t-test, where the null hypothesis was that there was no difference in means between the groups, and the alternative hypothesis that there was a difference. We can also perform one-sided tests using the <code>alternative</code> argument. <code>alternative = "greater"</code> means that the alternative is that the first group has a greater mean, and <code>alternative = "less"</code> means that the first group has a smaller mean. Here is an example with the former:</p>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="modchapter.html#cb722-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sleep_total <span class="sc">~</span> vore,</span>
<span id="cb722-2"><a href="modchapter.html#cb722-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> <span class="fu">subset</span>(msleep, vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span> <span class="sc">|</span> vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>),</span>
<span id="cb722-3"><a href="modchapter.html#cb722-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<p>By default, R uses the Welch two-sample t-test, meaning that it is <em>not</em> assumed that the groups have equal variances. If you don’t want to make that assumption, you can add <code>var.equal = TRUE</code>:</p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="modchapter.html#cb723-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sleep_total <span class="sc">~</span> vore,</span>
<span id="cb723-2"><a href="modchapter.html#cb723-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> <span class="fu">subset</span>(msleep, vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span> <span class="sc">|</span> vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>),</span>
<span id="cb723-3"><a href="modchapter.html#cb723-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>In addition to two-sample t-tests, <code>t.test</code> can also be used for one-sample tests and paired t-tests. To perform a one-sample t-test, all we need to do is to supply a single vector with observations, along with the value of the mean <span class="math inline">\(\mu\)</span> under the null hypothesis. I usually sleep for about 7 hours each night, and so if I want to test whether that is true for an average mammal, I’d use the following:</p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="modchapter.html#cb724-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(msleep<span class="sc">$</span>sleep_total, <span class="at">mu =</span> <span class="dv">7</span>)</span></code></pre></div>
<p>As we can see from the output, your average mammal sleeps for 10.4 hours per day. Moreover, the p-value is quite low - apparently, I sleep unusually little for a mammal!</p>
<p>As for paired t-tests, we can perform them by supplying two vectors (where element 1 of the first vector corresponds to element 1 of the second vector, and so on) and the argument <code>paired = TRUE</code>. For instance, using the <code>diamonds</code> data from <code>ggplot2</code>, we could run a test to see if the length <code>x</code> of diamonds with a fair quality of the cut on average equals the width <code>y</code>:</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="modchapter.html#cb725-1" aria-hidden="true" tabindex="-1"></a>fair_diamonds <span class="ot">&lt;-</span> <span class="fu">subset</span>(diamonds, cut <span class="sc">==</span> <span class="st">&quot;Fair&quot;</span>)</span>
<span id="cb725-2"><a href="modchapter.html#cb725-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(fair_diamonds<span class="sc">$</span>x, fair_diamonds<span class="sc">$</span>y, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch7exc5" class="exercise"><strong>Exercise 7.4  </strong></span>Load the VAS pain data <code>vas.csv</code> from Exercise <a href="datachapter.html#exr:ch3exc4">3.8</a>. Perform a one-sided t-test to see test the null hypothesis that the average VAS among the patients during the time period is less than or equal to 6.</p>
</div>
<p><a href="solutions.html#ch7solutions5">(Click here to go to the solution.)</a></p>
</div>
<div id="permutation-tests" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Permutation tests<a href="modchapter.html#permutation-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Maybe it was a little harsh to say that Gosset’s formulas have become obsolete. The formulas are mathematical approximations to the distribution of the test statistics under the null hypothesis. The truth is that they work very well as long as your data is (nearly) normally distributed. The two-sample test also works well for non-normal data as long as you have balanced sample sizes, that is, equally many observations in both groups. However, for one-sample tests, and two-sample tests with imbalanced sample sizes, there are better ways to compute p-values and confidence intervals than to use Gosset’s traditional formulas.</p>
<p>The first option that we’ll look at is permutation tests. Let’s return to our mammal sleeping times example, where we wanted to investigate whether there are differences in how long carnivores and herbivores sleep on average:</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="modchapter.html#cb726-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sleep_total <span class="sc">~</span> vore, <span class="at">data =</span> </span>
<span id="cb726-2"><a href="modchapter.html#cb726-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">subset</span>(msleep, vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span> <span class="sc">|</span> vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>))</span></code></pre></div>
<p>There are 19 carnivores and 32 herbivores - 51 animals in total. If there are no differences between the two groups, the <code>vore</code> labels offer no information about how long the animals sleep each day. Under the null hypothesis, the assignment of <code>vore</code> labels to different animals is therefore for all intents and purposes random. To find the distribution of the test statistic under the null hypothesis, we could look at all possible ways to assign 19 animals the label <code>carnivore</code> and 32 animals the label <code>herbivore</code>. That is, look at all permutations of the labels. The probability of a result at least as extreme as that obtained in our sample (in the direction of the alternative), i.e. the p-value, would then be the proportion of permutations that yield a result at least extreme as that in our sample. This is known as a permutation test.</p>
<p>Permutation tests were known to the likes of Gosset and Fisher (Fisher’s exact test is a common example), but because the number of permutations of labels often tend to become quite large (76,000 billion, in our carnivore-herbivore example), they lacked the means actually to use them. 76,000 billion permutations may be too many even today, but we can obtain very good approximations of the p-values of permutation tests using simulation.</p>
<p>The idea is that we look at a large number of randomly selected permutations, and check for how many of them we obtain a test statistic that is more extreme than the sample test statistic. The law of large number guarantees that this proportion will converge to the permutation test p-value as the number of randomly selected permutations increases.</p>
<p>Let’s have a go!</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="modchapter.html#cb727-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the data, to get carnivores and herbivores:</span></span>
<span id="cb727-2"><a href="modchapter.html#cb727-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">subset</span>(msleep, vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span> <span class="sc">|</span> vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>)</span>
<span id="cb727-3"><a href="modchapter.html#cb727-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-4"><a href="modchapter.html#cb727-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the sample test statistic:</span></span>
<span id="cb727-5"><a href="modchapter.html#cb727-5" aria-hidden="true" tabindex="-1"></a>sample_t <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sleep_total <span class="sc">~</span> vore, <span class="at">data =</span> data)<span class="sc">$</span>statistic</span>
<span id="cb727-6"><a href="modchapter.html#cb727-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-7"><a href="modchapter.html#cb727-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of random permutations and create a vector to</span></span>
<span id="cb727-8"><a href="modchapter.html#cb727-8" aria-hidden="true" tabindex="-1"></a><span class="co"># store the result in:</span></span>
<span id="cb727-9"><a href="modchapter.html#cb727-9" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">9999</span></span>
<span id="cb727-10"><a href="modchapter.html#cb727-10" aria-hidden="true" tabindex="-1"></a>permutation_t <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, B)</span>
<span id="cb727-11"><a href="modchapter.html#cb727-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-12"><a href="modchapter.html#cb727-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Start progress bar:</span></span>
<span id="cb727-13"><a href="modchapter.html#cb727-13" aria-hidden="true" tabindex="-1"></a>pbar <span class="ot">&lt;-</span> <span class="fu">txtProgressBar</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> B, <span class="at">style =</span> <span class="dv">3</span>)</span>
<span id="cb727-14"><a href="modchapter.html#cb727-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-15"><a href="modchapter.html#cb727-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the test statistic for B randomly selected permutations</span></span>
<span id="cb727-16"><a href="modchapter.html#cb727-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B)</span>
<span id="cb727-17"><a href="modchapter.html#cb727-17" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb727-18"><a href="modchapter.html#cb727-18" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Draw a permutation of the labels:</span></span>
<span id="cb727-19"><a href="modchapter.html#cb727-19" aria-hidden="true" tabindex="-1"></a>      data<span class="sc">$</span>vore <span class="ot">&lt;-</span> <span class="fu">sample</span>(data<span class="sc">$</span>vore, <span class="fu">length</span>(data<span class="sc">$</span>vore),</span>
<span id="cb727-20"><a href="modchapter.html#cb727-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb727-21"><a href="modchapter.html#cb727-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb727-22"><a href="modchapter.html#cb727-22" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Compute statistic for permuted sample:</span></span>
<span id="cb727-23"><a href="modchapter.html#cb727-23" aria-hidden="true" tabindex="-1"></a>      permutation_t[i] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sleep_total <span class="sc">~</span> vore,</span>
<span id="cb727-24"><a href="modchapter.html#cb727-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> data)<span class="sc">$</span>statistic</span>
<span id="cb727-25"><a href="modchapter.html#cb727-25" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb727-26"><a href="modchapter.html#cb727-26" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Update progress bar</span></span>
<span id="cb727-27"><a href="modchapter.html#cb727-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setTxtProgressBar</span>(pbar, i)</span>
<span id="cb727-28"><a href="modchapter.html#cb727-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb727-29"><a href="modchapter.html#cb727-29" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(pbar)</span>
<span id="cb727-30"><a href="modchapter.html#cb727-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-31"><a href="modchapter.html#cb727-31" aria-hidden="true" tabindex="-1"></a><span class="co"># In this case, with a two-sided alternative hypothesis, a</span></span>
<span id="cb727-32"><a href="modchapter.html#cb727-32" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;more extreme&quot; test statistic is one that has a larger</span></span>
<span id="cb727-33"><a href="modchapter.html#cb727-33" aria-hidden="true" tabindex="-1"></a><span class="co"># absolute value than the sample test statistic.</span></span>
<span id="cb727-34"><a href="modchapter.html#cb727-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-35"><a href="modchapter.html#cb727-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute approximate permutation test p-value:</span></span>
<span id="cb727-36"><a href="modchapter.html#cb727-36" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(permutation_t) <span class="sc">&gt;</span> <span class="fu">abs</span>(sample_t))</span></code></pre></div>
<p>In this particular example, the resulting p-value is pretty close to that from the old-school t-test. However, we will soon see examples where the two versions of the t-test differ more.</p>
<p>You may ask why we used 9,999 permutations and not 10,000. The reason is that we avoid p-values that are equal to traditional significance levels like 0.05 and 0.01 this way. If we’d used 10,000 permutations, 500 of which yielded a statistics that had a larger absolute value than the sample statistic, then the p-value would have been exactly 0.05, which would cause some difficulties in trying to determine whether or not the result was significant at the 5 % level. This cannot happen when we use 9,999 permutations instead (500 statistics with a large absolute value yields the p-value <span class="math inline">\(0.050005&gt;0.05\)</span>, and 499 yields the p-value <span class="math inline">\(0.0499&lt;0.05\)</span>).</p>
<p>Having to write a <code>for</code> loop every time we want to run a t-test seems unnecessarily complicated. Fortunately, others have tread this path before us. The <code>MKinfer</code> package contains a function to perform (approximate) permutation t-tests, which also happens to be faster than our implementation above. Let’s install it:</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="modchapter.html#cb728-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;MKinfer&quot;</span>)</span></code></pre></div>
<p>The function for the permutation t-test, <code>perm.t.test</code>, works exactly like <code>t.test</code>. In all the examples from Section <a href="modchapter.html#oldschoolt">7.2.1</a> we can replace <code>t.test</code> with <code>perm.t.test</code> to run a permutation t-test instead. Like so:</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="modchapter.html#cb729-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKinfer)</span>
<span id="cb729-2"><a href="modchapter.html#cb729-2" aria-hidden="true" tabindex="-1"></a><span class="fu">perm.t.test</span>(sleep_total <span class="sc">~</span> vore, <span class="at">data =</span> </span>
<span id="cb729-3"><a href="modchapter.html#cb729-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">subset</span>(msleep, vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span> <span class="sc">|</span> vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>))</span></code></pre></div>
<p>Note that two p-values and confidence intervals are presented: one set from the permutations and one from the old-school approach - so make sure that you look at the right ones!</p>
<p>You may ask how many randomly selected permutations we need to get an accurate approximation of the permutation test p-value. By default, <code>perm.t.test</code> uses 9,999 permutations (you can change that number using the argument <code>R</code>), which is widely considered to be a reasonable number. If you are running a permutation test with a much more complex (and computationally intensive) statistic, you may have to use a lower number, but avoid that if you can.</p>
</div>
<div id="the-bootstrap" class="section level3 hasAnchor" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> The bootstrap<a href="modchapter.html#the-bootstrap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A popular method for computing p-values and confidence intervals that resembles the permutation approach is the bootstrap. Instead of drawing permuted samples, new observations are drawn with replacement from the original sample, and then labels are randomly allocated to them. That means that each randomly drawn sample will differ not only in the permutation of labels, but also in what observations are included - some may appear more than once and some not at all.</p>
<p>We will have a closer look at the bootstrap in Section <a href="modchapter.html#bootstrap">7.7</a>, where we will learn how to use it for creating confidence intervals and computing p-values for any test statistic. For now, we’ll just note that <code>MKinfer</code> offers a bootstrap version of the t-test, <code>boot.t.test</code> :</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="modchapter.html#cb730-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKinfer)</span>
<span id="cb730-2"><a href="modchapter.html#cb730-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.t.test</span>(sleep_total <span class="sc">~</span> vore, <span class="at">data =</span> </span>
<span id="cb730-3"><a href="modchapter.html#cb730-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">subset</span>(msleep, vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span> <span class="sc">|</span> vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>))</span></code></pre></div>
<p>Both <code>perm.test</code> and <code>boot.test</code> have a useful argument called <code>symmetric</code>, the details of which are discussed in depth in Section <a href="mathschap.html#twotypesofpvalues">12.3</a>.</p>
</div>
<div id="saving-the-output" class="section level3 hasAnchor" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Saving the output<a href="modchapter.html#saving-the-output" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we run a t-test, the results are printed in the Console. But we can also store the results in a variable, which allows us to access e.g. the p-value of the test:</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="modchapter.html#cb731-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb731-2"><a href="modchapter.html#cb731-2" aria-hidden="true" tabindex="-1"></a>carnivores <span class="ot">&lt;-</span> msleep[msleep<span class="sc">$</span>vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span>,]</span>
<span id="cb731-3"><a href="modchapter.html#cb731-3" aria-hidden="true" tabindex="-1"></a>herbivores <span class="ot">&lt;-</span> msleep[msleep<span class="sc">$</span>vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>,]</span>
<span id="cb731-4"><a href="modchapter.html#cb731-4" aria-hidden="true" tabindex="-1"></a>test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sleep_total <span class="sc">~</span> vore, <span class="at">data =</span> </span>
<span id="cb731-5"><a href="modchapter.html#cb731-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">subset</span>(msleep, vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span> <span class="sc">|</span> vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>))</span>
<span id="cb731-6"><a href="modchapter.html#cb731-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-7"><a href="modchapter.html#cb731-7" aria-hidden="true" tabindex="-1"></a>test_result</span></code></pre></div>
<p>What does the resulting object look like?</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="modchapter.html#cb732-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(test_result)</span></code></pre></div>
<p>As you can see, <code>test_result</code> is a <code>list</code> containing different parameters and vectors for the test. To get the p-value, we can run the following:</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="modchapter.html#cb733-1" aria-hidden="true" tabindex="-1"></a>test_result<span class="sc">$</span>p.value</span></code></pre></div>
</div>
<div id="multipletesting" class="section level3 hasAnchor" number="7.2.5">
<h3><span class="header-section-number">7.2.5</span> Multiple testing<a href="modchapter.html#multipletesting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Some programming tools from Section <a href="progchapter.html#loopsection">6.4</a> can be of use if we wish to perform multiple t-tests. For example, maybe we want to make pairwise comparisons of the sleeping times of all the different feeding behaviours in <code>msleep</code>: carnivores, herbivores, insectivores and omnivores. To find all possible pairs, we can use a nested <code>for</code> loop (Section <a href="progchapter.html#nestedloops">6.4.2</a>). Note how the indices <code>i</code> and <code>j</code> that we loop over are set so that we only run the test for each combination once:</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="modchapter.html#cb734-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKinfer)</span>
<span id="cb734-2"><a href="modchapter.html#cb734-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb734-3"><a href="modchapter.html#cb734-3" aria-hidden="true" tabindex="-1"></a><span class="co"># List the different feeding behaviours (ignoring NA&#39;s):</span></span>
<span id="cb734-4"><a href="modchapter.html#cb734-4" aria-hidden="true" tabindex="-1"></a>vores <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">unique</span>(msleep<span class="sc">$</span>vore))</span>
<span id="cb734-5"><a href="modchapter.html#cb734-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">length</span>(vores)</span>
<span id="cb734-6"><a href="modchapter.html#cb734-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb734-7"><a href="modchapter.html#cb734-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the number of pairs, and create an appropriately</span></span>
<span id="cb734-8"><a href="modchapter.html#cb734-8" aria-hidden="true" tabindex="-1"></a><span class="co"># sized data frame to store the p-values in:</span></span>
<span id="cb734-9"><a href="modchapter.html#cb734-9" aria-hidden="true" tabindex="-1"></a>n_comb <span class="ot">&lt;-</span> <span class="fu">choose</span>(B, <span class="dv">2</span>)</span>
<span id="cb734-10"><a href="modchapter.html#cb734-10" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group1 =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>, n_comb),</span>
<span id="cb734-11"><a href="modchapter.html#cb734-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group2 =</span> <span class="fu">vector</span>(<span class="st">&quot;character&quot;</span>, n_comb),</span>
<span id="cb734-12"><a href="modchapter.html#cb734-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">p =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, n_comb))</span>
<span id="cb734-13"><a href="modchapter.html#cb734-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb734-14"><a href="modchapter.html#cb734-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over all pairs:</span></span>
<span id="cb734-15"><a href="modchapter.html#cb734-15" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># Counter variable</span></span>
<span id="cb734-16"><a href="modchapter.html#cb734-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(B<span class="dv">-1</span>))</span>
<span id="cb734-17"><a href="modchapter.html#cb734-17" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb734-18"><a href="modchapter.html#cb734-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>B)</span>
<span id="cb734-19"><a href="modchapter.html#cb734-19" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb734-20"><a href="modchapter.html#cb734-20" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Run a t-test for the current pair:</span></span>
<span id="cb734-21"><a href="modchapter.html#cb734-21" aria-hidden="true" tabindex="-1"></a>            test_res <span class="ot">&lt;-</span> <span class="fu">perm.t.test</span>(sleep_total <span class="sc">~</span> vore, </span>
<span id="cb734-22"><a href="modchapter.html#cb734-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> <span class="fu">subset</span>(msleep,</span>
<span id="cb734-23"><a href="modchapter.html#cb734-23" aria-hidden="true" tabindex="-1"></a>                                 vore <span class="sc">==</span> vores[i] <span class="sc">|</span> vore <span class="sc">==</span> vores[j]))</span>
<span id="cb734-24"><a href="modchapter.html#cb734-24" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Store the p-value:</span></span>
<span id="cb734-25"><a href="modchapter.html#cb734-25" aria-hidden="true" tabindex="-1"></a>            p_values[k, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(vores[i], vores[j], test_res<span class="sc">$</span>p.value)</span>
<span id="cb734-26"><a href="modchapter.html#cb734-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Increase the counter variable:</span></span>
<span id="cb734-27"><a href="modchapter.html#cb734-27" aria-hidden="true" tabindex="-1"></a>            k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb734-28"><a href="modchapter.html#cb734-28" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb734-29"><a href="modchapter.html#cb734-29" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>To view the p-values for each pairwise test, we can now run:</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="modchapter.html#cb735-1" aria-hidden="true" tabindex="-1"></a>p_values</span></code></pre></div>
<p>When we run multiple tests, the risk for a type I error increases, to the point where we’re virtually guaranteed to get a significant result. We can reduce the risk of false positive results and adjust the p-values for multiplicity using for instance Bonferroni correction, Holm’s method (an improved version of the standard Bonferroni approach), or the Benjamini-Hochberg approach (which controls the <em>false discovery rate</em> and is useful if you for instance are screening a lot of variables for differences), using <code>p.adjust</code>:</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="modchapter.html#cb736-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(p_values<span class="sc">$</span>p, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb736-2"><a href="modchapter.html#cb736-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(p_values<span class="sc">$</span>p, <span class="at">method =</span> <span class="st">&quot;holm&quot;</span>)</span>
<span id="cb736-3"><a href="modchapter.html#cb736-3" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(p_values<span class="sc">$</span>p, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span></code></pre></div>
</div>
<div id="hotellingst2" class="section level3 hasAnchor" number="7.2.6">
<h3><span class="header-section-number">7.2.6</span> Multivariate testing with Hotelling’s <span class="math inline">\(T^2\)</span><a href="modchapter.html#hotellingst2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you are interested in comparing the means of several variables for two groups, using a multivariate test is sometimes a better option than running multiple univariate t-tests. The multivariate generalisation of the t-test, Hotelling’s <span class="math inline">\(T^2\)</span>, is available through the <code>Hotelling</code> package:</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="modchapter.html#cb737-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;Hotelling&quot;</span>)</span></code></pre></div>
<p>As an example, consider the <code>airquality</code> data. Let’s say that we want to test whether the mean ozone, solar radiation, wind speed, and temperature differ between June and July. We could use four separate t-tests to test this, but we could also use Hotelling’s <span class="math inline">\(T^2\)</span> to test the null hypothesis that the mean vector, i.e. the vector containing the four means, is the same for both months. The function used for this is <code>hotelling.test</code>:</p>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="modchapter.html#cb738-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the data:</span></span>
<span id="cb738-2"><a href="modchapter.html#cb738-2" aria-hidden="true" tabindex="-1"></a>airquality_t2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(airquality, Month <span class="sc">==</span> <span class="dv">6</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">7</span>)</span>
<span id="cb738-3"><a href="modchapter.html#cb738-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-4"><a href="modchapter.html#cb738-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the test under the assumption of normality:</span></span>
<span id="cb738-5"><a href="modchapter.html#cb738-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hotelling)</span>
<span id="cb738-6"><a href="modchapter.html#cb738-6" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">hotelling.test</span>(Ozone <span class="sc">+</span> Solar.R <span class="sc">+</span> Wind <span class="sc">+</span> Temp <span class="sc">~</span> Month,</span>
<span id="cb738-7"><a href="modchapter.html#cb738-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> airquality_t2)</span>
<span id="cb738-8"><a href="modchapter.html#cb738-8" aria-hidden="true" tabindex="-1"></a>t2</span>
<span id="cb738-9"><a href="modchapter.html#cb738-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-10"><a href="modchapter.html#cb738-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Run a permutation test instead:</span></span>
<span id="cb738-11"><a href="modchapter.html#cb738-11" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">hotelling.test</span>(Ozone <span class="sc">+</span> Solar.R <span class="sc">+</span> Wind <span class="sc">+</span> Temp <span class="sc">~</span> Month,</span>
<span id="cb738-12"><a href="modchapter.html#cb738-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> airquality_t2, <span class="at">perm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb738-13"><a href="modchapter.html#cb738-13" aria-hidden="true" tabindex="-1"></a>t2</span></code></pre></div>
</div>
<div id="sample-size-computations-for-the-t-test" class="section level3 hasAnchor" number="7.2.7">
<h3><span class="header-section-number">7.2.7</span> Sample size computations for the t-test<a href="modchapter.html#sample-size-computations-for-the-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In any study, it is important to collect enough data for the inference that we wish to make. If we want to use a t-test for a test about a mean or the difference of two means, what constitutes “enough data” is usually measured by the power of the test. The sample is large enough when the test achieves high enough power. If we are comfortable assuming normality (and we may well be, especially as the main goal with sample size computations is to get a ballpark figure), we can use <code>power.t.test</code> to compute what power our test would achieve under different settings. For a two-sample test with unequal variances, we can use <code>power.welch.t.test</code> from <code>MKpower</code> instead. Both functions can be used to either find the sample size required for a certain power, or to find out what power will be obtained from a given sample size.</p>
<p>First of all, let’s install <code>MKpower</code>:</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="modchapter.html#cb739-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;MKpower&quot;</span>)</span></code></pre></div>
<p><code>power.t.test</code> and <code>power.welch.t.test</code> both use <code>delta</code> to denote the mean difference under the alternative hypothesis. In addition, we must supply the standard deviation<code>sd</code> of the distribution. Here are some examples:</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="modchapter.html#cb740-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKpower)</span>
<span id="cb740-2"><a href="modchapter.html#cb740-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb740-3"><a href="modchapter.html#cb740-3" aria-hidden="true" tabindex="-1"></a><span class="co"># A one-sided one-sample test with 80 % power:</span></span>
<span id="cb740-4"><a href="modchapter.html#cb740-4" aria-hidden="true" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">delta =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb740-5"><a href="modchapter.html#cb740-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;one.sample&quot;</span>, <span class="at">alternative =</span> <span class="st">&quot;one.sided&quot;</span>)</span>
<span id="cb740-6"><a href="modchapter.html#cb740-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb740-7"><a href="modchapter.html#cb740-7" aria-hidden="true" tabindex="-1"></a><span class="co"># A two-sided two-sample test with sample size n = 25 and equal</span></span>
<span id="cb740-8"><a href="modchapter.html#cb740-8" aria-hidden="true" tabindex="-1"></a><span class="co"># variances:</span></span>
<span id="cb740-9"><a href="modchapter.html#cb740-9" aria-hidden="true" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">n =</span> <span class="dv">25</span>, <span class="at">delta =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb740-10"><a href="modchapter.html#cb740-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb740-11"><a href="modchapter.html#cb740-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb740-12"><a href="modchapter.html#cb740-12" aria-hidden="true" tabindex="-1"></a><span class="co"># A one-sided two-sample test with 90 % power and equal variances:</span></span>
<span id="cb740-13"><a href="modchapter.html#cb740-13" aria-hidden="true" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">power =</span> <span class="fl">0.9</span>, <span class="at">delta =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.5</span>, <span class="at">sig.level =</span> <span class="fl">0.01</span>,</span>
<span id="cb740-14"><a href="modchapter.html#cb740-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>, <span class="at">alternative =</span> <span class="st">&quot;one.sided&quot;</span>)</span>
<span id="cb740-15"><a href="modchapter.html#cb740-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb740-16"><a href="modchapter.html#cb740-16" aria-hidden="true" tabindex="-1"></a><span class="co"># A one-sided two-sample test with 90 % power and unequal variances:</span></span>
<span id="cb740-17"><a href="modchapter.html#cb740-17" aria-hidden="true" tabindex="-1"></a><span class="fu">power.welch.t.test</span>(<span class="at">power =</span> <span class="fl">0.9</span>, <span class="at">delta =</span> <span class="dv">1</span>, <span class="at">sd1 =</span> <span class="fl">0.5</span>, <span class="at">sd2 =</span> <span class="dv">1</span>,</span>
<span id="cb740-18"><a href="modchapter.html#cb740-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sig.level =</span> <span class="fl">0.01</span>,</span>
<span id="cb740-19"><a href="modchapter.html#cb740-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>, <span class="at">alternative =</span> <span class="st">&quot;one.sided&quot;</span>)</span></code></pre></div>
<p>You may wonder how to choose <code>delta</code> and <code>sd</code>. If possible, it is good to base these numbers on a pilot study or related previous work. If no such data is available, your guess is as good as mine. For <code>delta</code>, some useful terminology comes from medical statistics, where the concept of <em>clinical significance</em> is used increasingly often. Make sure that <code>delta</code> is large enough to be clinically significant, that is, large enough to actually matter in practice.</p>
<p>If we have reason to believe that the data follows a non-normal distribution, another option is to use simulation to compute the sample size that will be required. We’ll do just that in Section <a href="modchapter.html#sscus">7.6</a>.</p>
<div class="exercise">
<p><span id="exr:ch7exc7" class="exercise"><strong>Exercise 7.5  </strong></span>Return to the one-sided t-test that you performed in Exercise <a href="modchapter.html#exr:ch7exc5">7.4</a>. Assume that <code>delta</code> is 0.5 (i.e. that the true mean is 6.5) and that the standard deviation is 2. How large does the sample size <span class="math inline">\(n\)</span> have to be for the power of the test to be 95 % at a 5 % significance level? What is the power of the test when the sample size is <span class="math inline">\(n=2,351\)</span>?</p>
</div>
<p><a href="solutions.html#ch7solutions7">(Click here to go to the solution.)</a></p>
</div>
<div id="a-bayesian-approach" class="section level3 hasAnchor" number="7.2.8">
<h3><span class="header-section-number">7.2.8</span> A Bayesian approach<a href="modchapter.html#a-bayesian-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Bayesian paradigm differs in many ways from the frequentist approach that we use in the rest of this chapter. In Bayesian statistics, we first define a <em>prior distribution</em> for the parameters that we are interested in, representing our beliefs about them (for instance based on previous studies). Bayes’ theorem is then used to derive the <em>posterior distribution</em>, i.e. the distribution of the coefficients given the prior distribution and the data. Philosophically, this is very different from frequentist estimation, in which we don’t incorporate prior beliefs into our models (except for through which variables we include).</p>
<p>In many situations, we don’t have access to data that can be used to create an <em>informative</em> prior distribution. In such cases, we can use a so-called weakly informative prior instead. These act as a sort of “default priors”, representing large uncertainty about the values of the coefficients.</p>
<p>The <code>rstanarm</code> package contains methods for using Bayesian estimation to fit some common statistical models. It takes a while to install, but it is well worth it:</p>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="modchapter.html#cb741-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;rstanarm&quot;</span>)</span></code></pre></div>
<p>To use a Bayesian model with a weakly informative prior to analyse the difference in sleeping time between herbivores and carnivores, we load <code>rstanarm</code> and use <code>stan_glm</code> in complete analogue with how we use <code>t.test</code>:</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="modchapter.html#cb742-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb742-2"><a href="modchapter.html#cb742-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb742-3"><a href="modchapter.html#cb742-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(sleep_total <span class="sc">~</span> vore, <span class="at">data =</span> </span>
<span id="cb742-4"><a href="modchapter.html#cb742-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">subset</span>(msleep, vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span> <span class="sc">|</span> vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>))</span>
<span id="cb742-5"><a href="modchapter.html#cb742-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb742-6"><a href="modchapter.html#cb742-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the estimates:</span></span>
<span id="cb742-7"><a href="modchapter.html#cb742-7" aria-hidden="true" tabindex="-1"></a>m</span></code></pre></div>
<p>There are two estimates here: an “intercept” (the average sleeping time for carnivores) and <code>voreherbi</code> (the difference between carnivores and herbivores). To plot the posterior distribution of the difference, we can use <code>plot</code>:</p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="modchapter.html#cb743-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m, <span class="st">&quot;dens&quot;</span>, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;voreherbi&quot;</span>))</span></code></pre></div>
<p>To get a 95 % credible interval (the Bayesian equivalent of a confidence interval) for the difference, we can use <code>posterior_interval</code> as follows:</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="modchapter.html#cb744-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_interval</span>(m, </span>
<span id="cb744-2"><a href="modchapter.html#cb744-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;voreherbi&quot;</span>),</span>
<span id="cb744-3"><a href="modchapter.html#cb744-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">prob =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<p>p-values are not a part of Bayesian statistics, so don’t expect any. It is however possible to perform a kind of Bayesian test of whether there is a difference by checking whether the credible interval for the difference contains 0. If not, there is evidence that there is a difference (Thulin, 2014c). In this case, 0 is contained in the interval, and there is no evidence of a difference.</p>
<p>In most cases, Bayesian estimation is done using Monte Carlo integration (specifically, a class of methods known as Markov Chain Monte Carlo, MCMC). To check that the model fitting has converged, we can use a measure called <span class="math inline">\(\hat{R}\)</span>. It should be less than 1.1 if the fitting has converged:</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="modchapter.html#cb745-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m, <span class="st">&quot;rhat&quot;</span>)</span></code></pre></div>
<p>If the model fitting hasn’t converged, you may need to increase the number of iterations of the MCMC algorithm. You can increase the number of iterations by adding the argument <code>iter</code> to <code>stan_glm</code> (the default is 2,000).</p>
<p>If you want to use a custom prior for your analysis, that is of course possible too. See <code>?priors</code> and <code>?stan_glm</code> for details about this, and about the default weakly informative prior.</p>
</div>
</div>
<div id="other-common-hypothesis-tests-and-confidence-intervals" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Other common hypothesis tests and confidence intervals<a href="modchapter.html#other-common-hypothesis-tests-and-confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are thousands of statistical tests in addition to the t-test, and equally many methods for computing confidence intervals for different parameters. In this section we will have a look at some useful tools: the nonparametric Wilcoxon-Mann-Whitney test for location, tests for correlation, <span class="math inline">\(\chi^2\)</span>-tests for contingency tables, and confidence intervals for proportions.</p>
<div id="nonparametric-tests-of-location" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Nonparametric tests of location<a href="modchapter.html#nonparametric-tests-of-location" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Wilcoxon-Mann-Whitney test, <code>wilcox.test</code> in R, is a nonparametric alternative to the t-test that is based on ranks. <code>wilcox.test</code> can be used in complete analogue to <code>t.test</code>.</p>
<p>We can use two vectors as input:</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="modchapter.html#cb746-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb746-2"><a href="modchapter.html#cb746-2" aria-hidden="true" tabindex="-1"></a>carnivores <span class="ot">&lt;-</span> msleep[msleep<span class="sc">$</span>vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span>,]</span>
<span id="cb746-3"><a href="modchapter.html#cb746-3" aria-hidden="true" tabindex="-1"></a>herbivores <span class="ot">&lt;-</span> msleep[msleep<span class="sc">$</span>vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>,]</span>
<span id="cb746-4"><a href="modchapter.html#cb746-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(carnivores<span class="sc">$</span>sleep_total, herbivores<span class="sc">$</span>sleep_total)</span></code></pre></div>
<p>Or use a formula:</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="modchapter.html#cb747-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(sleep_total <span class="sc">~</span> vore, <span class="at">data =</span></span>
<span id="cb747-2"><a href="modchapter.html#cb747-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">subset</span>(msleep, vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span> <span class="sc">|</span> vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>))</span></code></pre></div>
</div>
<div id="tests-for-correlation" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Tests for correlation<a href="modchapter.html#tests-for-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To test the null hypothesis that two numerical variables are correlated, we can use <code>cor.test</code>. Let’s try it with sleeping times and brain weight, using the <code>msleep</code> data again:</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="modchapter.html#cb748-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb748-2"><a href="modchapter.html#cb748-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(msleep<span class="sc">$</span>sleep_total, msleep<span class="sc">$</span>brainwt,</span>
<span id="cb748-3"><a href="modchapter.html#cb748-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">use =</span> <span class="st">&quot;pairwise.complete&quot;</span>)</span></code></pre></div>
<p>The setting <code>use = "pairwise.complete"</code> means that <code>NA</code> values are ignored.</p>
<p><code>cor.test</code> doesn’t have a <code>data</code> argument, so if you want to use it in a pipeline I recommend using the <code>%$%</code> pipe (Section <a href="progchapter.html#morepipes">6.2</a>) to pass on the vectors from your data frame:</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="modchapter.html#cb749-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb749-2"><a href="modchapter.html#cb749-2" aria-hidden="true" tabindex="-1"></a>msleep <span class="sc">%$%</span> <span class="fu">cor.test</span>(sleep_total, brainwt, <span class="at">use =</span> <span class="st">&quot;pairwise.complete&quot;</span>)</span></code></pre></div>
<p>The test we just performed uses the Pearson correlation coefficient as its test statistic. If you prefer, you can use the nonparametric Spearman and Kendall correlation coefficients in the test instead, by changing the value of <code>method</code>:</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="modchapter.html#cb750-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Spearman test of correlation:</span></span>
<span id="cb750-2"><a href="modchapter.html#cb750-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(msleep<span class="sc">$</span>sleep_total, msleep<span class="sc">$</span>brainwt,</span>
<span id="cb750-3"><a href="modchapter.html#cb750-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">use =</span> <span class="st">&quot;pairwise.complete&quot;</span>,</span>
<span id="cb750-4"><a href="modchapter.html#cb750-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<p>These tests are all based on asymptotic approximations, which among other things causes the Pearson correlation test perform poorly for non-normal data. In Section <a href="modchapter.html#bootstrap">7.7</a> we will create a bootstrap version of the correlation test, which has better performance.</p>
</div>
<div id="chi2-tests" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> <span class="math inline">\(\chi^2\)</span>-tests<a href="modchapter.html#chi2-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(\chi^2\)</span> (chi-squared) tests are most commonly used to test whether two categorical variables are independent. To use it, we must first construct a contingency table, i.e. a table showing the counts for different combinations of categories, typically using <code>table</code>. Here is an example with the <code>diamonds</code> data from <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="modchapter.html#cb751-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb751-2"><a href="modchapter.html#cb751-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(diamonds<span class="sc">$</span>cut, diamonds<span class="sc">$</span>color)</span></code></pre></div>
<p>The null hypothesis of our test is that the quality of the cut (<code>cut</code>) and the colour of the diamond (<code>color</code>) are independent, with the alternative being that they are dependent. We use <code>chisq.test</code> with the contingency table as input to run the <span class="math inline">\(\chi^2\)</span> test of independence:</p>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="modchapter.html#cb752-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(diamonds<span class="sc">$</span>cut, diamonds<span class="sc">$</span>color))</span></code></pre></div>
<p>By default, <code>chisq.test</code> uses an asymptotic approximation of the p-value. For small sample sizes, it is almost often better to use permutation p-values by setting <code>simulate.p.value = TRUE</code> (but here the sample is not small, and so the computation of the permutation test will take a while):</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="modchapter.html#cb753-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(diamonds<span class="sc">$</span>cut, diamonds<span class="sc">$</span>color),</span>
<span id="cb753-2"><a href="modchapter.html#cb753-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">simulate.p.value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>As with <code>t.test</code>, we can use pipes to perform the test if we like:</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="modchapter.html#cb754-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb754-2"><a href="modchapter.html#cb754-2" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%$%</span> <span class="fu">table</span>(cut, color) <span class="sc">%&gt;%</span> </span>
<span id="cb754-3"><a href="modchapter.html#cb754-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">chisq.test</span>()</span></code></pre></div>
<p>If both of the variables are binary, i.e. only take two values, the power of the test can be approximated using <code>power.prop.test</code>. Let’s say that we have two variables, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, taking the values 0 and 1. Assume that we collect <span class="math inline">\(n\)</span> observations with <span class="math inline">\(X=0\)</span> and <span class="math inline">\(n\)</span> with <span class="math inline">\(X=1\)</span>. Furthermore, let <code>p1</code> be the probability that <span class="math inline">\(Y=1\)</span> if <span class="math inline">\(X=0\)</span> and <code>p2</code> be the probability that <span class="math inline">\(Y=1\)</span> if <span class="math inline">\(X=1\)</span>. We can then use <code>power.prop.test</code> as follows:</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="modchapter.html#cb755-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume that n = 50, p1 = 0.4 and p2 = 0.5 and compute the power:</span></span>
<span id="cb755-2"><a href="modchapter.html#cb755-2" aria-hidden="true" tabindex="-1"></a><span class="fu">power.prop.test</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">p1 =</span> <span class="fl">0.4</span>, <span class="at">p2 =</span> <span class="fl">0.5</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>)</span>
<span id="cb755-3"><a href="modchapter.html#cb755-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb755-4"><a href="modchapter.html#cb755-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume that p1 = 0.4 and p2 = 0.5 and that we want 85 % power.</span></span>
<span id="cb755-5"><a href="modchapter.html#cb755-5" aria-hidden="true" tabindex="-1"></a><span class="co"># To compute the sample size required:</span></span>
<span id="cb755-6"><a href="modchapter.html#cb755-6" aria-hidden="true" tabindex="-1"></a><span class="fu">power.prop.test</span>(<span class="at">power =</span> <span class="fl">0.85</span>, <span class="at">p1 =</span> <span class="fl">0.4</span>, <span class="at">p2 =</span> <span class="fl">0.5</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>)</span></code></pre></div>
</div>
<div id="confprop" class="section level3 hasAnchor" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> Confidence intervals for proportions<a href="modchapter.html#confprop" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The different t-test functions provide confidence intervals for means and differences of means. But what about proportions? The <code>binomCI</code> function in the <code>MKinfer</code> package allows us to compute confidence intervals for proportions from binomial experiments using a number of methods. The input is the number of “successes” <code>x</code>, the sample size <code>n</code>, and the <code>method</code> to be used.</p>
<p>Let’s say that we want to compute a confidence interval for the proportion of herbivore mammals that sleep for more than 7 hours a day.</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="modchapter.html#cb756-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb756-2"><a href="modchapter.html#cb756-2" aria-hidden="true" tabindex="-1"></a>herbivores <span class="ot">&lt;-</span> msleep[msleep<span class="sc">$</span>vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>,]</span>
<span id="cb756-3"><a href="modchapter.html#cb756-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb756-4"><a href="modchapter.html#cb756-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the number of animals for which we know the sleeping time:</span></span>
<span id="cb756-5"><a href="modchapter.html#cb756-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(herbivores<span class="sc">$</span>sleep_total))</span>
<span id="cb756-6"><a href="modchapter.html#cb756-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb756-7"><a href="modchapter.html#cb756-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the number of &quot;successes&quot;, i.e. the number of animals</span></span>
<span id="cb756-8"><a href="modchapter.html#cb756-8" aria-hidden="true" tabindex="-1"></a><span class="co"># that sleep for more than 7 hours:</span></span>
<span id="cb756-9"><a href="modchapter.html#cb756-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sum</span>(herbivores<span class="sc">$</span>sleep_total <span class="sc">&gt;</span> <span class="dv">7</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The estimated proportion is <code>x/n</code>, which in this case is 0.625. We’d like to quantify the uncertainty in this estimate by computing a confidence interval. The standard Wald method, taught in most introductory courses, can be computed using:</p>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="modchapter.html#cb757-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKinfer)</span>
<span id="cb757-2"><a href="modchapter.html#cb757-2" aria-hidden="true" tabindex="-1"></a><span class="fu">binomCI</span>(x, n, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">&quot;wald&quot;</span>)</span></code></pre></div>
<p>Don’t do that though! The Wald interval is known to be severely flawed (Brown et al., 2001), and much better options are available. If the proportion can be expected to be close to 0 or 1, the Clopper-Pearson interval is recommended, and otherwise the Wilson interval is the best choice (Thulin, 2014a):</p>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="modchapter.html#cb758-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binomCI</span>(x, n, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">&quot;clopper-pearson&quot;</span>)</span>
<span id="cb758-2"><a href="modchapter.html#cb758-2" aria-hidden="true" tabindex="-1"></a><span class="fu">binomCI</span>(x, n, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">&quot;wilson&quot;</span>)</span></code></pre></div>
<p>An excellent Bayesian credible interval is the Jeffreys interval, which uses the weakly informative Jeffreys prior:</p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="modchapter.html#cb759-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binomCI</span>(x, n, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">&quot;jeffreys&quot;</span>)</span></code></pre></div>
<p>The <code>ssize.propCI</code> function in <code>MKpower</code> can be used to compute the sample size needed to obtain a confidence interval with a given width<a href="#fn50" class="footnote-ref" id="fnref50"><sup>50</sup></a>. It relies on asymptotic formulas that are highly accurate, as you later on will verify in Exercise <a href="modchapter.html#exr:ch7excCP">7.15</a>.</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="modchapter.html#cb760-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKpower)</span>
<span id="cb760-2"><a href="modchapter.html#cb760-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the sample size required to obtain an interval with</span></span>
<span id="cb760-3"><a href="modchapter.html#cb760-3" aria-hidden="true" tabindex="-1"></a><span class="co"># width 0.1 if the true proportion is 0.4:</span></span>
<span id="cb760-4"><a href="modchapter.html#cb760-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ssize.propCI</span>(<span class="at">prop =</span> <span class="fl">0.4</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">method =</span> <span class="st">&quot;wilson&quot;</span>)</span>
<span id="cb760-5"><a href="modchapter.html#cb760-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ssize.propCI</span>(<span class="at">prop =</span> <span class="fl">0.4</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">method =</span> <span class="st">&quot;clopper-pearson&quot;</span>)</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch7exc8" class="exercise"><strong>Exercise 7.6  </strong></span>The function <code>binomDiffCI</code> from <code>MKinfer</code> can be used to compute a confidence interval for the <em>difference</em> of two proportions. Using the <code>msleep</code> data, use it to compute a confidence interval for the difference between the proportion of herbivores that sleep for more than 7 hours a day and the proportion of carnivores that sleep for more than 7 hours a day.</p>
</div>
<p><a href="solutions.html#ch7solutions8">(Click here to go to the solution.)</a></p>
</div>
</div>
<div id="ethicsinference" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Ethical issues in statistical inference<a href="modchapter.html#ethicsinference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The use and misuse of statistical inference offer many ethical dilemmas. Some common issues related to ethics and good statistical practice are discussed below. As you read them and work with the associated exercises, consider consulting the ASA’s ethical guidelines, presented in Section <a href="datachapter.html#ethicalguidelines">3.11</a>.</p>
<div id="p-hacking-and-the-file-drawer-problem" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> p-hacking and the file-drawer problem<a href="modchapter.html#p-hacking-and-the-file-drawer-problem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hypothesis tests are easy to misuse. If you run enough tests on your data, you are almost guaranteed to end up with significant results - either due to chance or because some of the null hypotheses you test are false. The process of trying lots of different tests (different methods, different hypotheses, different sub-groups) in search of significant results is known as <em>p-hacking</em> or <em>data dredging</em>. This greatly increases the risk of false findings, and can often produce misleading results.</p>
<p>Many practitioners inadvertently resort to p-hacking, by mixing exploratory data analysis and hypothesis testing, or by coming up with new hypotheses to test as they work with their data. This can be avoided by planning your analyses in advance, a practice that in fact is required in medical trials.</p>
<p>On the other end of the spectrum, there is the <em>file-drawer problem</em>, in which studies with negative (i.e. not statistically significant) results aren’t published or reported, but instead are stored in the researcher’s file-drawers. There are many reasons for this, one being that negative results usually are seen as less important and less worthy of spending time on. Simply put, negative results just aren’t news. If your study shows that eating kale every day significantly reduces the risk of cancer, then that is news, something that people are interested in learning, and something that can be published in a prestigious journal. However, if your study shows that a daily serving of kale has no impact on the risk of cancer, that’s not news, people aren’t really interested in hearing it, and it may prove difficult to publish your findings.</p>
<p>But what if 100 different researchers carried out the same study? If eating kale doesn’t affect the risk of cancer, then we can still expect 5 out of these researchers to get significant results (using a 5 % significance level). If only those researchers publish their results, that may give the impressions that there is strong evidence of the cancer-preventing effect of kale backed up by several papers, even though the majority of studies actually indicated that there was no such effect.</p>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch7ethics1" class="exercise"><strong>Exercise 7.7  </strong></span><em>Discuss the following.</em> You are helping a research team with statistical analysis of data that they have collected. You agree on five hypotheses to test. None of the tests turns out significant. Fearing that all their hard work won’t lead anywhere, your collaborators then ask you to carry out five new tests. Neither turns out significant. Your collaborators closely inspect the data and then ask you to carry out ten more tests, two of which are significant. The team wants to publish these significant results in a scientific journal. Should you agree to publish them? If so, what results should be published? Should you have put your foot down and told them not to run more tests? Does your answer depend on how long it took the research team to collect the data? What if the team won’t get funding for new projects unless they publish a paper soon? What if other research teams competing for the same grants do their analyses like this?</p>
</div>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch7ethics2" class="exercise"><strong>Exercise 7.8  </strong></span><em>Discuss the following.</em> You are working for a company that is launching a new product, a hair-loss treatment. In a small study, the product worked for 19 out of 22 participants (86 %). You compute a 95 % Clopper-Pearson confidence interval (Section <a href="modchapter.html#confprop">7.3.4</a>) for the proportion of successes and find that it is (0.65, 0.97). Based on this, the company wants to market the product as being 97 % effective. Is that acceptable to you? If not, how should it be marketed? Would your answer change if the product was something else (new running shoes that make you faster, a plastic film that protects smartphone screens from scratches, or contraceptives)? What if the company wanted to market it as being 86 % effective instead?</p>
</div>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch7ethics3" class="exercise"><strong>Exercise 7.9  </strong></span><em>Discuss the following.</em> You have worked long and hard on a project. In the end, to see if the project was a success, you run a hypothesis test to check if two variables are correlated. You find that they are not (p = 0.15). However, if you remove three outliers, the two variables are significantly correlated (p = 0.03). What should you do? Does your answer change if you only have to remove one outlier to get a significant result? If you have to remove ten outliers? 100 outliers? What if the p-value is 0.051 before removing the outliers and 0.049 after removing the outliers?</p>
</div>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch7ethics4" class="exercise"><strong>Exercise 7.10  </strong></span><em>Discuss the following.</em> You are analysing data from an experiment to see if there is a difference between two treatments. You estimate<a href="#fn51" class="footnote-ref" id="fnref51"><sup>51</sup></a> that given the sample size and the expected difference in treatment effects, the power of the test that you’ll be using, i.e. the probability of rejecting the null hypothesis if it is false, is about 15 %. Should you carry out such an analysis? If not, how high does the power need to be for the analysis to be meaningful?</p>
</div>
</div>
<div id="reproducibility" class="section level3 hasAnchor" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Reproducibility<a href="modchapter.html#reproducibility" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An analysis is <em>reproducible</em> if it can be reproduced by someone else. By producing reproducible analyses, we make it easier for others to scrutinise our work. We also make all the steps in the data analysis transparent. This can act as a safeguard against data fabrication and data dredging.</p>
<p>In order to make an analysis reproducible, we need to provide at least two things. First, <em>the data</em> - all unedited data files in their original format. This also includes <em>metadata</em> with information required to understand the data (e.g. codebooks explaining variable names and codes used for categorical variables). Second, <em>the computer code</em> used to prepare and analyse the data. This includes any wrangling and preliminary testing performed on the data.</p>
<p>As long as we save our data files and code, data wrangling and analyses in R are inherently reproducible, in contrast to the same tasks carried out in menu-based software such as Excel. However, if reports are created using a word processor, there is always a risk that something will be lost along the way. Perhaps numbers are copied by hand (which may introduce errors), or maybe the wrong version of a figure is pasted into the document. R Markdown (Section <a href="eda.html#rmarkdown">4.1</a>) is a great tool for creating completely reproducible reports, as it allows you to integrate R code for data wrangling, analyses, and graphics in your report-writing. This reduces the risk of manually inserting errors, and allows you to share your work with others easily.</p>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch7ethics5" class="exercise"><strong>Exercise 7.11  </strong></span><em>Discuss the following.</em> You are working on a study at a small-town hospital. The data involves biomarker measurements for a number of patients, and you show that patients with a sexually transmittable disease have elevated levels of some of the biomarkers. The data also includes information about the patients: their names, ages, ZIP codes, heights, and weights. The research team wants to publish your results and make the analysis reproducible. Is it ethically acceptable to share all your data? Can you make the analysis reproducible without violating patient confidentiality?</p>
</div>
</div>
</div>
<div id="simeval" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Evaluating statistical methods using simulation<a href="modchapter.html#simeval" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An important use of simulation is in the evaluation of statistical methods. In this section, we will see how simulation can be used to compare the performance of two estimators, as well as the type I error rate and power of hypothesis tests.</p>
<div id="comparing-estimators" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Comparing estimators<a href="modchapter.html#comparing-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s say that we want to estimate the mean <span class="math inline">\(\mu\)</span> of a normal distribution. We could come up with several different estimators for <span class="math inline">\(\mu\)</span>:</p>
<ul>
<li>The sample mean <span class="math inline">\(\bar{x}\)</span>,</li>
<li>The sample median <span class="math inline">\(\tilde{x}\)</span>,</li>
<li>The average of the largest and smallest value in the sample: <span class="math inline">\(\frac{x_{max}+x_{min}}{2}\)</span>.</li>
</ul>
<p>In this particular case (under normality), statistical theory tells us that the sample mean is the best estimator<a href="#fn52" class="footnote-ref" id="fnref52"><sup>52</sup></a>. But how much better is it, really? And what if we didn’t know statistical theory - could we use simulation to find out which estimator to use?</p>
<p>To begin with, let’s write a function that computes the estimate <span class="math inline">\(\frac{x_{max}+x_{min}}{2}\)</span>:</p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="modchapter.html#cb761-1" aria-hidden="true" tabindex="-1"></a>max_min_avg <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb761-2"><a href="modchapter.html#cb761-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb761-3"><a href="modchapter.html#cb761-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>((<span class="fu">max</span>(x)<span class="sc">+</span><span class="fu">min</span>(x))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb761-4"><a href="modchapter.html#cb761-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Next, we’ll generate some data from a <span class="math inline">\(N(0,1)\)</span> distribution and compute the three estimates:</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="modchapter.html#cb762-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>)</span>
<span id="cb762-2"><a href="modchapter.html#cb762-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb762-3"><a href="modchapter.html#cb762-3" aria-hidden="true" tabindex="-1"></a>x_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb762-4"><a href="modchapter.html#cb762-4" aria-hidden="true" tabindex="-1"></a>x_median <span class="ot">&lt;-</span> <span class="fu">median</span>(x)</span>
<span id="cb762-5"><a href="modchapter.html#cb762-5" aria-hidden="true" tabindex="-1"></a>x_mma <span class="ot">&lt;-</span> <span class="fu">max_min_avg</span>(x)</span>
<span id="cb762-6"><a href="modchapter.html#cb762-6" aria-hidden="true" tabindex="-1"></a>x_mean; x_median; x_mma</span></code></pre></div>
<p>As you can see, the estimates given by the different approaches differ, so clearly the choice of estimator matters. We can’t determine which to use based on a single sample though. Instead, we typically compare the long-run properties of estimators, such as their <em>bias</em> and <em>variance</em>. The bias is the difference between the mean of the estimator and the parameter it seeks to estimate. An estimator is <em>unbiased</em> if its bias is 0, which is considered desirable at least in this setting. Among unbiased estimators, we prefer the one that has the smallest variance. So how can we use simulation to compute the bias and variance of estimators?</p>
<p>The key to using simulation here is to realise that <code>x_mean</code> is an observation of the random variable <span class="math inline">\(\bar{X}= \frac{1}{25}(X_1+X_2+\cdots+X_{25})\)</span> where each <span class="math inline">\(X_i\)</span> is <span class="math inline">\(N(0, 1)\)</span>-distributed. We can generate observations of <span class="math inline">\(X_i\)</span> (using <code>rnorm</code>), and can therefore also generate observations of <span class="math inline">\(\bar{X}\)</span>. That means that we can obtain an arbitrarily large sample of observations of <span class="math inline">\(\bar{X}\)</span>, which we can use to estimate its mean and variance. Here is an example:</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="modchapter.html#cb763-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the parameters for the normal distribution:</span></span>
<span id="cb763-2"><a href="modchapter.html#cb763-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb763-3"><a href="modchapter.html#cb763-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb763-4"><a href="modchapter.html#cb763-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb763-5"><a href="modchapter.html#cb763-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We will generate 10,000 observations of the estimators:</span></span>
<span id="cb763-6"><a href="modchapter.html#cb763-6" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb763-7"><a href="modchapter.html#cb763-7" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x_mean =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, B),</span>
<span id="cb763-8"><a href="modchapter.html#cb763-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x_median =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, B),</span>
<span id="cb763-9"><a href="modchapter.html#cb763-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x_mma =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, B))</span>
<span id="cb763-10"><a href="modchapter.html#cb763-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb763-11"><a href="modchapter.html#cb763-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Start progress bar:</span></span>
<span id="cb763-12"><a href="modchapter.html#cb763-12" aria-hidden="true" tabindex="-1"></a>pbar <span class="ot">&lt;-</span> <span class="fu">txtProgressBar</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> B, <span class="at">style =</span> <span class="dv">3</span>)</span>
<span id="cb763-13"><a href="modchapter.html#cb763-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb763-14"><a href="modchapter.html#cb763-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(res<span class="sc">$</span>x_mean))</span>
<span id="cb763-15"><a href="modchapter.html#cb763-15" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb763-16"><a href="modchapter.html#cb763-16" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, mu, sigma)</span>
<span id="cb763-17"><a href="modchapter.html#cb763-17" aria-hidden="true" tabindex="-1"></a>      res<span class="sc">$</span>x_mean[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb763-18"><a href="modchapter.html#cb763-18" aria-hidden="true" tabindex="-1"></a>      res<span class="sc">$</span>x_median[i] <span class="ot">&lt;-</span> <span class="fu">median</span>(x)</span>
<span id="cb763-19"><a href="modchapter.html#cb763-19" aria-hidden="true" tabindex="-1"></a>      res<span class="sc">$</span>x_mma[i] <span class="ot">&lt;-</span> <span class="fu">max_min_avg</span>(x)</span>
<span id="cb763-20"><a href="modchapter.html#cb763-20" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb763-21"><a href="modchapter.html#cb763-21" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Update progress bar</span></span>
<span id="cb763-22"><a href="modchapter.html#cb763-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setTxtProgressBar</span>(pbar, i)</span>
<span id="cb763-23"><a href="modchapter.html#cb763-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb763-24"><a href="modchapter.html#cb763-24" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(pbar)</span>
<span id="cb763-25"><a href="modchapter.html#cb763-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb763-26"><a href="modchapter.html#cb763-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the estimators:</span></span>
<span id="cb763-27"><a href="modchapter.html#cb763-27" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(res<span class="sc">-</span>mu) <span class="co"># Bias</span></span>
<span id="cb763-28"><a href="modchapter.html#cb763-28" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(res, <span class="dv">2</span>, var) <span class="co"># Variances</span></span></code></pre></div>
<p>All three estimators appear to be unbiased (even if the simulation results aren’t exactly 0, they are very close). The sample mean has the smallest variance (and is therefore preferable!), followed by the median. The <span class="math inline">\(\frac{x_{max}+x_{min}}{2}\)</span> estimator has the worst performance, which is unsurprising as it ignores all information not contained in the extremes of the dataset.</p>
<p>In Section <a href="modchapter.html#simadvice">7.5.5</a> we’ll discuss how to choose the number of simulated samples to use in your simulations. For now, we’ll just note that the estimate of the estimators’ biases becomes more stable as the number of simulated samples increases, as can be seen from this plot, which utilises <code>cumsum</code>, described in Section <a href="messychapter.html#rle">5.3.3</a>:</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="modchapter.html#cb764-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute estimates of the bias of the sample mean for each</span></span>
<span id="cb764-2"><a href="modchapter.html#cb764-2" aria-hidden="true" tabindex="-1"></a><span class="co"># iteration:</span></span>
<span id="cb764-3"><a href="modchapter.html#cb764-3" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>iterations <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>B</span>
<span id="cb764-4"><a href="modchapter.html#cb764-4" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>x_mean_bias <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(res<span class="sc">$</span>x_mean)<span class="sc">/</span><span class="dv">1</span><span class="sc">:</span>B <span class="sc">-</span> mu</span>
<span id="cb764-5"><a href="modchapter.html#cb764-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb764-6"><a href="modchapter.html#cb764-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results:</span></span>
<span id="cb764-7"><a href="modchapter.html#cb764-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb764-8"><a href="modchapter.html#cb764-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res, <span class="fu">aes</span>(iterations, x_mean_bias)) <span class="sc">+</span></span>
<span id="cb764-9"><a href="modchapter.html#cb764-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb764-10"><a href="modchapter.html#cb764-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(<span class="st">&quot;Number of iterations&quot;</span>) <span class="sc">+</span></span>
<span id="cb764-11"><a href="modchapter.html#cb764-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(<span class="st">&quot;Estimated bias&quot;</span>)</span>
<span id="cb764-12"><a href="modchapter.html#cb764-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb764-13"><a href="modchapter.html#cb764-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Cut the x-axis to better see the oscillations for smaller</span></span>
<span id="cb764-14"><a href="modchapter.html#cb764-14" aria-hidden="true" tabindex="-1"></a><span class="co"># numbers of iterations:</span></span>
<span id="cb764-15"><a href="modchapter.html#cb764-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(res, <span class="fu">aes</span>(iterations, x_mean_bias)) <span class="sc">+</span></span>
<span id="cb764-16"><a href="modchapter.html#cb764-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb764-17"><a href="modchapter.html#cb764-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(<span class="st">&quot;Number of iterations&quot;</span>) <span class="sc">+</span></span>
<span id="cb764-18"><a href="modchapter.html#cb764-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(<span class="st">&quot;Estimated bias&quot;</span>) <span class="sc">+</span></span>
<span id="cb764-19"><a href="modchapter.html#cb764-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">1000</span>)</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch7exc9" class="exercise"><strong>Exercise 7.12  </strong></span>Repeat the above simulation for different samples sizes <span class="math inline">\(n\)</span> between 10 and 100. Plot the resulting variances as a function of <span class="math inline">\(n\)</span>.</p>
</div>
<p><a href="solutions.html#ch7solutions9">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch7exc10" class="exercise"><strong>Exercise 7.13  </strong></span>Repeat the simulation in <a href="modchapter.html#exr:ch7exc9">7.12</a>, but with a <span class="math inline">\(t(3)\)</span> distribution instead of the normal distribution. Which estimator is better in this case?</p>
</div>
<p><a href="solutions.html#ch7solutions10">(Click here to go to the solution.)</a></p>
</div>
<div id="simtypeI" class="section level3 hasAnchor" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Type I error rate of hypothesis tests<a href="modchapter.html#simtypeI" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the same vein that we just compared estimators, we can also compare hypothesis tests or confidence intervals. Let’s have a look at the former, and evaluate how well the old-school two-sample t-test fares compared to a permutation t-test and the Wilcoxon-Mann-Whitney test.</p>
<p>For our first comparison, we will compare the type I error rate of the three tests, i.e. the risk of rejecting the null hypothesis if the null hypothesis is true. Nominally, this is the significance level <span class="math inline">\(\alpha\)</span>, which we set to be 0.05.</p>
<p>We write a function for such a simulation, to which we can pass the sizes <code>n1</code> and <code>n2</code> of the two samples, as well as a function <code>distr</code> to generate data:</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="modchapter.html#cb765-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load package used for permutation t-test:</span></span>
<span id="cb765-2"><a href="modchapter.html#cb765-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKinfer)</span>
<span id="cb765-3"><a href="modchapter.html#cb765-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb765-4"><a href="modchapter.html#cb765-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function for running the simulation:</span></span>
<span id="cb765-5"><a href="modchapter.html#cb765-5" aria-hidden="true" tabindex="-1"></a>simulate_type_I <span class="ot">&lt;-</span> <span class="cf">function</span>(n1, n2, distr, <span class="at">level =</span> <span class="fl">0.05</span>, <span class="at">B =</span> <span class="dv">999</span>,</span>
<span id="cb765-6"><a href="modchapter.html#cb765-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, ...)</span>
<span id="cb765-7"><a href="modchapter.html#cb765-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb765-8"><a href="modchapter.html#cb765-8" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create a data frame to store the results in:</span></span>
<span id="cb765-9"><a href="modchapter.html#cb765-9" aria-hidden="true" tabindex="-1"></a>      p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p_t_test =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, B),</span>
<span id="cb765-10"><a href="modchapter.html#cb765-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">p_perm_t_test =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, B),</span>
<span id="cb765-11"><a href="modchapter.html#cb765-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">p_wilcoxon =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, B))</span>
<span id="cb765-12"><a href="modchapter.html#cb765-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb765-13"><a href="modchapter.html#cb765-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Start progress bar:</span></span>
<span id="cb765-14"><a href="modchapter.html#cb765-14" aria-hidden="true" tabindex="-1"></a>      pbar <span class="ot">&lt;-</span> <span class="fu">txtProgressBar</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> B, <span class="at">style =</span> <span class="dv">3</span>)</span>
<span id="cb765-15"><a href="modchapter.html#cb765-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb765-16"><a href="modchapter.html#cb765-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B)</span>
<span id="cb765-17"><a href="modchapter.html#cb765-17" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb765-18"><a href="modchapter.html#cb765-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Generate data:</span></span>
<span id="cb765-19"><a href="modchapter.html#cb765-19" aria-hidden="true" tabindex="-1"></a>            x <span class="ot">&lt;-</span> <span class="fu">distr</span>(n1, ...)</span>
<span id="cb765-20"><a href="modchapter.html#cb765-20" aria-hidden="true" tabindex="-1"></a>            y <span class="ot">&lt;-</span> <span class="fu">distr</span>(n2, ...)</span>
<span id="cb765-21"><a href="modchapter.html#cb765-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb765-22"><a href="modchapter.html#cb765-22" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Compute p-values:</span></span>
<span id="cb765-23"><a href="modchapter.html#cb765-23" aria-hidden="true" tabindex="-1"></a>            p_values[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, y,</span>
<span id="cb765-24"><a href="modchapter.html#cb765-24" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alternative =</span> alternative)<span class="sc">$</span>p.value</span>
<span id="cb765-25"><a href="modchapter.html#cb765-25" aria-hidden="true" tabindex="-1"></a>            p_values[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">perm.t.test</span>(x, y,</span>
<span id="cb765-26"><a href="modchapter.html#cb765-26" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alternative =</span> alternative,</span>
<span id="cb765-27"><a href="modchapter.html#cb765-27" aria-hidden="true" tabindex="-1"></a>                               <span class="at">R =</span> <span class="dv">999</span>)<span class="sc">$</span>perm.p.value</span>
<span id="cb765-28"><a href="modchapter.html#cb765-28" aria-hidden="true" tabindex="-1"></a>            p_values[i, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(x, y,</span>
<span id="cb765-29"><a href="modchapter.html#cb765-29" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alternative =</span> alternative)<span class="sc">$</span>p.value</span>
<span id="cb765-30"><a href="modchapter.html#cb765-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb765-31"><a href="modchapter.html#cb765-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Update progress bar:</span></span>
<span id="cb765-32"><a href="modchapter.html#cb765-32" aria-hidden="true" tabindex="-1"></a>            <span class="fu">setTxtProgressBar</span>(pbar, i)</span>
<span id="cb765-33"><a href="modchapter.html#cb765-33" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb765-34"><a href="modchapter.html#cb765-34" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb765-35"><a href="modchapter.html#cb765-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">close</span>(pbar)</span>
<span id="cb765-36"><a href="modchapter.html#cb765-36" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb765-37"><a href="modchapter.html#cb765-37" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Return the type I error rates:</span></span>
<span id="cb765-38"><a href="modchapter.html#cb765-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">colMeans</span>(p_values <span class="sc">&lt;</span> level))</span>
<span id="cb765-39"><a href="modchapter.html#cb765-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>First, let’s try it with normal data. The simulation takes a little while to run, primarily because of the permutation t-test, so you may want to take a short break while you wait.</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="modchapter.html#cb766-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulate_type_I</span>(<span class="dv">20</span>, <span class="dv">20</span>, rnorm, <span class="at">B =</span> <span class="dv">9999</span>)</span></code></pre></div>
<p>Next, let’s try it with a lognormal distribution, both with balanced and imbalanced sample sizes. Increasing the parameter <span class="math inline">\(\sigma\)</span> (<code>sdlog</code>) increases the skewness of the lognormal distribution (i.e. makes it <em>more</em> asymmetric and therefore less similar to the normal distribution), so let’s try that to. In case you are in a rush, the results from my run of this code block can be found below it.</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="modchapter.html#cb767-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simulate_type_I</span>(<span class="dv">20</span>, <span class="dv">20</span>, rlnorm, <span class="at">B =</span> <span class="dv">9999</span>, <span class="at">sdlog =</span> <span class="dv">1</span>)</span>
<span id="cb767-2"><a href="modchapter.html#cb767-2" aria-hidden="true" tabindex="-1"></a><span class="fu">simulate_type_I</span>(<span class="dv">20</span>, <span class="dv">20</span>, rlnorm, <span class="at">B =</span> <span class="dv">9999</span>, <span class="at">sdlog =</span> <span class="dv">3</span>)</span>
<span id="cb767-3"><a href="modchapter.html#cb767-3" aria-hidden="true" tabindex="-1"></a><span class="fu">simulate_type_I</span>(<span class="dv">20</span>, <span class="dv">30</span>, rlnorm, <span class="at">B =</span> <span class="dv">9999</span>, <span class="at">sdlog =</span> <span class="dv">1</span>)</span>
<span id="cb767-4"><a href="modchapter.html#cb767-4" aria-hidden="true" tabindex="-1"></a><span class="fu">simulate_type_I</span>(<span class="dv">20</span>, <span class="dv">30</span>, rlnorm, <span class="at">B =</span> <span class="dv">9999</span>, <span class="at">sdlog =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>My results were:</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="modchapter.html#cb768-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal distribution, n1 = n2 = 20:</span></span>
<span id="cb768-2"><a href="modchapter.html#cb768-2" aria-hidden="true" tabindex="-1"></a>     p_t_test p_perm_t_test    p_wilcoxon </span>
<span id="cb768-3"><a href="modchapter.html#cb768-3" aria-hidden="true" tabindex="-1"></a>   <span class="fl">0.04760476</span>    <span class="fl">0.04780478</span>    <span class="fl">0.04680468</span> </span>
<span id="cb768-4"><a href="modchapter.html#cb768-4" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb768-5"><a href="modchapter.html#cb768-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Lognormal distribution, n1 = n2 = 20, sigma = 1:</span></span>
<span id="cb768-6"><a href="modchapter.html#cb768-6" aria-hidden="true" tabindex="-1"></a>     p_t_test p_perm_t_test    p_wilcoxon </span>
<span id="cb768-7"><a href="modchapter.html#cb768-7" aria-hidden="true" tabindex="-1"></a>   <span class="fl">0.03320332</span>    <span class="fl">0.04620462</span>    <span class="fl">0.04910491</span> </span>
<span id="cb768-8"><a href="modchapter.html#cb768-8" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb768-9"><a href="modchapter.html#cb768-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Lognormal distribution, n1 = n2 = 20, sigma = 3:</span></span>
<span id="cb768-10"><a href="modchapter.html#cb768-10" aria-hidden="true" tabindex="-1"></a>     p_t_test p_perm_t_test    p_wilcoxon </span>
<span id="cb768-11"><a href="modchapter.html#cb768-11" aria-hidden="true" tabindex="-1"></a>   <span class="fl">0.00830083</span>    <span class="fl">0.05240524</span>    <span class="fl">0.04590459</span> </span>
<span id="cb768-12"><a href="modchapter.html#cb768-12" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb768-13"><a href="modchapter.html#cb768-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Lognormal distribution, n1 = 20, n2 = 30, sigma = 1:</span></span>
<span id="cb768-14"><a href="modchapter.html#cb768-14" aria-hidden="true" tabindex="-1"></a>     p_t_test p_perm_t_test    p_wilcoxon </span>
<span id="cb768-15"><a href="modchapter.html#cb768-15" aria-hidden="true" tabindex="-1"></a>   <span class="fl">0.04080408</span>    <span class="fl">0.04970497</span>    <span class="fl">0.05300530</span> </span>
<span id="cb768-16"><a href="modchapter.html#cb768-16" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb768-17"><a href="modchapter.html#cb768-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Lognormal distribution, n1 = 20, n2 = 30, sigma = 3:</span></span>
<span id="cb768-18"><a href="modchapter.html#cb768-18" aria-hidden="true" tabindex="-1"></a>     p_t_test p_perm_t_test    p_wilcoxon </span>
<span id="cb768-19"><a href="modchapter.html#cb768-19" aria-hidden="true" tabindex="-1"></a>   <span class="fl">0.01180118</span>    <span class="fl">0.04850485</span>    <span class="fl">0.05240524</span>    </span></code></pre></div>
<p>What’s noticeable here is that the permutation t-test and the Wilcoxon-Mann-Whitney test have type I error rates that are close to the nominal 0.05 in all five scenarios, whereas the t-test has too low a type I error rate when the data comes from a lognormal distribution. This makes the test too conservative in this setting. Next, let’s compare the power of the tests.</p>
</div>
<div id="simpower" class="section level3 hasAnchor" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> Power of hypothesis tests<a href="modchapter.html#simpower" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The power of a test is the probability of rejecting the null hypothesis if it is false. To estimate that, we need to generate data under the alternative hypothesis. For two-sample tests of the mean, the code is similar to what we used for the type I error simulation above, but we now need two functions for generating data - one for each group, because the groups differ under the alternative hypothesis. Bear in mind that the alternative hypothesis for the two-sample test is that the two distributions differ in location, so the two functions for generating data should reflect that.</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="modchapter.html#cb769-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load package used for permutation t-test:</span></span>
<span id="cb769-2"><a href="modchapter.html#cb769-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKinfer)</span>
<span id="cb769-3"><a href="modchapter.html#cb769-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb769-4"><a href="modchapter.html#cb769-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function for running the simulation:</span></span>
<span id="cb769-5"><a href="modchapter.html#cb769-5" aria-hidden="true" tabindex="-1"></a>simulate_power <span class="ot">&lt;-</span> <span class="cf">function</span>(n1, n2, distr1, distr2, <span class="at">level =</span> <span class="fl">0.05</span>,</span>
<span id="cb769-6"><a href="modchapter.html#cb769-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">B =</span> <span class="dv">999</span>, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb769-7"><a href="modchapter.html#cb769-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb769-8"><a href="modchapter.html#cb769-8" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create a data frame to store the results in:</span></span>
<span id="cb769-9"><a href="modchapter.html#cb769-9" aria-hidden="true" tabindex="-1"></a>      p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p_t_test =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, B),</span>
<span id="cb769-10"><a href="modchapter.html#cb769-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">p_perm_t_test =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, B),</span>
<span id="cb769-11"><a href="modchapter.html#cb769-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">p_wilcoxon =</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, B))</span>
<span id="cb769-12"><a href="modchapter.html#cb769-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb769-13"><a href="modchapter.html#cb769-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Start progress bar:</span></span>
<span id="cb769-14"><a href="modchapter.html#cb769-14" aria-hidden="true" tabindex="-1"></a>      pbar <span class="ot">&lt;-</span> <span class="fu">txtProgressBar</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> B, <span class="at">style =</span> <span class="dv">3</span>)</span>
<span id="cb769-15"><a href="modchapter.html#cb769-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb769-16"><a href="modchapter.html#cb769-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B)</span>
<span id="cb769-17"><a href="modchapter.html#cb769-17" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb769-18"><a href="modchapter.html#cb769-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Generate data:</span></span>
<span id="cb769-19"><a href="modchapter.html#cb769-19" aria-hidden="true" tabindex="-1"></a>            x <span class="ot">&lt;-</span> <span class="fu">distr1</span>(n1)</span>
<span id="cb769-20"><a href="modchapter.html#cb769-20" aria-hidden="true" tabindex="-1"></a>            y <span class="ot">&lt;-</span> <span class="fu">distr2</span>(n2)</span>
<span id="cb769-21"><a href="modchapter.html#cb769-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb769-22"><a href="modchapter.html#cb769-22" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Compute p-values:</span></span>
<span id="cb769-23"><a href="modchapter.html#cb769-23" aria-hidden="true" tabindex="-1"></a>            p_values[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, y,</span>
<span id="cb769-24"><a href="modchapter.html#cb769-24" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alternative =</span> alternative)<span class="sc">$</span>p.value</span>
<span id="cb769-25"><a href="modchapter.html#cb769-25" aria-hidden="true" tabindex="-1"></a>            p_values[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">perm.t.test</span>(x, y,</span>
<span id="cb769-26"><a href="modchapter.html#cb769-26" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alternative =</span> alternative,</span>
<span id="cb769-27"><a href="modchapter.html#cb769-27" aria-hidden="true" tabindex="-1"></a>                               <span class="at">R =</span> <span class="dv">999</span>)<span class="sc">$</span>perm.p.value</span>
<span id="cb769-28"><a href="modchapter.html#cb769-28" aria-hidden="true" tabindex="-1"></a>            p_values[i, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(x, y,</span>
<span id="cb769-29"><a href="modchapter.html#cb769-29" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alternative =</span> alternative)<span class="sc">$</span>p.value</span>
<span id="cb769-30"><a href="modchapter.html#cb769-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb769-31"><a href="modchapter.html#cb769-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Update progress bar:</span></span>
<span id="cb769-32"><a href="modchapter.html#cb769-32" aria-hidden="true" tabindex="-1"></a>            <span class="fu">setTxtProgressBar</span>(pbar, i)</span>
<span id="cb769-33"><a href="modchapter.html#cb769-33" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb769-34"><a href="modchapter.html#cb769-34" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb769-35"><a href="modchapter.html#cb769-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">close</span>(pbar)</span>
<span id="cb769-36"><a href="modchapter.html#cb769-36" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb769-37"><a href="modchapter.html#cb769-37" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Return power:</span></span>
<span id="cb769-38"><a href="modchapter.html#cb769-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">colMeans</span>(p_values <span class="sc">&lt;</span> level))</span>
<span id="cb769-39"><a href="modchapter.html#cb769-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s try this out with lognormal data, where the difference in the log means is 1:</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="modchapter.html#cb770-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Balanced sample sizes:</span></span>
<span id="cb770-2"><a href="modchapter.html#cb770-2" aria-hidden="true" tabindex="-1"></a><span class="fu">simulate_power</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="cf">function</span>(n) { <span class="fu">rlnorm</span>(n,</span>
<span id="cb770-3"><a href="modchapter.html#cb770-3" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">meanlog =</span> <span class="dv">2</span>, <span class="at">sdlog =</span> <span class="dv">1</span>) },</span>
<span id="cb770-4"><a href="modchapter.html#cb770-4" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">function</span>(n) { <span class="fu">rlnorm</span>(n,</span>
<span id="cb770-5"><a href="modchapter.html#cb770-5" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">meanlog =</span> <span class="dv">1</span>, <span class="at">sdlog =</span> <span class="dv">1</span>) },</span>
<span id="cb770-6"><a href="modchapter.html#cb770-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">B =</span> <span class="dv">9999</span>)</span>
<span id="cb770-7"><a href="modchapter.html#cb770-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb770-8"><a href="modchapter.html#cb770-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Imbalanced sample sizes:</span></span>
<span id="cb770-9"><a href="modchapter.html#cb770-9" aria-hidden="true" tabindex="-1"></a><span class="fu">simulate_power</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="cf">function</span>(n) { <span class="fu">rlnorm</span>(n,</span>
<span id="cb770-10"><a href="modchapter.html#cb770-10" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">meanlog =</span> <span class="dv">2</span>, <span class="at">sdlog =</span> <span class="dv">1</span>) },</span>
<span id="cb770-11"><a href="modchapter.html#cb770-11" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">function</span>(n) { <span class="fu">rlnorm</span>(n,</span>
<span id="cb770-12"><a href="modchapter.html#cb770-12" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">meanlog =</span> <span class="dv">1</span>, <span class="at">sdlog =</span> <span class="dv">1</span>) },</span>
<span id="cb770-13"><a href="modchapter.html#cb770-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">B =</span> <span class="dv">9999</span>)</span></code></pre></div>
<p>Here are the results from my runs:</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="modchapter.html#cb771-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Balanced sample sizes:</span></span>
<span id="cb771-2"><a href="modchapter.html#cb771-2" aria-hidden="true" tabindex="-1"></a>     p_t_test p_perm_t_test    p_wilcoxon </span>
<span id="cb771-3"><a href="modchapter.html#cb771-3" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.6708671</span>     <span class="fl">0.7596760</span>     <span class="fl">0.8508851</span></span>
<span id="cb771-4"><a href="modchapter.html#cb771-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb771-5"><a href="modchapter.html#cb771-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Imbalanced sample sizes:</span></span>
<span id="cb771-6"><a href="modchapter.html#cb771-6" aria-hidden="true" tabindex="-1"></a>     p_t_test p_perm_t_test    p_wilcoxon </span>
<span id="cb771-7"><a href="modchapter.html#cb771-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.6915692</span>     <span class="fl">0.7747775</span>     <span class="fl">0.9041904</span></span></code></pre></div>
<p>Among the three, the Wilcoxon-Mann-Whitney test appears to be preferable for lognormal data, as it manages to obtain the correct type I error rate (unlike the old-school t-test) and has the highest power (although we would have to consider more scenarios, including different samples sizes, other differences of means, and different values of <span class="math inline">\(\sigma\)</span> to say for sure!).</p>
<p>Remember that both our estimates of power and type I error rates are proportions, meaning that we can use binomial confidence intervals to quantify the uncertainty in the estimates from our simulation studies. Let’s do that for the lognormal setting with balanced sample sizes, using the results from my runs. The number of simulated samples were 9,999. For the t-test, the estimated type I error rate was <code>0.03320332</code>, which corresponds to <span class="math inline">\(0.03320332\cdot9,999=332\)</span> “successes”. Similarly, there were 6,708 “successes” in the power study. The confidence intervals become:</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="modchapter.html#cb772-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKinfer)</span>
<span id="cb772-2"><a href="modchapter.html#cb772-2" aria-hidden="true" tabindex="-1"></a><span class="fu">binomCI</span>(<span class="dv">332</span>, <span class="dv">9999</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">&quot;clopper-pearson&quot;</span>)</span>
<span id="cb772-3"><a href="modchapter.html#cb772-3" aria-hidden="true" tabindex="-1"></a><span class="fu">binomCI</span>(<span class="dv">6708</span>, <span class="dv">9999</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">method =</span> <span class="st">&quot;wilson&quot;</span>)</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch7exc11" class="exercise"><strong>Exercise 7.14  </strong></span>Repeat the simulation study of type I error rate and power for the old school t-test, permutation t-test and the Wilcoxon-Mann-Whitney test with <span class="math inline">\(t(3)\)</span>-distributed data. Which test has the best performance? How much lower is the type I error rate of the old-school t-test compared to the permutation t-test in the case of balanced sample sizes?</p>
</div>
<p><a href="solutions.html#ch7solutions11">(Click here to go to the solution.)</a></p>
</div>
<div id="powerlocation" class="section level3 hasAnchor" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> Power of some tests of location<a href="modchapter.html#powerlocation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>MKpower</code> package contains functions for quickly performing power simulations for the old-school t-test and Wilcoxon-Mann-Whitney test in different settings. The arguments <code>rx</code> and <code>ry</code> are used to pass functions used to generate the random numbers, in line with the <code>simulate_power</code> function that we created above.</p>
<p>For the t-test, we can use <code>sim.power.t.test</code>:</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="modchapter.html#cb773-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKpower)</span>
<span id="cb773-2"><a href="modchapter.html#cb773-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sim.power.t.test</span>(<span class="at">nx =</span> <span class="dv">25</span>, <span class="at">rx =</span> rnorm, <span class="at">rx.H0 =</span> rnorm,</span>
<span id="cb773-3"><a href="modchapter.html#cb773-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ny =</span> <span class="dv">25</span>, <span class="at">ry =</span> <span class="cf">function</span>(x) { <span class="fu">rnorm</span>(x, <span class="at">mean =</span> <span class="fl">0.8</span>) },</span>
<span id="cb773-4"><a href="modchapter.html#cb773-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ry.H0 =</span> rnorm)</span></code></pre></div>
<p>For the Wilcoxon-Mann-Whitney test, we can use <code>sim.power.wilcox.test</code> for power simulations:</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="modchapter.html#cb774-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKpower)</span>
<span id="cb774-2"><a href="modchapter.html#cb774-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sim.power.wilcox.test</span>(<span class="at">nx =</span> <span class="dv">10</span>, <span class="at">rx =</span> rnorm, <span class="at">rx.H0 =</span> rnorm,</span>
<span id="cb774-3"><a href="modchapter.html#cb774-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ny =</span> <span class="dv">15</span>,</span>
<span id="cb774-4"><a href="modchapter.html#cb774-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ry =</span> <span class="cf">function</span>(x) { <span class="fu">rnorm</span>(x, <span class="at">mean =</span> <span class="dv">2</span>) }, </span>
<span id="cb774-5"><a href="modchapter.html#cb774-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ry.H0 =</span> rnorm)</span></code></pre></div>
</div>
<div id="simadvice" class="section level3 hasAnchor" number="7.5.5">
<h3><span class="header-section-number">7.5.5</span> Some advice on simulation studies<a href="modchapter.html#simadvice" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are two things that you need to decide when performing a simulation study:</p>
<ul>
<li>How many <em>scenarios</em> to include, i.e. how many different settings for the model parameters to study, and</li>
<li>How many <em>iterations</em> to use, i.e. how many simulated samples to create for each scenario.</li>
</ul>
<p>The number of scenarios is typically determined by what the purpose of the study is. If you only are looking to compare two tests for a particular sample size and a particular difference in means, then maybe you only need that one scenario. On the other hand, if you want to know which of the two tests that is preferable in general, or for different sample sizes, or for different types of distributions, then you need to cover more scenarios. In that case, the number of scenarios may well be determined by how much time you have available or how many you can fit into your report.</p>
<p>As for the number of iterations to run, that also partially comes down to computational power. If each iteration takes a long while to run, it may not be feasible to run tens of thousands of iterations (some advice for speeding up simulations by using parallelisation can be found in Section <a href="advancedchapter.html#parallel">10.2</a>). In the best of all possible worlds, you have enough computational power available, and can choose the number of iterations freely. In such cases, it is often a good idea to use confidence intervals to quantify the uncertainty in your estimate of power, bias, or whatever it is that you are studying. For instance, the power of a test is estimated as the proportion of simulations in which the null hypothesis was rejected. This is a binomial experiment, and a confidence interval for the power can be obtained using the methods described in Section <a href="modchapter.html#confprop">7.3.4</a>. Moreover, the <code>ssize.propCI</code> function described in said section can be used to determine the number of simulations that you need to obtain a confidence interval that is short enough for you to feel that you have a good idea about the actual power of the test.</p>
<p>As an example, if a small pilot simulation indicates that the power is about 0.8 and you want a confidence interval with width 0.01, the number of simulations needed can be computed as follows:</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="modchapter.html#cb775-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKpower)</span>
<span id="cb775-2"><a href="modchapter.html#cb775-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ssize.propCI</span>(<span class="at">prop =</span> <span class="fl">0.8</span>, <span class="at">width =</span> <span class="fl">0.01</span>, <span class="at">method =</span> <span class="st">&quot;wilson&quot;</span>)</span></code></pre></div>
<p>In this case, you’d need 24,592 iterations to obtain the desired accuracy.</p>
</div>
</div>
<div id="sscus" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Sample size computations using simulation<a href="modchapter.html#sscus" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Using simulation to compare statistical methods is a key tool in methodological statistical research and when assessing new methods. In applied statistics, a use of simulation that is just as important is sample size computations. In this section we’ll have a look at how simulations can be useful in determining sample sizes.</p>
<div id="simcorpower" class="section level3 hasAnchor" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Writing your own simulation<a href="modchapter.html#simcorpower" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose that we want to perform a correlation test and want to know how many observations we need to collect. As in the previous section, we can write a function to compute the power of the test:</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="modchapter.html#cb776-1" aria-hidden="true" tabindex="-1"></a>simulate_power <span class="ot">&lt;-</span> <span class="cf">function</span>(n, distr, <span class="at">level =</span> <span class="fl">0.05</span>, <span class="at">B =</span> <span class="dv">999</span>, ...)</span>
<span id="cb776-2"><a href="modchapter.html#cb776-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb776-3"><a href="modchapter.html#cb776-3" aria-hidden="true" tabindex="-1"></a>      p_values <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, B)</span>
<span id="cb776-4"><a href="modchapter.html#cb776-4" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb776-5"><a href="modchapter.html#cb776-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Start progress bar:</span></span>
<span id="cb776-6"><a href="modchapter.html#cb776-6" aria-hidden="true" tabindex="-1"></a>      pbar <span class="ot">&lt;-</span> <span class="fu">txtProgressBar</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> B, <span class="at">style =</span> <span class="dv">3</span>)</span>
<span id="cb776-7"><a href="modchapter.html#cb776-7" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb776-8"><a href="modchapter.html#cb776-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B)</span>
<span id="cb776-9"><a href="modchapter.html#cb776-9" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb776-10"><a href="modchapter.html#cb776-10" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Generate bivariate data:</span></span>
<span id="cb776-11"><a href="modchapter.html#cb776-11" aria-hidden="true" tabindex="-1"></a>            x <span class="ot">&lt;-</span> <span class="fu">distr</span>(n)</span>
<span id="cb776-12"><a href="modchapter.html#cb776-12" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb776-13"><a href="modchapter.html#cb776-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Compute p-values:</span></span>
<span id="cb776-14"><a href="modchapter.html#cb776-14" aria-hidden="true" tabindex="-1"></a>            p_values[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x[,<span class="dv">1</span>], x[,<span class="dv">2</span>], ...)<span class="sc">$</span>p.value</span>
<span id="cb776-15"><a href="modchapter.html#cb776-15" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb776-16"><a href="modchapter.html#cb776-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Update progress bar:</span></span>
<span id="cb776-17"><a href="modchapter.html#cb776-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">setTxtProgressBar</span>(pbar, i)</span>
<span id="cb776-18"><a href="modchapter.html#cb776-18" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb776-19"><a href="modchapter.html#cb776-19" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb776-20"><a href="modchapter.html#cb776-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">close</span>(pbar)</span>
<span id="cb776-21"><a href="modchapter.html#cb776-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb776-22"><a href="modchapter.html#cb776-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">mean</span>(p_values <span class="sc">&lt;</span> level))</span>
<span id="cb776-23"><a href="modchapter.html#cb776-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Under the null hypothesis of no correlation, the correlation coefficient is 0. We want to find a sample size that will give us 90 % power at the 5 % significance level, for different hypothesised correlations. We will generate data from a bivariate normal distribution, because it allows us to easily set the correlation of the generated data. Note that the mean and variance of the marginal normal distributions are nuisance variables, which can be set to 0 and 1, respectively, without loss of generality (because the correlation test is invariant under scaling and shifts in location).</p>
<p>First, let’s try our power simulation function:</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="modchapter.html#cb777-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># Contains mvrnorm function for generating data</span></span>
<span id="cb777-2"><a href="modchapter.html#cb777-2" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># The correlation between the variables</span></span>
<span id="cb777-3"><a href="modchapter.html#cb777-3" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb777-4"><a href="modchapter.html#cb777-4" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, rho, rho, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb777-5"><a href="modchapter.html#cb777-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb777-6"><a href="modchapter.html#cb777-6" aria-hidden="true" tabindex="-1"></a><span class="fu">simulate_power</span>(<span class="dv">50</span>, <span class="cf">function</span>(n) { <span class="fu">mvrnorm</span>(n, mu, Sigma) }, <span class="at">B =</span> <span class="dv">999</span>)</span></code></pre></div>
<p>To find the sample size we need, we will write a new function containing a <code>while</code> loop (see Section <a href="progchapter.html#whileloop">6.4.5</a>), that performs the simulation for increasing values of <span class="math inline">\(n\)</span> until the test has achieved the desired power:</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="modchapter.html#cb778-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb778-2"><a href="modchapter.html#cb778-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb778-3"><a href="modchapter.html#cb778-3" aria-hidden="true" tabindex="-1"></a>power.cor.test <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n_start =</span> <span class="dv">10</span>, rho, <span class="at">n_incr =</span> <span class="dv">5</span>, <span class="at">power =</span> <span class="fl">0.9</span>,</span>
<span id="cb778-4"><a href="modchapter.html#cb778-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">B =</span> <span class="dv">999</span>, ...)</span>
<span id="cb778-5"><a href="modchapter.html#cb778-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb778-6"><a href="modchapter.html#cb778-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set parameters for the multivariate normal distribution:</span></span>
<span id="cb778-7"><a href="modchapter.html#cb778-7" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb778-8"><a href="modchapter.html#cb778-8" aria-hidden="true" tabindex="-1"></a>    Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, rho, rho, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb778-9"><a href="modchapter.html#cb778-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb778-10"><a href="modchapter.html#cb778-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set initial values</span></span>
<span id="cb778-11"><a href="modchapter.html#cb778-11" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> n_start</span>
<span id="cb778-12"><a href="modchapter.html#cb778-12" aria-hidden="true" tabindex="-1"></a>    power_cor <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb778-13"><a href="modchapter.html#cb778-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb778-14"><a href="modchapter.html#cb778-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check power for different sample sizes:</span></span>
<span id="cb778-15"><a href="modchapter.html#cb778-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span>(power_cor <span class="sc">&lt;</span> power)</span>
<span id="cb778-16"><a href="modchapter.html#cb778-16" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb778-17"><a href="modchapter.html#cb778-17" aria-hidden="true" tabindex="-1"></a>        power_cor <span class="ot">&lt;-</span> <span class="fu">simulate_power</span>(n,</span>
<span id="cb778-18"><a href="modchapter.html#cb778-18" aria-hidden="true" tabindex="-1"></a>                               <span class="cf">function</span>(n) { <span class="fu">mvrnorm</span>(n, mu, Sigma) },</span>
<span id="cb778-19"><a href="modchapter.html#cb778-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">B =</span> B, ...)</span>
<span id="cb778-20"><a href="modchapter.html#cb778-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;n =&quot;</span>, n, <span class="st">&quot; - Power:&quot;</span>, power_cor, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb778-21"><a href="modchapter.html#cb778-21" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> n <span class="sc">+</span> n_incr</span>
<span id="cb778-22"><a href="modchapter.html#cb778-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb778-23"><a href="modchapter.html#cb778-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb778-24"><a href="modchapter.html#cb778-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the result:</span></span>
<span id="cb778-25"><a href="modchapter.html#cb778-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">When n =&quot;</span>, n, <span class="st">&quot;the power is&quot;</span>, <span class="fu">round</span>(power_cor, <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb778-26"><a href="modchapter.html#cb778-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(n)</span>
<span id="cb778-27"><a href="modchapter.html#cb778-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s try it out with different settings:</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="modchapter.html#cb779-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power.cor.test</span>(<span class="at">n_start =</span> <span class="dv">10</span>, <span class="at">rho =</span> <span class="fl">0.5</span>, <span class="at">power =</span> <span class="fl">0.9</span>)</span>
<span id="cb779-2"><a href="modchapter.html#cb779-2" aria-hidden="true" tabindex="-1"></a><span class="fu">power.cor.test</span>(<span class="at">n_start =</span> <span class="dv">10</span>, <span class="at">rho =</span> <span class="fl">0.2</span>, <span class="at">power =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p>As expected, larger sample sizes are required to detect smaller correlations.</p>
</div>
<div id="the-wilcoxon-mann-whitney-test" class="section level3 hasAnchor" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> The Wilcoxon-Mann-Whitney test<a href="modchapter.html#the-wilcoxon-mann-whitney-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>sim.ssize.wilcox.test</code> in <code>MKpower</code> can be used to quickly perform sample size computations for the Wilcoxon-Mann-Whitney test, analogously to how we used <code>sim.power.wilcox.test</code> in Section <a href="modchapter.html#powerlocation">7.5.4</a>:</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="modchapter.html#cb780-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKpower)</span>
<span id="cb780-2"><a href="modchapter.html#cb780-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sim.ssize.wilcox.test</span>(<span class="at">rx =</span> rnorm, <span class="at">ry =</span> <span class="cf">function</span>(x) <span class="fu">rnorm</span>(x, <span class="at">mean =</span> <span class="dv">2</span>), </span>
<span id="cb780-3"><a href="modchapter.html#cb780-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">power =</span> <span class="fl">0.8</span>, <span class="at">n.min =</span> <span class="dv">3</span>, <span class="at">n.max =</span> <span class="dv">10</span>,</span>
<span id="cb780-4"><a href="modchapter.html#cb780-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">step.size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><span class="math display">\[\sim\]</span>
::: {.exercise #ch7exc12}
Modify the functions we used to compute the sample sizes for the Pearson correlation test to instead compute sample sizes for the Spearman correlation tests. For bivariate normal data, are the required sample sizes lower or higher than those of the Pearson correlation test?</p>
<p>:::
<a href="solutions.html#ch7solutions12">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch7excCP" class="exercise"><strong>Exercise 7.15  </strong></span>In Section <a href="modchapter.html#confprop">7.3.4</a> we had a look at some confidence intervals for proportions, and saw how <code>ssize.propCI</code> can be used to compute sample sizes for such intervals using asymptotic approximations. Write a function to compute the exact sample size needed for the Clopper-Pearson interval to achieve a desired expected (average) width. Compare your results to those from the asymptotic approximations. Are the approximations good enough to be useful?</p>
</div>
<p><a href="solutions.html#ch7solutionsCP">(Click here to go to the solution.)</a></p>
</div>
</div>
<div id="bootstrap" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Bootstrapping<a href="modchapter.html#bootstrap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The bootstrap can be used formany things, most notably for constructing confidence intervals and running hypothesis tests. These tend to perform better than traditional parametric methods, such as the old-school t-test and its associated confidence interval, when the distributional assumptions of the parametric methods aren’t met.</p>
<p>Confidence intervals and hypothesis tests are always based on a <em>statistic</em>, i.e. a quantity that we compute from the samples. The statistic could be the sample mean, a proportion, the Pearson correlation coefficient, or something else. In traditional parametric methods, we start by assuming that our data follows some distribution. For different reasons, including mathematical tractability, a common assumption is that the data is normally distributed. Under that assumption, we can then derive the distribution of the statistic that we are interested in analytically, like Gosset did for the t-test. That distribution can then be used to compute confidence intervals and p-values.</p>
<p>When using a bootstrap method, we follow the same steps, but use the observed data and simulation instead. Rather than making assumptions about the distribution<a href="#fn53" class="footnote-ref" id="fnref53"><sup>53</sup></a>, we use the empirical distribution of the data. Instead of analytically deriving a formula that describes the statistic’s distribution, we find a good approximation of the distribution of the statistic by using simulation. We can then use that distribution to obtain confidence intervals and p-values, just as in the parametric case.</p>
<p>The simulation step is important. We use a process known as <em>resampling</em>, where we repeatedly draw new observations <em>with replacement</em> from the original sample. We draw <span class="math inline">\(B\)</span> samples this way, each with the same size <span class="math inline">\(n\)</span> as the original sample. Each randomly drawn sample - called a <em>bootstrap sample</em> - will include different observations. Some observations from the original sample may appear more than once in a specific bootstrap sample, and some not at all. For each bootstrap sample, we compute the statistic in which we are interested. This gives us <span class="math inline">\(B\)</span> observations of this statistic, which together form what is called the <em>bootstrap distribution</em> of the statistic. I recommend using <span class="math inline">\(B=9,999\)</span> or greater, but we’ll use smaller <span class="math inline">\(B\)</span> in some examples, to speed up the computations.</p>
<div id="a-general-approach" class="section level3 hasAnchor" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> A general approach<a href="modchapter.html#a-general-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Pearson correlation test is known to be sensitive to deviations from normality. We can construct a more robust version of it using the bootstrap. To illustrate the procedure, we will use the <code>sleep_total</code> and <code>brainwt</code> variables from the <code>msleep</code> data. Here is the result from the traditional parametric Pearson correlation test:</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="modchapter.html#cb781-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb781-2"><a href="modchapter.html#cb781-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb781-3"><a href="modchapter.html#cb781-3" aria-hidden="true" tabindex="-1"></a>msleep <span class="sc">%$%</span> <span class="fu">cor.test</span>(sleep_total, brainwt, <span class="at">use =</span> <span class="st">&quot;pairwise.complete&quot;</span>)</span></code></pre></div>
<p>To find the bootstrap distribution of the Pearson correlation coefficient, we can use resampling with a <code>for</code> loop (Section <a href="progchapter.html#forloops">6.4.1</a>):</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="modchapter.html#cb782-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the data that we are interested in:</span></span>
<span id="cb782-2"><a href="modchapter.html#cb782-2" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(msleep[,<span class="fu">c</span>(<span class="st">&quot;sleep_total&quot;</span>, <span class="st">&quot;brainwt&quot;</span>)])</span>
<span id="cb782-3"><a href="modchapter.html#cb782-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb782-4"><a href="modchapter.html#cb782-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Resampling using a for loop:</span></span>
<span id="cb782-5"><a href="modchapter.html#cb782-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co"># Number of bootstrap samples</span></span>
<span id="cb782-6"><a href="modchapter.html#cb782-6" aria-hidden="true" tabindex="-1"></a>statistic <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, B)</span>
<span id="cb782-7"><a href="modchapter.html#cb782-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B)</span>
<span id="cb782-8"><a href="modchapter.html#cb782-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb782-9"><a href="modchapter.html#cb782-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Draw row numbers for the bootstrap sample:</span></span>
<span id="cb782-10"><a href="modchapter.html#cb782-10" aria-hidden="true" tabindex="-1"></a>      row_numbers <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mydata), <span class="fu">nrow</span>(mydata),</span>
<span id="cb782-11"><a href="modchapter.html#cb782-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb782-12"><a href="modchapter.html#cb782-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb782-13"><a href="modchapter.html#cb782-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Obtain the bootstrap sample:</span></span>
<span id="cb782-14"><a href="modchapter.html#cb782-14" aria-hidden="true" tabindex="-1"></a>      sample <span class="ot">&lt;-</span> mydata[row_numbers,]</span>
<span id="cb782-15"><a href="modchapter.html#cb782-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb782-16"><a href="modchapter.html#cb782-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Compute the statistic for the bootstrap sample:</span></span>
<span id="cb782-17"><a href="modchapter.html#cb782-17" aria-hidden="true" tabindex="-1"></a>      statistic[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(sample[, <span class="dv">1</span>], sample[, <span class="dv">2</span>])</span>
<span id="cb782-18"><a href="modchapter.html#cb782-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb782-19"><a href="modchapter.html#cb782-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb782-20"><a href="modchapter.html#cb782-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the bootstrap distribution of the statistic:</span></span>
<span id="cb782-21"><a href="modchapter.html#cb782-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(statistic), <span class="fu">aes</span>(statistic)) <span class="sc">+</span></span>
<span id="cb782-22"><a href="modchapter.html#cb782-22" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_histogram</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p>Because this is such a common procedure, there are R packages that let’s us do resampling without having to write a <code>for</code> loop. In the remainder of the section, we will use the <code>boot</code> package to draw bootstrap samples. It also contains convenience functions that allows us to get confidence intervals from the bootstrap distribution quickly. Let’s install it:</p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="modchapter.html#cb783-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;boot&quot;</span>)</span></code></pre></div>
<p>The most important function in this package is <code>boot</code>, which does the resampling. As input, it takes the original data, the number <span class="math inline">\(B\)</span> of bootstrap samples to draw (called <code>R</code> here), and a function that computes the statistic of interest. This function should take the original data (<code>mydata</code> in our example above) and the row numbers of the sampled observation for a particular bootstrap sample (<code>row_numbers</code> in our example) as input.</p>
<p>For the correlation coefficient, the function that we input can look like this:</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="modchapter.html#cb784-1" aria-hidden="true" tabindex="-1"></a>cor_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, row_numbers, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb784-2"><a href="modchapter.html#cb784-2" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb784-3"><a href="modchapter.html#cb784-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Obtain the bootstrap sample:</span></span>
<span id="cb784-4"><a href="modchapter.html#cb784-4" aria-hidden="true" tabindex="-1"></a>    sample <span class="ot">&lt;-</span> data[row_numbers,]</span>
<span id="cb784-5"><a href="modchapter.html#cb784-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb784-6"><a href="modchapter.html#cb784-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute and return the statistic for the bootstrap sample:</span></span>
<span id="cb784-7"><a href="modchapter.html#cb784-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">cor</span>(sample[, <span class="dv">1</span>], sample[, <span class="dv">2</span>], <span class="at">method =</span> method))</span>
<span id="cb784-8"><a href="modchapter.html#cb784-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>To get the bootstrap distribution of the Pearson correlation coefficient for our data, we can now use <code>boot</code> as follows:</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="modchapter.html#cb785-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb785-2"><a href="modchapter.html#cb785-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb785-3"><a href="modchapter.html#cb785-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Base solution:</span></span>
<span id="cb785-4"><a href="modchapter.html#cb785-4" aria-hidden="true" tabindex="-1"></a>boot_res <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="fu">na.omit</span>(msleep[,<span class="fu">c</span>(<span class="st">&quot;sleep_total&quot;</span>, <span class="st">&quot;brainwt&quot;</span>)]),</span>
<span id="cb785-5"><a href="modchapter.html#cb785-5" aria-hidden="true" tabindex="-1"></a>                 cor_boot,</span>
<span id="cb785-6"><a href="modchapter.html#cb785-6" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">999</span>)</span></code></pre></div>
<p>Next, we can plot the bootstrap distribution of the statistic computed in <code>cor_boot</code>:</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="modchapter.html#cb786-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(boot_res)</span></code></pre></div>
<p>If you prefer, you can of course use a pipeline for the resampling instead:</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="modchapter.html#cb787-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb787-2"><a href="modchapter.html#cb787-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb787-3"><a href="modchapter.html#cb787-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb787-4"><a href="modchapter.html#cb787-4" aria-hidden="true" tabindex="-1"></a><span class="co"># With pipes:</span></span>
<span id="cb787-5"><a href="modchapter.html#cb787-5" aria-hidden="true" tabindex="-1"></a>msleep <span class="sc">%&gt;%</span> <span class="fu">select</span>(sleep_total, brainwt) <span class="sc">%&gt;%</span> </span>
<span id="cb787-6"><a href="modchapter.html#cb787-6" aria-hidden="true" tabindex="-1"></a>      drop_na <span class="sc">%&gt;%</span> </span>
<span id="cb787-7"><a href="modchapter.html#cb787-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">boot</span>(cor_boot, <span class="dv">999</span>) <span class="ot">-&gt;</span> boot_res</span></code></pre></div>
</div>
<div id="bootstrap-confidence-intervals" class="section level3 hasAnchor" number="7.7.2">
<h3><span class="header-section-number">7.7.2</span> Bootstrap confidence intervals<a href="modchapter.html#bootstrap-confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The next step is to use <code>boot.ci</code> to compute bootstrap confidence intervals. This is as simple as running:</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="modchapter.html#cb788-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(boot_res)</span></code></pre></div>
<p>Four intervals are presented: normal, basic, percentile and BCa. The details concerning how these are computed based on the bootstrap distribution are presented in Section <a href="mathschap.html#bootstrapcimaths">12.1</a>. It is generally agreed that the percentile and BCa intervals are preferable to the normal and basic intervals; see e.g. Davison &amp; Hinkley (1997) and Hall (1992); but which performs the best varies.</p>
<p>We also receive a warning message:</p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="modchapter.html#cb789-1" aria-hidden="true" tabindex="-1"></a>Warning message<span class="sc">:</span></span>
<span id="cb789-2"><a href="modchapter.html#cb789-2" aria-hidden="true" tabindex="-1"></a>In <span class="fu">boot.ci</span>(boot_res) <span class="sc">:</span> bootstrap variances needed <span class="cf">for</span> studentized</span>
<span id="cb789-3"><a href="modchapter.html#cb789-3" aria-hidden="true" tabindex="-1"></a>intervals</span></code></pre></div>
<p>A fifth type of confidence interval, the studentised interval, requires bootstrap estimates of the standard error of the test statistic. These are obtained by running an <em>inner bootstrap</em>, i.e. by bootstrapping each bootstrap sample to get estimates of the variance of the test statistic. Let’s create a new function that does this, and then compute the bootstrap confidence intervals:</p>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="modchapter.html#cb790-1" aria-hidden="true" tabindex="-1"></a>cor_boot_student <span class="ot">&lt;-</span> <span class="cf">function</span>(data, i, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb790-2"><a href="modchapter.html#cb790-2" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb790-3"><a href="modchapter.html#cb790-3" aria-hidden="true" tabindex="-1"></a>    sample <span class="ot">&lt;-</span> data[i,]</span>
<span id="cb790-4"><a href="modchapter.html#cb790-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb790-5"><a href="modchapter.html#cb790-5" aria-hidden="true" tabindex="-1"></a>    correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(sample[, <span class="dv">1</span>], sample[, <span class="dv">2</span>], <span class="at">method =</span> method)</span>
<span id="cb790-6"><a href="modchapter.html#cb790-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb790-7"><a href="modchapter.html#cb790-7" aria-hidden="true" tabindex="-1"></a>    inner_boot <span class="ot">&lt;-</span> <span class="fu">boot</span>(sample, cor_boot, <span class="dv">100</span>)</span>
<span id="cb790-8"><a href="modchapter.html#cb790-8" aria-hidden="true" tabindex="-1"></a>    variance <span class="ot">&lt;-</span> <span class="fu">var</span>(inner_boot<span class="sc">$</span>t)</span>
<span id="cb790-9"><a href="modchapter.html#cb790-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-10"><a href="modchapter.html#cb790-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(correlation, variance))</span>
<span id="cb790-11"><a href="modchapter.html#cb790-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb790-12"><a href="modchapter.html#cb790-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-13"><a href="modchapter.html#cb790-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb790-14"><a href="modchapter.html#cb790-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb790-15"><a href="modchapter.html#cb790-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-16"><a href="modchapter.html#cb790-16" aria-hidden="true" tabindex="-1"></a>boot_res <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="fu">na.omit</span>(msleep[,<span class="fu">c</span>(<span class="st">&quot;sleep_total&quot;</span>, <span class="st">&quot;brainwt&quot;</span>)]),</span>
<span id="cb790-17"><a href="modchapter.html#cb790-17" aria-hidden="true" tabindex="-1"></a>                 cor_boot_student,</span>
<span id="cb790-18"><a href="modchapter.html#cb790-18" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">999</span>)</span>
<span id="cb790-19"><a href="modchapter.html#cb790-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-20"><a href="modchapter.html#cb790-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Show bootstrap distribution:</span></span>
<span id="cb790-21"><a href="modchapter.html#cb790-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(boot_res)</span>
<span id="cb790-22"><a href="modchapter.html#cb790-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-23"><a href="modchapter.html#cb790-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute confidence intervals - including studentised:</span></span>
<span id="cb790-24"><a href="modchapter.html#cb790-24" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(boot_res)</span></code></pre></div>
<p>While theoretically appealing (Hall, 1992), studentised intervals can be a little erratic in practice. I prefer to use percentile and BCa intervals instead.</p>
<p>For two-sample problems, we need to make sure that the number of observations drawn from each sample is the same as in the original data. The <code>strata</code> argument in <code>boot</code> is used to achieve this. Let’s return to the example studied in Section <a href="modchapter.html#ttest">7.2</a>, concerning the difference in how long carnivores and herbivores sleep. Let’s say that we want a confidence interval for the difference of two means, using the <code>msleep</code> data. The simplest approach is to create a Welch-type interval, where we allow the two populations to have different variances. We can then resample from each population separately:</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="modchapter.html#cb791-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function that computes the mean for each group:</span></span>
<span id="cb791-2"><a href="modchapter.html#cb791-2" aria-hidden="true" tabindex="-1"></a>mean_diff_msleep <span class="ot">&lt;-</span> <span class="cf">function</span>(data, i)</span>
<span id="cb791-3"><a href="modchapter.html#cb791-3" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb791-4"><a href="modchapter.html#cb791-4" aria-hidden="true" tabindex="-1"></a>    sample1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(data[i, <span class="dv">1</span>], data[i, <span class="dv">2</span>] <span class="sc">==</span> <span class="st">&quot;carni&quot;</span>)</span>
<span id="cb791-5"><a href="modchapter.html#cb791-5" aria-hidden="true" tabindex="-1"></a>    sample2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(data[i, <span class="dv">1</span>], data[i, <span class="dv">2</span>] <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>)</span>
<span id="cb791-6"><a href="modchapter.html#cb791-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(sample1[[<span class="dv">1</span>]]) <span class="sc">-</span> <span class="fu">mean</span>(sample2[[<span class="dv">1</span>]]))</span>
<span id="cb791-7"><a href="modchapter.html#cb791-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb791-8"><a href="modchapter.html#cb791-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb791-9"><a href="modchapter.html#cb791-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># Load the data</span></span>
<span id="cb791-10"><a href="modchapter.html#cb791-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)    <span class="co"># Load bootstrap functions</span></span>
<span id="cb791-11"><a href="modchapter.html#cb791-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb791-12"><a href="modchapter.html#cb791-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data set to resample from:</span></span>
<span id="cb791-13"><a href="modchapter.html#cb791-13" aria-hidden="true" tabindex="-1"></a>boot_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">subset</span>(msleep,</span>
<span id="cb791-14"><a href="modchapter.html#cb791-14" aria-hidden="true" tabindex="-1"></a>              vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span> <span class="sc">|</span> vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>)[,<span class="fu">c</span>(<span class="st">&quot;sleep_total&quot;</span>,</span>
<span id="cb791-15"><a href="modchapter.html#cb791-15" aria-hidden="true" tabindex="-1"></a>                                                          <span class="st">&quot;vore&quot;</span>)])</span>
<span id="cb791-16"><a href="modchapter.html#cb791-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Do the resampling - we specify that we want resampling from two</span></span>
<span id="cb791-17"><a href="modchapter.html#cb791-17" aria-hidden="true" tabindex="-1"></a><span class="co"># populations by using strata:</span></span>
<span id="cb791-18"><a href="modchapter.html#cb791-18" aria-hidden="true" tabindex="-1"></a>boot_res <span class="ot">&lt;-</span> <span class="fu">boot</span>(boot_data,</span>
<span id="cb791-19"><a href="modchapter.html#cb791-19" aria-hidden="true" tabindex="-1"></a>                 mean_diff_msleep,</span>
<span id="cb791-20"><a href="modchapter.html#cb791-20" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">999</span>,</span>
<span id="cb791-21"><a href="modchapter.html#cb791-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">strata =</span> <span class="fu">factor</span>(boot_data<span class="sc">$</span>vore))</span>
<span id="cb791-22"><a href="modchapter.html#cb791-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb791-23"><a href="modchapter.html#cb791-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute confidence intervals:</span></span>
<span id="cb791-24"><a href="modchapter.html#cb791-24" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(boot_res, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch7exc13" class="exercise"><strong>Exercise 7.16  </strong></span>Let’s continue the example with a confidence interval for the difference in how long carnivores and herbivores sleep. How can you create a confidence interval under the assumption that the two groups have equal variances?</p>
</div>
<p><a href="solutions.html#ch7solutions13">(Click here to go to the solution.)</a></p>
</div>
<div id="intervalinversion" class="section level3 hasAnchor" number="7.7.3">
<h3><span class="header-section-number">7.7.3</span> Bootstrap hypothesis tests<a href="modchapter.html#intervalinversion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Writing code for bootstrap hypothesis tests can be a little tricky, because the resampling must be done <em>under the null hypothesis</em>. The process is greatly simplified by computing p-values using <em>confidence interval inversion</em> instead. This approach exploits the equivalence between confidence intervals and hypothesis tests, detailed in Section <a href="mathschap.html#confintequal">12.2</a>. It relies on the fact that:</p>
<ul>
<li>The p-value of the test for the parameter <span class="math inline">\(\theta\)</span> is the smallest <span class="math inline">\(\alpha\)</span> such that <span class="math inline">\(\theta\)</span> is not contained in the corresponding <span class="math inline">\(1-\alpha\)</span> confidence interval.</li>
<li>For a test for the parameter <span class="math inline">\(\theta\)</span> with significance level <span class="math inline">\(\alpha\)</span>, the set of values of <span class="math inline">\(\theta\)</span> that aren’t rejected by the test (when used as the null hypothesis) is a <span class="math inline">\(1-\alpha\)</span> confidence interval for <span class="math inline">\(\theta\)</span>.</li>
</ul>
<p>Here is an example of how we can use a <code>while</code> loop (Section <a href="progchapter.html#whileloop">6.4.5</a>) for confidence interval inversion, in order to test the null hypothesis that the Pearson correlation between sleeping time and brain weight is <span class="math inline">\(\rho=-0.2\)</span>. It uses the studentised confidence interval that we created in the previous section:</p>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="modchapter.html#cb792-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the studentised confidence interval:</span></span>
<span id="cb792-2"><a href="modchapter.html#cb792-2" aria-hidden="true" tabindex="-1"></a>cor_boot_student <span class="ot">&lt;-</span> <span class="cf">function</span>(data, i, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb792-3"><a href="modchapter.html#cb792-3" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb792-4"><a href="modchapter.html#cb792-4" aria-hidden="true" tabindex="-1"></a>    sample <span class="ot">&lt;-</span> data[i,]</span>
<span id="cb792-5"><a href="modchapter.html#cb792-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb792-6"><a href="modchapter.html#cb792-6" aria-hidden="true" tabindex="-1"></a>    correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(sample[, <span class="dv">1</span>], sample[, <span class="dv">2</span>], <span class="at">method =</span> method)</span>
<span id="cb792-7"><a href="modchapter.html#cb792-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb792-8"><a href="modchapter.html#cb792-8" aria-hidden="true" tabindex="-1"></a>    inner_boot <span class="ot">&lt;-</span> <span class="fu">boot</span>(sample, cor_boot, <span class="dv">100</span>)</span>
<span id="cb792-9"><a href="modchapter.html#cb792-9" aria-hidden="true" tabindex="-1"></a>    variance <span class="ot">&lt;-</span> <span class="fu">var</span>(inner_boot<span class="sc">$</span>t)</span>
<span id="cb792-10"><a href="modchapter.html#cb792-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-11"><a href="modchapter.html#cb792-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(correlation, variance))</span>
<span id="cb792-12"><a href="modchapter.html#cb792-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb792-13"><a href="modchapter.html#cb792-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-14"><a href="modchapter.html#cb792-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb792-15"><a href="modchapter.html#cb792-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb792-16"><a href="modchapter.html#cb792-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-17"><a href="modchapter.html#cb792-17" aria-hidden="true" tabindex="-1"></a>boot_res <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="fu">na.omit</span>(msleep[,<span class="fu">c</span>(<span class="st">&quot;sleep_total&quot;</span>, <span class="st">&quot;brainwt&quot;</span>)]),</span>
<span id="cb792-18"><a href="modchapter.html#cb792-18" aria-hidden="true" tabindex="-1"></a>                 cor_boot_student,</span>
<span id="cb792-19"><a href="modchapter.html#cb792-19" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">999</span>)</span>
<span id="cb792-20"><a href="modchapter.html#cb792-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-21"><a href="modchapter.html#cb792-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, a hypothesis test:</span></span>
<span id="cb792-22"><a href="modchapter.html#cb792-22" aria-hidden="true" tabindex="-1"></a><span class="co"># The null hypothesis:</span></span>
<span id="cb792-23"><a href="modchapter.html#cb792-23" aria-hidden="true" tabindex="-1"></a>rho_null <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.2</span></span>
<span id="cb792-24"><a href="modchapter.html#cb792-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-25"><a href="modchapter.html#cb792-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Set initial conditions:</span></span>
<span id="cb792-26"><a href="modchapter.html#cb792-26" aria-hidden="true" tabindex="-1"></a>in_interval <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb792-27"><a href="modchapter.html#cb792-27" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb792-28"><a href="modchapter.html#cb792-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-29"><a href="modchapter.html#cb792-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the lowest alpha for which rho_null is in the interval:</span></span>
<span id="cb792-30"><a href="modchapter.html#cb792-30" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(in_interval)</span>
<span id="cb792-31"><a href="modchapter.html#cb792-31" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb792-32"><a href="modchapter.html#cb792-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Increase alpha a small step:</span></span>
<span id="cb792-33"><a href="modchapter.html#cb792-33" aria-hidden="true" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> alpha <span class="sc">+</span> <span class="fl">0.001</span></span>
<span id="cb792-34"><a href="modchapter.html#cb792-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb792-35"><a href="modchapter.html#cb792-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the 1-alpha confidence interval, and extract</span></span>
<span id="cb792-36"><a href="modchapter.html#cb792-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># its bounds:</span></span>
<span id="cb792-37"><a href="modchapter.html#cb792-37" aria-hidden="true" tabindex="-1"></a>    interval <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_res, </span>
<span id="cb792-38"><a href="modchapter.html#cb792-38" aria-hidden="true" tabindex="-1"></a>                        <span class="at">conf =</span> <span class="dv">1</span> <span class="sc">-</span> alpha,</span>
<span id="cb792-39"><a href="modchapter.html#cb792-39" aria-hidden="true" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&quot;stud&quot;</span>)<span class="sc">$</span>student[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb792-40"><a href="modchapter.html#cb792-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb792-41"><a href="modchapter.html#cb792-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the null value for rho is greater than the lower</span></span>
<span id="cb792-42"><a href="modchapter.html#cb792-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># interval bound and smaller than the upper interval bound,</span></span>
<span id="cb792-43"><a href="modchapter.html#cb792-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># i.e. if it is contained in the interval:</span></span>
<span id="cb792-44"><a href="modchapter.html#cb792-44" aria-hidden="true" tabindex="-1"></a>    in_interval <span class="ot">&lt;-</span> rho_null <span class="sc">&gt;</span> interval[<span class="dv">1</span>] <span class="sc">&amp;</span> rho_null <span class="sc">&lt;</span> interval[<span class="dv">2</span>]</span>
<span id="cb792-45"><a href="modchapter.html#cb792-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb792-46"><a href="modchapter.html#cb792-46" aria-hidden="true" tabindex="-1"></a><span class="co"># The loop will finish as soon as it reaches a value of alpha such</span></span>
<span id="cb792-47"><a href="modchapter.html#cb792-47" aria-hidden="true" tabindex="-1"></a><span class="co"># that rho_null is not contained in the interval.</span></span>
<span id="cb792-48"><a href="modchapter.html#cb792-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-49"><a href="modchapter.html#cb792-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the p-value:</span></span>
<span id="cb792-50"><a href="modchapter.html#cb792-50" aria-hidden="true" tabindex="-1"></a>alpha</span></code></pre></div>
<p>The <code>boot.pval</code> package contains a function computing p-values through inversion of bootstrap confidence intervals. We can use it to obtain a bootstrap p-value without having to write a <code>while</code> loop. It works more or less analogously to <code>boot.ci</code>. The arguments to the <code>boot.pval</code> function is the <code>boot</code> object (<code>boot_res</code>), the type of interval to use (<code>"stud"</code>), and the value of the parameter under the null hypothesis (<code>-0.2</code>):</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="modchapter.html#cb793-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;boot.pval&quot;</span>)</span>
<span id="cb793-2"><a href="modchapter.html#cb793-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot.pval)</span>
<span id="cb793-3"><a href="modchapter.html#cb793-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.pval</span>(boot_res, <span class="at">type =</span> <span class="st">&quot;stud&quot;</span>, <span class="at">theta_null =</span> <span class="sc">-</span><span class="fl">0.2</span>)</span></code></pre></div>
<p>Confidence interval inversion fails in spectacular ways for certain tests for parameters of discrete distributions (Thulin &amp; Zwanzig, 2017), so be careful if you plan on using this approach with count data.</p>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch7exc14" class="exercise"><strong>Exercise 7.17  </strong></span>With the data from Exercise <a href="modchapter.html#exr:ch7exc13">7.16</a>, invert a percentile confidence interval to compute the p-value of the corresponding test of the null hypothesis that there is no difference in means. What are the results?</p>
</div>
<p><a href="solutions.html#ch7solutions14">(Click here to go to the solution.)</a></p>
</div>
<div id="parametricbootstrap" class="section level3 hasAnchor" number="7.7.4">
<h3><span class="header-section-number">7.7.4</span> The parametric bootstrap<a href="modchapter.html#parametricbootstrap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In some cases, we may be willing to make distributional assumptions about our data. We can then use the <em>parametric bootstrap</em>, in which the resampling is done not from the original sample, but the theorised distribution (with parameters estimated from the original sample). Here is an example for the bootstrap correlation test, where we assume a multivariate normal distribution for the data. Note that we no longer include an index as an argument in the function <code>cor_boot</code>, because the bootstrap samples won’t be drawn directly from the original data:</p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="modchapter.html#cb794-1" aria-hidden="true" tabindex="-1"></a>cor_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb794-2"><a href="modchapter.html#cb794-2" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb794-3"><a href="modchapter.html#cb794-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">cor</span>(data[, <span class="dv">1</span>], data[, <span class="dv">2</span>], <span class="at">method =</span> method))</span>
<span id="cb794-4"><a href="modchapter.html#cb794-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb794-5"><a href="modchapter.html#cb794-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb794-6"><a href="modchapter.html#cb794-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb794-7"><a href="modchapter.html#cb794-7" aria-hidden="true" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(data, mle)</span>
<span id="cb794-8"><a href="modchapter.html#cb794-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb794-9"><a href="modchapter.html#cb794-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mvrnorm</span>(<span class="fu">nrow</span>(data), mle[[<span class="dv">1</span>]], mle[[<span class="dv">2</span>]]))</span>
<span id="cb794-10"><a href="modchapter.html#cb794-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb794-11"><a href="modchapter.html#cb794-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb794-12"><a href="modchapter.html#cb794-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb794-13"><a href="modchapter.html#cb794-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb794-14"><a href="modchapter.html#cb794-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb794-15"><a href="modchapter.html#cb794-15" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(msleep[,<span class="fu">c</span>(<span class="st">&quot;sleep_total&quot;</span>, <span class="st">&quot;brainwt&quot;</span>)])</span>
<span id="cb794-16"><a href="modchapter.html#cb794-16" aria-hidden="true" tabindex="-1"></a>boot_res <span class="ot">&lt;-</span> <span class="fu">boot</span>(filtered_data,</span>
<span id="cb794-17"><a href="modchapter.html#cb794-17" aria-hidden="true" tabindex="-1"></a>                 cor_boot,</span>
<span id="cb794-18"><a href="modchapter.html#cb794-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">R =</span> <span class="dv">999</span>,</span>
<span id="cb794-19"><a href="modchapter.html#cb794-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sim =</span> <span class="st">&quot;parametric&quot;</span>,</span>
<span id="cb794-20"><a href="modchapter.html#cb794-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ran.gen =</span> generate_data,</span>
<span id="cb794-21"><a href="modchapter.html#cb794-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">mle =</span> <span class="fu">list</span>(<span class="fu">colMeans</span>(filtered_data),</span>
<span id="cb794-22"><a href="modchapter.html#cb794-22" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">cov</span>(filtered_data)))</span>
<span id="cb794-23"><a href="modchapter.html#cb794-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb794-24"><a href="modchapter.html#cb794-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Show bootstrap distribution:</span></span>
<span id="cb794-25"><a href="modchapter.html#cb794-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(boot_res)</span>
<span id="cb794-26"><a href="modchapter.html#cb794-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb794-27"><a href="modchapter.html#cb794-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute bootstrap percentile confidence interval:</span></span>
<span id="cb794-28"><a href="modchapter.html#cb794-28" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(boot_res, <span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)</span></code></pre></div>
<p>The BCa interval implemented in <code>boot.ci</code> is not valid for parametric bootstrap samples, so running <code>boot.ci(boot_res)</code> without specifying the interval <code>type</code> will render an error<a href="#fn54" class="footnote-ref" id="fnref54"><sup>54</sup></a>. Percentile intervals work just fine, though.</p>
</div>
</div>
<div id="reporting-statistical-results" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> Reporting statistical results<a href="modchapter.html#reporting-statistical-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Carrying out a statistical analysis is only the first step. After that, you probably need to communicate your results to others: your boss, your colleagues, your clients, the public… This section contains some tips for how best to do that.</p>
<div id="what-should-you-include" class="section level3 hasAnchor" number="7.8.1">
<h3><span class="header-section-number">7.8.1</span> What should you include?<a href="modchapter.html#what-should-you-include" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When reporting your results, it should always be clear:</p>
<ul>
<li>How the data was collected,</li>
<li>If, how, and why any observations were removed from the data prior to the analysis,</li>
<li>What method was used for the analysis (including a reference unless it is a routine method),</li>
<li>If any other analyses were performed/attempted on the data, and if you don’t report their results, why.</li>
</ul>
<p>Let’s say that you’ve estimate some parameter, for instance the mean sleeping time of mammals, and want to report the results. The first thing to think about is that you shouldn’t include too many decimals: don’t give the mean with 5 decimals if sleeping times only were measured with one decimal.</p>
<blockquote>
<p><strong>BAD:</strong> The mean sleeping time of mammals was found to be 10.43373.</p>
</blockquote>
<blockquote>
<p><strong>GOOD:</strong> The mean sleeping time of mammals was found to be 10.4.</p>
</blockquote>
<p>It is common to see estimates reported with standard errors or standard deviations:</p>
<blockquote>
<p><strong>BAD:</strong> The mean sleeping time of mammals was found to be 10.3 (<span class="math inline">\(\sigma=4.5\)</span>).</p>
</blockquote>
<p>or</p>
<blockquote>
<p><strong>BAD:</strong> The mean sleeping time of mammals was found to be 10.3 (standard error 0.49).</p>
</blockquote>
<p>or</p>
<blockquote>
<p><strong>BAD:</strong> The mean sleeping time of mammals was found to be <span class="math inline">\(10.3 \pm 0.49\)</span>.</p>
</blockquote>
<p>Although common, this isn’t a very good practice. Standard errors/deviations are included to give some indication of the uncertainty of the estimate, but are very difficult to interpret. In most cases, they will probably cause the reader to either overestimate or underestimate the uncertainty in your estimate. A much better option is to present the estimate with a confidence interval, which quantifies the uncertainty in the estimate in an interpretable manner:</p>
<blockquote>
<p><strong>GOOD:</strong> The mean sleeping time of mammals was found to be 10.3 (95 % percentile bootstrap confidence interval: 9.5-11.4).</p>
</blockquote>
<p>Similarly, it is common to include error bars representing standard deviations and standard errors e.g. in bar charts. This questionable practice becomes even more troublesome because a lot of people fail to indicate what the error bars represent. If you wish to include error bars in your figures, they should always represent confidence intervals, unless you have a very strong reason for them to represent something else. In the latter case, make sure that you clearly explain what the error bars represent.</p>
<p>If the purpose of your study is to describe differences between groups, you should present a confidence interval for the difference between the groups, rather than one confidence interval (or error bar) for each group. It is possible for the individual confidence intervals to overlap even if there is a significant difference between the two groups, so reporting group-wise confidence intervals will only lead to confusion. If you are interested in the difference, then of course <em>the difference</em> is what you should report a confidence interval for.</p>
<blockquote>
<p><strong>BAD:</strong> There was no significant difference between the sleeping times of carnivores (mean 10.4, 95 % percentile bootstrap confidence interval: 8.4-12.5) and herbivores (mean 9.5, 95 % percentile bootstrap confidence interval: 8.1-12.6).</p>
</blockquote>
<blockquote>
<p><strong>GOOD:</strong> There was no significant difference between the sleeping times of carnivores (mean 10.4) and herbivores (mean 9.5), with the 95 % percentile bootstrap confidence interval for the difference being (-1.8, 3.5).</p>
</blockquote>
</div>
<div id="citing-r-packages" class="section level3 hasAnchor" number="7.8.2">
<h3><span class="header-section-number">7.8.2</span> Citing R packages<a href="modchapter.html#citing-r-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In statistical reports, it is often a good idea to specify what version of a software or a package that you used, for the sake of reproducibility (indeed, this is a requirement in some scientific journals). To get the citation information for the version of R that you are running, simply type <code>citation()</code>. To get the version number, you can use <code>R.Version</code> as follows:</p>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="modchapter.html#cb795-1" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>()</span>
<span id="cb795-2"><a href="modchapter.html#cb795-2" aria-hidden="true" tabindex="-1"></a><span class="fu">R.Version</span>()<span class="sc">$</span>version.string</span></code></pre></div>
<p>To get the citation and version information for a package, use <code>citation</code> and <code>packageVersion</code> as follows:</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="modchapter.html#cb796-1" aria-hidden="true" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb796-2"><a href="modchapter.html#cb796-2" aria-hidden="true" tabindex="-1"></a><span class="fu">packageVersion</span>(<span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="48">
<li id="fn48"><p>In general, the proportion of points that fall below the curve will be proportional to the area under the curve <em>relative</em> to the area of the sample space. In this case the sample space is the unit square, which has area 1, meaning that the relative area is the same as the absolute area.<a href="modchapter.html#fnref48" class="footnote-back">↩︎</a></p></li>
<li id="fn49"><p>Note that this is not a random sample of mammals, and so one of the fundamental assumptions behind the t-test isn’t valid in this case. For the purpose of showing how to use the t-test, the data is good enough though.<a href="modchapter.html#fnref49" class="footnote-back">↩︎</a></p></li>
<li id="fn50"><p>Or rather, a given <em>expected</em>, or average, width. The width of the interval is a function of a random variable, and is therefore also random.<a href="modchapter.html#fnref50" class="footnote-back">↩︎</a></p></li>
<li id="fn51"><p>We’ll discuss methods for producing such estimates in Section <a href="modchapter.html#simpower">7.5.3</a>.<a href="modchapter.html#fnref51" class="footnote-back">↩︎</a></p></li>
<li id="fn52"><p>At least in terms of mean squared error.<a href="modchapter.html#fnref52" class="footnote-back">↩︎</a></p></li>
<li id="fn53"><p>Well, sometimes we make assumptions about the distribution <em>and</em> use the bootstrap. This is known as the parametric bootstrap, and is discussed in Section <a href="modchapter.html#parametricbootstrap">7.7.4</a>.<a href="modchapter.html#fnref53" class="footnote-back">↩︎</a></p></li>
<li id="fn54"><p>If you really need a BCa interval for the parametric bootstrap, you can find the formulas for it in Davison &amp; Hinkley (1997).<a href="modchapter.html#fnref54" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="progchapter.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
