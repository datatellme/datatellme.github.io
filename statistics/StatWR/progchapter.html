<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 R programming | R 통계분석</title>
  <meta name="description" content="6 R programming | R 통계분석" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="6 R programming | R 통계분석" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 R programming | R 통계분석" />
  
  
  

<meta name="author" content="psnam" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="messychapter.html"/>
<link rel="next" href="modchapter.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="preamble.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://datatellme.github.io">Data Tell Me Something</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>안녕하세요</a></li>
<li class="chapter" data-level="1" data-path="Introduction.html"><a href="Introduction.html"><i class="fa fa-check"></i><b>1</b> 들어가며</a>
<ul>
<li class="chapter" data-level="1.1" data-path="Introduction.html"><a href="Introduction.html#whatR"><i class="fa fa-check"></i><b>1.1</b> R이란?</a></li>
<li class="chapter" data-level="1.2" data-path="Introduction.html"><a href="Introduction.html#Rinstallation"><i class="fa fa-check"></i><b>1.2</b> R 설치하기</a></li>
<li class="chapter" data-level="1.3" data-path="Introduction.html"><a href="Introduction.html#RStudioinstallation"><i class="fa fa-check"></i><b>1.3</b> RStudio 설치하기</a></li>
<li class="chapter" data-level="1.4" data-path="Introduction.html"><a href="Introduction.html#LaTeXinstallation"><i class="fa fa-check"></i><b>1.4</b> 레이텍 설치하기</a></li>
<li class="chapter" data-level="1.5" data-path="Introduction.html"><a href="Introduction.html#packageinstallation"><i class="fa fa-check"></i><b>1.5</b> Packages 설치하기</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="thebasics.html"><a href="thebasics.html"><i class="fa fa-check"></i><b>2</b> 기본</a>
<ul>
<li class="chapter" data-level="2.1" data-path="thebasics.html"><a href="thebasics.html#rstudio-살펴보기"><i class="fa fa-check"></i><b>2.1</b> RStudio 살펴보기</a></li>
<li class="chapter" data-level="2.2" data-path="thebasics.html"><a href="thebasics.html#runningcode"><i class="fa fa-check"></i><b>2.2</b> R 코드 실행하기</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="thebasics.html"><a href="thebasics.html#r-스크립트"><i class="fa fa-check"></i><b>2.2.1</b> R 스크립트</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="thebasics.html"><a href="thebasics.html#varsandfuncs"><i class="fa fa-check"></i><b>2.3</b> 변수와 함수</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="thebasics.html"><a href="thebasics.html#데이터-저장"><i class="fa fa-check"></i><b>2.3.1</b> 데이터 저장</a></li>
<li class="chapter" data-level="2.3.2" data-path="thebasics.html"><a href="thebasics.html#변수-이름"><i class="fa fa-check"></i><b>2.3.2</b> 변수 이름</a></li>
<li class="chapter" data-level="2.3.3" data-path="thebasics.html"><a href="thebasics.html#벡터와-데이터프레임"><i class="fa fa-check"></i><b>2.3.3</b> 벡터와 데이터프레임</a></li>
<li class="chapter" data-level="2.3.4" data-path="thebasics.html"><a href="thebasics.html#함수"><i class="fa fa-check"></i><b>2.3.4</b> 함수</a></li>
<li class="chapter" data-level="2.3.5" data-path="thebasics.html"><a href="thebasics.html#maths"><i class="fa fa-check"></i><b>2.3.5</b> 수학연산</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="thebasics.html"><a href="thebasics.html#descstats"><i class="fa fa-check"></i><b>2.4</b> 기술통계</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="thebasics.html"><a href="thebasics.html#숫자-데이터"><i class="fa fa-check"></i><b>2.4.1</b> 숫자 데이터</a></li>
<li class="chapter" data-level="2.4.2" data-path="thebasics.html"><a href="thebasics.html#catdata1"><i class="fa fa-check"></i><b>2.4.2</b> 명목 데이터</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="thebasics.html"><a href="thebasics.html#그래프와-숫자-데이터"><i class="fa fa-check"></i><b>2.5</b> 그래프와 숫자 데이터</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="thebasics.html"><a href="thebasics.html#나의-그래프"><i class="fa fa-check"></i><b>2.5.1</b> 나의 그래프</a></li>
<li class="chapter" data-level="2.5.2" data-path="thebasics.html"><a href="thebasics.html#색과-형태-및-축"><i class="fa fa-check"></i><b>2.5.2</b> 색과 형태 및 축</a></li>
<li class="chapter" data-level="2.5.3" data-path="thebasics.html"><a href="thebasics.html#축의-한계와-스케일"><i class="fa fa-check"></i><b>2.5.3</b> 축의 한계와 스케일</a></li>
<li class="chapter" data-level="2.5.4" data-path="thebasics.html"><a href="thebasics.html#comparinggroups"><i class="fa fa-check"></i><b>2.5.4</b> 그룹 비교</a></li>
<li class="chapter" data-level="2.5.5" data-path="thebasics.html"><a href="thebasics.html#박스-그래풀럿"><i class="fa fa-check"></i><b>2.5.5</b> 박스 그래풀럿</a></li>
<li class="chapter" data-level="2.5.6" data-path="thebasics.html"><a href="thebasics.html#히스토그램"><i class="fa fa-check"></i><b>2.5.6</b> 히스토그램</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="thebasics.html"><a href="thebasics.html#catdata2"><i class="fa fa-check"></i><b>2.6</b> 그래프와 명목 데인터</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="thebasics.html"><a href="thebasics.html#막대-그래프"><i class="fa fa-check"></i><b>2.6.1</b> 막대 그래프</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="thebasics.html"><a href="thebasics.html#그래프-저장"><i class="fa fa-check"></i><b>2.7</b> 그래프 저장</a></li>
<li class="chapter" data-level="2.8" data-path="thebasics.html"><a href="thebasics.html#troubleshooting"><i class="fa fa-check"></i><b>2.8</b> 오류 문제 해결</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datachapter.html"><a href="datachapter.html"><i class="fa fa-check"></i><b>3</b> Transforming, summarising, and analysing data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="datachapter.html"><a href="datachapter.html#data-frames-and-data-types"><i class="fa fa-check"></i><b>3.1</b> Data frames and data types</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="datachapter.html"><a href="datachapter.html#types-and-structures"><i class="fa fa-check"></i><b>3.1.1</b> Types and structures</a></li>
<li class="chapter" data-level="3.1.2" data-path="datachapter.html"><a href="datachapter.html#typesoftables"><i class="fa fa-check"></i><b>3.1.2</b> Types of tables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datachapter.html"><a href="datachapter.html#findingpoints"><i class="fa fa-check"></i><b>3.2</b> Vectors in data frames</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="datachapter.html"><a href="datachapter.html#accessingelements"><i class="fa fa-check"></i><b>3.2.1</b> Accessing vectors and elements</a></li>
<li class="chapter" data-level="3.2.2" data-path="datachapter.html"><a href="datachapter.html#use-your-dollars"><i class="fa fa-check"></i><b>3.2.2</b> Use your dollars</a></li>
<li class="chapter" data-level="3.2.3" data-path="datachapter.html"><a href="datachapter.html#conditionsintro"><i class="fa fa-check"></i><b>3.2.3</b> Using conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="datachapter.html"><a href="datachapter.html#paths"><i class="fa fa-check"></i><b>3.3</b> Importing data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="datachapter.html"><a href="datachapter.html#importing-csv-files"><i class="fa fa-check"></i><b>3.3.1</b> Importing csv files</a></li>
<li class="chapter" data-level="3.3.2" data-path="datachapter.html"><a href="datachapter.html#file-paths"><i class="fa fa-check"></i><b>3.3.2</b> File paths</a></li>
<li class="chapter" data-level="3.3.3" data-path="datachapter.html"><a href="datachapter.html#importing-excel-files"><i class="fa fa-check"></i><b>3.3.3</b> Importing Excel files</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="datachapter.html"><a href="datachapter.html#saving-and-exporting-your-data"><i class="fa fa-check"></i><b>3.4</b> Saving and exporting your data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="datachapter.html"><a href="datachapter.html#exporting-data"><i class="fa fa-check"></i><b>3.4.1</b> Exporting data</a></li>
<li class="chapter" data-level="3.4.2" data-path="datachapter.html"><a href="datachapter.html#saving-and-loading-r-data"><i class="fa fa-check"></i><b>3.4.2</b> Saving and loading R data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="datachapter.html"><a href="datachapter.html#rstudio-projects"><i class="fa fa-check"></i><b>3.5</b> RStudio projects</a></li>
<li class="chapter" data-level="3.6" data-path="datachapter.html"><a href="datachapter.html#firstttest"><i class="fa fa-check"></i><b>3.6</b> Running a t-test</a></li>
<li class="chapter" data-level="3.7" data-path="datachapter.html"><a href="datachapter.html#firstlm"><i class="fa fa-check"></i><b>3.7</b> Fitting a linear regression model</a></li>
<li class="chapter" data-level="3.8" data-path="datachapter.html"><a href="datachapter.html#grouped"><i class="fa fa-check"></i><b>3.8</b> Grouped summaries</a></li>
<li class="chapter" data-level="3.9" data-path="datachapter.html"><a href="datachapter.html#pipes"><i class="fa fa-check"></i><b>3.9</b> Using <code>%&gt;%</code> pipes</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="datachapter.html"><a href="datachapter.html#ceci-nest-pas-une-pipe"><i class="fa fa-check"></i><b>3.9.1</b> <em>Ceci n’est pas une pipe</em></a></li>
<li class="chapter" data-level="3.9.2" data-path="datachapter.html"><a href="datachapter.html#aliases-and-placeholders"><i class="fa fa-check"></i><b>3.9.2</b> Aliases and placeholders</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="datachapter.html"><a href="datachapter.html#flavours-of-r-base-and-tidyverse"><i class="fa fa-check"></i><b>3.10</b> Flavours of R: base and tidyverse</a></li>
<li class="chapter" data-level="3.11" data-path="datachapter.html"><a href="datachapter.html#ethicalguidelines"><i class="fa fa-check"></i><b>3.11</b> Ethics and good statistical practice</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>4</b> Exploratory data analysis and unsupervised learning</a>
<ul>
<li class="chapter" data-level="4.1" data-path="eda.html"><a href="eda.html#rmarkdown"><i class="fa fa-check"></i><b>4.1</b> Reports with R Markdown</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="eda.html"><a href="eda.html#a-first-example"><i class="fa fa-check"></i><b>4.1.1</b> A first example</a></li>
<li class="chapter" data-level="4.1.2" data-path="eda.html"><a href="eda.html#formatting-text"><i class="fa fa-check"></i><b>4.1.2</b> Formatting text</a></li>
<li class="chapter" data-level="4.1.3" data-path="eda.html"><a href="eda.html#lists-tables-and-images"><i class="fa fa-check"></i><b>4.1.3</b> Lists, tables, and images</a></li>
<li class="chapter" data-level="4.1.4" data-path="eda.html"><a href="eda.html#code-chunks"><i class="fa fa-check"></i><b>4.1.4</b> Code chunks</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="eda.html"><a href="eda.html#themes"><i class="fa fa-check"></i><b>4.2</b> Customising <code>ggplot2</code> plots</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="eda.html"><a href="eda.html#using-themes"><i class="fa fa-check"></i><b>4.2.1</b> Using themes</a></li>
<li class="chapter" data-level="4.2.2" data-path="eda.html"><a href="eda.html#colourpalettes"><i class="fa fa-check"></i><b>4.2.2</b> Colour palettes</a></li>
<li class="chapter" data-level="4.2.3" data-path="eda.html"><a href="eda.html#theme-settings"><i class="fa fa-check"></i><b>4.2.3</b> Theme settings</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="eda.html"><a href="eda.html#exploring-distributions"><i class="fa fa-check"></i><b>4.3</b> Exploring distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="eda.html"><a href="eda.html#density-plots-and-frequency-polygons"><i class="fa fa-check"></i><b>4.3.1</b> Density plots and frequency polygons</a></li>
<li class="chapter" data-level="4.3.2" data-path="eda.html"><a href="eda.html#asking-questions"><i class="fa fa-check"></i><b>4.3.2</b> Asking questions</a></li>
<li class="chapter" data-level="4.3.3" data-path="eda.html"><a href="eda.html#violin-plots"><i class="fa fa-check"></i><b>4.3.3</b> Violin plots</a></li>
<li class="chapter" data-level="4.3.4" data-path="eda.html"><a href="eda.html#patchwork"><i class="fa fa-check"></i><b>4.3.4</b> Combine multiple plots into a single graphic</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="eda.html"><a href="eda.html#outliers-and-missing-data"><i class="fa fa-check"></i><b>4.4</b> Outliers and missing data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="eda.html"><a href="eda.html#detecting-outliers"><i class="fa fa-check"></i><b>4.4.1</b> Detecting outliers</a></li>
<li class="chapter" data-level="4.4.2" data-path="eda.html"><a href="eda.html#labelling-outliers"><i class="fa fa-check"></i><b>4.4.2</b> Labelling outliers</a></li>
<li class="chapter" data-level="4.4.3" data-path="eda.html"><a href="eda.html#missing-data"><i class="fa fa-check"></i><b>4.4.3</b> Missing data</a></li>
<li class="chapter" data-level="4.4.4" data-path="eda.html"><a href="eda.html#exploring-data"><i class="fa fa-check"></i><b>4.4.4</b> Exploring data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="eda.html"><a href="eda.html#trends-in-scatterplots"><i class="fa fa-check"></i><b>4.5</b> Trends in scatterplots</a></li>
<li class="chapter" data-level="4.6" data-path="eda.html"><a href="eda.html#tsplots"><i class="fa fa-check"></i><b>4.6</b> Exploring time series</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="eda.html"><a href="eda.html#annotations-and-reference-lines"><i class="fa fa-check"></i><b>4.6.1</b> Annotations and reference lines</a></li>
<li class="chapter" data-level="4.6.2" data-path="eda.html"><a href="eda.html#longitudinal-data"><i class="fa fa-check"></i><b>4.6.2</b> Longitudinal data</a></li>
<li class="chapter" data-level="4.6.3" data-path="eda.html"><a href="eda.html#path-plots"><i class="fa fa-check"></i><b>4.6.3</b> Path plots</a></li>
<li class="chapter" data-level="4.6.4" data-path="eda.html"><a href="eda.html#spaghetti-plots"><i class="fa fa-check"></i><b>4.6.4</b> Spaghetti plots</a></li>
<li class="chapter" data-level="4.6.5" data-path="eda.html"><a href="eda.html#stlsec"><i class="fa fa-check"></i><b>4.6.5</b> Seasonal plots and decompositions</a></li>
<li class="chapter" data-level="4.6.6" data-path="eda.html"><a href="eda.html#detecting-changepoints"><i class="fa fa-check"></i><b>4.6.6</b> Detecting changepoints</a></li>
<li class="chapter" data-level="4.6.7" data-path="eda.html"><a href="eda.html#interactivets"><i class="fa fa-check"></i><b>4.6.7</b> Interactive time series plots</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="eda.html"><a href="eda.html#polar"><i class="fa fa-check"></i><b>4.7</b> Using polar coordinates</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="eda.html"><a href="eda.html#visualising-periodic-data"><i class="fa fa-check"></i><b>4.7.1</b> Visualising periodic data</a></li>
<li class="chapter" data-level="4.7.2" data-path="eda.html"><a href="eda.html#pie-charts"><i class="fa fa-check"></i><b>4.7.2</b> Pie charts</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="eda.html"><a href="eda.html#visualising-multiple-variables"><i class="fa fa-check"></i><b>4.8</b> Visualising multiple variables</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="eda.html"><a href="eda.html#scatterplotmatrix"><i class="fa fa-check"></i><b>4.8.1</b> Scatterplot matrices</a></li>
<li class="chapter" data-level="4.8.2" data-path="eda.html"><a href="eda.html#d-scatterplots"><i class="fa fa-check"></i><b>4.8.2</b> 3D scatterplots</a></li>
<li class="chapter" data-level="4.8.3" data-path="eda.html"><a href="eda.html#correlograms"><i class="fa fa-check"></i><b>4.8.3</b> Correlograms</a></li>
<li class="chapter" data-level="4.8.4" data-path="eda.html"><a href="eda.html#adding-more-variables-to-scatterplots"><i class="fa fa-check"></i><b>4.8.4</b> Adding more variables to scatterplots</a></li>
<li class="chapter" data-level="4.8.5" data-path="eda.html"><a href="eda.html#overplotting"><i class="fa fa-check"></i><b>4.8.5</b> Overplotting</a></li>
<li class="chapter" data-level="4.8.6" data-path="eda.html"><a href="eda.html#categorical-data"><i class="fa fa-check"></i><b>4.8.6</b> Categorical data</a></li>
<li class="chapter" data-level="4.8.7" data-path="eda.html"><a href="eda.html#putting-it-all-together"><i class="fa fa-check"></i><b>4.8.7</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="eda.html"><a href="eda.html#pca"><i class="fa fa-check"></i><b>4.9</b> Principal component analysis</a></li>
<li class="chapter" data-level="4.10" data-path="eda.html"><a href="eda.html#clustering"><i class="fa fa-check"></i><b>4.10</b> Cluster analysis</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="eda.html"><a href="eda.html#hierarchical-clustering"><i class="fa fa-check"></i><b>4.10.1</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="4.10.2" data-path="eda.html"><a href="eda.html#heatmaps-and-clustering-variables"><i class="fa fa-check"></i><b>4.10.2</b> Heatmaps and clustering variables</a></li>
<li class="chapter" data-level="4.10.3" data-path="eda.html"><a href="eda.html#centroid"><i class="fa fa-check"></i><b>4.10.3</b> Centroid-based clustering</a></li>
<li class="chapter" data-level="4.10.4" data-path="eda.html"><a href="eda.html#fuzzy-clustering"><i class="fa fa-check"></i><b>4.10.4</b> Fuzzy clustering</a></li>
<li class="chapter" data-level="4.10.5" data-path="eda.html"><a href="eda.html#modelbasedclustering"><i class="fa fa-check"></i><b>4.10.5</b> Model-based clustering</a></li>
<li class="chapter" data-level="4.10.6" data-path="eda.html"><a href="eda.html#comparing-clusters"><i class="fa fa-check"></i><b>4.10.6</b> Comparing clusters</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="eda.html"><a href="eda.html#exploratory-factor-analysis"><i class="fa fa-check"></i><b>4.11</b> Exploratory factor analysis</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="eda.html"><a href="eda.html#factor-analysis"><i class="fa fa-check"></i><b>4.11.1</b> Factor analysis</a></li>
<li class="chapter" data-level="4.11.2" data-path="eda.html"><a href="eda.html#lca"><i class="fa fa-check"></i><b>4.11.2</b> Latent class analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="messychapter.html"><a href="messychapter.html"><i class="fa fa-check"></i><b>5</b> Dealing with messy data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="messychapter.html"><a href="messychapter.html#coercion"><i class="fa fa-check"></i><b>5.1</b> Changing data types</a></li>
<li class="chapter" data-level="5.2" data-path="messychapter.html"><a href="messychapter.html#lists2"><i class="fa fa-check"></i><b>5.2</b> Working with lists</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="messychapter.html"><a href="messychapter.html#splitvector"><i class="fa fa-check"></i><b>5.2.1</b> Splitting vectors into lists</a></li>
<li class="chapter" data-level="5.2.2" data-path="messychapter.html"><a href="messychapter.html#collapsing-lists-into-vectors"><i class="fa fa-check"></i><b>5.2.2</b> Collapsing lists into vectors</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="messychapter.html"><a href="messychapter.html#working-with-numbers"><i class="fa fa-check"></i><b>5.3</b> Working with numbers</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="messychapter.html"><a href="messychapter.html#rounding-numbers"><i class="fa fa-check"></i><b>5.3.1</b> Rounding numbers</a></li>
<li class="chapter" data-level="5.3.2" data-path="messychapter.html"><a href="messychapter.html#sums-and-means-in-data-frames"><i class="fa fa-check"></i><b>5.3.2</b> Sums and means in data frames</a></li>
<li class="chapter" data-level="5.3.3" data-path="messychapter.html"><a href="messychapter.html#rle"><i class="fa fa-check"></i><b>5.3.3</b> Summaries of series of numbers</a></li>
<li class="chapter" data-level="5.3.4" data-path="messychapter.html"><a href="messychapter.html#scientific-notation-1e-03"><i class="fa fa-check"></i><b>5.3.4</b> Scientific notation <code>1e-03</code></a></li>
<li class="chapter" data-level="5.3.5" data-path="messychapter.html"><a href="messychapter.html#floatingpoints"><i class="fa fa-check"></i><b>5.3.5</b> Floating point arithmetics</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="messychapter.html"><a href="messychapter.html#factors"><i class="fa fa-check"></i><b>5.4</b> Working with factors</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="messychapter.html"><a href="messychapter.html#creating-factors"><i class="fa fa-check"></i><b>5.4.1</b> Creating factors</a></li>
<li class="chapter" data-level="5.4.2" data-path="messychapter.html"><a href="messychapter.html#factorlevels"><i class="fa fa-check"></i><b>5.4.2</b> Changing factor levels</a></li>
<li class="chapter" data-level="5.4.3" data-path="messychapter.html"><a href="messychapter.html#changing-the-order-of-levels"><i class="fa fa-check"></i><b>5.4.3</b> Changing the order of levels</a></li>
<li class="chapter" data-level="5.4.4" data-path="messychapter.html"><a href="messychapter.html#combining-levels"><i class="fa fa-check"></i><b>5.4.4</b> Combining levels</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="messychapter.html"><a href="messychapter.html#strings"><i class="fa fa-check"></i><b>5.5</b> Working with strings</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="messychapter.html"><a href="messychapter.html#concatenating-strings"><i class="fa fa-check"></i><b>5.5.1</b> Concatenating strings</a></li>
<li class="chapter" data-level="5.5.2" data-path="messychapter.html"><a href="messychapter.html#changing-case"><i class="fa fa-check"></i><b>5.5.2</b> Changing case</a></li>
<li class="chapter" data-level="5.5.3" data-path="messychapter.html"><a href="messychapter.html#regexp"><i class="fa fa-check"></i><b>5.5.3</b> Finding patterns using regular expressions</a></li>
<li class="chapter" data-level="5.5.4" data-path="messychapter.html"><a href="messychapter.html#sub"><i class="fa fa-check"></i><b>5.5.4</b> Substitution</a></li>
<li class="chapter" data-level="5.5.5" data-path="messychapter.html"><a href="messychapter.html#splitting-strings"><i class="fa fa-check"></i><b>5.5.5</b> Splitting strings</a></li>
<li class="chapter" data-level="5.5.6" data-path="messychapter.html"><a href="messychapter.html#variable-names"><i class="fa fa-check"></i><b>5.5.6</b> Variable names</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="messychapter.html"><a href="messychapter.html#datetime"><i class="fa fa-check"></i><b>5.6</b> Working with dates and times</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="messychapter.html"><a href="messychapter.html#date-formats"><i class="fa fa-check"></i><b>5.6.1</b> Date formats</a></li>
<li class="chapter" data-level="5.6.2" data-path="messychapter.html"><a href="messychapter.html#plotting-with-dates"><i class="fa fa-check"></i><b>5.6.2</b> Plotting with dates</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="messychapter.html"><a href="messychapter.html#data-manipulation-with-data.table-dplyr-and-tidyr"><i class="fa fa-check"></i><b>5.7</b> Data manipulation with <code>data.table</code>, <code>dplyr</code>, and <code>tidyr</code></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="messychapter.html"><a href="messychapter.html#dtbasics"><i class="fa fa-check"></i><b>5.7.1</b> <code>data.table</code> and tidyverse syntax basics</a></li>
<li class="chapter" data-level="5.7.2" data-path="messychapter.html"><a href="messychapter.html#modifyvar"><i class="fa fa-check"></i><b>5.7.2</b> Modifying a variable</a></li>
<li class="chapter" data-level="5.7.3" data-path="messychapter.html"><a href="messychapter.html#computing-a-new-variable-based-on-existing-variables"><i class="fa fa-check"></i><b>5.7.3</b> Computing a new variable based on existing variables</a></li>
<li class="chapter" data-level="5.7.4" data-path="messychapter.html"><a href="messychapter.html#renaming-a-variable"><i class="fa fa-check"></i><b>5.7.4</b> Renaming a variable</a></li>
<li class="chapter" data-level="5.7.5" data-path="messychapter.html"><a href="messychapter.html#removing-a-variable"><i class="fa fa-check"></i><b>5.7.5</b> Removing a variable</a></li>
<li class="chapter" data-level="5.7.6" data-path="messychapter.html"><a href="messychapter.html#recodedplyr"><i class="fa fa-check"></i><b>5.7.6</b> Recoding <code>factor</code> levels</a></li>
<li class="chapter" data-level="5.7.7" data-path="messychapter.html"><a href="messychapter.html#grouped2"><i class="fa fa-check"></i><b>5.7.7</b> Grouped summaries</a></li>
<li class="chapter" data-level="5.7.8" data-path="messychapter.html"><a href="messychapter.html#fillNA"><i class="fa fa-check"></i><b>5.7.8</b> Filling in missing values</a></li>
<li class="chapter" data-level="5.7.9" data-path="messychapter.html"><a href="messychapter.html#chaining-commands-together"><i class="fa fa-check"></i><b>5.7.9</b> Chaining commands together</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="messychapter.html"><a href="messychapter.html#filtering"><i class="fa fa-check"></i><b>5.8</b> Filtering: select rows</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="messychapter.html"><a href="messychapter.html#filtering-using-row-numbers"><i class="fa fa-check"></i><b>5.8.1</b> Filtering using row numbers</a></li>
<li class="chapter" data-level="5.8.2" data-path="messychapter.html"><a href="messychapter.html#conditions2"><i class="fa fa-check"></i><b>5.8.2</b> Filtering using conditions</a></li>
<li class="chapter" data-level="5.8.3" data-path="messychapter.html"><a href="messychapter.html#selecting-rows-at-random"><i class="fa fa-check"></i><b>5.8.3</b> Selecting rows at random</a></li>
<li class="chapter" data-level="5.8.4" data-path="messychapter.html"><a href="messychapter.html#using-regular-expressions-to-select-rows"><i class="fa fa-check"></i><b>5.8.4</b> Using regular expressions to select rows</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="messychapter.html"><a href="messychapter.html#subsetting-select-columns"><i class="fa fa-check"></i><b>5.9</b> Subsetting: select columns</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="messychapter.html"><a href="messychapter.html#selecting-a-single-column"><i class="fa fa-check"></i><b>5.9.1</b> Selecting a single column</a></li>
<li class="chapter" data-level="5.9.2" data-path="messychapter.html"><a href="messychapter.html#selecting-multiple-columns"><i class="fa fa-check"></i><b>5.9.2</b> Selecting multiple columns</a></li>
<li class="chapter" data-level="5.9.3" data-path="messychapter.html"><a href="messychapter.html#using-regular-expressions-to-select-columns"><i class="fa fa-check"></i><b>5.9.3</b> Using regular expressions to select columns</a></li>
<li class="chapter" data-level="5.9.4" data-path="messychapter.html"><a href="messychapter.html#subsetusingcn"><i class="fa fa-check"></i><b>5.9.4</b> Subsetting using column numbers</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="messychapter.html"><a href="messychapter.html#sorting"><i class="fa fa-check"></i><b>5.10</b> Sorting</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="messychapter.html"><a href="messychapter.html#changing-the-column-order"><i class="fa fa-check"></i><b>5.10.1</b> Changing the column order</a></li>
<li class="chapter" data-level="5.10.2" data-path="messychapter.html"><a href="messychapter.html#changing-the-row-order"><i class="fa fa-check"></i><b>5.10.2</b> Changing the row order</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="messychapter.html"><a href="messychapter.html#reshaping"><i class="fa fa-check"></i><b>5.11</b> Reshaping data</a>
<ul>
<li class="chapter" data-level="5.11.1" data-path="messychapter.html"><a href="messychapter.html#from-long-to-wide"><i class="fa fa-check"></i><b>5.11.1</b> From long to wide</a></li>
<li class="chapter" data-level="5.11.2" data-path="messychapter.html"><a href="messychapter.html#from-wide-to-long"><i class="fa fa-check"></i><b>5.11.2</b> From wide to long</a></li>
<li class="chapter" data-level="5.11.3" data-path="messychapter.html"><a href="messychapter.html#splittingcolumns"><i class="fa fa-check"></i><b>5.11.3</b> Splitting columns</a></li>
<li class="chapter" data-level="5.11.4" data-path="messychapter.html"><a href="messychapter.html#merging-columns"><i class="fa fa-check"></i><b>5.11.4</b> Merging columns</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="messychapter.html"><a href="messychapter.html#mergedata"><i class="fa fa-check"></i><b>5.12</b> Merging data from multiple tables</a>
<ul>
<li class="chapter" data-level="5.12.1" data-path="messychapter.html"><a href="messychapter.html#binds"><i class="fa fa-check"></i><b>5.12.1</b> Binds</a></li>
<li class="chapter" data-level="5.12.2" data-path="messychapter.html"><a href="messychapter.html#merging-tables-using-keys"><i class="fa fa-check"></i><b>5.12.2</b> Merging tables using keys</a></li>
<li class="chapter" data-level="5.12.3" data-path="messychapter.html"><a href="messychapter.html#inner-and-outer-joins"><i class="fa fa-check"></i><b>5.12.3</b> Inner and outer joins</a></li>
<li class="chapter" data-level="5.12.4" data-path="messychapter.html"><a href="messychapter.html#semijoins"><i class="fa fa-check"></i><b>5.12.4</b> Semijoins and antijoins</a></li>
</ul></li>
<li class="chapter" data-level="5.13" data-path="messychapter.html"><a href="messychapter.html#scraping-data-from-websites"><i class="fa fa-check"></i><b>5.13</b> Scraping data from websites</a></li>
<li class="chapter" data-level="5.14" data-path="messychapter.html"><a href="messychapter.html#commontasks"><i class="fa fa-check"></i><b>5.14</b> Other commons tasks</a>
<ul>
<li class="chapter" data-level="5.14.1" data-path="messychapter.html"><a href="messychapter.html#deleting-variables"><i class="fa fa-check"></i><b>5.14.1</b> Deleting variables</a></li>
<li class="chapter" data-level="5.14.2" data-path="messychapter.html"><a href="messychapter.html#foreign"><i class="fa fa-check"></i><b>5.14.2</b> Importing data from other statistical packages</a></li>
<li class="chapter" data-level="5.14.3" data-path="messychapter.html"><a href="messychapter.html#importing-data-from-databases"><i class="fa fa-check"></i><b>5.14.3</b> Importing data from databases</a></li>
<li class="chapter" data-level="5.14.4" data-path="messychapter.html"><a href="messychapter.html#importing-data-from-json-files"><i class="fa fa-check"></i><b>5.14.4</b> Importing data from JSON files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="progchapter.html"><a href="progchapter.html"><i class="fa fa-check"></i><b>6</b> R programming</a>
<ul>
<li class="chapter" data-level="6.1" data-path="progchapter.html"><a href="progchapter.html#functions"><i class="fa fa-check"></i><b>6.1</b> Functions</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="progchapter.html"><a href="progchapter.html#createfunctions"><i class="fa fa-check"></i><b>6.1.1</b> Creating functions</a></li>
<li class="chapter" data-level="6.1.2" data-path="progchapter.html"><a href="progchapter.html#local-and-global-variables"><i class="fa fa-check"></i><b>6.1.2</b> Local and global variables</a></li>
<li class="chapter" data-level="6.1.3" data-path="progchapter.html"><a href="progchapter.html#willfunctionwork"><i class="fa fa-check"></i><b>6.1.3</b> Will your function work?</a></li>
<li class="chapter" data-level="6.1.4" data-path="progchapter.html"><a href="progchapter.html#more-on-arguments"><i class="fa fa-check"></i><b>6.1.4</b> More on arguments</a></li>
<li class="chapter" data-level="6.1.5" data-path="progchapter.html"><a href="progchapter.html#namespaces"><i class="fa fa-check"></i><b>6.1.5</b> Namespaces</a></li>
<li class="chapter" data-level="6.1.6" data-path="progchapter.html"><a href="progchapter.html#sourcing-other-scripts"><i class="fa fa-check"></i><b>6.1.6</b> Sourcing other scripts</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="progchapter.html"><a href="progchapter.html#morepipes"><i class="fa fa-check"></i><b>6.2</b> More on pipes</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="progchapter.html"><a href="progchapter.html#ce-ne-sont-pas-non-plus-des-pipes"><i class="fa fa-check"></i><b>6.2.1</b> <em>Ce ne sont pas non plus des pipes</em></a></li>
<li class="chapter" data-level="6.2.2" data-path="progchapter.html"><a href="progchapter.html#writing-functions-with-pipes"><i class="fa fa-check"></i><b>6.2.2</b> Writing functions with pipes</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="progchapter.html"><a href="progchapter.html#conditions"><i class="fa fa-check"></i><b>6.3</b> Checking conditions</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="progchapter.html"><a href="progchapter.html#if-and-else"><i class="fa fa-check"></i><b>6.3.1</b> <code>if</code> and <code>else</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="progchapter.html"><a href="progchapter.html#section"><i class="fa fa-check"></i><b>6.3.2</b> <code>&amp;</code> &amp; <code>&amp;&amp;</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="progchapter.html"><a href="progchapter.html#ifelse"><i class="fa fa-check"></i><b>6.3.3</b> <code>ifelse</code></a></li>
<li class="chapter" data-level="6.3.4" data-path="progchapter.html"><a href="progchapter.html#switch"><i class="fa fa-check"></i><b>6.3.4</b> <code>switch</code></a></li>
<li class="chapter" data-level="6.3.5" data-path="progchapter.html"><a href="progchapter.html#failing-gracefully"><i class="fa fa-check"></i><b>6.3.5</b> Failing gracefully</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="progchapter.html"><a href="progchapter.html#loopsection"><i class="fa fa-check"></i><b>6.4</b> Iteration using loops</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="progchapter.html"><a href="progchapter.html#forloops"><i class="fa fa-check"></i><b>6.4.1</b> <code>for</code> loops</a></li>
<li class="chapter" data-level="6.4.2" data-path="progchapter.html"><a href="progchapter.html#nestedloops"><i class="fa fa-check"></i><b>6.4.2</b> Loops within loops</a></li>
<li class="chapter" data-level="6.4.3" data-path="progchapter.html"><a href="progchapter.html#beepr"><i class="fa fa-check"></i><b>6.4.3</b> Keeping track of what’s happening</a></li>
<li class="chapter" data-level="6.4.4" data-path="progchapter.html"><a href="progchapter.html#lists"><i class="fa fa-check"></i><b>6.4.4</b> Loops and lists</a></li>
<li class="chapter" data-level="6.4.5" data-path="progchapter.html"><a href="progchapter.html#whileloop"><i class="fa fa-check"></i><b>6.4.5</b> <code>while</code> loops</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="progchapter.html"><a href="progchapter.html#vectorloops"><i class="fa fa-check"></i><b>6.5</b> Iteration using vectorisation and functionals</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="progchapter.html"><a href="progchapter.html#a-first-example-with-apply"><i class="fa fa-check"></i><b>6.5.1</b> A first example with <code>apply</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="progchapter.html"><a href="progchapter.html#variations-on-a-theme"><i class="fa fa-check"></i><b>6.5.2</b> Variations on a theme</a></li>
<li class="chapter" data-level="6.5.3" data-path="progchapter.html"><a href="progchapter.html#purrr"><i class="fa fa-check"></i><b>6.5.3</b> <code>purrr</code></a></li>
<li class="chapter" data-level="6.5.4" data-path="progchapter.html"><a href="progchapter.html#specialised-functions"><i class="fa fa-check"></i><b>6.5.4</b> Specialised functions</a></li>
<li class="chapter" data-level="6.5.5" data-path="progchapter.html"><a href="progchapter.html#exploring-data-with-functionals"><i class="fa fa-check"></i><b>6.5.5</b> Exploring data with functionals</a></li>
<li class="chapter" data-level="6.5.6" data-path="progchapter.html"><a href="progchapter.html#keep-calm-and-carry-on"><i class="fa fa-check"></i><b>6.5.6</b> Keep calm and carry on</a></li>
<li class="chapter" data-level="6.5.7" data-path="progchapter.html"><a href="progchapter.html#multiiter"><i class="fa fa-check"></i><b>6.5.7</b> Iterating over multiple variables</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="progchapter.html"><a href="progchapter.html#measureperformance"><i class="fa fa-check"></i><b>6.6</b> Measuring code performance</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="progchapter.html"><a href="progchapter.html#timing-functions"><i class="fa fa-check"></i><b>6.6.1</b> Timing functions</a></li>
<li class="chapter" data-level="6.6.2" data-path="progchapter.html"><a href="progchapter.html#measuring-memory-usage---and-a-note-on-compilation"><i class="fa fa-check"></i><b>6.6.2</b> Measuring memory usage - and a note on compilation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modchapter.html"><a href="modchapter.html"><i class="fa fa-check"></i><b>7</b> Modern classical statistics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modchapter.html"><a href="modchapter.html#simulation"><i class="fa fa-check"></i><b>7.1</b> Simulation and distributions</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="modchapter.html"><a href="modchapter.html#generating-random-numbers"><i class="fa fa-check"></i><b>7.1.1</b> Generating random numbers</a></li>
<li class="chapter" data-level="7.1.2" data-path="modchapter.html"><a href="modchapter.html#distfunctions"><i class="fa fa-check"></i><b>7.1.2</b> Some common distributions</a></li>
<li class="chapter" data-level="7.1.3" data-path="modchapter.html"><a href="modchapter.html#assessing-distributional-assumptions"><i class="fa fa-check"></i><b>7.1.3</b> Assessing distributional assumptions</a></li>
<li class="chapter" data-level="7.1.4" data-path="modchapter.html"><a href="modchapter.html#monte-carlo-integration"><i class="fa fa-check"></i><b>7.1.4</b> Monte Carlo integration</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="modchapter.html"><a href="modchapter.html#ttest"><i class="fa fa-check"></i><b>7.2</b> Student’s t-test revisited</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="modchapter.html"><a href="modchapter.html#oldschoolt"><i class="fa fa-check"></i><b>7.2.1</b> The old-school t-test</a></li>
<li class="chapter" data-level="7.2.2" data-path="modchapter.html"><a href="modchapter.html#permutation-tests"><i class="fa fa-check"></i><b>7.2.2</b> Permutation tests</a></li>
<li class="chapter" data-level="7.2.3" data-path="modchapter.html"><a href="modchapter.html#the-bootstrap"><i class="fa fa-check"></i><b>7.2.3</b> The bootstrap</a></li>
<li class="chapter" data-level="7.2.4" data-path="modchapter.html"><a href="modchapter.html#saving-the-output"><i class="fa fa-check"></i><b>7.2.4</b> Saving the output</a></li>
<li class="chapter" data-level="7.2.5" data-path="modchapter.html"><a href="modchapter.html#multipletesting"><i class="fa fa-check"></i><b>7.2.5</b> Multiple testing</a></li>
<li class="chapter" data-level="7.2.6" data-path="modchapter.html"><a href="modchapter.html#hotellingst2"><i class="fa fa-check"></i><b>7.2.6</b> Multivariate testing with Hotelling’s <span class="math inline">\(T^2\)</span></a></li>
<li class="chapter" data-level="7.2.7" data-path="modchapter.html"><a href="modchapter.html#sample-size-computations-for-the-t-test"><i class="fa fa-check"></i><b>7.2.7</b> Sample size computations for the t-test</a></li>
<li class="chapter" data-level="7.2.8" data-path="modchapter.html"><a href="modchapter.html#a-bayesian-approach"><i class="fa fa-check"></i><b>7.2.8</b> A Bayesian approach</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="modchapter.html"><a href="modchapter.html#other-common-hypothesis-tests-and-confidence-intervals"><i class="fa fa-check"></i><b>7.3</b> Other common hypothesis tests and confidence intervals</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="modchapter.html"><a href="modchapter.html#nonparametric-tests-of-location"><i class="fa fa-check"></i><b>7.3.1</b> Nonparametric tests of location</a></li>
<li class="chapter" data-level="7.3.2" data-path="modchapter.html"><a href="modchapter.html#tests-for-correlation"><i class="fa fa-check"></i><b>7.3.2</b> Tests for correlation</a></li>
<li class="chapter" data-level="7.3.3" data-path="modchapter.html"><a href="modchapter.html#chi2-tests"><i class="fa fa-check"></i><b>7.3.3</b> <span class="math inline">\(\chi^2\)</span>-tests</a></li>
<li class="chapter" data-level="7.3.4" data-path="modchapter.html"><a href="modchapter.html#confprop"><i class="fa fa-check"></i><b>7.3.4</b> Confidence intervals for proportions</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="modchapter.html"><a href="modchapter.html#ethicsinference"><i class="fa fa-check"></i><b>7.4</b> Ethical issues in statistical inference</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="modchapter.html"><a href="modchapter.html#p-hacking-and-the-file-drawer-problem"><i class="fa fa-check"></i><b>7.4.1</b> p-hacking and the file-drawer problem</a></li>
<li class="chapter" data-level="7.4.2" data-path="modchapter.html"><a href="modchapter.html#reproducibility"><i class="fa fa-check"></i><b>7.4.2</b> Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="modchapter.html"><a href="modchapter.html#simeval"><i class="fa fa-check"></i><b>7.5</b> Evaluating statistical methods using simulation</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="modchapter.html"><a href="modchapter.html#comparing-estimators"><i class="fa fa-check"></i><b>7.5.1</b> Comparing estimators</a></li>
<li class="chapter" data-level="7.5.2" data-path="modchapter.html"><a href="modchapter.html#simtypeI"><i class="fa fa-check"></i><b>7.5.2</b> Type I error rate of hypothesis tests</a></li>
<li class="chapter" data-level="7.5.3" data-path="modchapter.html"><a href="modchapter.html#simpower"><i class="fa fa-check"></i><b>7.5.3</b> Power of hypothesis tests</a></li>
<li class="chapter" data-level="7.5.4" data-path="modchapter.html"><a href="modchapter.html#powerlocation"><i class="fa fa-check"></i><b>7.5.4</b> Power of some tests of location</a></li>
<li class="chapter" data-level="7.5.5" data-path="modchapter.html"><a href="modchapter.html#simadvice"><i class="fa fa-check"></i><b>7.5.5</b> Some advice on simulation studies</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="modchapter.html"><a href="modchapter.html#sscus"><i class="fa fa-check"></i><b>7.6</b> Sample size computations using simulation</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="modchapter.html"><a href="modchapter.html#simcorpower"><i class="fa fa-check"></i><b>7.6.1</b> Writing your own simulation</a></li>
<li class="chapter" data-level="7.6.2" data-path="modchapter.html"><a href="modchapter.html#the-wilcoxon-mann-whitney-test"><i class="fa fa-check"></i><b>7.6.2</b> The Wilcoxon-Mann-Whitney test</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="modchapter.html"><a href="modchapter.html#bootstrap"><i class="fa fa-check"></i><b>7.7</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="modchapter.html"><a href="modchapter.html#a-general-approach"><i class="fa fa-check"></i><b>7.7.1</b> A general approach</a></li>
<li class="chapter" data-level="7.7.2" data-path="modchapter.html"><a href="modchapter.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>7.7.2</b> Bootstrap confidence intervals</a></li>
<li class="chapter" data-level="7.7.3" data-path="modchapter.html"><a href="modchapter.html#intervalinversion"><i class="fa fa-check"></i><b>7.7.3</b> Bootstrap hypothesis tests</a></li>
<li class="chapter" data-level="7.7.4" data-path="modchapter.html"><a href="modchapter.html#parametricbootstrap"><i class="fa fa-check"></i><b>7.7.4</b> The parametric bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="modchapter.html"><a href="modchapter.html#reporting-statistical-results"><i class="fa fa-check"></i><b>7.8</b> Reporting statistical results</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="modchapter.html"><a href="modchapter.html#what-should-you-include"><i class="fa fa-check"></i><b>7.8.1</b> What should you include?</a></li>
<li class="chapter" data-level="7.8.2" data-path="modchapter.html"><a href="modchapter.html#citing-r-packages"><i class="fa fa-check"></i><b>7.8.2</b> Citing R packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>8</b> Regression models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="regression.html"><a href="regression.html#linearmodels"><i class="fa fa-check"></i><b>8.1</b> Linear models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="regression.html"><a href="regression.html#fitting-linear-models"><i class="fa fa-check"></i><b>8.1.1</b> Fitting linear models</a></li>
<li class="chapter" data-level="8.1.2" data-path="regression.html"><a href="regression.html#interactions-and-polynomial-terms"><i class="fa fa-check"></i><b>8.1.2</b> Interactions and polynomial terms</a></li>
<li class="chapter" data-level="8.1.3" data-path="regression.html"><a href="regression.html#dummy-variables"><i class="fa fa-check"></i><b>8.1.3</b> Dummy variables</a></li>
<li class="chapter" data-level="8.1.4" data-path="regression.html"><a href="regression.html#model-diagnostics"><i class="fa fa-check"></i><b>8.1.4</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.1.5" data-path="regression.html"><a href="regression.html#transformations"><i class="fa fa-check"></i><b>8.1.5</b> Transformations</a></li>
<li class="chapter" data-level="8.1.6" data-path="regression.html"><a href="regression.html#alternatives-to-lm"><i class="fa fa-check"></i><b>8.1.6</b> Alternatives to <code>lm</code></a></li>
<li class="chapter" data-level="8.1.7" data-path="regression.html"><a href="regression.html#regbootstrap"><i class="fa fa-check"></i><b>8.1.7</b> Bootstrap confidence intervals for regression coefficients</a></li>
<li class="chapter" data-level="8.1.8" data-path="regression.html"><a href="regression.html#broom"><i class="fa fa-check"></i><b>8.1.8</b> Alternative summaries with <code>broom</code></a></li>
<li class="chapter" data-level="8.1.9" data-path="regression.html"><a href="regression.html#stepwise"><i class="fa fa-check"></i><b>8.1.9</b> Variable selection</a></li>
<li class="chapter" data-level="8.1.10" data-path="regression.html"><a href="regression.html#prediction"><i class="fa fa-check"></i><b>8.1.10</b> Prediction</a></li>
<li class="chapter" data-level="8.1.11" data-path="regression.html"><a href="regression.html#multipredict"><i class="fa fa-check"></i><b>8.1.11</b> Prediction for multiple datasets</a></li>
<li class="chapter" data-level="8.1.12" data-path="regression.html"><a href="regression.html#ANOVA"><i class="fa fa-check"></i><b>8.1.12</b> ANOVA</a></li>
<li class="chapter" data-level="8.1.13" data-path="regression.html"><a href="regression.html#bayeslm"><i class="fa fa-check"></i><b>8.1.13</b> Bayesian estimation of linear models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="regression.html"><a href="regression.html#ethical-issues-in-regression-modelling"><i class="fa fa-check"></i><b>8.2</b> Ethical issues in regression modelling</a></li>
<li class="chapter" data-level="8.3" data-path="regression.html"><a href="regression.html#generalised-linear-models"><i class="fa fa-check"></i><b>8.3</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="regression.html"><a href="regression.html#logreg"><i class="fa fa-check"></i><b>8.3.1</b> Modelling proportions: Logistic regression</a></li>
<li class="chapter" data-level="8.3.2" data-path="regression.html"><a href="regression.html#bootstrap-confidence-intervals-1"><i class="fa fa-check"></i><b>8.3.2</b> Bootstrap confidence intervals</a></li>
<li class="chapter" data-level="8.3.3" data-path="regression.html"><a href="regression.html#model-diagnostics-1"><i class="fa fa-check"></i><b>8.3.3</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.3.4" data-path="regression.html"><a href="regression.html#prediction-1"><i class="fa fa-check"></i><b>8.3.4</b> Prediction</a></li>
<li class="chapter" data-level="8.3.5" data-path="regression.html"><a href="regression.html#modelling-count-data"><i class="fa fa-check"></i><b>8.3.5</b> Modelling count data</a></li>
<li class="chapter" data-level="8.3.6" data-path="regression.html"><a href="regression.html#modelling-rates"><i class="fa fa-check"></i><b>8.3.6</b> Modelling rates</a></li>
<li class="chapter" data-level="8.3.7" data-path="regression.html"><a href="regression.html#bayesian-estimation-of-generalised-linear-models"><i class="fa fa-check"></i><b>8.3.7</b> Bayesian estimation of generalised linear models</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="regression.html"><a href="regression.html#mixedmodels"><i class="fa fa-check"></i><b>8.4</b> Mixed models</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="regression.html"><a href="regression.html#fitting-a-linear-mixed-model"><i class="fa fa-check"></i><b>8.4.1</b> Fitting a linear mixed model</a></li>
<li class="chapter" data-level="8.4.2" data-path="regression.html"><a href="regression.html#model-diagnostics-2"><i class="fa fa-check"></i><b>8.4.2</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.4.3" data-path="regression.html"><a href="regression.html#lmmbootstrap"><i class="fa fa-check"></i><b>8.4.3</b> Bootstrapping</a></li>
<li class="chapter" data-level="8.4.4" data-path="regression.html"><a href="regression.html#nested-random-effects-and-multilevelhierarchical-models"><i class="fa fa-check"></i><b>8.4.4</b> Nested random effects and multilevel/hierarchical models</a></li>
<li class="chapter" data-level="8.4.5" data-path="regression.html"><a href="regression.html#anova-with-random-effects"><i class="fa fa-check"></i><b>8.4.5</b> ANOVA with random effects</a></li>
<li class="chapter" data-level="8.4.6" data-path="regression.html"><a href="regression.html#generalised-linear-mixed-models"><i class="fa fa-check"></i><b>8.4.6</b> Generalised linear mixed models</a></li>
<li class="chapter" data-level="8.4.7" data-path="regression.html"><a href="regression.html#bayesian-estimation-of-mixed-models"><i class="fa fa-check"></i><b>8.4.7</b> Bayesian estimation of mixed models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="regression.html"><a href="regression.html#survival"><i class="fa fa-check"></i><b>8.5</b> Survival analysis</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="regression.html"><a href="regression.html#comparing-groups"><i class="fa fa-check"></i><b>8.5.1</b> Comparing groups</a></li>
<li class="chapter" data-level="8.5.2" data-path="regression.html"><a href="regression.html#the-cox-proportional-hazards-model"><i class="fa fa-check"></i><b>8.5.2</b> The Cox proportional hazards model</a></li>
<li class="chapter" data-level="8.5.3" data-path="regression.html"><a href="regression.html#accelerated-failure-time-models"><i class="fa fa-check"></i><b>8.5.3</b> Accelerated failure time models</a></li>
<li class="chapter" data-level="8.5.4" data-path="regression.html"><a href="regression.html#bayesian-survival-analysis"><i class="fa fa-check"></i><b>8.5.4</b> Bayesian survival analysis</a></li>
<li class="chapter" data-level="8.5.5" data-path="regression.html"><a href="regression.html#multivariate-survival-analysis"><i class="fa fa-check"></i><b>8.5.5</b> Multivariate survival analysis</a></li>
<li class="chapter" data-level="8.5.6" data-path="regression.html"><a href="regression.html#power-estimates-for-the-logrank-test"><i class="fa fa-check"></i><b>8.5.6</b> Power estimates for the logrank test</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="regression.html"><a href="regression.html#left-censored-data-and-nondetects"><i class="fa fa-check"></i><b>8.6</b> Left-censored data and nondetects</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="regression.html"><a href="regression.html#estimation"><i class="fa fa-check"></i><b>8.6.1</b> Estimation</a></li>
<li class="chapter" data-level="8.6.2" data-path="regression.html"><a href="regression.html#tests-of-means"><i class="fa fa-check"></i><b>8.6.2</b> Tests of means</a></li>
<li class="chapter" data-level="8.6.3" data-path="regression.html"><a href="regression.html#censored-regression"><i class="fa fa-check"></i><b>8.6.3</b> Censored regression</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="regression.html"><a href="regression.html#creating-matched-samples"><i class="fa fa-check"></i><b>8.7</b> Creating matched samples</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="regression.html"><a href="regression.html#propensity-score-matching"><i class="fa fa-check"></i><b>8.7.1</b> Propensity score matching</a></li>
<li class="chapter" data-level="8.7.2" data-path="regression.html"><a href="regression.html#stepwise-matching"><i class="fa fa-check"></i><b>8.7.2</b> Stepwise matching</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mlchapter.html"><a href="mlchapter.html"><i class="fa fa-check"></i><b>9</b> Predictive modelling and machine learning</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mlchapter.html"><a href="mlchapter.html#evaluating-predictive-models"><i class="fa fa-check"></i><b>9.1</b> Evaluating predictive models</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="mlchapter.html"><a href="mlchapter.html#evaluating-regression-models"><i class="fa fa-check"></i><b>9.1.1</b> Evaluating regression models</a></li>
<li class="chapter" data-level="9.1.2" data-path="mlchapter.html"><a href="mlchapter.html#test-training-splits"><i class="fa fa-check"></i><b>9.1.2</b> Test-training splits</a></li>
<li class="chapter" data-level="9.1.3" data-path="mlchapter.html"><a href="mlchapter.html#loocv"><i class="fa fa-check"></i><b>9.1.3</b> Leave-one-out cross-validation and <code>caret</code></a></li>
<li class="chapter" data-level="9.1.4" data-path="mlchapter.html"><a href="mlchapter.html#kfoldcv"><i class="fa fa-check"></i><b>9.1.4</b> k-fold cross-validation</a></li>
<li class="chapter" data-level="9.1.5" data-path="mlchapter.html"><a href="mlchapter.html#twinned-observations"><i class="fa fa-check"></i><b>9.1.5</b> Twinned observations</a></li>
<li class="chapter" data-level="9.1.6" data-path="mlchapter.html"><a href="mlchapter.html#bootstrapping"><i class="fa fa-check"></i><b>9.1.6</b> Bootstrapping</a></li>
<li class="chapter" data-level="9.1.7" data-path="mlchapter.html"><a href="mlchapter.html#classifieraccuracy"><i class="fa fa-check"></i><b>9.1.7</b> Evaluating classification models</a></li>
<li class="chapter" data-level="9.1.8" data-path="mlchapter.html"><a href="mlchapter.html#decisionboundaries"><i class="fa fa-check"></i><b>9.1.8</b> Visualising decision boundaries</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="mlchapter.html"><a href="mlchapter.html#ethical-issues-in-predictive-modelling"><i class="fa fa-check"></i><b>9.2</b> Ethical issues in predictive modelling</a></li>
<li class="chapter" data-level="9.3" data-path="mlchapter.html"><a href="mlchapter.html#modellingchallenges"><i class="fa fa-check"></i><b>9.3</b> Challenges in predictive modelling</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mlchapter.html"><a href="mlchapter.html#imbalanced"><i class="fa fa-check"></i><b>9.3.1</b> Handling class imbalance</a></li>
<li class="chapter" data-level="9.3.2" data-path="mlchapter.html"><a href="mlchapter.html#varimportance"><i class="fa fa-check"></i><b>9.3.2</b> Assessing variable importance</a></li>
<li class="chapter" data-level="9.3.3" data-path="mlchapter.html"><a href="mlchapter.html#extrapolation"><i class="fa fa-check"></i><b>9.3.3</b> Extrapolation</a></li>
<li class="chapter" data-level="9.3.4" data-path="mlchapter.html"><a href="mlchapter.html#missing-data-and-imputation"><i class="fa fa-check"></i><b>9.3.4</b> Missing data and imputation</a></li>
<li class="chapter" data-level="9.3.5" data-path="mlchapter.html"><a href="mlchapter.html#endless-waiting"><i class="fa fa-check"></i><b>9.3.5</b> Endless waiting</a></li>
<li class="chapter" data-level="9.3.6" data-path="mlchapter.html"><a href="mlchapter.html#overfittingtestset"><i class="fa fa-check"></i><b>9.3.6</b> Overfitting to the test set</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mlchapter.html"><a href="mlchapter.html#regularised"><i class="fa fa-check"></i><b>9.4</b> Regularised regression models</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="mlchapter.html"><a href="mlchapter.html#ridge-regression"><i class="fa fa-check"></i><b>9.4.1</b> Ridge regression</a></li>
<li class="chapter" data-level="9.4.2" data-path="mlchapter.html"><a href="mlchapter.html#lasso"><i class="fa fa-check"></i><b>9.4.2</b> The lasso</a></li>
<li class="chapter" data-level="9.4.3" data-path="mlchapter.html"><a href="mlchapter.html#elastic-net"><i class="fa fa-check"></i><b>9.4.3</b> Elastic net</a></li>
<li class="chapter" data-level="9.4.4" data-path="mlchapter.html"><a href="mlchapter.html#choosing-the-best-model"><i class="fa fa-check"></i><b>9.4.4</b> Choosing the best model</a></li>
<li class="chapter" data-level="9.4.5" data-path="mlchapter.html"><a href="mlchapter.html#regularised-mixed-models"><i class="fa fa-check"></i><b>9.4.5</b> Regularised mixed models</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="mlchapter.html"><a href="mlchapter.html#mlmethods"><i class="fa fa-check"></i><b>9.5</b> Machine learning models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mlchapter.html"><a href="mlchapter.html#decisiontrees"><i class="fa fa-check"></i><b>9.5.1</b> Decision trees</a></li>
<li class="chapter" data-level="9.5.2" data-path="mlchapter.html"><a href="mlchapter.html#randomforests"><i class="fa fa-check"></i><b>9.5.2</b> Random forests</a></li>
<li class="chapter" data-level="9.5.3" data-path="mlchapter.html"><a href="mlchapter.html#boosted-trees"><i class="fa fa-check"></i><b>9.5.3</b> Boosted trees</a></li>
<li class="chapter" data-level="9.5.4" data-path="mlchapter.html"><a href="mlchapter.html#model-trees"><i class="fa fa-check"></i><b>9.5.4</b> Model trees</a></li>
<li class="chapter" data-level="9.5.5" data-path="mlchapter.html"><a href="mlchapter.html#discriminant-analysis"><i class="fa fa-check"></i><b>9.5.5</b> Discriminant analysis</a></li>
<li class="chapter" data-level="9.5.6" data-path="mlchapter.html"><a href="mlchapter.html#support-vector-machines"><i class="fa fa-check"></i><b>9.5.6</b> Support vector machines</a></li>
<li class="chapter" data-level="9.5.7" data-path="mlchapter.html"><a href="mlchapter.html#nearest-neighbours-classifiers"><i class="fa fa-check"></i><b>9.5.7</b> Nearest neighbours classifiers</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="mlchapter.html"><a href="mlchapter.html#tsforecast"><i class="fa fa-check"></i><b>9.6</b> Forecasting time series</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="mlchapter.html"><a href="mlchapter.html#decomposition"><i class="fa fa-check"></i><b>9.6.1</b> Decomposition</a></li>
<li class="chapter" data-level="9.6.2" data-path="mlchapter.html"><a href="mlchapter.html#forecasting-using-arima-models"><i class="fa fa-check"></i><b>9.6.2</b> Forecasting using ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="mlchapter.html"><a href="mlchapter.html#deploying-models"><i class="fa fa-check"></i><b>9.7</b> Deploying models</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="mlchapter.html"><a href="mlchapter.html#creating-apis-with-plumber"><i class="fa fa-check"></i><b>9.7.1</b> Creating APIs with <code>plumber</code></a></li>
<li class="chapter" data-level="9.7.2" data-path="mlchapter.html"><a href="mlchapter.html#different-types-of-output"><i class="fa fa-check"></i><b>9.7.2</b> Different types of output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="advancedchapter.html"><a href="advancedchapter.html"><i class="fa fa-check"></i><b>10</b> Advanced topics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="advancedchapter.html"><a href="advancedchapter.html#moreonpackages"><i class="fa fa-check"></i><b>10.1</b> More on packages</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="advancedchapter.html"><a href="advancedchapter.html#loading-and-auto-installing-packages"><i class="fa fa-check"></i><b>10.1.1</b> Loading and auto-installing packages</a></li>
<li class="chapter" data-level="10.1.2" data-path="advancedchapter.html"><a href="advancedchapter.html#updating-r-and-your-packages"><i class="fa fa-check"></i><b>10.1.2</b> Updating R and your packages</a></li>
<li class="chapter" data-level="10.1.3" data-path="advancedchapter.html"><a href="advancedchapter.html#alternative-repositories"><i class="fa fa-check"></i><b>10.1.3</b> Alternative repositories</a></li>
<li class="chapter" data-level="10.1.4" data-path="advancedchapter.html"><a href="advancedchapter.html#removing-packages"><i class="fa fa-check"></i><b>10.1.4</b> Removing packages</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="advancedchapter.html"><a href="advancedchapter.html#parallel"><i class="fa fa-check"></i><b>10.2</b> Speeding up computations with parallelisation</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="advancedchapter.html"><a href="advancedchapter.html#parallelising-for-loops"><i class="fa fa-check"></i><b>10.2.1</b> Parallelising <code>for</code> loops</a></li>
<li class="chapter" data-level="10.2.2" data-path="advancedchapter.html"><a href="advancedchapter.html#parallelising-functionals"><i class="fa fa-check"></i><b>10.2.2</b> Parallelising functionals</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="advancedchapter.html"><a href="advancedchapter.html#linearalgebra"><i class="fa fa-check"></i><b>10.3</b> Linear algebra and matrices</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="advancedchapter.html"><a href="advancedchapter.html#creating-matrices"><i class="fa fa-check"></i><b>10.3.1</b> Creating matrices</a></li>
<li class="chapter" data-level="10.3.2" data-path="advancedchapter.html"><a href="advancedchapter.html#sparse-matrices"><i class="fa fa-check"></i><b>10.3.2</b> Sparse matrices</a></li>
<li class="chapter" data-level="10.3.3" data-path="advancedchapter.html"><a href="advancedchapter.html#matrix-operations"><i class="fa fa-check"></i><b>10.3.3</b> Matrix operations</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="advancedchapter.html"><a href="advancedchapter.html#integration"><i class="fa fa-check"></i><b>10.4</b> Integration with other programming languages</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-c"><i class="fa fa-check"></i><b>10.4.1</b> Integration with C++</a></li>
<li class="chapter" data-level="10.4.2" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-python"><i class="fa fa-check"></i><b>10.4.2</b> Integration with Python</a></li>
<li class="chapter" data-level="10.4.3" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-tensorflow-and-pytorch"><i class="fa fa-check"></i><b>10.4.3</b> Integration with Tensorflow and PyTorch</a></li>
<li class="chapter" data-level="10.4.4" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-spark"><i class="fa fa-check"></i><b>10.4.4</b> Integration with Spark</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="errorchapter.html"><a href="errorchapter.html"><i class="fa fa-check"></i><b>11</b> Debugging</a>
<ul>
<li class="chapter" data-level="11.1" data-path="errorchapter.html"><a href="errorchapter.html#debugging"><i class="fa fa-check"></i><b>11.1</b> Debugging</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="errorchapter.html"><a href="errorchapter.html#find-out-where-the-error-occured-with-traceback"><i class="fa fa-check"></i><b>11.1.1</b> Find out where the error occured with <code>traceback</code></a></li>
<li class="chapter" data-level="11.1.2" data-path="errorchapter.html"><a href="errorchapter.html#interactive-debugging-of-functions-with-debug"><i class="fa fa-check"></i><b>11.1.2</b> Interactive debugging of functions with <code>debug</code></a></li>
<li class="chapter" data-level="11.1.3" data-path="errorchapter.html"><a href="errorchapter.html#investigate-the-environment-with-recover"><i class="fa fa-check"></i><b>11.1.3</b> Investigate the environment with <code>recover</code></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="errorchapter.html"><a href="errorchapter.html#commonerrors"><i class="fa fa-check"></i><b>11.2</b> Common error messages</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="errorchapter.html"><a href="errorchapter.html#section-1"><i class="fa fa-check"></i><b>11.2.1</b> <code>+</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="errorchapter.html"><a href="errorchapter.html#could-not-find-function"><i class="fa fa-check"></i><b>11.2.2</b> <code>could not find function</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="errorchapter.html"><a href="errorchapter.html#object-not-found"><i class="fa fa-check"></i><b>11.2.3</b> <code>object not found</code></a></li>
<li class="chapter" data-level="11.2.4" data-path="errorchapter.html"><a href="errorchapter.html#cannot-open-the-connection-and-no-such-file-or-directory"><i class="fa fa-check"></i><b>11.2.4</b> <code>cannot open the connection</code> and <code>No such file or directory</code></a></li>
<li class="chapter" data-level="11.2.5" data-path="errorchapter.html"><a href="errorchapter.html#invalid-description-argument"><i class="fa fa-check"></i><b>11.2.5</b> <code>invalid 'description' argument</code></a></li>
<li class="chapter" data-level="11.2.6" data-path="errorchapter.html"><a href="errorchapter.html#missing-value-where-truefalse-needed"><i class="fa fa-check"></i><b>11.2.6</b> <code>missing value where TRUE/FALSE needed</code></a></li>
<li class="chapter" data-level="11.2.7" data-path="errorchapter.html"><a href="errorchapter.html#unexpected-in-..."><i class="fa fa-check"></i><b>11.2.7</b> <code>unexpected '=' in ...</code></a></li>
<li class="chapter" data-level="11.2.8" data-path="errorchapter.html"><a href="errorchapter.html#attempt-to-apply-non-function"><i class="fa fa-check"></i><b>11.2.8</b> <code>attempt to apply non-function</code></a></li>
<li class="chapter" data-level="11.2.9" data-path="errorchapter.html"><a href="errorchapter.html#undefined-columns-selected"><i class="fa fa-check"></i><b>11.2.9</b> <code>undefined columns selected</code></a></li>
<li class="chapter" data-level="11.2.10" data-path="errorchapter.html"><a href="errorchapter.html#subscript-out-of-bounds"><i class="fa fa-check"></i><b>11.2.10</b> <code>subscript out of bounds</code></a></li>
<li class="chapter" data-level="11.2.11" data-path="errorchapter.html"><a href="errorchapter.html#object-of-type-closure-is-not-subsettable"><i class="fa fa-check"></i><b>11.2.11</b> <code>Object of type ‘closure’ is not subsettable</code></a></li>
<li class="chapter" data-level="11.2.12" data-path="errorchapter.html"><a href="errorchapter.html#operator-is-invalid-for-atomic-vectors"><i class="fa fa-check"></i><b>11.2.12</b> <code>$ operator is invalid for atomic vectors</code></a></li>
<li class="chapter" data-level="11.2.13" data-path="errorchapter.html"><a href="errorchapter.html#list-object-cannot-be-coerced-to-type-double"><i class="fa fa-check"></i><b>11.2.13</b> <code>(list) object cannot be coerced to type ‘double’</code></a></li>
<li class="chapter" data-level="11.2.14" data-path="errorchapter.html"><a href="errorchapter.html#arguments-imply-differing-number-of-rows"><i class="fa fa-check"></i><b>11.2.14</b> <code>arguments imply differing number of rows</code></a></li>
<li class="chapter" data-level="11.2.15" data-path="errorchapter.html"><a href="errorchapter.html#non-numeric-argument-to-a-binary-operator"><i class="fa fa-check"></i><b>11.2.15</b> <code>non-numeric argument to a binary operator</code></a></li>
<li class="chapter" data-level="11.2.16" data-path="errorchapter.html"><a href="errorchapter.html#non-numeric-argument-to-mathematical-function"><i class="fa fa-check"></i><b>11.2.16</b> <code>non-numeric argument to mathematical function</code></a></li>
<li class="chapter" data-level="11.2.17" data-path="errorchapter.html"><a href="errorchapter.html#cannot-allocate-vector-of-size-..."><i class="fa fa-check"></i><b>11.2.17</b> <code>cannot allocate vector of size ...</code></a></li>
<li class="chapter" data-level="11.2.18" data-path="errorchapter.html"><a href="errorchapter.html#error-in-plot.new-figure-margins-too-large"><i class="fa fa-check"></i><b>11.2.18</b> <code>Error in plot.new() : figure margins too large</code></a></li>
<li class="chapter" data-level="11.2.19" data-path="errorchapter.html"><a href="errorchapter.html#error-in-.call.graphicsc_palette2-.callc_palette2-null-invalid-graphics-state"><i class="fa fa-check"></i><b>11.2.19</b> <code>Error in .Call.graphics(C_palette2, .Call(C_palette2, NULL)) : invalid graphics state</code></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="errorchapter.html"><a href="errorchapter.html#commonwarnings"><i class="fa fa-check"></i><b>11.3</b> Common warning messages</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="errorchapter.html"><a href="errorchapter.html#replacement-has-...-rows-..."><i class="fa fa-check"></i><b>11.3.1</b> <code>replacement has ... rows ...</code></a></li>
<li class="chapter" data-level="11.3.2" data-path="errorchapter.html"><a href="errorchapter.html#iferror"><i class="fa fa-check"></i><b>11.3.2</b> <code>the condition has length &gt; 1 and only the first element will be used</code></a></li>
<li class="chapter" data-level="11.3.3" data-path="errorchapter.html"><a href="errorchapter.html#number-of-items-to-replace-is-not-a-multiple-of-replacement-length"><i class="fa fa-check"></i><b>11.3.3</b> <code>number of items to replace is not a multiple of replacement length</code></a></li>
<li class="chapter" data-level="11.3.4" data-path="errorchapter.html"><a href="errorchapter.html#longer-object-length-is-not-a-multiple-of-shorter-object-length"><i class="fa fa-check"></i><b>11.3.4</b> <code>longer object length is not a multiple of shorter object length</code></a></li>
<li class="chapter" data-level="11.3.5" data-path="errorchapter.html"><a href="errorchapter.html#nas-introduced-by-coercion"><i class="fa fa-check"></i><b>11.3.5</b> <code>NAs introduced by coercion</code></a></li>
<li class="chapter" data-level="11.3.6" data-path="errorchapter.html"><a href="errorchapter.html#package-is-not-available-for-r-version-4.x.x"><i class="fa fa-check"></i><b>11.3.6</b> <code>package is not available (for R version 4.x.x)</code></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="errorchapter.html"><a href="errorchapter.html#installationmessages"><i class="fa fa-check"></i><b>11.4</b> Messages printed when installing <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mathschap.html"><a href="mathschap.html"><i class="fa fa-check"></i><b>12</b> Mathematical appendix</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mathschap.html"><a href="mathschap.html#bootstrapcimaths"><i class="fa fa-check"></i><b>12.1</b> Bootstrap confidence intervals</a></li>
<li class="chapter" data-level="12.2" data-path="mathschap.html"><a href="mathschap.html#confintequal"><i class="fa fa-check"></i><b>12.2</b> The equivalence between confidence intervals and hypothesis tests</a></li>
<li class="chapter" data-level="12.3" data-path="mathschap.html"><a href="mathschap.html#twotypesofpvalues"><i class="fa fa-check"></i><b>12.3</b> Two types of p-values</a></li>
<li class="chapter" data-level="12.4" data-path="mathschap.html"><a href="mathschap.html#deviance"><i class="fa fa-check"></i><b>12.4</b> Deviance tests</a></li>
<li class="chapter" data-level="12.5" data-path="mathschap.html"><a href="mathschap.html#regreg"><i class="fa fa-check"></i><b>12.5</b> Regularised regression</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>13</b> Solutions to exercises</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutionsch2"><i class="fa fa-check"></i>Chapter 2</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutionsch3"><i class="fa fa-check"></i>Chapter 3</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutionsch4"><i class="fa fa-check"></i>Chapter 4</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch5solutions"><i class="fa fa-check"></i>Chapter 5</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch6solutions"><i class="fa fa-check"></i>Chapter 6</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch7solutions"><i class="fa fa-check"></i>Chapter 7</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch7bsolutions"><i class="fa fa-check"></i>Chapter 8</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch8solutions"><i class="fa fa-check"></i>Chapter 9</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>Bibliography</a>
<ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references1"><i class="fa fa-check"></i>Further reading</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references2"><i class="fa fa-check"></i>Online resources</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references3"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="divider"></li>
<li>&copy; 2023 psnam</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R 통계분석</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="progchapter" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> R programming<a href="progchapter.html#progchapter" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The tools in Chapters <a href="thebasics.html#thebasics">2</a>-<a href="messychapter.html#messychapter">5</a> will allow you to manipulate, summarise and visualise your data in all sorts of ways. But what if you need to compute some statistic that there isn’t a function for? What if you need automatic checks of your data and results? What if you need to repeat the same analysis for a large number of files? This is where the programming tools you’ll learn about in this chapter, like loops and conditional statements, come in handy. And this is where you take the step from being able to use R for routine analyses to being able to use R for <em>any</em> analysis.</p>
<p>After working with the material in this chapter, you will be able to use R to:</p>
<ul>
<li>Write your own R functions,</li>
<li>Use several new pipe operators,</li>
<li>Use conditional statements to perform different operations depending on whether or not a condition is satisfied,</li>
<li>Iterate code operations multiple times using loops,</li>
<li>Iterate code operations multiple times using functionals,</li>
<li>Measure the performance of your R code.</li>
</ul>
<div id="functions" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Functions<a href="progchapter.html#functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose that we wish to compute the mean of a vector <code>x</code>. One way to do this would be to use <code>sum</code> and <code>length</code>:</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="progchapter.html#cb582-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb582-2"><a href="progchapter.html#cb582-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute mean:</span></span>
<span id="cb582-3"><a href="progchapter.html#cb582-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x)<span class="sc">/</span><span class="fu">length</span>(x)</span></code></pre></div>
<p>Now suppose that we wish to compute the mean of several vectors. We could do this by repeated use of <code>sum</code> and <code>length</code>:</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="progchapter.html#cb583-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb583-2"><a href="progchapter.html#cb583-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb583-3"><a href="progchapter.html#cb583-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">300</span></span>
<span id="cb583-4"><a href="progchapter.html#cb583-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb583-5"><a href="progchapter.html#cb583-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute means:</span></span>
<span id="cb583-6"><a href="progchapter.html#cb583-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb583-7"><a href="progchapter.html#cb583-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(y)<span class="sc">/</span><span class="fu">length</span>(y)</span>
<span id="cb583-8"><a href="progchapter.html#cb583-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(z)<span class="sc">/</span><span class="fu">length</span>(x)</span></code></pre></div>
<p>But wait! I made a mistake when I copied the code to compute the mean of <code>z</code> - I forgot to change <code>length(x)</code> to <code>length(z)</code>! This is an easy mistake to make when you repeatedly copy and paste code. In addition, repeating the same code multiple times just doesn’t look good. It would be much more convenient to have a single function for computing the means. Fortunately, such a function exists - <code>mean</code>:</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="progchapter.html#cb584-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute means</span></span>
<span id="cb584-2"><a href="progchapter.html#cb584-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span>
<span id="cb584-3"><a href="progchapter.html#cb584-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y)</span>
<span id="cb584-4"><a href="progchapter.html#cb584-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z)</span></code></pre></div>
<p>As you can see, using <code>mean</code> makes the code shorter and easier to read and reduces the risk of errors induced by copying and pasting code (we only have to change the argument of one function instead of two).</p>
<p>You’ve already used a ton of different functions in R: functions for computing means, manipulating data, plotting graphics, and more. All these functions have been written by somebody who thought that they needed to repeat a task (e.g. computing a mean or plotting a bar chart) over and over again. And in such cases, it is much more convenient to have a function that does that task than to have to write or copy code every time you want to do it. This is true also for your own work - whenever you need to repeat the same task several times, it is probably a good idea to write a function for it. It will reduce the amount of code you have to write and lessen the risk of errors caused by copying and pasting old code. In this section, you will learn how to write your own functions.</p>
<div id="createfunctions" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Creating functions<a href="progchapter.html#createfunctions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the sake of the example, let’s say that we wish to compute the mean of several vectors but that the function <code>mean</code> doesn’t exist. We would therefore like to write our own function for computing the mean of a vector. An R function takes some variables as input (arguments or parameters) and returns an object. Functions are defined using <code>function</code>. The definition follows a particular format:</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="progchapter.html#cb585-1" aria-hidden="true" tabindex="-1"></a>function_name <span class="ot">&lt;-</span> <span class="cf">function</span>(argument1, argument2, ...)</span>
<span id="cb585-2"><a href="progchapter.html#cb585-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb585-3"><a href="progchapter.html#cb585-3" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ...</span></span>
<span id="cb585-4"><a href="progchapter.html#cb585-4" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Some rows with code that creates some_object</span></span>
<span id="cb585-5"><a href="progchapter.html#cb585-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ...</span></span>
<span id="cb585-6"><a href="progchapter.html#cb585-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(some_object)</span>
<span id="cb585-7"><a href="progchapter.html#cb585-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In the case of our function for computing a mean, this could look like:</p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="progchapter.html#cb586-1" aria-hidden="true" tabindex="-1"></a>average <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb586-2"><a href="progchapter.html#cb586-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb586-3"><a href="progchapter.html#cb586-3" aria-hidden="true" tabindex="-1"></a>      avg <span class="ot">&lt;-</span> <span class="fu">sum</span>(x)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb586-4"><a href="progchapter.html#cb586-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(avg)</span>
<span id="cb586-5"><a href="progchapter.html#cb586-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This defines a function called <code>average</code>, that takes an object called <code>x</code> as input. It computes the sum of the elements of <code>x</code>, divides that by the number of elements in <code>x</code>, and returns the resulting mean.</p>
<p>If we now make a call to <code>average(x)</code>, our function will compute the mean value of the vector <code>x</code>. Let’s try it out, to see that it works:</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="progchapter.html#cb587-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb587-2"><a href="progchapter.html#cb587-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb587-3"><a href="progchapter.html#cb587-3" aria-hidden="true" tabindex="-1"></a><span class="fu">average</span>(x)</span>
<span id="cb587-4"><a href="progchapter.html#cb587-4" aria-hidden="true" tabindex="-1"></a><span class="fu">average</span>(y)</span></code></pre></div>
</div>
<div id="local-and-global-variables" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Local and global variables<a href="progchapter.html#local-and-global-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note that despite the fact that the vector was called <code>x</code> in the code we used to define the function, <code>average</code> works regardless of whether the input is called <code>x</code> or <code>y</code>. This is because R distinguishes between <em>global variables</em> and <em>local variables</em>. A global variable is created in the <em>global environment</em> outside a function, and is available to all functions (these are the variables that you can see in the Environment panel in RStudio). A local variable is created in the <em>local environment</em> inside a function, and is only available to that particular function. For instance, our <code>average</code> function creates a variable called <code>avg</code>, yet when we attempt to access <code>avg</code> after running <code>average</code> this variable doesn’t seem to exist:</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="progchapter.html#cb588-1" aria-hidden="true" tabindex="-1"></a><span class="fu">average</span>(x)</span>
<span id="cb588-2"><a href="progchapter.html#cb588-2" aria-hidden="true" tabindex="-1"></a>avg</span></code></pre></div>
<p>Because <code>avg</code> is a local variable, it is only available inside of the <code>average</code> function. Local variables take precedence over global variables inside the functions to which they belong. Because we named the argument used in the function <code>x</code>, <code>x</code> becomes the name of a local variable in <code>average</code>. As far as <code>average</code> is concerned, there is only one variable named <code>x</code>, and that is whatever object that was given as input to the function, regardless of what its original name was. Any operations performed on the local variable <code>x</code> won’t affect the global variable <code>x</code> at all.</p>
<p>Functions can access global variables:</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="progchapter.html#cb589-1" aria-hidden="true" tabindex="-1"></a>y_squared <span class="ot">&lt;-</span> <span class="cf">function</span>()</span>
<span id="cb589-2"><a href="progchapter.html#cb589-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb589-3"><a href="progchapter.html#cb589-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(y<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb589-4"><a href="progchapter.html#cb589-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb589-5"><a href="progchapter.html#cb589-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb589-6"><a href="progchapter.html#cb589-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb589-7"><a href="progchapter.html#cb589-7" aria-hidden="true" tabindex="-1"></a><span class="fu">y_squared</span>()</span></code></pre></div>
<p>But operations performed on global variables inside functions won’t affect the global variable:</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="progchapter.html#cb590-1" aria-hidden="true" tabindex="-1"></a>add_to_y <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb590-2"><a href="progchapter.html#cb590-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb590-3"><a href="progchapter.html#cb590-3" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;-</span> y <span class="sc">+</span> n</span>
<span id="cb590-4"><a href="progchapter.html#cb590-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb590-5"><a href="progchapter.html#cb590-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb590-6"><a href="progchapter.html#cb590-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb590-7"><a href="progchapter.html#cb590-7" aria-hidden="true" tabindex="-1"></a><span class="fu">add_to_y</span>(<span class="dv">1</span>)</span>
<span id="cb590-8"><a href="progchapter.html#cb590-8" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<p>Suppose you really need to change a global variable inside a function<a href="#fn40" class="footnote-ref" id="fnref40"><sup>40</sup></a>. In that case, you can use an alternative assignment operator, <code>&lt;&lt;-</code>, which assigns a value to the variable in the <em>parent environment</em> to the current environment. If you use <code>&lt;&lt;-</code> for assignment inside a function that is called from the global environment, this means that the assignment takes place in the global environment. But if you use <code>&lt;&lt;-</code> in a function (function 1) that is called by another function (function 2), the assignment will take place in the environment for function 2, thus affecting a local variable in function 2. Here is an example of a global assignment using <code>&lt;&lt;-</code>:</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="progchapter.html#cb591-1" aria-hidden="true" tabindex="-1"></a>add_to_y_global <span class="ot">&lt;-</span> <span class="cf">function</span>(n)</span>
<span id="cb591-2"><a href="progchapter.html#cb591-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb591-3"><a href="progchapter.html#cb591-3" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;&lt;-</span> y <span class="sc">+</span> n</span>
<span id="cb591-4"><a href="progchapter.html#cb591-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb591-5"><a href="progchapter.html#cb591-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb591-6"><a href="progchapter.html#cb591-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb591-7"><a href="progchapter.html#cb591-7" aria-hidden="true" tabindex="-1"></a><span class="fu">add_to_y_global</span>(<span class="dv">1</span>)</span>
<span id="cb591-8"><a href="progchapter.html#cb591-8" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
</div>
<div id="willfunctionwork" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Will your function work?<a href="progchapter.html#willfunctionwork" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is always a good idea to test if your function works as intended, and to try to figure out what can cause it to break. Let’s return to our <code>average</code> function:</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="progchapter.html#cb592-1" aria-hidden="true" tabindex="-1"></a>average <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb592-2"><a href="progchapter.html#cb592-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb592-3"><a href="progchapter.html#cb592-3" aria-hidden="true" tabindex="-1"></a>      avg <span class="ot">&lt;-</span> <span class="fu">sum</span>(x)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb592-4"><a href="progchapter.html#cb592-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(avg)</span>
<span id="cb592-5"><a href="progchapter.html#cb592-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We’ve already seen that it seems to work when the input <code>x</code> is a numeric vector. But what happens if we input something else instead?</p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="progchapter.html#cb593-1" aria-hidden="true" tabindex="-1"></a><span class="fu">average</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">8</span>)) <span class="co"># Numeric input</span></span>
<span id="cb593-2"><a href="progchapter.html#cb593-2" aria-hidden="true" tabindex="-1"></a><span class="fu">average</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)) <span class="co"># Logical input</span></span>
<span id="cb593-3"><a href="progchapter.html#cb593-3" aria-hidden="true" tabindex="-1"></a><span class="fu">average</span>(<span class="fu">c</span>(<span class="st">&quot;Lady Gaga&quot;</span>, <span class="st">&quot;Tool&quot;</span>, <span class="st">&quot;Dry the River&quot;</span>)) <span class="co"># Character input</span></span>
<span id="cb593-4"><a href="progchapter.html#cb593-4" aria-hidden="true" tabindex="-1"></a><span class="fu">average</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>))) <span class="co"># Numeric df</span></span>
<span id="cb593-5"><a href="progchapter.html#cb593-5" aria-hidden="true" tabindex="-1"></a><span class="fu">average</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">8</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>))) <span class="co"># Mixed type</span></span></code></pre></div>
<p>The first two of these render the desired output (the <code>logical</code> values being represented by 0’s and 1’s), but the rest don’t. Many R functions include checks that the input is of the correct type, or checks to see which method should be applied depending on what data type the input is. We’ll learn how to perform such checks in Section <a href="progchapter.html#conditions">6.3</a>.</p>
<p>As a side note, it is possible to write functions that don’t end with <code>return</code>. In that case, the output (i.e. what would be written in the Console if you’d run the code there) from the last line of the function will automatically be returned. I prefer to (almost) always use <code>return</code> though, as it is easy to accidentally make the function return nothing by finishing it with a line that yields no output. Below are two examples of how we could have written <code>average</code> without a call to <code>return</code>. The first doesn’t work as intended, because the function’s final (and only) line doesn’t give any output.</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="progchapter.html#cb594-1" aria-hidden="true" tabindex="-1"></a>average_bad <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb594-2"><a href="progchapter.html#cb594-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb594-3"><a href="progchapter.html#cb594-3" aria-hidden="true" tabindex="-1"></a>      avg <span class="ot">&lt;-</span> <span class="fu">sum</span>(x)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb594-4"><a href="progchapter.html#cb594-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb594-5"><a href="progchapter.html#cb594-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-6"><a href="progchapter.html#cb594-6" aria-hidden="true" tabindex="-1"></a>average_ok <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb594-7"><a href="progchapter.html#cb594-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb594-8"><a href="progchapter.html#cb594-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(x)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb594-9"><a href="progchapter.html#cb594-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb594-10"><a href="progchapter.html#cb594-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb594-11"><a href="progchapter.html#cb594-11" aria-hidden="true" tabindex="-1"></a><span class="fu">average_bad</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">8</span>))</span>
<span id="cb594-12"><a href="progchapter.html#cb594-12" aria-hidden="true" tabindex="-1"></a><span class="fu">average_ok</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">8</span>))</span></code></pre></div>
</div>
<div id="more-on-arguments" class="section level3 hasAnchor" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> More on arguments<a href="progchapter.html#more-on-arguments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is possible to create functions with as many arguments as you like, but it will become quite unwieldy if the user has to supply too many arguments to your function. It is therefore common to provide default values to arguments, which is done by setting a value in the <code>function</code> call. Here is an example of a function that computes <span class="math inline">\(x^n\)</span>, using <span class="math inline">\(n=2\)</span> as the default:</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="progchapter.html#cb595-1" aria-hidden="true" tabindex="-1"></a>power_n <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb595-2"><a href="progchapter.html#cb595-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb595-3"><a href="progchapter.html#cb595-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(x<span class="sc">^</span>n)</span>
<span id="cb595-4"><a href="progchapter.html#cb595-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>If we don’t supply <code>n</code>, <code>power_n</code> uses the default <code>n = 2</code>:</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="progchapter.html#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power_n</span>(<span class="dv">3</span>)</span></code></pre></div>
<p>But if we supply an <code>n</code>, <code>power_n</code> will use that instead:</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="progchapter.html#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power_n</span>(<span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb597-2"><a href="progchapter.html#cb597-2" aria-hidden="true" tabindex="-1"></a><span class="fu">power_n</span>(<span class="dv">3</span>, <span class="dv">3</span>)</span></code></pre></div>
<p>For clarity, you can specify which value corresponds to which argument:</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="progchapter.html#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power_n</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>…and can then even put the arguments in the wrong order:</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="progchapter.html#cb599-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power_n</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">x =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>However, if we only supply <code>n</code> we get an error, because there is no default value for <code>x</code>:</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="progchapter.html#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power_n</span>(<span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>It is possible to pass a function as an argument. Here is a function that takes a vector and a function as input, and applies the function to the first two elements of the vector:</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="progchapter.html#cb601-1" aria-hidden="true" tabindex="-1"></a>apply_to_first2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, func)</span>
<span id="cb601-2"><a href="progchapter.html#cb601-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb601-3"><a href="progchapter.html#cb601-3" aria-hidden="true" tabindex="-1"></a>      result <span class="ot">&lt;-</span> <span class="fu">func</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb601-4"><a href="progchapter.html#cb601-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(result)</span>
<span id="cb601-5"><a href="progchapter.html#cb601-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>By supplying different functions to <code>apply_to_first2</code>, we can make it perform different tasks:</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="progchapter.html#cb602-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb602-2"><a href="progchapter.html#cb602-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply_to_first2</span>(x, sqrt)</span>
<span id="cb602-3"><a href="progchapter.html#cb602-3" aria-hidden="true" tabindex="-1"></a><span class="fu">apply_to_first2</span>(x, is.character)</span>
<span id="cb602-4"><a href="progchapter.html#cb602-4" aria-hidden="true" tabindex="-1"></a><span class="fu">apply_to_first2</span>(x, power_n)</span></code></pre></div>
<p>But what if the function that we supply requires additional arguments? Using <code>apply_to_first2</code> with <code>sum</code> and the vector <code>c(4, 5, 6)</code> works fine:</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="progchapter.html#cb603-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply_to_first2</span>(x, sum)</span></code></pre></div>
<p>But if we instead use the vector <code>c(4, NA, 6)</code> the function returns <code>NA</code> :</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="progchapter.html#cb604-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="cn">NA</span>, <span class="dv">6</span>)</span>
<span id="cb604-2"><a href="progchapter.html#cb604-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply_to_first2</span>(x, sum)</span></code></pre></div>
<p>Perhaps we’d like to pass <code>na.rm = TRUE</code> to <code>sum</code> to ensure that we get a <code>numeric</code> result, if at all possible. This can be done by adding <code>...</code> to the list of arguments for both functions, which indicates additional parameters (to be supplied by the user) that will be passed to <code>func</code>:</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="progchapter.html#cb605-1" aria-hidden="true" tabindex="-1"></a>apply_to_first2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, func, ...)</span>
<span id="cb605-2"><a href="progchapter.html#cb605-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb605-3"><a href="progchapter.html#cb605-3" aria-hidden="true" tabindex="-1"></a>      result <span class="ot">&lt;-</span> <span class="fu">func</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], ...)</span>
<span id="cb605-4"><a href="progchapter.html#cb605-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(result)</span>
<span id="cb605-5"><a href="progchapter.html#cb605-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb605-6"><a href="progchapter.html#cb605-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb605-7"><a href="progchapter.html#cb605-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="cn">NA</span>, <span class="dv">6</span>)</span>
<span id="cb605-8"><a href="progchapter.html#cb605-8" aria-hidden="true" tabindex="-1"></a><span class="fu">apply_to_first2</span>(x, sum)</span>
<span id="cb605-9"><a href="progchapter.html#cb605-9" aria-hidden="true" tabindex="-1"></a><span class="fu">apply_to_first2</span>(x, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch6exc1" class="exercise"><strong>Exercise 6.1  </strong></span>Write a function that converts temperature measurements in degrees Fahrenheit to degrees Celsius, and apply it to the <code>Temp</code> column of the <code>airquality</code> data.</p>
</div>
<p><a href="solutions.html#ch6solutions1">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch6exc2" class="exercise"><strong>Exercise 6.2  </strong></span>Practice writing functions by doing the following:</p>
<ol style="list-style-type: decimal">
<li><p>Write a function that takes a vector as input and returns a vector containing its minimum and maximum, without using <code>min</code> and <code>max</code>.</p></li>
<li><p>Write a function that computes the mean of the squared values of a vector using <code>mean</code>, and that takes additional arguments that it passes on to <code>mean</code> (e.g. <code>na.rm</code>).</p></li>
</ol>
</div>
<p><a href="solutions.html#ch6solutions2">(Click here to go to the solution.)</a></p>
</div>
<div id="namespaces" class="section level3 hasAnchor" number="6.1.5">
<h3><span class="header-section-number">6.1.5</span> Namespaces<a href="progchapter.html#namespaces" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is possible, and even likely, that you will encounter functions in packages with the same name as functions in other packages. Or, similarly, that there are functions in packages with the same names as those you have written yourself. This is of course a bit of a headache, but it’s actually something that can be overcome without changing the names of the functions. Just like variables can live in different environments, R functions live in <em>namespaces</em>, usually corresponding to either the global environment or the package they belong to. By specifying which namespace to look for the function in, you can use multiple functions that all have the same name.</p>
<p>For example, let’s create a function called <code>sqrt</code>. There is already such a function in the <code>base</code> package<a href="#fn41" class="footnote-ref" id="fnref41"><sup>41</sup></a> (see <code>?sqrt</code>), but let’s do it anyway:</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="progchapter.html#cb606-1" aria-hidden="true" tabindex="-1"></a>sqrt <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb606-2"><a href="progchapter.html#cb606-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb606-3"><a href="progchapter.html#cb606-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(x<span class="sc">^</span><span class="dv">10</span>)</span>
<span id="cb606-4"><a href="progchapter.html#cb606-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>If we now apply <code>sqrt</code> to an object, the function that we just defined will be used:</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="progchapter.html#cb607-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">4</span>)</span></code></pre></div>
<p>But if we want to use the <code>sqrt</code> from <code>base</code>, we can specify that by writing the namespace (which almost always is the package name) followed by <code>::</code> and the function name:</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="progchapter.html#cb608-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">sqrt</span>(<span class="dv">4</span>)</span></code></pre></div>
<p>The <code>::</code> notation can also be used to call a function or object from a package without loading the package’s namespace:</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="progchapter.html#cb609-1" aria-hidden="true" tabindex="-1"></a>msleep <span class="co"># Doesn&#39;t work if ggplot2 isn&#39;t loaded</span></span>
<span id="cb609-2"><a href="progchapter.html#cb609-2" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span>msleep <span class="co"># Works, without loading the ggplot2 namespace!</span></span></code></pre></div>
<p>When you call a function, R will look for it in all active namespaces, following a particular order. To see the order of the namespaces, you can use <code>search</code>:</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="progchapter.html#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="fu">search</span>()</span></code></pre></div>
<p>Note that the global environment is first in this list - meaning that the functions that you define always will be preferred to functions in packages.</p>
<p>All this being said, note that it is bad practice to give your functions and variables the same names as common functions. Don’t name them <code>mean</code>, <code>c</code> or <code>sqrt</code>. Nothing good can ever come from that sort of behaviour.</p>
<p>Nothing.</p>
</div>
<div id="sourcing-other-scripts" class="section level3 hasAnchor" number="6.1.6">
<h3><span class="header-section-number">6.1.6</span> Sourcing other scripts<a href="progchapter.html#sourcing-other-scripts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you want to reuse a function that you have written in a new script, you can of course copy it into that script. But if you then make changes to your function, you will quickly end up with several different versions of it. A better idea can therefore be to put the function in a separate script, which you then can call in each script where you need the function. This is done using <code>source</code>. If, for instance, you have code that defines some functions in a file called <code>helper-functions.R</code> in your working directory, you can run it (thus defining the functions) when the rest of your code is run by adding <code>source("helper-functions.R")</code> to your code.</p>
<p>Another option is to create an R package containing the function, but that is beyond the scope of this book. Should you choose to go down that route, I highly recommend reading <a href="https://r-pkgs.org/index.html"><em>R Packages</em></a> by Wickham and Bryan.</p>
</div>
</div>
<div id="morepipes" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> More on pipes<a href="progchapter.html#morepipes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have seen how the <code>magrittr</code> pipe <code>%&gt;%</code> can be used to chain functions together. But there are also other pipe operators that are useful. In this section we’ll look at some of them, and see how you can create functions using pipes.</p>
<div id="ce-ne-sont-pas-non-plus-des-pipes" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> <em>Ce ne sont pas non plus des pipes</em><a href="progchapter.html#ce-ne-sont-pas-non-plus-des-pipes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Although <code>%&gt;%</code> is the most used pipe operator, the <code>magrittr</code> package provides a number of other pipes that are useful in certain situations.</p>
<p>One example is when you want to pass variables rather than an entire dataset to the next function. This is needed for instance if you want to use <code>cor</code> to compute the correlation between two variables, because <code>cor</code> takes two vectors as input instead of a data frame. You can do it using ordinary <code>%&gt;%</code> pipes:</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="progchapter.html#cb611-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb611-2"><a href="progchapter.html#cb611-2" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span></span>
<span id="cb611-3"><a href="progchapter.html#cb611-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">subset</span>(Temp <span class="sc">&gt;</span> <span class="dv">80</span>) <span class="sc">%&gt;%</span></span>
<span id="cb611-4"><a href="progchapter.html#cb611-4" aria-hidden="true" tabindex="-1"></a>      {<span class="fu">cor</span>(.<span class="sc">$</span>Temp, .<span class="sc">$</span>Wind)}</span></code></pre></div>
<p>However, the curly brackets <code>{}</code> and the dots <code>.</code> makes this a little awkward and difficult to read. A better option is to use the <code>%$%</code> pipe, which passes on the names of all variables in your data frame instead:</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="progchapter.html#cb612-1" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> </span>
<span id="cb612-2"><a href="progchapter.html#cb612-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">subset</span>(Temp <span class="sc">&gt;</span> <span class="dv">80</span>) <span class="sc">%$%</span> </span>
<span id="cb612-3"><a href="progchapter.html#cb612-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cor</span>(Temp, Wind)</span></code></pre></div>
<p>If you want to modify a variable using a pipe, you can use the <em>compound assignment</em> pipe <code>%&lt;&gt;%</code>. The following three lines all yield exactly the same result:</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="progchapter.html#cb613-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>;   x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(x);        x</span>
<span id="cb613-2"><a href="progchapter.html#cb613-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>;   x <span class="sc">%&gt;%</span> sqrt <span class="ot">-&gt;</span> x;     x   </span>
<span id="cb613-3"><a href="progchapter.html#cb613-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>;   x <span class="sc">%&lt;&gt;%</span> sqrt;         x</span></code></pre></div>
<p>As long as the first pipe in the pipeline is the compound assignment operator <code>%&lt;&gt;%</code>, you can combine it with other pipes:</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="progchapter.html#cb614-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb614-2"><a href="progchapter.html#cb614-2" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%&lt;&gt;%</span> <span class="fu">subset</span>(x <span class="sc">&gt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> sqrt</span>
<span id="cb614-3"><a href="progchapter.html#cb614-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<p>Sometimes you want to do something in the middle of a pipeline, like creating a plot, before continuing to the next step in the chain. The <em>tee</em> operator <code>%T&gt;%</code> can be used to execute a function without passing on its output (if any). Instead, it passes on the output to its left. Here is an example:</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="progchapter.html#cb615-1" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> </span>
<span id="cb615-2"><a href="progchapter.html#cb615-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">subset</span>(Temp <span class="sc">&gt;</span> <span class="dv">80</span>) <span class="sc">%T&gt;%</span></span>
<span id="cb615-3"><a href="progchapter.html#cb615-3" aria-hidden="true" tabindex="-1"></a>      plot <span class="sc">%$%</span> </span>
<span id="cb615-4"><a href="progchapter.html#cb615-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cor</span>(Temp, Wind)</span></code></pre></div>
<p>Note that if we’d used an ordinary pipe <code>%&gt;%</code> instead, we’d get an error:</p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="progchapter.html#cb616-1" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> </span>
<span id="cb616-2"><a href="progchapter.html#cb616-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">subset</span>(Temp <span class="sc">&gt;</span> <span class="dv">80</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb616-3"><a href="progchapter.html#cb616-3" aria-hidden="true" tabindex="-1"></a>      plot <span class="sc">%$%</span> </span>
<span id="cb616-4"><a href="progchapter.html#cb616-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cor</span>(Temp, Wind)</span></code></pre></div>
<p>The reason is that <code>cor</code> looks for the variables <code>Temp</code> and <code>Wind</code> in the plot object, and not in the data frame. The tee operator takes care of this by passing on the data from its left side.</p>
<p>Remember that if you have a function where data only appears within parentheses, you need to wrap the function in curly brackets:</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="progchapter.html#cb617-1" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> </span>
<span id="cb617-2"><a href="progchapter.html#cb617-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">subset</span>(Temp <span class="sc">&gt;</span> <span class="dv">80</span>) <span class="sc">%T&gt;%</span></span>
<span id="cb617-3"><a href="progchapter.html#cb617-3" aria-hidden="true" tabindex="-1"></a>      {<span class="fu">cat</span>(<span class="st">&quot;Number of rows in data:&quot;</span>, <span class="fu">nrow</span>(.), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)} <span class="sc">%$%</span> </span>
<span id="cb617-4"><a href="progchapter.html#cb617-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cor</span>(Temp, Wind)</span></code></pre></div>
<p>When using the tee operator, this is true also for call to <code>ggplot</code>, where you additionally need to wrap the plot object in a call to <code>print</code>:</p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="progchapter.html#cb618-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb618-2"><a href="progchapter.html#cb618-2" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> </span>
<span id="cb618-3"><a href="progchapter.html#cb618-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">subset</span>(Temp <span class="sc">&gt;</span> <span class="dv">80</span>) <span class="sc">%T&gt;%</span></span>
<span id="cb618-4"><a href="progchapter.html#cb618-4" aria-hidden="true" tabindex="-1"></a>      {<span class="fu">print</span>(<span class="fu">ggplot</span>(., <span class="fu">aes</span>(Temp, Wind)) <span class="sc">+</span> <span class="fu">geom_point</span>())} <span class="sc">%$%</span> </span>
<span id="cb618-5"><a href="progchapter.html#cb618-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cor</span>(Temp, Wind)</span></code></pre></div>
</div>
<div id="writing-functions-with-pipes" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Writing functions with pipes<a href="progchapter.html#writing-functions-with-pipes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you will be reusing the same pipeline multiple times, you may want to create a function for it. Let’s say that you have a data frame containing only <code>numeric</code> variables, and that you want to create a scatterplot matrix (which can be done using <code>plot</code>) and compute the correlations between all variables (using <code>cor</code>). As an example, you could do this for <code>airquality</code> as follows:</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="progchapter.html#cb619-1" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%T&gt;%</span> plot <span class="sc">%&gt;%</span> cor</span></code></pre></div>
<p>To define a function for this combination of operators, we simply write:</p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="progchapter.html#cb620-1" aria-hidden="true" tabindex="-1"></a>plot_and_cor <span class="ot">&lt;-</span> . <span class="sc">%T&gt;%</span> plot <span class="sc">%&gt;%</span> cor</span></code></pre></div>
<p>Note that we don’t have to write <code>function(...)</code> when defining functions with pipes!</p>
<p>We can now use this function just like any other:</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="progchapter.html#cb621-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With the airquality data:</span></span>
<span id="cb621-2"><a href="progchapter.html#cb621-2" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> plot_and_cor</span>
<span id="cb621-3"><a href="progchapter.html#cb621-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_and_cor</span>(airquality)</span>
<span id="cb621-4"><a href="progchapter.html#cb621-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb621-5"><a href="progchapter.html#cb621-5" aria-hidden="true" tabindex="-1"></a><span class="co"># With the bookstore data:</span></span>
<span id="cb621-6"><a href="progchapter.html#cb621-6" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">48</span>, <span class="dv">47</span>, <span class="dv">71</span>, <span class="dv">22</span>, <span class="dv">80</span>, <span class="dv">48</span>, <span class="dv">30</span>, <span class="dv">31</span>)</span>
<span id="cb621-7"><a href="progchapter.html#cb621-7" aria-hidden="true" tabindex="-1"></a>purchase <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">59</span>, <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">160</span>, <span class="dv">34</span>, <span class="dv">34</span>, <span class="dv">29</span>)</span>
<span id="cb621-8"><a href="progchapter.html#cb621-8" aria-hidden="true" tabindex="-1"></a>bookstore <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(age, purchase)</span>
<span id="cb621-9"><a href="progchapter.html#cb621-9" aria-hidden="true" tabindex="-1"></a>bookstore <span class="sc">%&gt;%</span> plot_and_cor</span></code></pre></div>
<p><span class="math display">\[\sim\]</span>
::: {.exercise #ch6exc2b}
Write a function that takes a data frame as input and uses pipes to print the number of <code>NA</code> values in the data, remove all rows with <code>NA</code> values and return a summary of the remaining data.</p>
<p>:::
<a href="solutions.html#ch6solutions2b">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch6exc2c" class="exercise"><strong>Exercise 6.3  </strong></span>Pipes are operators, that is, functions that take two variables as input and can be written without parentheses (other examples of operators are <code>+</code> and <code>*</code>). You can define your own operators just as you would any other function. For instance, we can define an operator called <code>quadratic</code> that takes two numbers <code>a</code> and <code>b</code> as input and computes the quadratic expression <span class="math inline">\((a+b)^2\)</span>:</p>
</div>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="progchapter.html#cb622-1" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">%quadratic%</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b) { (a <span class="sc">+</span> b)<span class="sc">^</span><span class="dv">2</span> }</span>
<span id="cb622-2"><a href="progchapter.html#cb622-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">%quadratic%</span> <span class="dv">3</span></span></code></pre></div>
<p>Create an operator called <code>%against%</code> that takes two vectors as input and draws a scatterplot of them.</p>
<p><a href="solutions.html#ch6solutions2c">(Click here to go to the solution.)</a></p>
</div>
</div>
<div id="conditions" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Checking conditions<a href="progchapter.html#conditions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sometimes you’d like your code to perform different operations depending on whether or not a certain condition is fulfilled. Perhaps you want it to do something different if there is missing data, if the input is a <code>character</code> vector, or if the largest value in a <code>numeric</code> vector is greater than some number. In Section <a href="datachapter.html#conditionsintro">3.2.3</a> you learned how to filter data using conditions. In this section, you’ll learn how to use conditional statements for a number of other tasks.</p>
<div id="if-and-else" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> <code>if</code> and <code>else</code><a href="progchapter.html#if-and-else" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The most important functions for checking whether a condition is fulfilled are <code>if</code> and <code>else</code>. The basic syntax is</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="progchapter.html#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(condition) { do something } <span class="cf">else</span> { do something <span class="cf">else</span> }</span></code></pre></div>
<p>The condition should return a single <code>logical</code> value, so that it evaluates to either <code>TRUE</code> or <code>FALSE</code>. If the condition is fulfilled, i.e. if it is <code>TRUE</code>, the code inside the first pair of curly brackets will run, and if it’s not (<code>FALSE</code>), the code within the second pair of curly brackets will run instead.</p>
<p>As a first example, assume that you want to compute the reciprocal of <span class="math inline">\(x\)</span>, <span class="math inline">\(1/x\)</span>, unless <span class="math inline">\(x=0\)</span>, in which case you wish to print an error message:</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="progchapter.html#cb624-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb624-2"><a href="progchapter.html#cb624-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(x <span class="sc">==</span> <span class="dv">0</span>) { <span class="fu">cat</span>(<span class="st">&quot;Error! Division by zero.&quot;</span>) } <span class="cf">else</span> { <span class="dv">1</span><span class="sc">/</span>x }</span></code></pre></div>
<p>Now try running the same code with <code>x</code> set to <code>0</code>:</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="progchapter.html#cb625-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb625-2"><a href="progchapter.html#cb625-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(x <span class="sc">==</span> <span class="dv">0</span>) { <span class="fu">cat</span>(<span class="st">&quot;Error! Division by zero.&quot;</span>) } <span class="cf">else</span> { <span class="dv">1</span><span class="sc">/</span>x }</span></code></pre></div>
<p>Alternatively, we could check if <span class="math inline">\(x\neq 0\)</span> and then change the order of the segments within the curly brackets:</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="progchapter.html#cb626-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb626-2"><a href="progchapter.html#cb626-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(x <span class="sc">!=</span> <span class="dv">0</span>) { <span class="dv">1</span><span class="sc">/</span>x } <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">&quot;Error! Division by zero.&quot;</span>) }</span></code></pre></div>
<p>You don’t have to write all of the code on the same line, but you must make sure that the <code>else</code> part is on the same line as the first <code>}</code>:</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="progchapter.html#cb627-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(x <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb627-2"><a href="progchapter.html#cb627-2" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb627-3"><a href="progchapter.html#cb627-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Error! Division by zero.&quot;</span>)</span>
<span id="cb627-4"><a href="progchapter.html#cb627-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span></span>
<span id="cb627-5"><a href="progchapter.html#cb627-5" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb627-6"><a href="progchapter.html#cb627-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">/</span>x</span>
<span id="cb627-7"><a href="progchapter.html#cb627-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>You can also choose not to have an <code>else</code> part at all. In that case, the code inside the curly brackets will run if the condition is satisfied, and if not, nothing will happen:</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="progchapter.html#cb628-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb628-2"><a href="progchapter.html#cb628-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(x <span class="sc">==</span> <span class="dv">0</span>) { <span class="fu">cat</span>(<span class="st">&quot;x is 0.&quot;</span>) }</span>
<span id="cb628-3"><a href="progchapter.html#cb628-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb628-4"><a href="progchapter.html#cb628-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb628-5"><a href="progchapter.html#cb628-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(x <span class="sc">==</span> <span class="dv">0</span>) { <span class="fu">cat</span>(<span class="st">&quot;x is 0.&quot;</span>) }</span></code></pre></div>
<p>Finally, if you need to check a number of conditions one after another, in order to list different possibilities, you can do so by repeated use of <code>if</code> and <code>else</code>:</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="progchapter.html#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(x <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb629-2"><a href="progchapter.html#cb629-2" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb629-3"><a href="progchapter.html#cb629-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Error! Division by zero.&quot;</span>)</span>
<span id="cb629-4"><a href="progchapter.html#cb629-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">is.infinite</span>((x)))</span>
<span id="cb629-5"><a href="progchapter.html#cb629-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb629-6"><a href="progchapter.html#cb629-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Error! Divison by infinity.&quot;</span>)</span>
<span id="cb629-7"><a href="progchapter.html#cb629-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span>(<span class="fu">is.na</span>((x)))</span>
<span id="cb629-8"><a href="progchapter.html#cb629-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb629-9"><a href="progchapter.html#cb629-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Error! Divison by NA.&quot;</span>)</span>
<span id="cb629-10"><a href="progchapter.html#cb629-10" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span></span>
<span id="cb629-11"><a href="progchapter.html#cb629-11" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb629-12"><a href="progchapter.html#cb629-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">/</span>x</span>
<span id="cb629-13"><a href="progchapter.html#cb629-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="section" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> <code>&amp;</code> &amp; <code>&amp;&amp;</code><a href="progchapter.html#section" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Just as when we used conditions for filtering in Sections <a href="datachapter.html#conditionsintro">3.2.3</a> and <a href="messychapter.html#conditions2">5.8.2</a>, it is possible to combine several conditions into one using <code>&amp;</code> (AND) and <code>|</code> (OR). However, the <code>&amp;</code> and <code>|</code> operators are vectorised, meaning that they will return a vector of <code>logical</code> values whenever possible. This is not desirable in conditional statements, where the condition must evaluate to a single value. Using a condition that returns a vector results in a warning message:</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="progchapter.html#cb630-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">==</span> <span class="dv">2</span>) { <span class="fu">cat</span>(<span class="st">&quot;The vector contains the number 2.</span><span class="sc">\n</span><span class="st">&quot;</span>) }</span>
<span id="cb630-2"><a href="progchapter.html#cb630-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>) <span class="sc">==</span> <span class="dv">2</span>) { <span class="fu">cat</span>(<span class="st">&quot;The vector contains the number 2.</span><span class="sc">\n</span><span class="st">&quot;</span>) }</span></code></pre></div>
<p>As you can see, only the first element of the <code>logical</code> vector is evaluated by <code>if</code>. Usually, if a condition evaluates to a vector, it is because you’ve made an error in your code. Remember, if you really need to evaluate a condition regarding the elements in a vector, you can collapse the resulting <code>logical</code> vector to a single value using <code>any</code> or <code>all</code>.</p>
<p>Some texts recommend using the operators <code>&amp;&amp;</code> and <code>||</code> instead of <code>&amp;</code> and <code>|</code> in conditional statements. These work almost like <code>&amp;</code> and <code>|</code>, but force the condition to evaluate to a single <code>logical</code>. I prefer to use <code>&amp;</code> and <code>|</code>, because I want to be notified if my condition evaluates to a vector - once again, that likely means that there is an error somewhere in my code!</p>
<p>There is, however, one case where I much prefer <code>&amp;&amp;</code> and <code>||</code>. <code>&amp;</code> and <code>|</code> always evaluate all the conditions that you’re combining, while <code>&amp;&amp;</code> and <code>||</code> don’t: <code>&amp;&amp;</code> stops as soon as it encounters a <code>FALSE</code> and <code>||</code> stops as soon as it encounters a <code>TRUE</code>. Consequently, you can put the conditions you wish to combine in a particular order to make sure that they can be evaluated. For instance, you may want first to check that a variable exists, and then check a property. This can be done using <code>exists</code> to check whether or not it exists - note that the variable name must be written within quotes:</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="progchapter.html#cb631-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a is a variable that doesn&#39;t exist</span></span>
<span id="cb631-2"><a href="progchapter.html#cb631-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb631-3"><a href="progchapter.html#cb631-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Using &amp;&amp; works:</span></span>
<span id="cb631-4"><a href="progchapter.html#cb631-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">&quot;a&quot;</span>) <span class="sc">&amp;&amp;</span> a <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb631-5"><a href="progchapter.html#cb631-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb631-6"><a href="progchapter.html#cb631-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;The variable exists and is positive.&quot;</span>)</span>
<span id="cb631-7"><a href="progchapter.html#cb631-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">&quot;a doesn&#39;t exist or is negative.&quot;</span>) }</span>
<span id="cb631-8"><a href="progchapter.html#cb631-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb631-9"><a href="progchapter.html#cb631-9" aria-hidden="true" tabindex="-1"></a><span class="co"># But using &amp; doesn&#39;t, because it attempts to evaluate a&gt;0</span></span>
<span id="cb631-10"><a href="progchapter.html#cb631-10" aria-hidden="true" tabindex="-1"></a><span class="co"># even though a doesn&#39;t exist:</span></span>
<span id="cb631-11"><a href="progchapter.html#cb631-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(<span class="st">&quot;a&quot;</span>) <span class="sc">&amp;</span> a <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb631-12"><a href="progchapter.html#cb631-12" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb631-13"><a href="progchapter.html#cb631-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;The variable exists and is positive.&quot;</span>)</span>
<span id="cb631-14"><a href="progchapter.html#cb631-14" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> { <span class="fu">cat</span>(<span class="st">&quot;a doesn&#39;t exist or is negative.&quot;</span>) }</span></code></pre></div>
</div>
<div id="ifelse" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> <code>ifelse</code><a href="progchapter.html#ifelse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is common that you want to assign different values to a variable depending on whether or not a condition is satisfied:</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="progchapter.html#cb632-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb632-2"><a href="progchapter.html#cb632-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-3"><a href="progchapter.html#cb632-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(x <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb632-4"><a href="progchapter.html#cb632-4" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb632-5"><a href="progchapter.html#cb632-5" aria-hidden="true" tabindex="-1"></a>    reciprocal <span class="ot">&lt;-</span> <span class="st">&quot;Error! Division by zero.&quot;</span></span>
<span id="cb632-6"><a href="progchapter.html#cb632-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span></span>
<span id="cb632-7"><a href="progchapter.html#cb632-7" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb632-8"><a href="progchapter.html#cb632-8" aria-hidden="true" tabindex="-1"></a>    reciprocal <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>x</span>
<span id="cb632-9"><a href="progchapter.html#cb632-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb632-10"><a href="progchapter.html#cb632-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-11"><a href="progchapter.html#cb632-11" aria-hidden="true" tabindex="-1"></a>reciprocal</span></code></pre></div>
<p>In fact, this situation is so common that there is a special function for it: <code>ifelse</code>:</p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="progchapter.html#cb633-1" aria-hidden="true" tabindex="-1"></a>reciprocal <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="dv">0</span>, <span class="st">&quot;Error! Division by zero.&quot;</span>, <span class="dv">1</span><span class="sc">/</span>x)</span></code></pre></div>
<p><code>ifelse</code> evaluates a condition and then returns different answers depending on whether the condition is <code>TRUE</code> or <code>FALSE</code>. It can also be applied to vectors, in which case it checks the condition for each element of the vector and returns an answer for each element:</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="progchapter.html#cb634-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb634-2"><a href="progchapter.html#cb634-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">&quot;Positive&quot;</span>, <span class="st">&quot;Negative&quot;</span>)</span></code></pre></div>
</div>
<div id="switch" class="section level3 hasAnchor" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> <code>switch</code><a href="progchapter.html#switch" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the sake of readability, it is usually a good idea to try to avoid chains of the type <code>if() {} else if() {} else if() {} else {}</code>. One function that can be useful for this is <code>switch</code>, which lets you list a number of possible results, either by position (a number) or by name:</p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="progchapter.html#cb635-1" aria-hidden="true" tabindex="-1"></a>position <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb635-2"><a href="progchapter.html#cb635-2" aria-hidden="true" tabindex="-1"></a><span class="cf">switch</span>(position,</span>
<span id="cb635-3"><a href="progchapter.html#cb635-3" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;First position&quot;</span>,</span>
<span id="cb635-4"><a href="progchapter.html#cb635-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Second position&quot;</span>,</span>
<span id="cb635-5"><a href="progchapter.html#cb635-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Third position&quot;</span>)</span>
<span id="cb635-6"><a href="progchapter.html#cb635-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb635-7"><a href="progchapter.html#cb635-7" aria-hidden="true" tabindex="-1"></a>name <span class="ot">&lt;-</span> <span class="st">&quot;First&quot;</span></span>
<span id="cb635-8"><a href="progchapter.html#cb635-8" aria-hidden="true" tabindex="-1"></a><span class="cf">switch</span>(name,</span>
<span id="cb635-9"><a href="progchapter.html#cb635-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">First =</span> <span class="st">&quot;First name&quot;</span>,</span>
<span id="cb635-10"><a href="progchapter.html#cb635-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">Second =</span> <span class="st">&quot;Second name&quot;</span>,</span>
<span id="cb635-11"><a href="progchapter.html#cb635-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">Third =</span> <span class="st">&quot;Third name&quot;</span>)</span></code></pre></div>
<p>You can for instance use this to decide what function should be applied to your data:</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="progchapter.html#cb636-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb636-2"><a href="progchapter.html#cb636-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb636-3"><a href="progchapter.html#cb636-3" aria-hidden="true" tabindex="-1"></a>method <span class="ot">&lt;-</span> <span class="st">&quot;nonparametric2&quot;</span></span>
<span id="cb636-4"><a href="progchapter.html#cb636-4" aria-hidden="true" tabindex="-1"></a>cor_xy <span class="ot">&lt;-</span> <span class="cf">switch</span>(method,</span>
<span id="cb636-5"><a href="progchapter.html#cb636-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">parametric =</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>),</span>
<span id="cb636-6"><a href="progchapter.html#cb636-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">nonparametric1 =</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>),</span>
<span id="cb636-7"><a href="progchapter.html#cb636-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">nonparametric2 =</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>))</span>
<span id="cb636-8"><a href="progchapter.html#cb636-8" aria-hidden="true" tabindex="-1"></a>cor_xy</span></code></pre></div>
</div>
<div id="failing-gracefully" class="section level3 hasAnchor" number="6.3.5">
<h3><span class="header-section-number">6.3.5</span> Failing gracefully<a href="progchapter.html#failing-gracefully" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Conditional statements are useful for ensuring that the input to a function you’ve written is of the correct type. In Section <a href="progchapter.html#willfunctionwork">6.1.3</a> we saw that our <code>average</code> function failed if we applied it to a <code>character</code> vector:</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="progchapter.html#cb637-1" aria-hidden="true" tabindex="-1"></a>average <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb637-2"><a href="progchapter.html#cb637-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb637-3"><a href="progchapter.html#cb637-3" aria-hidden="true" tabindex="-1"></a>      avg <span class="ot">&lt;-</span> <span class="fu">sum</span>(x)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb637-4"><a href="progchapter.html#cb637-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(avg)</span>
<span id="cb637-5"><a href="progchapter.html#cb637-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb637-6"><a href="progchapter.html#cb637-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb637-7"><a href="progchapter.html#cb637-7" aria-hidden="true" tabindex="-1"></a><span class="fu">average</span>(<span class="fu">c</span>(<span class="st">&quot;Lady Gaga&quot;</span>, <span class="st">&quot;Tool&quot;</span>, <span class="st">&quot;Dry the River&quot;</span>))</span></code></pre></div>
<p>By using a conditional statement, we can provide a more informative error message. We can check that the input is <code>numeric</code> and, if it’s not, stop the function and print an error message, using <code>stop</code>:</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="progchapter.html#cb638-1" aria-hidden="true" tabindex="-1"></a>average <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb638-2"><a href="progchapter.html#cb638-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb638-3"><a href="progchapter.html#cb638-3" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">is.numeric</span>(x))</span>
<span id="cb638-4"><a href="progchapter.html#cb638-4" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb638-5"><a href="progchapter.html#cb638-5" aria-hidden="true" tabindex="-1"></a>            avg <span class="ot">&lt;-</span> <span class="fu">sum</span>(x)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb638-6"><a href="progchapter.html#cb638-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(avg)</span>
<span id="cb638-7"><a href="progchapter.html#cb638-7" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span></span>
<span id="cb638-8"><a href="progchapter.html#cb638-8" aria-hidden="true" tabindex="-1"></a>      { </span>
<span id="cb638-9"><a href="progchapter.html#cb638-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;The input must be a numeric vector.&quot;</span>)</span>
<span id="cb638-10"><a href="progchapter.html#cb638-10" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb638-11"><a href="progchapter.html#cb638-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb638-12"><a href="progchapter.html#cb638-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb638-13"><a href="progchapter.html#cb638-13" aria-hidden="true" tabindex="-1"></a><span class="fu">average</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">8</span>))</span>
<span id="cb638-14"><a href="progchapter.html#cb638-14" aria-hidden="true" tabindex="-1"></a><span class="fu">average</span>(<span class="fu">c</span>(<span class="st">&quot;Lady Gaga&quot;</span>, <span class="st">&quot;Tool&quot;</span>, <span class="st">&quot;Dry the River&quot;</span>))</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch6exc3" class="exercise"><strong>Exercise 6.4  </strong></span>Which of the following conditions are <code>TRUE</code>? First think about the answer, and then check it using R.</p>
</div>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="progchapter.html#cb639-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb639-2"><a href="progchapter.html#cb639-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb639-3"><a href="progchapter.html#cb639-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p><code>x &gt; 2</code></p></li>
<li><p><code>x &gt; y | x &gt; z</code></p></li>
<li><p><code>x &gt; y &amp; x &gt; z</code></p></li>
<li><p><code>abs(x*z) &gt;= y</code></p></li>
</ol>
<p><a href="solutions.html#ch6solutions3">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch6exc4" class="exercise"><strong>Exercise 6.5  </strong></span>Fix the errors in the following code:</p>
</div>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="progchapter.html#cb640-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, pi, <span class="dv">8</span>)</span>
<span id="cb640-2"><a href="progchapter.html#cb640-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb640-3"><a href="progchapter.html#cb640-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Only compute square roots if x exists</span></span>
<span id="cb640-4"><a href="progchapter.html#cb640-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and contains positive values:</span></span>
<span id="cb640-5"><a href="progchapter.html#cb640-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">exists</span>(x)) { <span class="cf">if</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>) { <span class="fu">sqrt</span>(x) } }</span></code></pre></div>
<p><a href="solutions.html#ch6solutions4">(Click here to go to the solution.)</a></p>
</div>
</div>
<div id="loopsection" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Iteration using loops<a href="progchapter.html#loopsection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have already seen how you can use functions to make it easier to repeat the same task over and over. But there is still a part of the puzzle missing - what if, for example, you wish to apply a function to each column of a data frame? What if you want to apply it to data from a number of files, one at a time? The solution to these problems is to use <em>iteration</em>. In this section, we’ll explore how to perform iteration using <em>loops</em>.</p>
<div id="forloops" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> <code>for</code> loops<a href="progchapter.html#forloops" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>for</code> loops can be used to run the same code several times, with different settings, e.g. different data, in each iteration. Their use is perhaps best explained by some examples. We create the loop using <code>for</code>, give the name of a <em>control variable</em> and a vector containing its values (the control variable controls how many iterations to run) and then write the code that should be repeated in each iteration of the loop. In each iteration, a new value of the control variable is used in the code, and the loop stops when all values have been used.</p>
<p>As a first example, let’s write a <code>for</code> loop that runs a block of code five times, where the block prints the current iteration number:</p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="progchapter.html#cb641-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb641-2"><a href="progchapter.html#cb641-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb641-3"><a href="progchapter.html#cb641-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Iteration&quot;</span>, i, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb641-4"><a href="progchapter.html#cb641-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This is equivalent to writing:</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="progchapter.html#cb642-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Iteration&quot;</span>, <span class="dv">1</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb642-2"><a href="progchapter.html#cb642-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Iteration&quot;</span>, <span class="dv">2</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb642-3"><a href="progchapter.html#cb642-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Iteration&quot;</span>, <span class="dv">3</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb642-4"><a href="progchapter.html#cb642-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Iteration&quot;</span>, <span class="dv">4</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb642-5"><a href="progchapter.html#cb642-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Iteration&quot;</span>, <span class="dv">5</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>The upside is that we didn’t have to copy and edit the same code multiple times - and as you can imagine, this benefit becomes even more pronounced if you have more complicated code blocks.</p>
<p>The values for the control variable are given in a vector, and the code block will be run once for each element in the vector - we say the we <em>loop over the values in the vector</em>. The vector doesn’t have to be <code>numeric</code> - here is an example with a <code>character</code> vector:</p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="progchapter.html#cb643-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(word <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;five hundred and fifty five&quot;</span>))</span>
<span id="cb643-2"><a href="progchapter.html#cb643-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb643-3"><a href="progchapter.html#cb643-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Iteration&quot;</span>, word, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb643-4"><a href="progchapter.html#cb643-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Of course, loops are used for so much more than merely printing text on the screen. A common use is to perform some computation and then store the result in a vector. In this case, we must first create an empty vector to store the result in, e.g. using <code>vector</code>, which creates an empty vector of a specific type and length:</p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="progchapter.html#cb644-1" aria-hidden="true" tabindex="-1"></a>squares <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">5</span>)</span>
<span id="cb644-2"><a href="progchapter.html#cb644-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb644-3"><a href="progchapter.html#cb644-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb644-4"><a href="progchapter.html#cb644-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb644-5"><a href="progchapter.html#cb644-5" aria-hidden="true" tabindex="-1"></a>    squares[i] <span class="ot">&lt;-</span> i<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb644-6"><a href="progchapter.html#cb644-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb644-7"><a href="progchapter.html#cb644-7" aria-hidden="true" tabindex="-1"></a>squares</span></code></pre></div>
<p>In this case, it would have been both simpler and computationally faster to compute the squared values by running <code>(1:5)^2</code>. This is known as a <em>vectorised</em> solution, and is very important in R. We’ll discuss vectorised solutions in detail in Section <a href="progchapter.html#vectorloops">6.5</a>.</p>
<p>When creating the values used for the control variable, we often wish to create different sequences of numbers. Two functions that are very useful for this are <code>seq</code>, which creates sequences, and <code>rep</code>, which repeats patterns:</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="progchapter.html#cb645-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb645-2"><a href="progchapter.html#cb645-2" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">10</span>)</span>
<span id="cb645-3"><a href="progchapter.html#cb645-3" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">21</span>)</span>
<span id="cb645-4"><a href="progchapter.html#cb645-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb645-5"><a href="progchapter.html#cb645-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb645-6"><a href="progchapter.html#cb645-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">4</span>)</span>
<span id="cb645-7"><a href="progchapter.html#cb645-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>))</span></code></pre></div>
<p>Finally, <code>seq_along</code> can be used to create a sequence of indices for a vector of a data frame, which is useful if you wish to iterate some code for each element of a vector or each column of a data frame:</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="progchapter.html#cb646-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq_along</span>(airquality) <span class="co"># Gives the indices of all column of the data </span></span>
<span id="cb646-2"><a href="progchapter.html#cb646-2" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># frame</span></span>
<span id="cb646-3"><a href="progchapter.html#cb646-3" aria-hidden="true" tabindex="-1"></a><span class="fu">seq_along</span>(airquality<span class="sc">$</span>Temp) <span class="co"># Gives the indices of all elements of the</span></span>
<span id="cb646-4"><a href="progchapter.html#cb646-4" aria-hidden="true" tabindex="-1"></a>                           <span class="co"># vector</span></span></code></pre></div>
<p>Here is an example of how to use <code>seq_along</code> to compute the mean of each column of a data frame:</p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="progchapter.html#cb647-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the mean for each column of the airquality data:</span></span>
<span id="cb647-2"><a href="progchapter.html#cb647-2" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;double&quot;</span>, <span class="fu">ncol</span>(airquality))</span>
<span id="cb647-3"><a href="progchapter.html#cb647-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb647-4"><a href="progchapter.html#cb647-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over the variables in airquality:</span></span>
<span id="cb647-5"><a href="progchapter.html#cb647-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(airquality))</span>
<span id="cb647-6"><a href="progchapter.html#cb647-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb647-7"><a href="progchapter.html#cb647-7" aria-hidden="true" tabindex="-1"></a>      means[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(airquality[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb647-8"><a href="progchapter.html#cb647-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb647-9"><a href="progchapter.html#cb647-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb647-10"><a href="progchapter.html#cb647-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that the results agree with those from the colMeans function:</span></span>
<span id="cb647-11"><a href="progchapter.html#cb647-11" aria-hidden="true" tabindex="-1"></a>means</span>
<span id="cb647-12"><a href="progchapter.html#cb647-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(airquality, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The line inside the loop could have read <code>means[i] &lt;- mean(airquality[,i], na.rm = TRUE)</code>, but that would have caused problems if we’d used it with a <code>data.table</code> or <code>tibble</code> object; see Section <a href="messychapter.html#subsetusingcn">5.9.4</a>.</p>
<p>Finally, we can also change the values of the data in each iteration of the loop. Some machine learning methods require that the data is <em>standardised</em>, i.e. that all columns have mean 0 and standard deviation 1. This is achieved by subtracting the mean from each variable and then dividing each variable by its standard deviation. We can write a function for this that uses a loop, changing the values of a column in each iteration:</p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="progchapter.html#cb648-1" aria-hidden="true" tabindex="-1"></a>standardise <span class="ot">&lt;-</span> <span class="cf">function</span>(df, ...)</span>
<span id="cb648-2"><a href="progchapter.html#cb648-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb648-3"><a href="progchapter.html#cb648-3" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(df))</span>
<span id="cb648-4"><a href="progchapter.html#cb648-4" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb648-5"><a href="progchapter.html#cb648-5" aria-hidden="true" tabindex="-1"></a>          df[[i]] <span class="ot">&lt;-</span> (df[[i]] <span class="sc">-</span> <span class="fu">mean</span>(df[[i]], ...))<span class="sc">/</span><span class="fu">sd</span>(df[[i]], ...)</span>
<span id="cb648-6"><a href="progchapter.html#cb648-6" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb648-7"><a href="progchapter.html#cb648-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(df)</span>
<span id="cb648-8"><a href="progchapter.html#cb648-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb648-9"><a href="progchapter.html#cb648-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb648-10"><a href="progchapter.html#cb648-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Try it out:</span></span>
<span id="cb648-11"><a href="progchapter.html#cb648-11" aria-hidden="true" tabindex="-1"></a>aqs <span class="ot">&lt;-</span> <span class="fu">standardise</span>(airquality, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb648-12"><a href="progchapter.html#cb648-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(aqs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># Non-zero due to floating point</span></span>
<span id="cb648-13"><a href="progchapter.html#cb648-13" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># arithmetics!</span></span>
<span id="cb648-14"><a href="progchapter.html#cb648-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(aqs<span class="sc">$</span>Wind)</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch6exc5" class="exercise"><strong>Exercise 6.6  </strong></span>Practice writing <code>for</code> loops by doing the following:</p>
<ol style="list-style-type: decimal">
<li><p>Compute the mean temperature for each month in the <code>airquality</code> dataset using a loop rather than an existing function.</p></li>
<li><p>Use a <code>for</code> loop to compute the maximum and minimum value of each column of the <code>airquality</code> data frame, storing the results in a data frame.</p></li>
<li><p>Make your solution to the previous task reusable by writing a function that returns the maximum and minimum value of each column of a data frame.</p></li>
</ol>
</div>
<p><a href="solutions.html#ch6solutions5">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch6exc5b" class="exercise"><strong>Exercise 6.7  </strong></span>Use <code>rep</code> or <code>seq</code> to create the following vectors:</p>
<ol style="list-style-type: decimal">
<li><p><code>0.25 0.5 0.75 1</code></p></li>
<li><p><code>1 1 1 2 2 5</code></p></li>
</ol>
</div>
<p><a href="solutions.html#ch6solutions5b">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch6exc6" class="exercise"><strong>Exercise 6.8  </strong></span>As an alternative to <code>seq_along(airquality)</code> and <code>seq_along(airquality$Temp)</code>, we could create the same sequences using <code>1:ncol(airquality)</code> and <code>1:length(airquality$Temp)</code>. Use <code>x &lt;- c()</code> to create a vector of length zero. Then create loops that use <code>seq_along(x)</code> and <code>1:length(x)</code> as values for the control variable. How many iterations are the two loops run? Which solution is preferable?</p>
</div>
<p><a href="solutions.html#ch6solutions6">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch6exc7" class="exercise"><strong>Exercise 6.9  </strong></span>An alternative to standardisation is <em>normalisation</em>, where all <code>numeric</code> variables are rescaled so that their smallest value is 0 and their largest value is 1. Write a function that normalises the variables in a data frame containing <code>numeric</code> columns.</p>
</div>
<p><a href="solutions.html#ch6solutions7">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch6exc10" class="exercise"><strong>Exercise 6.10  </strong></span>The function <code>list.files</code> can be used to create a vector containing the names of all files in a folder. The <code>pattern</code> argument can be used to supply a regular expression describing a file name pattern. For instance, if <code>pattern = "\\.csv$"</code> is used, only <code>.csv</code> files will be listed.</p>
<p>Create a loop that goes through all <code>.csv</code> files in a folder and prints the names of the variables for each file.</p>
</div>
<p><a href="solutions.html#ch6solutions10">(Click here to go to the solution.)</a></p>
</div>
<div id="nestedloops" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Loops within loops<a href="progchapter.html#nestedloops" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In some situations, you’ll want to put a loop inside another loop. Such loops are said to be <em>nested</em>. An example is if we want to compute the correlation between all pairs of variables in <code>airquality</code>, and store the result in a matrix:</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="progchapter.html#cb649-1" aria-hidden="true" tabindex="-1"></a>cor_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">ncol</span>(airquality),</span>
<span id="cb649-2"><a href="progchapter.html#cb649-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ncol =</span> <span class="fu">ncol</span>(airquality))</span>
<span id="cb649-3"><a href="progchapter.html#cb649-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(airquality))</span>
<span id="cb649-4"><a href="progchapter.html#cb649-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb649-5"><a href="progchapter.html#cb649-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">seq_along</span>(airquality))</span>
<span id="cb649-6"><a href="progchapter.html#cb649-6" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb649-7"><a href="progchapter.html#cb649-7" aria-hidden="true" tabindex="-1"></a>        cor_mat[i, j] <span class="ot">&lt;-</span> <span class="fu">cor</span>(airquality[[i]], airquality[[j]],</span>
<span id="cb649-8"><a href="progchapter.html#cb649-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">use =</span> <span class="st">&quot;pairwise.complete&quot;</span>)</span>
<span id="cb649-9"><a href="progchapter.html#cb649-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb649-10"><a href="progchapter.html#cb649-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb649-11"><a href="progchapter.html#cb649-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb649-12"><a href="progchapter.html#cb649-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Element [i, j] of the matrix now contains the correlation between</span></span>
<span id="cb649-13"><a href="progchapter.html#cb649-13" aria-hidden="true" tabindex="-1"></a><span class="co"># variables i and j:</span></span>
<span id="cb649-14"><a href="progchapter.html#cb649-14" aria-hidden="true" tabindex="-1"></a>cor_mat</span></code></pre></div>
<p>Once again, there is a vectorised solution to this problem, given by <code>cor(airquality, use = "pairwise.complete")</code>. As we will see in Section <a href="progchapter.html#measureperformance">6.6</a>, vectorised solutions like this can be several times faster than solutions that use nested loops. In general, solutions involving nested loops tend to be fairly slow - but on the other hand, they are often easy and straightforward to implement.</p>
</div>
<div id="beepr" class="section level3 hasAnchor" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> Keeping track of what’s happening<a href="progchapter.html#beepr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes each iteration of your loop takes a long time to run, and you’ll want to monitor its progress. This can be done using printed messages or a progress bar in the Console panel, or sound notifications. We’ll showcase each of these using a loop containing a call to <code>Sys.sleep</code>, which pauses the execution of R commands for a short time (determined by the user).</p>
<p>First, we can use <code>cat</code> to print a message describing the progress. Adding <code>\r</code> to the end of a string allows us to print all messages on the same line, with each new message replacing the old one:</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="progchapter.html#cb650-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print each message on a new same line:</span></span>
<span id="cb650-2"><a href="progchapter.html#cb650-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb650-3"><a href="progchapter.html#cb650-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb650-4"><a href="progchapter.html#cb650-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Step&quot;</span>, i, <span class="st">&quot;out of 5</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb650-5"><a href="progchapter.html#cb650-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">1</span>) <span class="co"># Sleep for 1 second</span></span>
<span id="cb650-6"><a href="progchapter.html#cb650-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb650-7"><a href="progchapter.html#cb650-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb650-8"><a href="progchapter.html#cb650-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace the previous message with the new one:</span></span>
<span id="cb650-9"><a href="progchapter.html#cb650-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb650-10"><a href="progchapter.html#cb650-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb650-11"><a href="progchapter.html#cb650-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Step&quot;</span>, i, <span class="st">&quot;out of 5</span><span class="sc">\r</span><span class="st">&quot;</span>)</span>
<span id="cb650-12"><a href="progchapter.html#cb650-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">1</span>) <span class="co"># Sleep for one second</span></span>
<span id="cb650-13"><a href="progchapter.html#cb650-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Adding a progress bar is a little more complicated, because we must first start the bar by using <code>txtProgressBar</code> and the update it using <code>setTxtProgressBar</code>:</p>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="progchapter.html#cb651-1" aria-hidden="true" tabindex="-1"></a>sequence <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb651-2"><a href="progchapter.html#cb651-2" aria-hidden="true" tabindex="-1"></a>pbar <span class="ot">&lt;-</span> <span class="fu">txtProgressBar</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fu">max</span>(sequence), <span class="at">style =</span> <span class="dv">3</span>)</span>
<span id="cb651-3"><a href="progchapter.html#cb651-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> sequence)</span>
<span id="cb651-4"><a href="progchapter.html#cb651-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb651-5"><a href="progchapter.html#cb651-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">1</span>) <span class="co"># Sleep for 1 second</span></span>
<span id="cb651-6"><a href="progchapter.html#cb651-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setTxtProgressBar</span>(pbar, i)</span>
<span id="cb651-7"><a href="progchapter.html#cb651-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb651-8"><a href="progchapter.html#cb651-8" aria-hidden="true" tabindex="-1"></a><span class="fu">close</span>(pbar)</span></code></pre></div>
<p>Finally, the <code>beepr</code> package<a href="#fn42" class="footnote-ref" id="fnref42"><sup>42</sup></a> can be used to play sounds, with the function <code>beep</code>:</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="progchapter.html#cb652-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;beepr&quot;</span>)</span>
<span id="cb652-2"><a href="progchapter.html#cb652-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb652-3"><a href="progchapter.html#cb652-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(beepr)</span>
<span id="cb652-4"><a href="progchapter.html#cb652-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Play all 11 sounds available in beepr:</span></span>
<span id="cb652-5"><a href="progchapter.html#cb652-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>)</span>
<span id="cb652-6"><a href="progchapter.html#cb652-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb652-7"><a href="progchapter.html#cb652-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">beep</span>(<span class="at">sound =</span> i)</span>
<span id="cb652-8"><a href="progchapter.html#cb652-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>) <span class="co"># Sleep for 2 seconds</span></span>
<span id="cb652-9"><a href="progchapter.html#cb652-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="lists" class="section level3 hasAnchor" number="6.4.4">
<h3><span class="header-section-number">6.4.4</span> Loops and lists<a href="progchapter.html#lists" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In our previous examples of loops, it has always been clear from the start how many iterations the loop should run and what the length of the output vector (or data frame) should be. This isn’t always the case. To begin with, let’s consider the case where the length of the output is unknown or difficult to know in advance. Let’s say that we want to go through the <code>airquality</code> data to find days that are extreme in the sense that at least one variable attains its maximum on those days. That is, we wish to find the index of the maximum of each variable, and store them in a vector. Because several days can have the same temperature or wind speed, there may be more than one such maximal index for each variable. For that reason, we don’t know the length of the output vector in advance.</p>
<p>In such cases, it is usually a good idea to store the result from each iteration in a <code>list</code> (Section <a href="messychapter.html#lists2">5.2</a>), and then collect the elements from the list once the loop has finished. We can create an empty list with one element for each variable in <code>airquality</code> using <code>vector</code>:</p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="progchapter.html#cb653-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty list with one element for each variable in</span></span>
<span id="cb653-2"><a href="progchapter.html#cb653-2" aria-hidden="true" tabindex="-1"></a><span class="co"># airquality:</span></span>
<span id="cb653-3"><a href="progchapter.html#cb653-3" aria-hidden="true" tabindex="-1"></a>max_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">ncol</span>(airquality))</span>
<span id="cb653-4"><a href="progchapter.html#cb653-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb653-5"><a href="progchapter.html#cb653-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Naming the list elements will help us see which variable the maximal</span></span>
<span id="cb653-6"><a href="progchapter.html#cb653-6" aria-hidden="true" tabindex="-1"></a><span class="co"># indices belong to:</span></span>
<span id="cb653-7"><a href="progchapter.html#cb653-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(max_list) <span class="ot">&lt;-</span> <span class="fu">names</span>(airquality)</span>
<span id="cb653-8"><a href="progchapter.html#cb653-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb653-9"><a href="progchapter.html#cb653-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over the variables to find the maxima:</span></span>
<span id="cb653-10"><a href="progchapter.html#cb653-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(airquality))</span>
<span id="cb653-11"><a href="progchapter.html#cb653-11" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb653-12"><a href="progchapter.html#cb653-12" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Find indices of maximum values:</span></span>
<span id="cb653-13"><a href="progchapter.html#cb653-13" aria-hidden="true" tabindex="-1"></a>      max_index <span class="ot">&lt;-</span> <span class="fu">which</span>(airquality[[i]] <span class="sc">==</span> <span class="fu">max</span>(airquality[[i]],</span>
<span id="cb653-14"><a href="progchapter.html#cb653-14" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb653-15"><a href="progchapter.html#cb653-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb653-16"><a href="progchapter.html#cb653-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add indices to list:</span></span>
<span id="cb653-17"><a href="progchapter.html#cb653-17" aria-hidden="true" tabindex="-1"></a>      max_list[[i]] <span class="ot">&lt;-</span> max_index</span>
<span id="cb653-18"><a href="progchapter.html#cb653-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb653-19"><a href="progchapter.html#cb653-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb653-20"><a href="progchapter.html#cb653-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb653-21"><a href="progchapter.html#cb653-21" aria-hidden="true" tabindex="-1"></a>max_list</span>
<span id="cb653-22"><a href="progchapter.html#cb653-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb653-23"><a href="progchapter.html#cb653-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Collapse to a vector:</span></span>
<span id="cb653-24"><a href="progchapter.html#cb653-24" aria-hidden="true" tabindex="-1"></a>extreme_days <span class="ot">&lt;-</span> <span class="fu">unlist</span>(max_list)</span></code></pre></div>
<p>(In this case, only the variables <code>Month</code> and <code>Days</code> have duplicate maximum values.)</p>
</div>
<div id="whileloop" class="section level3 hasAnchor" number="6.4.5">
<h3><span class="header-section-number">6.4.5</span> <code>while</code> loops<a href="progchapter.html#whileloop" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In some situations, we want to run a loop until a certain condition is met, meaning that we don’t know in advance how many iterations we’ll need. This is more common in numerical optimisation and simulation, but sometimes also occurs in data analyses.</p>
<p>When we don’t know in advance how many iterations that are needed, we can use <code>while</code> loops. Unlike <code>for</code> loops, that iterate a fixed number of times, <code>while</code> loops keep iterating as long as some specified condition is met. Here is an example where the loop keeps iterating until <code>i</code> squared is greater than 100:</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="progchapter.html#cb654-1" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb654-2"><a href="progchapter.html#cb654-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb654-3"><a href="progchapter.html#cb654-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(i<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">100</span>)</span>
<span id="cb654-4"><a href="progchapter.html#cb654-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb654-5"><a href="progchapter.html#cb654-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(i,<span class="st">&quot;squared is&quot;</span>, i<span class="sc">^</span><span class="dv">2</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb654-6"><a href="progchapter.html#cb654-6" aria-hidden="true" tabindex="-1"></a>      i <span class="ot">&lt;-</span> i <span class="sc">+</span><span class="dv">1</span></span>
<span id="cb654-7"><a href="progchapter.html#cb654-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb654-8"><a href="progchapter.html#cb654-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb654-9"><a href="progchapter.html#cb654-9" aria-hidden="true" tabindex="-1"></a>i</span></code></pre></div>
<p>The code block inside the loop keeps repeating until the condition <code>i^2 &lt;= 100</code> no longer is satisfied. We have to be a little bit careful with this condition - if we set it in such a way that it is possible that the condition <em>always</em> will be satisfied, the loop will just keep running and running - creating what is known as an <em>infinite loop</em>. If you’ve accidentally created an infinite loop, you can break it by pressing the Stop button at the top of the Console panel in RStudio.</p>
<p>In Section <a href="messychapter.html#rle">5.3.3</a> we saw how <code>rle</code> can be used to find and compute the lengths of runs of equal values in a vector. We can use nested <code>while</code> loops to create something similar. <code>while</code> loops are a good choice here, because we don’t know how many runs are in the vector in advance. Here is an example, which you’ll study in more detail in Exercise <a href="progchapter.html#exr:ch6exc8">6.11</a>:</p>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="progchapter.html#cb655-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector of 0&#39;s and 1&#39;s:</span></span>
<span id="cb655-2"><a href="progchapter.html#cb655-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">7</span>))</span>
<span id="cb655-3"><a href="progchapter.html#cb655-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb655-4"><a href="progchapter.html#cb655-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create empty vectors where the results will be stored:</span></span>
<span id="cb655-5"><a href="progchapter.html#cb655-5" aria-hidden="true" tabindex="-1"></a>run_values <span class="ot">&lt;-</span> run_lengths <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb655-6"><a href="progchapter.html#cb655-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb655-7"><a href="progchapter.html#cb655-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the initial condition:</span></span>
<span id="cb655-8"><a href="progchapter.html#cb655-8" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb655-9"><a href="progchapter.html#cb655-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb655-10"><a href="progchapter.html#cb655-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over the entire vector:</span></span>
<span id="cb655-11"><a href="progchapter.html#cb655-11" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(i <span class="sc">&lt;</span> <span class="fu">length</span>(x))</span>
<span id="cb655-12"><a href="progchapter.html#cb655-12" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb655-13"><a href="progchapter.html#cb655-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># A new run starts:</span></span>
<span id="cb655-14"><a href="progchapter.html#cb655-14" aria-hidden="true" tabindex="-1"></a>    run_length <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb655-15"><a href="progchapter.html#cb655-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;A run starts at i =&quot;</span>, i, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb655-16"><a href="progchapter.html#cb655-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb655-17"><a href="progchapter.html#cb655-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check how long the run continues:</span></span>
<span id="cb655-18"><a href="progchapter.html#cb655-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span>(x[i<span class="sc">+</span><span class="dv">1</span>] <span class="sc">==</span> x[i] <span class="sc">&amp;</span> i <span class="sc">&lt;</span> <span class="fu">length</span>(x))</span>
<span id="cb655-19"><a href="progchapter.html#cb655-19" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb655-20"><a href="progchapter.html#cb655-20" aria-hidden="true" tabindex="-1"></a>          run_length <span class="ot">&lt;-</span> run_length <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb655-21"><a href="progchapter.html#cb655-21" aria-hidden="true" tabindex="-1"></a>          i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb655-22"><a href="progchapter.html#cb655-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb655-23"><a href="progchapter.html#cb655-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb655-24"><a href="progchapter.html#cb655-24" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb655-25"><a href="progchapter.html#cb655-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb655-26"><a href="progchapter.html#cb655-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save results:</span></span>
<span id="cb655-27"><a href="progchapter.html#cb655-27" aria-hidden="true" tabindex="-1"></a>    run_values <span class="ot">&lt;-</span> <span class="fu">c</span>(run_values, x[i<span class="dv">-1</span>])</span>
<span id="cb655-28"><a href="progchapter.html#cb655-28" aria-hidden="true" tabindex="-1"></a>    run_lengths <span class="ot">&lt;-</span> <span class="fu">c</span>(run_lengths, run_length)</span>
<span id="cb655-29"><a href="progchapter.html#cb655-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb655-30"><a href="progchapter.html#cb655-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb655-31"><a href="progchapter.html#cb655-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Present the results:</span></span>
<span id="cb655-32"><a href="progchapter.html#cb655-32" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(run_values, run_lengths)</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch6exc8" class="exercise"><strong>Exercise 6.11  </strong></span>Consider the nested <code>while</code> loops in the run length example above. Go through the code and think about what happens in each step. What happens when <code>i</code> is <code>1</code>? When it is <code>5</code>? When it is <code>6</code>? Answer the following questions:</p>
<ol style="list-style-type: decimal">
<li><p>What does the condition for the outer while loop check? Why is it needed?</p></li>
<li><p>What does the condition for the inner while loop check? Why is it needed?</p></li>
<li><p>What does the line <code>run_values &lt;- c(run_values, x[i-1])</code> do?</p></li>
</ol>
</div>
<p><a href="solutions.html#ch6solutions8">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch6exc9" class="exercise"><strong>Exercise 6.12  </strong></span>The <em>control statements</em> <code>break</code> and <code>next</code> can be used inside both <code>for</code> and <code>while</code> loops to control their behaviour further. <code>break</code> stops a loop, and <code>next</code> skips to the next iteration of it. Use these functions to modify the following piece of code so that the loop skips to the next iteration if <code>x[i]</code> is <code>0</code>, and breaks if <code>x[i]</code> is <code>NA</code>:</p>
</div>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="progchapter.html#cb656-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="cn">NA</span>, <span class="dv">18</span>, <span class="dv">2</span>)</span>
<span id="cb656-2"><a href="progchapter.html#cb656-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb656-3"><a href="progchapter.html#cb656-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(x))</span>
<span id="cb656-4"><a href="progchapter.html#cb656-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb656-5"><a href="progchapter.html#cb656-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;Step&quot;</span>, i, <span class="st">&quot;- reciprocal is&quot;</span>, <span class="dv">1</span><span class="sc">/</span>x[i], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb656-6"><a href="progchapter.html#cb656-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><a href="solutions.html#ch6solutions9">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch6exc9b" class="exercise"><strong>Exercise 6.13  </strong></span>Using the <code>cor_mat</code> computation from Section <a href="progchapter.html#nestedloops">6.4.2</a>, write a function that computes all pairwise correlations in a data frame, and uses <code>next</code> to only compute correlations for <code>numeric</code> variables. Test your function by applying it to the <code>msleep</code> data from <code>ggplot2</code>. Could you achieve the same thing without using <code>next</code>?</p>
</div>
<p><a href="solutions.html#ch6solutions9b">(Click here to go to the solution.)</a></p>
</div>
</div>
<div id="vectorloops" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Iteration using vectorisation and functionals<a href="progchapter.html#vectorloops" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many operators and functions in R take vectors as input and handle them in a highly efficient way, usually by passing the vector on to an optimised function written in the C programming language<a href="#fn43" class="footnote-ref" id="fnref43"><sup>43</sup></a>. So if we want to compute the squares of the numbers in a vector, we don’t need to write a loop:</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="progchapter.html#cb657-1" aria-hidden="true" tabindex="-1"></a>squares <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">5</span>)</span>
<span id="cb657-2"><a href="progchapter.html#cb657-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb657-3"><a href="progchapter.html#cb657-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb657-4"><a href="progchapter.html#cb657-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb657-5"><a href="progchapter.html#cb657-5" aria-hidden="true" tabindex="-1"></a>    squares[i] <span class="ot">&lt;-</span> i<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb657-6"><a href="progchapter.html#cb657-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb657-7"><a href="progchapter.html#cb657-7" aria-hidden="true" tabindex="-1"></a>squares</span></code></pre></div>
<p>Instead, we can simply apply the <code>^</code> operator, which uses fast C code to compute the squares:</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="progchapter.html#cb658-1" aria-hidden="true" tabindex="-1"></a>squares <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<p>These types of functions and operators are called <em>vectorised</em>. They take a vector as input and apply a function to all its elements, meaning that we can avoid slower solutions utilising loops in R<a href="#fn44" class="footnote-ref" id="fnref44"><sup>44</sup></a>. Try to use vectorised solutions rather than loops whenever possible - it makes your code both easier to read and faster to run.</p>
<p>A related concept is <em>functionals</em>, which are functions that contain a <code>for</code> loop. Instead of writing a <code>for</code> loop, you can use a functional, supplying data, a function that should be applied in each iteration of the loop, and a vector to loop over. This won’t necessarily make your loop run faster, but it does have other benefits:</p>
<ul>
<li><em>Shorter code</em>: functionals allow you to write more concise code. Some would argue that they also allow you to write code that is easier to read, but that is obviously a matter of taste.</li>
<li><em>Efficient</em>: functionals handle memory allocation and other small tasks efficiently, meaning that you don’t have to worry about creating a vector of an appropriate size to store the result.</li>
<li><em>No changes to your environment</em>: because all operations now take place in the local environment of the functional, you don’t run the risk of accidentally changing variables in your global environment.</li>
<li><em>No left-overs</em>: <code>for</code> leaves the control variable (e.g. <code>i</code>) in the environment, functionals do not.</li>
<li><em>Easy to use with pipes</em>: because the loop has been wrapped in a function, it lends itself well to being used in a <code>%&gt;%</code> pipeline.</li>
</ul>
<p>Explicit loops are preferable when:</p>
<ul>
<li>You think that they are easier to read and write.</li>
<li>Your functions take data frames or other non-vector objects as input.</li>
<li>Each iteration of your loop depends on the results from previous iterations.</li>
</ul>
<p>In this section, we’ll see how we can apply functionals to obtain elegant alternatives to (explicit) loops.</p>
<div id="a-first-example-with-apply" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> A first example with <code>apply</code><a href="progchapter.html#a-first-example-with-apply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The prototypical functional is <code>apply</code>, which loops over either the rows or the columns of a data frame<a href="#fn45" class="footnote-ref" id="fnref45"><sup>45</sup></a>. The arguments are a dataset, the margin to loop over (<code>1</code> for rows, <code>2</code> for columns) and then the function to be applied.</p>
<p>In Section <a href="progchapter.html#forloops">6.4.1</a> we wrote a <code>for</code> loop for computing the mean value of each column in a data frame:</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="progchapter.html#cb659-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the mean for each column of the airquality data:</span></span>
<span id="cb659-2"><a href="progchapter.html#cb659-2" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;double&quot;</span>, <span class="fu">ncol</span>(airquality))</span>
<span id="cb659-3"><a href="progchapter.html#cb659-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb659-4"><a href="progchapter.html#cb659-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop over the variables in airquality:</span></span>
<span id="cb659-5"><a href="progchapter.html#cb659-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(airquality))</span>
<span id="cb659-6"><a href="progchapter.html#cb659-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb659-7"><a href="progchapter.html#cb659-7" aria-hidden="true" tabindex="-1"></a>      means[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(airquality[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb659-8"><a href="progchapter.html#cb659-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Using apply, we can reduce this to a single line. We wish to use the <code>airquality</code> data, loop over the columns (margin <code>2</code>) and apply the function <code>mean</code> to each column:</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="progchapter.html#cb660-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(airquality, <span class="dv">2</span>, mean)</span></code></pre></div>
<p>Rather elegant, don’t you think?</p>
<p>Additional arguments can be passed to the function inside apply by adding them to the end of the function call:</p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="progchapter.html#cb661-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(airquality, <span class="dv">2</span>, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch6exc11" class="exercise"><strong>Exercise 6.14  </strong></span>Use <code>apply</code> to compute the maximum and minimum value of each column of the <code>airquality</code> data frame. Can you write a function that allows you to compute both with a single call to <code>apply</code>?</p>
</div>
<p><a href="solutions.html#ch6solutions11">(Click here to go to the solution.)</a></p>
</div>
<div id="variations-on-a-theme" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Variations on a theme<a href="progchapter.html#variations-on-a-theme" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are several variations of <code>apply</code> that are tailored to specific problems:</p>
<ul>
<li><code>lapply</code>: takes a function and vector/list as input, and returns a list.</li>
<li><code>sapply</code>: takes a function and vector/list as input, and returns a vector or matrix.</li>
<li><code>vapply</code>: a version of <code>sapply</code> with additional checks of the format of the output.</li>
<li><code>tapply</code>: for looping over groups, e.g. when computing grouped summaries.</li>
<li><code>rapply</code>: a recursive version of <code>tapply</code>.</li>
<li><code>mapply</code>: for applying a function to multiple arguments; see Section <a href="progchapter.html#multiiter">6.5.7</a>.</li>
<li><code>eapply</code>: for applying a function to all objects in an environment.</li>
</ul>
<p>We have already seen several ways to compute the mean temperature for different months in the <code>airquality</code> data (Sections <a href="datachapter.html#grouped">3.8</a> and <a href="messychapter.html#grouped2">5.7.7</a>, and Exercise <a href="progchapter.html#exr:ch6exc5">6.6</a>). The <code>*apply</code> family offer several more:</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="progchapter.html#cb662-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list:</span></span>
<span id="cb662-2"><a href="progchapter.html#cb662-2" aria-hidden="true" tabindex="-1"></a>temps <span class="ot">&lt;-</span> <span class="fu">split</span>(airquality<span class="sc">$</span>Temp, airquality<span class="sc">$</span>Month)</span>
<span id="cb662-3"><a href="progchapter.html#cb662-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb662-4"><a href="progchapter.html#cb662-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(temps, mean)</span>
<span id="cb662-5"><a href="progchapter.html#cb662-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(temps, mean)</span>
<span id="cb662-6"><a href="progchapter.html#cb662-6" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(temps, mean, <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">1</span>))</span>
<span id="cb662-7"><a href="progchapter.html#cb662-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(airquality<span class="sc">$</span>Temp, airquality<span class="sc">$</span>Month, mean)</span></code></pre></div>
<p>There is, as that delightful proverb goes, more than one way to skin a cat.</p>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch6exc12" class="exercise"><strong>Exercise 6.15  </strong></span>Use an <code>*apply</code> function to simultaneously compute the monthly maximum and minimum temperature in the <code>airquality</code> data frame.</p>
</div>
<p><a href="solutions.html#ch6solutions12">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch6exc13" class="exercise"><strong>Exercise 6.16  </strong></span>Use an <code>*apply</code> function to simultaneously compute the monthly maximum and minimum temperature and windspeed in the <code>airquality</code> data frame.</p>
<p>Hint: start by writing a function that simultaneously computes the maximum and minimum temperature and windspeed for a data frame containing data from a single month.</p>
</div>
<p><a href="solutions.html#ch6solutions13">(Click here to go to the solution.)</a></p>
</div>
<div id="purrr" class="section level3 hasAnchor" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> <code>purrr</code><a href="progchapter.html#purrr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you feel enthusiastic about <del>skinning cats</del> using functionals instead of loops, the tidyverse package <code>purrr</code> is a great addition to your toolbox. It contains a number of specialised alternatives to the <code>*apply</code> functions. More importantly, it also contains certain shortcuts that come in handy when working with functionals. For instance, it is fairly common to define a short function inside your functional, which is useful for instance when you don’t want the function to take up space in your environment. This can be done a little more elegantly with <code>purrr</code> functions using a shortcut denoted by <code>~</code>. Let’s say that we want to standardise all variables in <code>airquality</code>. The <code>map</code> function is the <code>purrr</code> equivalent of <code>lapply</code>. We can use it with or with the shortcut, and with or without pipes (we mention the use of pipes now because it will be important in what comes next):</p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="progchapter.html#cb663-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base solution:</span></span>
<span id="cb663-2"><a href="progchapter.html#cb663-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(airquality, <span class="cf">function</span>(x) { (x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x) })</span>
<span id="cb663-3"><a href="progchapter.html#cb663-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb663-4"><a href="progchapter.html#cb663-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Base solution with pipe:</span></span>
<span id="cb663-5"><a href="progchapter.html#cb663-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb663-6"><a href="progchapter.html#cb663-6" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> <span class="fu">lapply</span>(<span class="cf">function</span>(x) { (x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x) })</span>
<span id="cb663-7"><a href="progchapter.html#cb663-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb663-8"><a href="progchapter.html#cb663-8" aria-hidden="true" tabindex="-1"></a><span class="co"># purrr solution:</span></span>
<span id="cb663-9"><a href="progchapter.html#cb663-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb663-10"><a href="progchapter.html#cb663-10" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(airquality, <span class="cf">function</span>(x) { (x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x) })</span>
<span id="cb663-11"><a href="progchapter.html#cb663-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb663-12"><a href="progchapter.html#cb663-12" aria-hidden="true" tabindex="-1"></a><span class="co"># We can make the purrr solution less verbose using a shortcut:</span></span>
<span id="cb663-13"><a href="progchapter.html#cb663-13" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(airquality, <span class="sc">~</span>(.<span class="sc">-</span><span class="fu">mean</span>(.))<span class="sc">/</span><span class="fu">sd</span>(.))</span>
<span id="cb663-14"><a href="progchapter.html#cb663-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb663-15"><a href="progchapter.html#cb663-15" aria-hidden="true" tabindex="-1"></a><span class="co"># purr solution with pipe and shortcut:</span></span>
<span id="cb663-16"><a href="progchapter.html#cb663-16" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span>(.<span class="sc">-</span><span class="fu">mean</span>(.))<span class="sc">/</span><span class="fu">sd</span>(.))</span></code></pre></div>
<p>Where this shortcut really shines is if you need to use multiple functionals. Let’s say that we want to standardise the <code>airquality</code> variables, compute a <code>summary</code> and then extract columns <code>2</code> and <code>5</code> from the summary (which contains the 1st and 3rd quartile of the data):</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="progchapter.html#cb664-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Impenetrable base solution:</span></span>
<span id="cb664-2"><a href="progchapter.html#cb664-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">lapply</span>(<span class="fu">lapply</span>(airquality,</span>
<span id="cb664-3"><a href="progchapter.html#cb664-3" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">function</span>(x) { (x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x) }),</span>
<span id="cb664-4"><a href="progchapter.html#cb664-4" aria-hidden="true" tabindex="-1"></a>              summary),</span>
<span id="cb664-5"><a href="progchapter.html#cb664-5" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(x) { x[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>)] })</span>
<span id="cb664-6"><a href="progchapter.html#cb664-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb664-7"><a href="progchapter.html#cb664-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Base solution with pipe:</span></span>
<span id="cb664-8"><a href="progchapter.html#cb664-8" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> </span>
<span id="cb664-9"><a href="progchapter.html#cb664-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lapply</span>(<span class="cf">function</span>(x) { (x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x) }) <span class="sc">%&gt;%</span></span>
<span id="cb664-10"><a href="progchapter.html#cb664-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lapply</span>(summary) <span class="sc">%&gt;%</span></span>
<span id="cb664-11"><a href="progchapter.html#cb664-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lapply</span>(<span class="cf">function</span>(x) { x[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>)] })</span>
<span id="cb664-12"><a href="progchapter.html#cb664-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb664-13"><a href="progchapter.html#cb664-13" aria-hidden="true" tabindex="-1"></a><span class="co"># purrr solution:</span></span>
<span id="cb664-14"><a href="progchapter.html#cb664-14" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span></span>
<span id="cb664-15"><a href="progchapter.html#cb664-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">map</span>(<span class="sc">~</span>(.<span class="sc">-</span><span class="fu">mean</span>(.))<span class="sc">/</span><span class="fu">sd</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb664-16"><a href="progchapter.html#cb664-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">map</span>(summary) <span class="sc">%&gt;%</span></span>
<span id="cb664-17"><a href="progchapter.html#cb664-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">map</span>(<span class="sc">~</span>.[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>)])</span></code></pre></div>
<p>Once you know the meaning of <code>~</code>, the <code>purrr</code> solution is a lot cleaner than the base solutions.</p>
</div>
<div id="specialised-functions" class="section level3 hasAnchor" number="6.5.4">
<h3><span class="header-section-number">6.5.4</span> Specialised functions<a href="progchapter.html#specialised-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far, it may seem like <code>map</code> is just like <code>lapply</code> but with a shortcut for defining functions. Which is more or less true. But <code>purrr</code> contains a lot more functionals that you can use, each tailored to specific problems.</p>
<p>For instance, if you need to specify that the output should be a vector of a specific type, you can use:</p>
<ul>
<li><code>map_dbl(data, function)</code> instead of <code>vapply(data, function, vector("numeric", length))</code>,</li>
<li><code>map_int(data, function)</code> instead of <code>vapply(data, function, vector("integer", length))</code>,</li>
<li><code>map_chr(data, function)</code> instead of <code>vapply(data, function, vector("character", length))</code>,</li>
<li><code>map_lgl(data, function)</code> instead of <code>vapply(data, function, vector("logical", length))</code>.</li>
</ul>
<p>If you need to specify that the output should be a data frame, you can use:</p>
<ul>
<li><code>map_dfr(data, function)</code> instead of <code>sapply(data, function)</code>.</li>
</ul>
<p>The <code>~</code> shortcut for functions is available for all these <code>map_*</code> functions. In case you need to pass additional arguments to the function inside the functional, just add them at the end of the functional call:</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="progchapter.html#cb665-1" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> <span class="fu">map_dbl</span>(max)</span>
<span id="cb665-2"><a href="progchapter.html#cb665-2" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> <span class="fu">map_dbl</span>(max, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Another specialised function is the <code>walk</code> function. It works just like <code>map</code>, but doesn’t return anything. This is useful if you want to apply a function with no output, such as <code>cat</code> or <code>read.csv</code>:</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="progchapter.html#cb666-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns a list of NULL values:</span></span>
<span id="cb666-2"><a href="progchapter.html#cb666-2" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">cat</span>(<span class="st">&quot;Maximum:&quot;</span>, <span class="fu">max</span>(.), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb666-3"><a href="progchapter.html#cb666-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb666-4"><a href="progchapter.html#cb666-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns nothing:</span></span>
<span id="cb666-5"><a href="progchapter.html#cb666-5" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> <span class="fu">walk</span>(<span class="sc">~</span><span class="fu">cat</span>(<span class="st">&quot;Maximum:&quot;</span>, <span class="fu">max</span>(.), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)) </span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch6exc13b" class="exercise"><strong>Exercise 6.17  </strong></span>Use a <code>map_*</code> function to simultaneously compute the monthly maximum and minimum temperature in the <code>airquality</code> data frame, returning a vector.</p>
</div>
<p><a href="solutions.html#ch6solutions13b">(Click here to go to the solution.)</a></p>
</div>
<div id="exploring-data-with-functionals" class="section level3 hasAnchor" number="6.5.5">
<h3><span class="header-section-number">6.5.5</span> Exploring data with functionals<a href="progchapter.html#exploring-data-with-functionals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Functionals are great for creating custom summaries of your data. For instance, if you want to check the data type and number of unique values of each variable in your dataset, you can do that with a functional:</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="progchapter.html#cb667-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb667-2"><a href="progchapter.html#cb667-2" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> <span class="fu">map_dfr</span>(<span class="sc">~</span>(<span class="fu">data.frame</span>(<span class="at">unique_values =</span> <span class="fu">length</span>(<span class="fu">unique</span>(.)),</span>
<span id="cb667-3"><a href="progchapter.html#cb667-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">class =</span> <span class="fu">class</span>(.))))</span></code></pre></div>
<p>You can of course combine <code>purrr</code> functionals with functions from other packages, e.g. to replace <code>length(unique(.))</code> with a function from your favourite data manipulation package:</p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="progchapter.html#cb668-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using uniqueN from data.table:</span></span>
<span id="cb668-2"><a href="progchapter.html#cb668-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb668-3"><a href="progchapter.html#cb668-3" aria-hidden="true" tabindex="-1"></a>dia <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(diamonds)</span>
<span id="cb668-4"><a href="progchapter.html#cb668-4" aria-hidden="true" tabindex="-1"></a>dia <span class="sc">%&gt;%</span> <span class="fu">map_dfr</span>(<span class="sc">~</span>(<span class="fu">data.frame</span>(<span class="at">unique_values =</span> <span class="fu">uniqueN</span>(.),</span>
<span id="cb668-5"><a href="progchapter.html#cb668-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">class =</span> <span class="fu">class</span>(.))))</span>
<span id="cb668-6"><a href="progchapter.html#cb668-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb668-7"><a href="progchapter.html#cb668-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Using n_distinct from dplyr:</span></span>
<span id="cb668-8"><a href="progchapter.html#cb668-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb668-9"><a href="progchapter.html#cb668-9" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> <span class="fu">map_dfr</span>(<span class="sc">~</span>(<span class="fu">data.frame</span>(<span class="at">unique_values =</span> <span class="fu">n_distinct</span>(.),</span>
<span id="cb668-10"><a href="progchapter.html#cb668-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">class =</span> <span class="fu">class</span>(.))))</span></code></pre></div>
<p>When creating summaries it can often be useful to be able to loop over both the elements of a vector and their indices. In <code>purrr</code>, this is done using the usual <code>map*</code> functions, but with an <code>i</code> (for index) in the beginning of their names, e.g. <code>imap</code> and <code>iwalk</code>:</p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="progchapter.html#cb669-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns a list of NULL values:</span></span>
<span id="cb669-2"><a href="progchapter.html#cb669-2" aria-hidden="true" tabindex="-1"></a><span class="fu">imap</span>(airquality, <span class="sc">~</span> <span class="fu">cat</span>(.y, <span class="st">&quot;: &quot;</span>, <span class="fu">median</span>(.x), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))  </span>
<span id="cb669-3"><a href="progchapter.html#cb669-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb669-4"><a href="progchapter.html#cb669-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns nothing:</span></span>
<span id="cb669-5"><a href="progchapter.html#cb669-5" aria-hidden="true" tabindex="-1"></a><span class="fu">iwalk</span>(airquality, <span class="sc">~</span> <span class="fu">cat</span>(.y, <span class="st">&quot;: &quot;</span>, <span class="fu">median</span>(.x), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)) </span></code></pre></div>
<p>Note that <code>.x</code> is used to denote the variable, and that <code>.y</code> is used to denote the <em>name</em> of the variable. If <code>i*</code> functions are used on vectors without element names, indices are used instead. The names of elements of vectors can be set using <code>set_names</code>:</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="progchapter.html#cb670-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Without element names:</span></span>
<span id="cb670-2"><a href="progchapter.html#cb670-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb670-3"><a href="progchapter.html#cb670-3" aria-hidden="true" tabindex="-1"></a><span class="fu">iwalk</span>(x, <span class="sc">~</span> <span class="fu">cat</span>(.y, <span class="st">&quot;: &quot;</span>, <span class="fu">exp</span>(.x), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb670-4"><a href="progchapter.html#cb670-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb670-5"><a href="progchapter.html#cb670-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set element names:</span></span>
<span id="cb670-6"><a href="progchapter.html#cb670-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">set_names</span>(x, <span class="fu">c</span>(<span class="st">&quot;exp(1)&quot;</span>, <span class="st">&quot;exp(2)&quot;</span>, <span class="st">&quot;exp(3)&quot;</span>, <span class="st">&quot;exp(4)&quot;</span>, <span class="st">&quot;exp(5)&quot;</span>))</span>
<span id="cb670-7"><a href="progchapter.html#cb670-7" aria-hidden="true" tabindex="-1"></a><span class="fu">iwalk</span>(x, <span class="sc">~</span> <span class="fu">cat</span>(.y, <span class="st">&quot;: &quot;</span>, <span class="fu">exp</span>(.x), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch6exc13c" class="exercise"><strong>Exercise 6.18  </strong></span>Write a function that takes a data frame as input and returns the following information about each variable in the data frame: variable name, number of unique values, data type and number of missing values. The function should, as you will have guessed, use a functional.</p>
</div>
<p><a href="solutions.html#ch6solutions13c">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch6exc13d" class="exercise"><strong>Exercise 6.19  </strong></span>In Exercise <a href="progchapter.html#exr:ch6exc10">6.10</a> you wrote a function that printed the names and variables for all <code>.csv</code> files in a folder given by <code>folder_path</code>. Use <code>purrr</code> functionals to do the same thing.</p>
</div>
<p><a href="solutions.html#ch6solutions13d">(Click here to go to the solution.)</a></p>
</div>
<div id="keep-calm-and-carry-on" class="section level3 hasAnchor" number="6.5.6">
<h3><span class="header-section-number">6.5.6</span> Keep calm and carry on<a href="progchapter.html#keep-calm-and-carry-on" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another neat feature of <code>purrr</code> is the <code>safely</code> function, which can be used to wrap a function that will be used inside a functional, and makes sure that the functional returns a result even if there is an error. For instance, let’s say that we want to compute the logarithm of all variables in the <code>msleep</code> data:</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="progchapter.html#cb671-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb671-2"><a href="progchapter.html#cb671-2" aria-hidden="true" tabindex="-1"></a>msleep</span></code></pre></div>
<p>Note that some columns are <code>character</code> vectors, which will cause <code>log</code> to throw an error:</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="progchapter.html#cb672-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(msleep<span class="sc">$</span>name)</span>
<span id="cb672-2"><a href="progchapter.html#cb672-2" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(msleep)</span>
<span id="cb672-3"><a href="progchapter.html#cb672-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(msleep, log)</span>
<span id="cb672-4"><a href="progchapter.html#cb672-4" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(msleep, log)</span></code></pre></div>
<p>Note that the error messages we get from <code>lapply</code> and <code>map</code> here don’t give any information about which variable caused the error, making it more difficult to figure out what’s gone wrong.</p>
<p>If first we wrap <code>log</code> with <code>safely</code>, we get a list containing the correct output for the numeric variables, and error messages for the non-numeric variables:</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="progchapter.html#cb673-1" aria-hidden="true" tabindex="-1"></a>safe_log <span class="ot">&lt;-</span> <span class="fu">safely</span>(log)</span>
<span id="cb673-2"><a href="progchapter.html#cb673-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(msleep, safe_log)</span>
<span id="cb673-3"><a href="progchapter.html#cb673-3" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(msleep, safe_log)</span></code></pre></div>
<p>Not only does this tell us where the errors occur, but it also returns the logarithms for all variables that <code>log</code> actually could be applied to.</p>
<p>If you’d like your functional to return some default value, e.g. <code>NA</code>, instead of an error message, you can use <code>possibly</code> instead of <code>safely</code>:</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="progchapter.html#cb674-1" aria-hidden="true" tabindex="-1"></a>pos_log <span class="ot">&lt;-</span> <span class="fu">possibly</span>(log, <span class="at">otherwise =</span> <span class="cn">NA</span>)</span>
<span id="cb674-2"><a href="progchapter.html#cb674-2" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(msleep, pos_log)</span></code></pre></div>
</div>
<div id="multiiter" class="section level3 hasAnchor" number="6.5.7">
<h3><span class="header-section-number">6.5.7</span> Iterating over multiple variables<a href="progchapter.html#multiiter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A final important case is when you want to iterate over more than one variable. This is often the case when fitting statistical models that should be used for prediction, as you’ll see in Section <a href="regression.html#multipredict">8.1.11</a>. Another example is when you wish to create plots for several subsets in your data. For instance, we could create a plot of <code>carat</code> versus <code>price</code> for each combination of <code>color</code> and <code>cut</code> in the <code>diamonds</code> data. To do this for a single combination, we’d use something like this:</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="progchapter.html#cb675-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb675-2"><a href="progchapter.html#cb675-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb675-3"><a href="progchapter.html#cb675-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb675-4"><a href="progchapter.html#cb675-4" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cut <span class="sc">==</span> <span class="st">&quot;Fair&quot;</span>,</span>
<span id="cb675-5"><a href="progchapter.html#cb675-5" aria-hidden="true" tabindex="-1"></a>                    color <span class="sc">==</span> <span class="st">&quot;D&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb675-6"><a href="progchapter.html#cb675-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ggplot</span>(<span class="fu">aes</span>(carat, price)) <span class="sc">+</span></span>
<span id="cb675-7"><a href="progchapter.html#cb675-7" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb675-8"><a href="progchapter.html#cb675-8" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ggtitle</span>(<span class="st">&quot;Fair, D&quot;</span>)</span></code></pre></div>
<p>To create such a plot for all combinations of <code>color</code> and <code>cut</code>, we must first create a data frame containing all unique combinations, which can be done using the <code>distinct</code> function from <code>dplyr</code>:</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="progchapter.html#cb676-1" aria-hidden="true" tabindex="-1"></a>combos <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(cut, color)</span>
<span id="cb676-2"><a href="progchapter.html#cb676-2" aria-hidden="true" tabindex="-1"></a>cuts <span class="ot">&lt;-</span> combos<span class="sc">$</span>cut</span>
<span id="cb676-3"><a href="progchapter.html#cb676-3" aria-hidden="true" tabindex="-1"></a>colours <span class="ot">&lt;-</span> combos<span class="sc">$</span>color</span></code></pre></div>
<p><code>map2</code> and <code>walk2</code> from <code>purrr</code> loop over the elements of two vectors, <code>x</code> and <code>y</code>, say. They combine the first element of <code>x</code> with the first element of <code>y</code>, the second element of <code>x</code> with the second element of <code>y</code>, and so on - meaning that they won’t automatically loop over all combinations of elements. That is the reason why we use <code>distinct</code> above to create two vectors where each pair (<code>x[i]</code>, <code>y[i]</code>) correspond to a combination. Apart from the fact that we add a second vector to the call, <code>map2</code> and <code>walk2</code> work just like <code>map</code> and <code>walk</code>:</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="progchapter.html#cb677-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print all pairs:</span></span>
<span id="cb677-2"><a href="progchapter.html#cb677-2" aria-hidden="true" tabindex="-1"></a><span class="fu">walk2</span>(cuts, colours, <span class="sc">~</span><span class="fu">cat</span>(.x, .y, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb677-3"><a href="progchapter.html#cb677-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb677-4"><a href="progchapter.html#cb677-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a plot for each pair:</span></span>
<span id="cb677-5"><a href="progchapter.html#cb677-5" aria-hidden="true" tabindex="-1"></a>combos_plots <span class="ot">&lt;-</span> <span class="fu">map2</span>(cuts, colours, <span class="sc">~</span>{</span>
<span id="cb677-6"><a href="progchapter.html#cb677-6" aria-hidden="true" tabindex="-1"></a>                     diamonds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cut <span class="sc">==</span> .x,</span>
<span id="cb677-7"><a href="progchapter.html#cb677-7" aria-hidden="true" tabindex="-1"></a>                                         color <span class="sc">==</span> .y) <span class="sc">%&gt;%</span> </span>
<span id="cb677-8"><a href="progchapter.html#cb677-8" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ggplot</span>(<span class="fu">aes</span>(carat, price)) <span class="sc">+</span></span>
<span id="cb677-9"><a href="progchapter.html#cb677-9" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb677-10"><a href="progchapter.html#cb677-10" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ggtitle</span>(<span class="fu">paste</span>(.x, .y, <span class="at">sep =</span><span class="st">&quot;, &quot;</span>))})</span>
<span id="cb677-11"><a href="progchapter.html#cb677-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb677-12"><a href="progchapter.html#cb677-12" aria-hidden="true" tabindex="-1"></a><span class="co"># View some plots:</span></span>
<span id="cb677-13"><a href="progchapter.html#cb677-13" aria-hidden="true" tabindex="-1"></a>combos_plots[[<span class="dv">1</span>]]</span>
<span id="cb677-14"><a href="progchapter.html#cb677-14" aria-hidden="true" tabindex="-1"></a>combos_plots[[<span class="dv">30</span>]]</span>
<span id="cb677-15"><a href="progchapter.html#cb677-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb677-16"><a href="progchapter.html#cb677-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Save all plots in a pdf file, with one plot per page:</span></span>
<span id="cb677-17"><a href="progchapter.html#cb677-17" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;all_combos_plots.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb677-18"><a href="progchapter.html#cb677-18" aria-hidden="true" tabindex="-1"></a>combos_plots</span>
<span id="cb677-19"><a href="progchapter.html#cb677-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p>The base function <code>mapply</code> could also have been used here. If you need to iterate over more than two vectors, you can use <code>pmap</code> or <code>pwalk</code>, which work analogously to <code>map2</code> and <code>walk2</code>.</p>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch6exc13e" class="exercise"><strong>Exercise 6.20  </strong></span>Using the <code>gapminder</code> data from the <code>gapminder</code> package, create scatterplots of <code>pop</code> and <code>lifeExp</code> for each combination of <code>continent</code> and <code>year</code>. Save each plot as a separate <code>.png</code> file.</p>
</div>
<p><a href="solutions.html#ch6solutions13e">(Click here to go to the solution.)</a></p>
</div>
</div>
<div id="measureperformance" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Measuring code performance<a href="progchapter.html#measureperformance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are probably as many ideas about what good code is as there are programmers. Some prefer readable code; others prefer concise code. Some prefer to work with separate functions for each task, while others would rather continue to combine a few basic functions in new ways. Regardless of what you consider to be <em>good code</em>, there are a few objective measures that can be used to assess the quality of your code. In addition to writing code that works and is bug-free, you’d like your code to be:</p>
<ul>
<li><em>Fast</em>: meaning that it runs quickly. Some tasks can take anything from second to weeks, depending on what code you write for them. Speed is particularly important if you’re going to run your code many times.</li>
<li><em>Memory efficient</em>: meaning that it uses as little of your computer’s memory as possible. Software running on your computer uses its memory - its RAM - to store data. If you’re not careful with RAM, you may end up with a full memory and a sluggish or frozen computer. Memory efficiency is critical if you’re working with big datasets, that take up a lot of RAM to begin with.</li>
</ul>
<p>In this section we’ll have a look at how you can measure the speed and memory efficiency of R functions. A caveat is that while speed and memory efficiency are important, the most important thing is to come up with a solution that works in the first place. You should almost always start by solving a problem, and then worry about speed and memory efficiency, not the other way around. The reasons for this is that efficient code often is more difficult to write, read, and debug, which can slow down the process of writing it considerably.</p>
<p>Note also, that speed and memory usage is system dependent - the clock frequency and architecture of your processor and speed and size of your RAM will affect how your code performs, as will what operating system you use and what other programs you are running at the same time. That means that if you wish to compare how two functions perform, you need to compare them on the same system under the same conditions.</p>
<p>As a side note, a great way to speed up functions that use either loops or functionals is parallelisation. We cover that topic in Section <a href="advancedchapter.html#parallel">10.2</a>.</p>
<div id="timing-functions" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Timing functions<a href="progchapter.html#timing-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To measure how long a piece of code takes to run, we can use <code>system.time</code> as follows:</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="progchapter.html#cb678-1" aria-hidden="true" tabindex="-1"></a>rtime <span class="ot">&lt;-</span> <span class="fu">system.time</span>({</span>
<span id="cb678-2"><a href="progchapter.html#cb678-2" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e6</span>)</span>
<span id="cb678-3"><a href="progchapter.html#cb678-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(x)</span>
<span id="cb678-4"><a href="progchapter.html#cb678-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sd</span>(x)</span>
<span id="cb678-5"><a href="progchapter.html#cb678-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb678-6"><a href="progchapter.html#cb678-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb678-7"><a href="progchapter.html#cb678-7" aria-hidden="true" tabindex="-1"></a><span class="co"># elapsed is the total time it took to execute the code:</span></span>
<span id="cb678-8"><a href="progchapter.html#cb678-8" aria-hidden="true" tabindex="-1"></a>rtime</span></code></pre></div>
<p>This isn’t the best way of measuring computational time though, and doesn’t allow us to compare different functions easily. Instead, we’ll use the <code>bench</code> package, which contains a function called <code>mark</code> that is very useful for measuring the execution time of functions and blocks of code. Let’s start by installing it:</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="progchapter.html#cb679-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;bench&quot;</span>)</span></code></pre></div>
<p>In Section <a href="progchapter.html#createfunctions">6.1.1</a> we wrote a function for computing the mean of a vector:</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="progchapter.html#cb680-1" aria-hidden="true" tabindex="-1"></a>average <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb680-2"><a href="progchapter.html#cb680-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb680-3"><a href="progchapter.html#cb680-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">sum</span>(x)<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb680-4"><a href="progchapter.html#cb680-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Is this faster or slower than <code>mean</code>? We can use <code>mark</code> to apply both functions to a vector multiple times, and measure how long each execution takes:</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="progchapter.html#cb681-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bench)</span>
<span id="cb681-2"><a href="progchapter.html#cb681-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb681-3"><a href="progchapter.html#cb681-3" aria-hidden="true" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">mark</span>(<span class="fu">mean</span>(x), <span class="fu">average</span>(x))</span>
<span id="cb681-4"><a href="progchapter.html#cb681-4" aria-hidden="true" tabindex="-1"></a>bm <span class="co"># Or use View(bm) if you don&#39;t want to print the results in the</span></span>
<span id="cb681-5"><a href="progchapter.html#cb681-5" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Console panel.</span></span></code></pre></div>
<p><code>mark</code> has executed both function <code>n_itr</code> times each, and measured how long each execution took to perform. The execution time varies - in the output you can see the shortest (<code>min</code>) and median (<code>median</code>) execution times, as well as the number of iterations per second (<code>itr/sec</code>). Be a little wary of the units for the execution times so that you don’t get them confused - a millisecond (ms, <span class="math inline">\(10^{-3}\)</span> seconds) is 1,000 microseconds (µs, 1 µs is <span class="math inline">\(10^{-6}\)</span> seconds), and 1 microsecond is 1,000 nanoseconds (ns, 1 ns is <span class="math inline">\(10^{-9}\)</span> seconds).</p>
<p>The result here may surprise you - it appears that <code>average</code> is faster than <code>mean</code>! The reason is that <code>mean</code> does a lot of things that <code>average</code> does not: it checks the data type and gives error messages if the data is of the wrong type (e.g. <code>character</code>), and then traverses the vector twice to lower the risk of errors due to floating point arithmetics. All of this takes time, and makes the function slower (but safer to use).</p>
<p>We can plot the results using the <code>ggbeeswarm</code> package:</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="progchapter.html#cb682-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ggbeeswarm&quot;</span>)</span>
<span id="cb682-2"><a href="progchapter.html#cb682-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb682-3"><a href="progchapter.html#cb682-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bm)</span></code></pre></div>
<p>It is also possible to place blocks of code inside curly brackets, <code>{ }</code>, in <code>mark</code>. Here is an example comparing a vectorised solution for computing the squares of a vector with a solution using a loop:</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="progchapter.html#cb683-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb683-2"><a href="progchapter.html#cb683-2" aria-hidden="true" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">mark</span>(x<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb683-3"><a href="progchapter.html#cb683-3" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb683-4"><a href="progchapter.html#cb683-4" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> x</span>
<span id="cb683-5"><a href="progchapter.html#cb683-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(x))</span>
<span id="cb683-6"><a href="progchapter.html#cb683-6" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb683-7"><a href="progchapter.html#cb683-7" aria-hidden="true" tabindex="-1"></a>            y[i] <span class="ot">&lt;-</span> x[i]<span class="sc">*</span>x[i]</span>
<span id="cb683-8"><a href="progchapter.html#cb683-8" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb683-9"><a href="progchapter.html#cb683-9" aria-hidden="true" tabindex="-1"></a>        y</span>
<span id="cb683-10"><a href="progchapter.html#cb683-10" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb683-11"><a href="progchapter.html#cb683-11" aria-hidden="true" tabindex="-1"></a>bm</span>
<span id="cb683-12"><a href="progchapter.html#cb683-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bm)</span></code></pre></div>
<p>Although the above code works, it isn’t the prettiest, and the <code>bm</code> table looks a bit confusing because of the long expression for the code block. I prefer to put the code block inside a function instead:</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="progchapter.html#cb684-1" aria-hidden="true" tabindex="-1"></a>squares <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb684-2"><a href="progchapter.html#cb684-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb684-3"><a href="progchapter.html#cb684-3" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> x</span>
<span id="cb684-4"><a href="progchapter.html#cb684-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(x))</span>
<span id="cb684-5"><a href="progchapter.html#cb684-5" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb684-6"><a href="progchapter.html#cb684-6" aria-hidden="true" tabindex="-1"></a>            y[i] <span class="ot">&lt;-</span> x[i]<span class="sc">*</span>x[i]</span>
<span id="cb684-7"><a href="progchapter.html#cb684-7" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb684-8"><a href="progchapter.html#cb684-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(y)</span>
<span id="cb684-9"><a href="progchapter.html#cb684-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb684-10"><a href="progchapter.html#cb684-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb684-11"><a href="progchapter.html#cb684-11" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb684-12"><a href="progchapter.html#cb684-12" aria-hidden="true" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">mark</span>(x<span class="sc">^</span><span class="dv">2</span>, <span class="fu">squares</span>(x))</span>
<span id="cb684-13"><a href="progchapter.html#cb684-13" aria-hidden="true" tabindex="-1"></a>bm</span>
<span id="cb684-14"><a href="progchapter.html#cb684-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bm)</span></code></pre></div>
<p>Note that <code>squares(x)</code> is faster than the original code block:</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="progchapter.html#cb685-1" aria-hidden="true" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">mark</span>(<span class="fu">squares</span>(x),</span>
<span id="cb685-2"><a href="progchapter.html#cb685-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb685-3"><a href="progchapter.html#cb685-3" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> x</span>
<span id="cb685-4"><a href="progchapter.html#cb685-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(x))</span>
<span id="cb685-5"><a href="progchapter.html#cb685-5" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb685-6"><a href="progchapter.html#cb685-6" aria-hidden="true" tabindex="-1"></a>            y[i] <span class="ot">&lt;-</span> x[i]<span class="sc">*</span>x[i]</span>
<span id="cb685-7"><a href="progchapter.html#cb685-7" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb685-8"><a href="progchapter.html#cb685-8" aria-hidden="true" tabindex="-1"></a>        y</span>
<span id="cb685-9"><a href="progchapter.html#cb685-9" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb685-10"><a href="progchapter.html#cb685-10" aria-hidden="true" tabindex="-1"></a>bm</span></code></pre></div>
<p>Functions in R are <em>compiled</em> the first time they are run, which often makes them run faster than the same code would have outside of the function. We’ll discuss this further next.</p>
</div>
<div id="measuring-memory-usage---and-a-note-on-compilation" class="section level3 hasAnchor" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Measuring memory usage - and a note on compilation<a href="progchapter.html#measuring-memory-usage---and-a-note-on-compilation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>mark</code> also shows us how much memory is allocated when running different code blocks, in the <code>mem_alloc</code> column of the output<a href="#fn46" class="footnote-ref" id="fnref46"><sup>46</sup></a>.</p>
<p>Unfortunately, measuring memory usage is a little tricky. To see why, restart R (yes, really - this is important!), and then run the following code to benchmark <code>x^2</code> versus <code>squares(x)</code>:</p>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="progchapter.html#cb686-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bench)</span>
<span id="cb686-2"><a href="progchapter.html#cb686-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb686-3"><a href="progchapter.html#cb686-3" aria-hidden="true" tabindex="-1"></a>squares <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb686-4"><a href="progchapter.html#cb686-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb686-5"><a href="progchapter.html#cb686-5" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> x</span>
<span id="cb686-6"><a href="progchapter.html#cb686-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(x))</span>
<span id="cb686-7"><a href="progchapter.html#cb686-7" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb686-8"><a href="progchapter.html#cb686-8" aria-hidden="true" tabindex="-1"></a>            y[i] <span class="ot">&lt;-</span> x[i]<span class="sc">*</span>x[i]</span>
<span id="cb686-9"><a href="progchapter.html#cb686-9" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb686-10"><a href="progchapter.html#cb686-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(y)</span>
<span id="cb686-11"><a href="progchapter.html#cb686-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb686-12"><a href="progchapter.html#cb686-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb686-13"><a href="progchapter.html#cb686-13" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb686-14"><a href="progchapter.html#cb686-14" aria-hidden="true" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">mark</span>(x<span class="sc">^</span><span class="dv">2</span>, <span class="fu">squares</span>(x))</span>
<span id="cb686-15"><a href="progchapter.html#cb686-15" aria-hidden="true" tabindex="-1"></a>bm</span></code></pre></div>
<p>Judging from the <code>mem_alloc</code> column, it appears that the <code>squares(x)</code> loop not only is slower, but also uses more memory. But wait! Let’s run the code again, just to be sure of the result:</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="progchapter.html#cb687-1" aria-hidden="true" tabindex="-1"></a>bm <span class="ot">&lt;-</span> <span class="fu">mark</span>(x<span class="sc">^</span><span class="dv">2</span>, <span class="fu">squares</span>(x))</span>
<span id="cb687-2"><a href="progchapter.html#cb687-2" aria-hidden="true" tabindex="-1"></a>bm</span></code></pre></div>
<p>This time out, both functions use less memory, and <code>squares</code> now uses <em>less</em> memory than <code>x^2</code>. What’s going on?</p>
<p>Computers can’t read code written in R or most other programming languages directly. Instead, the code must be translated to <em>machine code</em> that the computer’s processor uses, in a process known as <em>compilation</em>. R uses <em>just-in-time compilation</em> of functions and loops<a href="#fn47" class="footnote-ref" id="fnref47"><sup>47</sup></a>, meaning that it translates the R code for new functions and loops to machine code <em>during execution</em>. Other languages, such as C, use ahead-of-time compilation, translating the code <em>prior to execution</em>. The latter can make the execution much faster, but some flexibility is lost, and the code needs to be run through a compiler ahead of execution, which also takes time. When doing the just-in-time compilation, R needs to use some of the computer’s memory, which causes the memory usage to be greater the first time the function is run. However, if an R function is run again, it has already been compiled, meaning R doesn’t have to allocate memory for compilation.</p>
<p>In conclusion, if you want to benchmark the memory usage of functions, make sure to run them once before benchmarking. Alternatively, if your function takes a long time to run, you can compile it without running it using the <code>cmpfun</code> function from the <code>compiler</code> package:</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="progchapter.html#cb688-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(compiler)</span>
<span id="cb688-2"><a href="progchapter.html#cb688-2" aria-hidden="true" tabindex="-1"></a>squares <span class="ot">&lt;-</span> <span class="fu">cmpfun</span>(squares)</span>
<span id="cb688-3"><a href="progchapter.html#cb688-3" aria-hidden="true" tabindex="-1"></a><span class="fu">squares</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch6exc14" class="exercise"><strong>Exercise 6.21  </strong></span>Write a function for computing the mean of a vector using a <code>for</code> loop. How much slower than <code>mean</code> is it? Which function uses more memory?</p>
</div>
<p><a href="solutions.html#ch6solutions14">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch6exc15" class="exercise"><strong>Exercise 6.22  </strong></span>We have seen three different ways of filtering a data frame to only keep rows that fulfil a condition: using base R, <code>data.table</code> and <code>dplyr</code>. Suppose that we want to extract all flights from 1 January from the <code>flights</code> data in the <code>nycflights13</code> package:</p>
</div>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="progchapter.html#cb689-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb689-2"><a href="progchapter.html#cb689-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb689-3"><a href="progchapter.html#cb689-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb689-4"><a href="progchapter.html#cb689-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read about the data:</span></span>
<span id="cb689-5"><a href="progchapter.html#cb689-5" aria-hidden="true" tabindex="-1"></a>?flights</span>
<span id="cb689-6"><a href="progchapter.html#cb689-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb689-7"><a href="progchapter.html#cb689-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a data.table copy of the data:</span></span>
<span id="cb689-8"><a href="progchapter.html#cb689-8" aria-hidden="true" tabindex="-1"></a>flights.dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(flights)</span>
<span id="cb689-9"><a href="progchapter.html#cb689-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb689-10"><a href="progchapter.html#cb689-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering using base R:</span></span>
<span id="cb689-11"><a href="progchapter.html#cb689-11" aria-hidden="true" tabindex="-1"></a>flights0101 <span class="ot">&lt;-</span> flights[flights<span class="sc">$</span>month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> flights<span class="sc">$</span>day <span class="sc">==</span> <span class="dv">1</span>,]</span>
<span id="cb689-12"><a href="progchapter.html#cb689-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering using data.table:</span></span>
<span id="cb689-13"><a href="progchapter.html#cb689-13" aria-hidden="true" tabindex="-1"></a>flights0101 <span class="ot">&lt;-</span> flights.dt[month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> day <span class="sc">==</span> <span class="dv">1</span>,]</span>
<span id="cb689-14"><a href="progchapter.html#cb689-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering using dplyr:</span></span>
<span id="cb689-15"><a href="progchapter.html#cb689-15" aria-hidden="true" tabindex="-1"></a>flights0101 <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> <span class="fu">filter</span>(month <span class="sc">==</span><span class="dv">1</span>, day <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Compare the speed and memory usage of these three approaches. Which has the best performance?</p>
<p><a href="solutions.html#ch6solutions15">(Click here to go to the solution.)</a></p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="40">
<li id="fn40"><p>Do you <em>really</em>?<a href="progchapter.html#fnref40" class="footnote-back">↩︎</a></p></li>
<li id="fn41"><p><code>base</code> is automatically loaded when you start R, and contains core functions such as <code>sqrt</code>.<a href="progchapter.html#fnref41" class="footnote-back">↩︎</a></p></li>
<li id="fn42"><p>Arguably the best add-on package for R.<a href="progchapter.html#fnref42" class="footnote-back">↩︎</a></p></li>
<li id="fn43"><p>Unlike R, C is a low-level language that allows the user to write highly specialised (and complex) code to perform operations very quickly.<a href="progchapter.html#fnref43" class="footnote-back">↩︎</a></p></li>
<li id="fn44"><p>The vectorised functions often use loops, but loops written in C, which are much faster.<a href="progchapter.html#fnref44" class="footnote-back">↩︎</a></p></li>
<li id="fn45"><p>Actually, over the rows or columns of a matrix - <code>apply</code> converts the data frame to a <code>matrix</code> object.<a href="progchapter.html#fnref45" class="footnote-back">↩︎</a></p></li>
<li id="fn46"><p>But only if your version of R has been <em>compiled with memory profiling</em>. If you are using a standard build of R, i.e. have downloaded the base R binary from R-project.org, you should be good to go. You can check that memory profiling is enabled by checking that <code>capabilities("profmem")</code> returns <code>TRUE</code>. If not, you may need to reinstall R if you wish to enable memory profiling.<a href="progchapter.html#fnref46" class="footnote-back">↩︎</a></p></li>
<li id="fn47"><p>Since R 3.4.<a href="progchapter.html#fnref47" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="messychapter.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modchapter.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
