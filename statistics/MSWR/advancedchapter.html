<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Advanced topics | Modern Statistics with R</title>
  <meta name="description" content="10 Advanced topics | Modern Statistics with R" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Advanced topics | Modern Statistics with R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Advanced topics | Modern Statistics with R" />
  
  
  

<meta name="author" content="Mans Thulin" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mlchapter.html"/>
<link rel="next" href="errorchapter.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="preamble.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modern Statistics with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="Introduction.html"><a href="Introduction.html"><i class="fa fa-check"></i><b>1</b> 들어가며</a>
<ul>
<li class="chapter" data-level="1.1" data-path="Introduction.html"><a href="Introduction.html#whatR"><i class="fa fa-check"></i><b>1.1</b> R이란?</a></li>
<li class="chapter" data-level="1.2" data-path="Introduction.html"><a href="Introduction.html#Rinstallation"><i class="fa fa-check"></i><b>1.2</b> R 설치하기</a></li>
<li class="chapter" data-level="1.3" data-path="Introduction.html"><a href="Introduction.html#RStudioinstallation"><i class="fa fa-check"></i><b>1.3</b> RStudio 설치하기</a></li>
<li class="chapter" data-level="1.4" data-path="Introduction.html"><a href="Introduction.html#LaTeXinstallation"><i class="fa fa-check"></i><b>1.4</b> 레이텍 설치하기</a></li>
<li class="chapter" data-level="1.5" data-path="Introduction.html"><a href="Introduction.html#packageinstallation"><i class="fa fa-check"></i><b>1.5</b> Packages 설치하기</a></li>
<li class="chapter" data-level="1.6" data-path="Introduction.html"><a href="Introduction.html#aboutbook"><i class="fa fa-check"></i><b>1.6</b> 이 책에 대하여</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="thebasics.html"><a href="thebasics.html"><i class="fa fa-check"></i><b>2</b> The basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="thebasics.html"><a href="thebasics.html#a-first-look-at-rstudio"><i class="fa fa-check"></i><b>2.1</b> A first look at RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="thebasics.html"><a href="thebasics.html#runningcode"><i class="fa fa-check"></i><b>2.2</b> Running R code</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="thebasics.html"><a href="thebasics.html#r-scripts"><i class="fa fa-check"></i><b>2.2.1</b> R scripts</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="thebasics.html"><a href="thebasics.html#varsandfuncs"><i class="fa fa-check"></i><b>2.3</b> Variables and functions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="thebasics.html"><a href="thebasics.html#storing-data"><i class="fa fa-check"></i><b>2.3.1</b> Storing data</a></li>
<li class="chapter" data-level="2.3.2" data-path="thebasics.html"><a href="thebasics.html#whats-in-a-name"><i class="fa fa-check"></i><b>2.3.2</b> What’s in a name?</a></li>
<li class="chapter" data-level="2.3.3" data-path="thebasics.html"><a href="thebasics.html#vectors-and-data-frames"><i class="fa fa-check"></i><b>2.3.3</b> Vectors and data frames</a></li>
<li class="chapter" data-level="2.3.4" data-path="thebasics.html"><a href="thebasics.html#functions"><i class="fa fa-check"></i><b>2.3.4</b> Functions</a></li>
<li class="chapter" data-level="2.3.5" data-path="thebasics.html"><a href="thebasics.html#maths"><i class="fa fa-check"></i><b>2.3.5</b> Mathematical operations</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="thebasics.html"><a href="thebasics.html#descstats"><i class="fa fa-check"></i><b>2.4</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="thebasics.html"><a href="thebasics.html#numerical-data"><i class="fa fa-check"></i><b>2.4.1</b> Numerical data</a></li>
<li class="chapter" data-level="2.4.2" data-path="thebasics.html"><a href="thebasics.html#catdata1"><i class="fa fa-check"></i><b>2.4.2</b> Categorical data</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="thebasics.html"><a href="thebasics.html#plotting-numerical-data"><i class="fa fa-check"></i><b>2.5</b> Plotting numerical data</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="thebasics.html"><a href="thebasics.html#our-first-plot"><i class="fa fa-check"></i><b>2.5.1</b> Our first plot</a></li>
<li class="chapter" data-level="2.5.2" data-path="thebasics.html"><a href="thebasics.html#colours-shapes-and-axis-labels"><i class="fa fa-check"></i><b>2.5.2</b> Colours, shapes and axis labels</a></li>
<li class="chapter" data-level="2.5.3" data-path="thebasics.html"><a href="thebasics.html#axis-limits-and-scales"><i class="fa fa-check"></i><b>2.5.3</b> Axis limits and scales</a></li>
<li class="chapter" data-level="2.5.4" data-path="thebasics.html"><a href="thebasics.html#comparinggroups"><i class="fa fa-check"></i><b>2.5.4</b> Comparing groups</a></li>
<li class="chapter" data-level="2.5.5" data-path="thebasics.html"><a href="thebasics.html#boxplots"><i class="fa fa-check"></i><b>2.5.5</b> Boxplots</a></li>
<li class="chapter" data-level="2.5.6" data-path="thebasics.html"><a href="thebasics.html#histograms"><i class="fa fa-check"></i><b>2.5.6</b> Histograms</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="thebasics.html"><a href="thebasics.html#catdata2"><i class="fa fa-check"></i><b>2.6</b> Plotting categorical data</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="thebasics.html"><a href="thebasics.html#bar-charts"><i class="fa fa-check"></i><b>2.6.1</b> Bar charts</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="thebasics.html"><a href="thebasics.html#saving-your-plot"><i class="fa fa-check"></i><b>2.7</b> Saving your plot</a></li>
<li class="chapter" data-level="2.8" data-path="thebasics.html"><a href="thebasics.html#troubleshooting"><i class="fa fa-check"></i><b>2.8</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datachapter.html"><a href="datachapter.html"><i class="fa fa-check"></i><b>3</b> Transforming, summarising, and analysing data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="datachapter.html"><a href="datachapter.html#data-frames-and-data-types"><i class="fa fa-check"></i><b>3.1</b> Data frames and data types</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="datachapter.html"><a href="datachapter.html#types-and-structures"><i class="fa fa-check"></i><b>3.1.1</b> Types and structures</a></li>
<li class="chapter" data-level="3.1.2" data-path="datachapter.html"><a href="datachapter.html#typesoftables"><i class="fa fa-check"></i><b>3.1.2</b> Types of tables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datachapter.html"><a href="datachapter.html#findingpoints"><i class="fa fa-check"></i><b>3.2</b> Vectors in data frames</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="datachapter.html"><a href="datachapter.html#accessingelements"><i class="fa fa-check"></i><b>3.2.1</b> Accessing vectors and elements</a></li>
<li class="chapter" data-level="3.2.2" data-path="datachapter.html"><a href="datachapter.html#use-your-dollars"><i class="fa fa-check"></i><b>3.2.2</b> Use your dollars</a></li>
<li class="chapter" data-level="3.2.3" data-path="datachapter.html"><a href="datachapter.html#conditionsintro"><i class="fa fa-check"></i><b>3.2.3</b> Using conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="datachapter.html"><a href="datachapter.html#paths"><i class="fa fa-check"></i><b>3.3</b> Importing data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="datachapter.html"><a href="datachapter.html#importing-csv-files"><i class="fa fa-check"></i><b>3.3.1</b> Importing csv files</a></li>
<li class="chapter" data-level="3.3.2" data-path="datachapter.html"><a href="datachapter.html#file-paths"><i class="fa fa-check"></i><b>3.3.2</b> File paths</a></li>
<li class="chapter" data-level="3.3.3" data-path="datachapter.html"><a href="datachapter.html#importing-excel-files"><i class="fa fa-check"></i><b>3.3.3</b> Importing Excel files</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="datachapter.html"><a href="datachapter.html#saving-and-exporting-your-data"><i class="fa fa-check"></i><b>3.4</b> Saving and exporting your data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="datachapter.html"><a href="datachapter.html#exporting-data"><i class="fa fa-check"></i><b>3.4.1</b> Exporting data</a></li>
<li class="chapter" data-level="3.4.2" data-path="datachapter.html"><a href="datachapter.html#saving-and-loading-r-data"><i class="fa fa-check"></i><b>3.4.2</b> Saving and loading R data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="datachapter.html"><a href="datachapter.html#rstudio-projects"><i class="fa fa-check"></i><b>3.5</b> RStudio projects</a></li>
<li class="chapter" data-level="3.6" data-path="datachapter.html"><a href="datachapter.html#firstttest"><i class="fa fa-check"></i><b>3.6</b> Running a t-test</a></li>
<li class="chapter" data-level="3.7" data-path="datachapter.html"><a href="datachapter.html#firstlm"><i class="fa fa-check"></i><b>3.7</b> Fitting a linear regression model</a></li>
<li class="chapter" data-level="3.8" data-path="datachapter.html"><a href="datachapter.html#grouped"><i class="fa fa-check"></i><b>3.8</b> Grouped summaries</a></li>
<li class="chapter" data-level="3.9" data-path="datachapter.html"><a href="datachapter.html#pipes"><i class="fa fa-check"></i><b>3.9</b> Using <code>%&gt;%</code> pipes</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="datachapter.html"><a href="datachapter.html#ceci-nest-pas-une-pipe"><i class="fa fa-check"></i><b>3.9.1</b> <em>Ceci n’est pas une pipe</em></a></li>
<li class="chapter" data-level="3.9.2" data-path="datachapter.html"><a href="datachapter.html#aliases-and-placeholders"><i class="fa fa-check"></i><b>3.9.2</b> Aliases and placeholders</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="datachapter.html"><a href="datachapter.html#flavours-of-r-base-and-tidyverse"><i class="fa fa-check"></i><b>3.10</b> Flavours of R: base and tidyverse</a></li>
<li class="chapter" data-level="3.11" data-path="datachapter.html"><a href="datachapter.html#ethicalguidelines"><i class="fa fa-check"></i><b>3.11</b> Ethics and good statistical practice</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>4</b> Exploratory data analysis and unsupervised learning</a>
<ul>
<li class="chapter" data-level="4.1" data-path="eda.html"><a href="eda.html#rmarkdown"><i class="fa fa-check"></i><b>4.1</b> Reports with R Markdown</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="eda.html"><a href="eda.html#a-first-example"><i class="fa fa-check"></i><b>4.1.1</b> A first example</a></li>
<li class="chapter" data-level="4.1.2" data-path="eda.html"><a href="eda.html#formatting-text"><i class="fa fa-check"></i><b>4.1.2</b> Formatting text</a></li>
<li class="chapter" data-level="4.1.3" data-path="eda.html"><a href="eda.html#lists-tables-and-images"><i class="fa fa-check"></i><b>4.1.3</b> Lists, tables, and images</a></li>
<li class="chapter" data-level="4.1.4" data-path="eda.html"><a href="eda.html#code-chunks"><i class="fa fa-check"></i><b>4.1.4</b> Code chunks</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="eda.html"><a href="eda.html#themes"><i class="fa fa-check"></i><b>4.2</b> Customising <code>ggplot2</code> plots</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="eda.html"><a href="eda.html#using-themes"><i class="fa fa-check"></i><b>4.2.1</b> Using themes</a></li>
<li class="chapter" data-level="4.2.2" data-path="eda.html"><a href="eda.html#colourpalettes"><i class="fa fa-check"></i><b>4.2.2</b> Colour palettes</a></li>
<li class="chapter" data-level="4.2.3" data-path="eda.html"><a href="eda.html#theme-settings"><i class="fa fa-check"></i><b>4.2.3</b> Theme settings</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="eda.html"><a href="eda.html#exploring-distributions"><i class="fa fa-check"></i><b>4.3</b> Exploring distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="eda.html"><a href="eda.html#density-plots-and-frequency-polygons"><i class="fa fa-check"></i><b>4.3.1</b> Density plots and frequency polygons</a></li>
<li class="chapter" data-level="4.3.2" data-path="eda.html"><a href="eda.html#asking-questions"><i class="fa fa-check"></i><b>4.3.2</b> Asking questions</a></li>
<li class="chapter" data-level="4.3.3" data-path="eda.html"><a href="eda.html#violin-plots"><i class="fa fa-check"></i><b>4.3.3</b> Violin plots</a></li>
<li class="chapter" data-level="4.3.4" data-path="eda.html"><a href="eda.html#patchwork"><i class="fa fa-check"></i><b>4.3.4</b> Combine multiple plots into a single graphic</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="eda.html"><a href="eda.html#outliers-and-missing-data"><i class="fa fa-check"></i><b>4.4</b> Outliers and missing data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="eda.html"><a href="eda.html#detecting-outliers"><i class="fa fa-check"></i><b>4.4.1</b> Detecting outliers</a></li>
<li class="chapter" data-level="4.4.2" data-path="eda.html"><a href="eda.html#labelling-outliers"><i class="fa fa-check"></i><b>4.4.2</b> Labelling outliers</a></li>
<li class="chapter" data-level="4.4.3" data-path="eda.html"><a href="eda.html#missing-data"><i class="fa fa-check"></i><b>4.4.3</b> Missing data</a></li>
<li class="chapter" data-level="4.4.4" data-path="eda.html"><a href="eda.html#exploring-data"><i class="fa fa-check"></i><b>4.4.4</b> Exploring data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="eda.html"><a href="eda.html#trends-in-scatterplots"><i class="fa fa-check"></i><b>4.5</b> Trends in scatterplots</a></li>
<li class="chapter" data-level="4.6" data-path="eda.html"><a href="eda.html#tsplots"><i class="fa fa-check"></i><b>4.6</b> Exploring time series</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="eda.html"><a href="eda.html#annotations-and-reference-lines"><i class="fa fa-check"></i><b>4.6.1</b> Annotations and reference lines</a></li>
<li class="chapter" data-level="4.6.2" data-path="eda.html"><a href="eda.html#longitudinal-data"><i class="fa fa-check"></i><b>4.6.2</b> Longitudinal data</a></li>
<li class="chapter" data-level="4.6.3" data-path="eda.html"><a href="eda.html#path-plots"><i class="fa fa-check"></i><b>4.6.3</b> Path plots</a></li>
<li class="chapter" data-level="4.6.4" data-path="eda.html"><a href="eda.html#spaghetti-plots"><i class="fa fa-check"></i><b>4.6.4</b> Spaghetti plots</a></li>
<li class="chapter" data-level="4.6.5" data-path="eda.html"><a href="eda.html#stlsec"><i class="fa fa-check"></i><b>4.6.5</b> Seasonal plots and decompositions</a></li>
<li class="chapter" data-level="4.6.6" data-path="eda.html"><a href="eda.html#detecting-changepoints"><i class="fa fa-check"></i><b>4.6.6</b> Detecting changepoints</a></li>
<li class="chapter" data-level="4.6.7" data-path="eda.html"><a href="eda.html#interactivets"><i class="fa fa-check"></i><b>4.6.7</b> Interactive time series plots</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="eda.html"><a href="eda.html#polar"><i class="fa fa-check"></i><b>4.7</b> Using polar coordinates</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="eda.html"><a href="eda.html#visualising-periodic-data"><i class="fa fa-check"></i><b>4.7.1</b> Visualising periodic data</a></li>
<li class="chapter" data-level="4.7.2" data-path="eda.html"><a href="eda.html#pie-charts"><i class="fa fa-check"></i><b>4.7.2</b> Pie charts</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="eda.html"><a href="eda.html#visualising-multiple-variables"><i class="fa fa-check"></i><b>4.8</b> Visualising multiple variables</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="eda.html"><a href="eda.html#scatterplotmatrix"><i class="fa fa-check"></i><b>4.8.1</b> Scatterplot matrices</a></li>
<li class="chapter" data-level="4.8.2" data-path="eda.html"><a href="eda.html#d-scatterplots"><i class="fa fa-check"></i><b>4.8.2</b> 3D scatterplots</a></li>
<li class="chapter" data-level="4.8.3" data-path="eda.html"><a href="eda.html#correlograms"><i class="fa fa-check"></i><b>4.8.3</b> Correlograms</a></li>
<li class="chapter" data-level="4.8.4" data-path="eda.html"><a href="eda.html#adding-more-variables-to-scatterplots"><i class="fa fa-check"></i><b>4.8.4</b> Adding more variables to scatterplots</a></li>
<li class="chapter" data-level="4.8.5" data-path="eda.html"><a href="eda.html#overplotting"><i class="fa fa-check"></i><b>4.8.5</b> Overplotting</a></li>
<li class="chapter" data-level="4.8.6" data-path="eda.html"><a href="eda.html#categorical-data"><i class="fa fa-check"></i><b>4.8.6</b> Categorical data</a></li>
<li class="chapter" data-level="4.8.7" data-path="eda.html"><a href="eda.html#putting-it-all-together"><i class="fa fa-check"></i><b>4.8.7</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="eda.html"><a href="eda.html#pca"><i class="fa fa-check"></i><b>4.9</b> Principal component analysis</a></li>
<li class="chapter" data-level="4.10" data-path="eda.html"><a href="eda.html#clustering"><i class="fa fa-check"></i><b>4.10</b> Cluster analysis</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="eda.html"><a href="eda.html#hierarchical-clustering"><i class="fa fa-check"></i><b>4.10.1</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="4.10.2" data-path="eda.html"><a href="eda.html#heatmaps-and-clustering-variables"><i class="fa fa-check"></i><b>4.10.2</b> Heatmaps and clustering variables</a></li>
<li class="chapter" data-level="4.10.3" data-path="eda.html"><a href="eda.html#centroid"><i class="fa fa-check"></i><b>4.10.3</b> Centroid-based clustering</a></li>
<li class="chapter" data-level="4.10.4" data-path="eda.html"><a href="eda.html#fuzzy-clustering"><i class="fa fa-check"></i><b>4.10.4</b> Fuzzy clustering</a></li>
<li class="chapter" data-level="4.10.5" data-path="eda.html"><a href="eda.html#modelbasedclustering"><i class="fa fa-check"></i><b>4.10.5</b> Model-based clustering</a></li>
<li class="chapter" data-level="4.10.6" data-path="eda.html"><a href="eda.html#comparing-clusters"><i class="fa fa-check"></i><b>4.10.6</b> Comparing clusters</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="eda.html"><a href="eda.html#exploratory-factor-analysis"><i class="fa fa-check"></i><b>4.11</b> Exploratory factor analysis</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="eda.html"><a href="eda.html#factor-analysis"><i class="fa fa-check"></i><b>4.11.1</b> Factor analysis</a></li>
<li class="chapter" data-level="4.11.2" data-path="eda.html"><a href="eda.html#lca"><i class="fa fa-check"></i><b>4.11.2</b> Latent class analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="messychapter.html"><a href="messychapter.html"><i class="fa fa-check"></i><b>5</b> Dealing with messy data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="messychapter.html"><a href="messychapter.html#coercion"><i class="fa fa-check"></i><b>5.1</b> Changing data types</a></li>
<li class="chapter" data-level="5.2" data-path="messychapter.html"><a href="messychapter.html#lists2"><i class="fa fa-check"></i><b>5.2</b> Working with lists</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="messychapter.html"><a href="messychapter.html#splitvector"><i class="fa fa-check"></i><b>5.2.1</b> Splitting vectors into lists</a></li>
<li class="chapter" data-level="5.2.2" data-path="messychapter.html"><a href="messychapter.html#collapsing-lists-into-vectors"><i class="fa fa-check"></i><b>5.2.2</b> Collapsing lists into vectors</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="messychapter.html"><a href="messychapter.html#working-with-numbers"><i class="fa fa-check"></i><b>5.3</b> Working with numbers</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="messychapter.html"><a href="messychapter.html#rounding-numbers"><i class="fa fa-check"></i><b>5.3.1</b> Rounding numbers</a></li>
<li class="chapter" data-level="5.3.2" data-path="messychapter.html"><a href="messychapter.html#sums-and-means-in-data-frames"><i class="fa fa-check"></i><b>5.3.2</b> Sums and means in data frames</a></li>
<li class="chapter" data-level="5.3.3" data-path="messychapter.html"><a href="messychapter.html#rle"><i class="fa fa-check"></i><b>5.3.3</b> Summaries of series of numbers</a></li>
<li class="chapter" data-level="5.3.4" data-path="messychapter.html"><a href="messychapter.html#scientific-notation-1e-03"><i class="fa fa-check"></i><b>5.3.4</b> Scientific notation <code>1e-03</code></a></li>
<li class="chapter" data-level="5.3.5" data-path="messychapter.html"><a href="messychapter.html#floatingpoints"><i class="fa fa-check"></i><b>5.3.5</b> Floating point arithmetics</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="messychapter.html"><a href="messychapter.html#factors"><i class="fa fa-check"></i><b>5.4</b> Working with factors</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="messychapter.html"><a href="messychapter.html#creating-factors"><i class="fa fa-check"></i><b>5.4.1</b> Creating factors</a></li>
<li class="chapter" data-level="5.4.2" data-path="messychapter.html"><a href="messychapter.html#factorlevels"><i class="fa fa-check"></i><b>5.4.2</b> Changing factor levels</a></li>
<li class="chapter" data-level="5.4.3" data-path="messychapter.html"><a href="messychapter.html#changing-the-order-of-levels"><i class="fa fa-check"></i><b>5.4.3</b> Changing the order of levels</a></li>
<li class="chapter" data-level="5.4.4" data-path="messychapter.html"><a href="messychapter.html#combining-levels"><i class="fa fa-check"></i><b>5.4.4</b> Combining levels</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="messychapter.html"><a href="messychapter.html#strings"><i class="fa fa-check"></i><b>5.5</b> Working with strings</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="messychapter.html"><a href="messychapter.html#concatenating-strings"><i class="fa fa-check"></i><b>5.5.1</b> Concatenating strings</a></li>
<li class="chapter" data-level="5.5.2" data-path="messychapter.html"><a href="messychapter.html#changing-case"><i class="fa fa-check"></i><b>5.5.2</b> Changing case</a></li>
<li class="chapter" data-level="5.5.3" data-path="messychapter.html"><a href="messychapter.html#regexp"><i class="fa fa-check"></i><b>5.5.3</b> Finding patterns using regular expressions</a></li>
<li class="chapter" data-level="5.5.4" data-path="messychapter.html"><a href="messychapter.html#sub"><i class="fa fa-check"></i><b>5.5.4</b> Substitution</a></li>
<li class="chapter" data-level="5.5.5" data-path="messychapter.html"><a href="messychapter.html#splitting-strings"><i class="fa fa-check"></i><b>5.5.5</b> Splitting strings</a></li>
<li class="chapter" data-level="5.5.6" data-path="messychapter.html"><a href="messychapter.html#variable-names"><i class="fa fa-check"></i><b>5.5.6</b> Variable names</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="messychapter.html"><a href="messychapter.html#datetime"><i class="fa fa-check"></i><b>5.6</b> Working with dates and times</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="messychapter.html"><a href="messychapter.html#date-formats"><i class="fa fa-check"></i><b>5.6.1</b> Date formats</a></li>
<li class="chapter" data-level="5.6.2" data-path="messychapter.html"><a href="messychapter.html#plotting-with-dates"><i class="fa fa-check"></i><b>5.6.2</b> Plotting with dates</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="messychapter.html"><a href="messychapter.html#data-manipulation-with-data.table-dplyr-and-tidyr"><i class="fa fa-check"></i><b>5.7</b> Data manipulation with <code>data.table</code>, <code>dplyr</code>, and <code>tidyr</code></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="messychapter.html"><a href="messychapter.html#dtbasics"><i class="fa fa-check"></i><b>5.7.1</b> <code>data.table</code> and tidyverse syntax basics</a></li>
<li class="chapter" data-level="5.7.2" data-path="messychapter.html"><a href="messychapter.html#modifyvar"><i class="fa fa-check"></i><b>5.7.2</b> Modifying a variable</a></li>
<li class="chapter" data-level="5.7.3" data-path="messychapter.html"><a href="messychapter.html#computing-a-new-variable-based-on-existing-variables"><i class="fa fa-check"></i><b>5.7.3</b> Computing a new variable based on existing variables</a></li>
<li class="chapter" data-level="5.7.4" data-path="messychapter.html"><a href="messychapter.html#renaming-a-variable"><i class="fa fa-check"></i><b>5.7.4</b> Renaming a variable</a></li>
<li class="chapter" data-level="5.7.5" data-path="messychapter.html"><a href="messychapter.html#removing-a-variable"><i class="fa fa-check"></i><b>5.7.5</b> Removing a variable</a></li>
<li class="chapter" data-level="5.7.6" data-path="messychapter.html"><a href="messychapter.html#recodedplyr"><i class="fa fa-check"></i><b>5.7.6</b> Recoding <code>factor</code> levels</a></li>
<li class="chapter" data-level="5.7.7" data-path="messychapter.html"><a href="messychapter.html#grouped2"><i class="fa fa-check"></i><b>5.7.7</b> Grouped summaries</a></li>
<li class="chapter" data-level="5.7.8" data-path="messychapter.html"><a href="messychapter.html#fillNA"><i class="fa fa-check"></i><b>5.7.8</b> Filling in missing values</a></li>
<li class="chapter" data-level="5.7.9" data-path="messychapter.html"><a href="messychapter.html#chaining-commands-together"><i class="fa fa-check"></i><b>5.7.9</b> Chaining commands together</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="messychapter.html"><a href="messychapter.html#filtering"><i class="fa fa-check"></i><b>5.8</b> Filtering: select rows</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="messychapter.html"><a href="messychapter.html#filtering-using-row-numbers"><i class="fa fa-check"></i><b>5.8.1</b> Filtering using row numbers</a></li>
<li class="chapter" data-level="5.8.2" data-path="messychapter.html"><a href="messychapter.html#conditions2"><i class="fa fa-check"></i><b>5.8.2</b> Filtering using conditions</a></li>
<li class="chapter" data-level="5.8.3" data-path="messychapter.html"><a href="messychapter.html#selecting-rows-at-random"><i class="fa fa-check"></i><b>5.8.3</b> Selecting rows at random</a></li>
<li class="chapter" data-level="5.8.4" data-path="messychapter.html"><a href="messychapter.html#using-regular-expressions-to-select-rows"><i class="fa fa-check"></i><b>5.8.4</b> Using regular expressions to select rows</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="messychapter.html"><a href="messychapter.html#subsetting-select-columns"><i class="fa fa-check"></i><b>5.9</b> Subsetting: select columns</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="messychapter.html"><a href="messychapter.html#selecting-a-single-column"><i class="fa fa-check"></i><b>5.9.1</b> Selecting a single column</a></li>
<li class="chapter" data-level="5.9.2" data-path="messychapter.html"><a href="messychapter.html#selecting-multiple-columns"><i class="fa fa-check"></i><b>5.9.2</b> Selecting multiple columns</a></li>
<li class="chapter" data-level="5.9.3" data-path="messychapter.html"><a href="messychapter.html#using-regular-expressions-to-select-columns"><i class="fa fa-check"></i><b>5.9.3</b> Using regular expressions to select columns</a></li>
<li class="chapter" data-level="5.9.4" data-path="messychapter.html"><a href="messychapter.html#subsetusingcn"><i class="fa fa-check"></i><b>5.9.4</b> Subsetting using column numbers</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="messychapter.html"><a href="messychapter.html#sorting"><i class="fa fa-check"></i><b>5.10</b> Sorting</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="messychapter.html"><a href="messychapter.html#changing-the-column-order"><i class="fa fa-check"></i><b>5.10.1</b> Changing the column order</a></li>
<li class="chapter" data-level="5.10.2" data-path="messychapter.html"><a href="messychapter.html#changing-the-row-order"><i class="fa fa-check"></i><b>5.10.2</b> Changing the row order</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="messychapter.html"><a href="messychapter.html#reshaping"><i class="fa fa-check"></i><b>5.11</b> Reshaping data</a>
<ul>
<li class="chapter" data-level="5.11.1" data-path="messychapter.html"><a href="messychapter.html#from-long-to-wide"><i class="fa fa-check"></i><b>5.11.1</b> From long to wide</a></li>
<li class="chapter" data-level="5.11.2" data-path="messychapter.html"><a href="messychapter.html#from-wide-to-long"><i class="fa fa-check"></i><b>5.11.2</b> From wide to long</a></li>
<li class="chapter" data-level="5.11.3" data-path="messychapter.html"><a href="messychapter.html#splittingcolumns"><i class="fa fa-check"></i><b>5.11.3</b> Splitting columns</a></li>
<li class="chapter" data-level="5.11.4" data-path="messychapter.html"><a href="messychapter.html#merging-columns"><i class="fa fa-check"></i><b>5.11.4</b> Merging columns</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="messychapter.html"><a href="messychapter.html#mergedata"><i class="fa fa-check"></i><b>5.12</b> Merging data from multiple tables</a>
<ul>
<li class="chapter" data-level="5.12.1" data-path="messychapter.html"><a href="messychapter.html#binds"><i class="fa fa-check"></i><b>5.12.1</b> Binds</a></li>
<li class="chapter" data-level="5.12.2" data-path="messychapter.html"><a href="messychapter.html#merging-tables-using-keys"><i class="fa fa-check"></i><b>5.12.2</b> Merging tables using keys</a></li>
<li class="chapter" data-level="5.12.3" data-path="messychapter.html"><a href="messychapter.html#inner-and-outer-joins"><i class="fa fa-check"></i><b>5.12.3</b> Inner and outer joins</a></li>
<li class="chapter" data-level="5.12.4" data-path="messychapter.html"><a href="messychapter.html#semijoins"><i class="fa fa-check"></i><b>5.12.4</b> Semijoins and antijoins</a></li>
</ul></li>
<li class="chapter" data-level="5.13" data-path="messychapter.html"><a href="messychapter.html#scraping-data-from-websites"><i class="fa fa-check"></i><b>5.13</b> Scraping data from websites</a></li>
<li class="chapter" data-level="5.14" data-path="messychapter.html"><a href="messychapter.html#commontasks"><i class="fa fa-check"></i><b>5.14</b> Other commons tasks</a>
<ul>
<li class="chapter" data-level="5.14.1" data-path="messychapter.html"><a href="messychapter.html#deleting-variables"><i class="fa fa-check"></i><b>5.14.1</b> Deleting variables</a></li>
<li class="chapter" data-level="5.14.2" data-path="messychapter.html"><a href="messychapter.html#foreign"><i class="fa fa-check"></i><b>5.14.2</b> Importing data from other statistical packages</a></li>
<li class="chapter" data-level="5.14.3" data-path="messychapter.html"><a href="messychapter.html#importing-data-from-databases"><i class="fa fa-check"></i><b>5.14.3</b> Importing data from databases</a></li>
<li class="chapter" data-level="5.14.4" data-path="messychapter.html"><a href="messychapter.html#importing-data-from-json-files"><i class="fa fa-check"></i><b>5.14.4</b> Importing data from JSON files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="progchapter.html"><a href="progchapter.html"><i class="fa fa-check"></i><b>6</b> R programming</a>
<ul>
<li class="chapter" data-level="6.1" data-path="progchapter.html"><a href="progchapter.html#functions-1"><i class="fa fa-check"></i><b>6.1</b> Functions</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="progchapter.html"><a href="progchapter.html#createfunctions"><i class="fa fa-check"></i><b>6.1.1</b> Creating functions</a></li>
<li class="chapter" data-level="6.1.2" data-path="progchapter.html"><a href="progchapter.html#local-and-global-variables"><i class="fa fa-check"></i><b>6.1.2</b> Local and global variables</a></li>
<li class="chapter" data-level="6.1.3" data-path="progchapter.html"><a href="progchapter.html#willfunctionwork"><i class="fa fa-check"></i><b>6.1.3</b> Will your function work?</a></li>
<li class="chapter" data-level="6.1.4" data-path="progchapter.html"><a href="progchapter.html#more-on-arguments"><i class="fa fa-check"></i><b>6.1.4</b> More on arguments</a></li>
<li class="chapter" data-level="6.1.5" data-path="progchapter.html"><a href="progchapter.html#namespaces"><i class="fa fa-check"></i><b>6.1.5</b> Namespaces</a></li>
<li class="chapter" data-level="6.1.6" data-path="progchapter.html"><a href="progchapter.html#sourcing-other-scripts"><i class="fa fa-check"></i><b>6.1.6</b> Sourcing other scripts</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="progchapter.html"><a href="progchapter.html#morepipes"><i class="fa fa-check"></i><b>6.2</b> More on pipes</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="progchapter.html"><a href="progchapter.html#ce-ne-sont-pas-non-plus-des-pipes"><i class="fa fa-check"></i><b>6.2.1</b> <em>Ce ne sont pas non plus des pipes</em></a></li>
<li class="chapter" data-level="6.2.2" data-path="progchapter.html"><a href="progchapter.html#writing-functions-with-pipes"><i class="fa fa-check"></i><b>6.2.2</b> Writing functions with pipes</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="progchapter.html"><a href="progchapter.html#conditions"><i class="fa fa-check"></i><b>6.3</b> Checking conditions</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="progchapter.html"><a href="progchapter.html#if-and-else"><i class="fa fa-check"></i><b>6.3.1</b> <code>if</code> and <code>else</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="progchapter.html"><a href="progchapter.html#section"><i class="fa fa-check"></i><b>6.3.2</b> <code>&amp;</code> &amp; <code>&amp;&amp;</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="progchapter.html"><a href="progchapter.html#ifelse"><i class="fa fa-check"></i><b>6.3.3</b> <code>ifelse</code></a></li>
<li class="chapter" data-level="6.3.4" data-path="progchapter.html"><a href="progchapter.html#switch"><i class="fa fa-check"></i><b>6.3.4</b> <code>switch</code></a></li>
<li class="chapter" data-level="6.3.5" data-path="progchapter.html"><a href="progchapter.html#failing-gracefully"><i class="fa fa-check"></i><b>6.3.5</b> Failing gracefully</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="progchapter.html"><a href="progchapter.html#loopsection"><i class="fa fa-check"></i><b>6.4</b> Iteration using loops</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="progchapter.html"><a href="progchapter.html#forloops"><i class="fa fa-check"></i><b>6.4.1</b> <code>for</code> loops</a></li>
<li class="chapter" data-level="6.4.2" data-path="progchapter.html"><a href="progchapter.html#nestedloops"><i class="fa fa-check"></i><b>6.4.2</b> Loops within loops</a></li>
<li class="chapter" data-level="6.4.3" data-path="progchapter.html"><a href="progchapter.html#beepr"><i class="fa fa-check"></i><b>6.4.3</b> Keeping track of what’s happening</a></li>
<li class="chapter" data-level="6.4.4" data-path="progchapter.html"><a href="progchapter.html#lists"><i class="fa fa-check"></i><b>6.4.4</b> Loops and lists</a></li>
<li class="chapter" data-level="6.4.5" data-path="progchapter.html"><a href="progchapter.html#whileloop"><i class="fa fa-check"></i><b>6.4.5</b> <code>while</code> loops</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="progchapter.html"><a href="progchapter.html#vectorloops"><i class="fa fa-check"></i><b>6.5</b> Iteration using vectorisation and functionals</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="progchapter.html"><a href="progchapter.html#a-first-example-with-apply"><i class="fa fa-check"></i><b>6.5.1</b> A first example with <code>apply</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="progchapter.html"><a href="progchapter.html#variations-on-a-theme"><i class="fa fa-check"></i><b>6.5.2</b> Variations on a theme</a></li>
<li class="chapter" data-level="6.5.3" data-path="progchapter.html"><a href="progchapter.html#purrr"><i class="fa fa-check"></i><b>6.5.3</b> <code>purrr</code></a></li>
<li class="chapter" data-level="6.5.4" data-path="progchapter.html"><a href="progchapter.html#specialised-functions"><i class="fa fa-check"></i><b>6.5.4</b> Specialised functions</a></li>
<li class="chapter" data-level="6.5.5" data-path="progchapter.html"><a href="progchapter.html#exploring-data-with-functionals"><i class="fa fa-check"></i><b>6.5.5</b> Exploring data with functionals</a></li>
<li class="chapter" data-level="6.5.6" data-path="progchapter.html"><a href="progchapter.html#keep-calm-and-carry-on"><i class="fa fa-check"></i><b>6.5.6</b> Keep calm and carry on</a></li>
<li class="chapter" data-level="6.5.7" data-path="progchapter.html"><a href="progchapter.html#multiiter"><i class="fa fa-check"></i><b>6.5.7</b> Iterating over multiple variables</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="progchapter.html"><a href="progchapter.html#measureperformance"><i class="fa fa-check"></i><b>6.6</b> Measuring code performance</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="progchapter.html"><a href="progchapter.html#timing-functions"><i class="fa fa-check"></i><b>6.6.1</b> Timing functions</a></li>
<li class="chapter" data-level="6.6.2" data-path="progchapter.html"><a href="progchapter.html#measuring-memory-usage---and-a-note-on-compilation"><i class="fa fa-check"></i><b>6.6.2</b> Measuring memory usage - and a note on compilation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modchapter.html"><a href="modchapter.html"><i class="fa fa-check"></i><b>7</b> Modern classical statistics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modchapter.html"><a href="modchapter.html#simulation"><i class="fa fa-check"></i><b>7.1</b> Simulation and distributions</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="modchapter.html"><a href="modchapter.html#generating-random-numbers"><i class="fa fa-check"></i><b>7.1.1</b> Generating random numbers</a></li>
<li class="chapter" data-level="7.1.2" data-path="modchapter.html"><a href="modchapter.html#distfunctions"><i class="fa fa-check"></i><b>7.1.2</b> Some common distributions</a></li>
<li class="chapter" data-level="7.1.3" data-path="modchapter.html"><a href="modchapter.html#assessing-distributional-assumptions"><i class="fa fa-check"></i><b>7.1.3</b> Assessing distributional assumptions</a></li>
<li class="chapter" data-level="7.1.4" data-path="modchapter.html"><a href="modchapter.html#monte-carlo-integration"><i class="fa fa-check"></i><b>7.1.4</b> Monte Carlo integration</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="modchapter.html"><a href="modchapter.html#ttest"><i class="fa fa-check"></i><b>7.2</b> Student’s t-test revisited</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="modchapter.html"><a href="modchapter.html#oldschoolt"><i class="fa fa-check"></i><b>7.2.1</b> The old-school t-test</a></li>
<li class="chapter" data-level="7.2.2" data-path="modchapter.html"><a href="modchapter.html#permutation-tests"><i class="fa fa-check"></i><b>7.2.2</b> Permutation tests</a></li>
<li class="chapter" data-level="7.2.3" data-path="modchapter.html"><a href="modchapter.html#the-bootstrap"><i class="fa fa-check"></i><b>7.2.3</b> The bootstrap</a></li>
<li class="chapter" data-level="7.2.4" data-path="modchapter.html"><a href="modchapter.html#saving-the-output"><i class="fa fa-check"></i><b>7.2.4</b> Saving the output</a></li>
<li class="chapter" data-level="7.2.5" data-path="modchapter.html"><a href="modchapter.html#multipletesting"><i class="fa fa-check"></i><b>7.2.5</b> Multiple testing</a></li>
<li class="chapter" data-level="7.2.6" data-path="modchapter.html"><a href="modchapter.html#hotellingst2"><i class="fa fa-check"></i><b>7.2.6</b> Multivariate testing with Hotelling’s <span class="math inline">\(T^2\)</span></a></li>
<li class="chapter" data-level="7.2.7" data-path="modchapter.html"><a href="modchapter.html#sample-size-computations-for-the-t-test"><i class="fa fa-check"></i><b>7.2.7</b> Sample size computations for the t-test</a></li>
<li class="chapter" data-level="7.2.8" data-path="modchapter.html"><a href="modchapter.html#a-bayesian-approach"><i class="fa fa-check"></i><b>7.2.8</b> A Bayesian approach</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="modchapter.html"><a href="modchapter.html#other-common-hypothesis-tests-and-confidence-intervals"><i class="fa fa-check"></i><b>7.3</b> Other common hypothesis tests and confidence intervals</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="modchapter.html"><a href="modchapter.html#nonparametric-tests-of-location"><i class="fa fa-check"></i><b>7.3.1</b> Nonparametric tests of location</a></li>
<li class="chapter" data-level="7.3.2" data-path="modchapter.html"><a href="modchapter.html#tests-for-correlation"><i class="fa fa-check"></i><b>7.3.2</b> Tests for correlation</a></li>
<li class="chapter" data-level="7.3.3" data-path="modchapter.html"><a href="modchapter.html#chi2-tests"><i class="fa fa-check"></i><b>7.3.3</b> <span class="math inline">\(\chi^2\)</span>-tests</a></li>
<li class="chapter" data-level="7.3.4" data-path="modchapter.html"><a href="modchapter.html#confprop"><i class="fa fa-check"></i><b>7.3.4</b> Confidence intervals for proportions</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="modchapter.html"><a href="modchapter.html#ethicsinference"><i class="fa fa-check"></i><b>7.4</b> Ethical issues in statistical inference</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="modchapter.html"><a href="modchapter.html#p-hacking-and-the-file-drawer-problem"><i class="fa fa-check"></i><b>7.4.1</b> p-hacking and the file-drawer problem</a></li>
<li class="chapter" data-level="7.4.2" data-path="modchapter.html"><a href="modchapter.html#reproducibility"><i class="fa fa-check"></i><b>7.4.2</b> Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="modchapter.html"><a href="modchapter.html#simeval"><i class="fa fa-check"></i><b>7.5</b> Evaluating statistical methods using simulation</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="modchapter.html"><a href="modchapter.html#comparing-estimators"><i class="fa fa-check"></i><b>7.5.1</b> Comparing estimators</a></li>
<li class="chapter" data-level="7.5.2" data-path="modchapter.html"><a href="modchapter.html#simtypeI"><i class="fa fa-check"></i><b>7.5.2</b> Type I error rate of hypothesis tests</a></li>
<li class="chapter" data-level="7.5.3" data-path="modchapter.html"><a href="modchapter.html#simpower"><i class="fa fa-check"></i><b>7.5.3</b> Power of hypothesis tests</a></li>
<li class="chapter" data-level="7.5.4" data-path="modchapter.html"><a href="modchapter.html#powerlocation"><i class="fa fa-check"></i><b>7.5.4</b> Power of some tests of location</a></li>
<li class="chapter" data-level="7.5.5" data-path="modchapter.html"><a href="modchapter.html#simadvice"><i class="fa fa-check"></i><b>7.5.5</b> Some advice on simulation studies</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="modchapter.html"><a href="modchapter.html#sscus"><i class="fa fa-check"></i><b>7.6</b> Sample size computations using simulation</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="modchapter.html"><a href="modchapter.html#simcorpower"><i class="fa fa-check"></i><b>7.6.1</b> Writing your own simulation</a></li>
<li class="chapter" data-level="7.6.2" data-path="modchapter.html"><a href="modchapter.html#the-wilcoxon-mann-whitney-test"><i class="fa fa-check"></i><b>7.6.2</b> The Wilcoxon-Mann-Whitney test</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="modchapter.html"><a href="modchapter.html#bootstrap"><i class="fa fa-check"></i><b>7.7</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="modchapter.html"><a href="modchapter.html#a-general-approach"><i class="fa fa-check"></i><b>7.7.1</b> A general approach</a></li>
<li class="chapter" data-level="7.7.2" data-path="modchapter.html"><a href="modchapter.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>7.7.2</b> Bootstrap confidence intervals</a></li>
<li class="chapter" data-level="7.7.3" data-path="modchapter.html"><a href="modchapter.html#intervalinversion"><i class="fa fa-check"></i><b>7.7.3</b> Bootstrap hypothesis tests</a></li>
<li class="chapter" data-level="7.7.4" data-path="modchapter.html"><a href="modchapter.html#parametricbootstrap"><i class="fa fa-check"></i><b>7.7.4</b> The parametric bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="modchapter.html"><a href="modchapter.html#reporting-statistical-results"><i class="fa fa-check"></i><b>7.8</b> Reporting statistical results</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="modchapter.html"><a href="modchapter.html#what-should-you-include"><i class="fa fa-check"></i><b>7.8.1</b> What should you include?</a></li>
<li class="chapter" data-level="7.8.2" data-path="modchapter.html"><a href="modchapter.html#citing-r-packages"><i class="fa fa-check"></i><b>7.8.2</b> Citing R packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>8</b> Regression models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="regression.html"><a href="regression.html#linearmodels"><i class="fa fa-check"></i><b>8.1</b> Linear models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="regression.html"><a href="regression.html#fitting-linear-models"><i class="fa fa-check"></i><b>8.1.1</b> Fitting linear models</a></li>
<li class="chapter" data-level="8.1.2" data-path="regression.html"><a href="regression.html#interactions-and-polynomial-terms"><i class="fa fa-check"></i><b>8.1.2</b> Interactions and polynomial terms</a></li>
<li class="chapter" data-level="8.1.3" data-path="regression.html"><a href="regression.html#dummy-variables"><i class="fa fa-check"></i><b>8.1.3</b> Dummy variables</a></li>
<li class="chapter" data-level="8.1.4" data-path="regression.html"><a href="regression.html#model-diagnostics"><i class="fa fa-check"></i><b>8.1.4</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.1.5" data-path="regression.html"><a href="regression.html#transformations"><i class="fa fa-check"></i><b>8.1.5</b> Transformations</a></li>
<li class="chapter" data-level="8.1.6" data-path="regression.html"><a href="regression.html#alternatives-to-lm"><i class="fa fa-check"></i><b>8.1.6</b> Alternatives to <code>lm</code></a></li>
<li class="chapter" data-level="8.1.7" data-path="regression.html"><a href="regression.html#regbootstrap"><i class="fa fa-check"></i><b>8.1.7</b> Bootstrap confidence intervals for regression coefficients</a></li>
<li class="chapter" data-level="8.1.8" data-path="regression.html"><a href="regression.html#broom"><i class="fa fa-check"></i><b>8.1.8</b> Alternative summaries with <code>broom</code></a></li>
<li class="chapter" data-level="8.1.9" data-path="regression.html"><a href="regression.html#stepwise"><i class="fa fa-check"></i><b>8.1.9</b> Variable selection</a></li>
<li class="chapter" data-level="8.1.10" data-path="regression.html"><a href="regression.html#prediction"><i class="fa fa-check"></i><b>8.1.10</b> Prediction</a></li>
<li class="chapter" data-level="8.1.11" data-path="regression.html"><a href="regression.html#multipredict"><i class="fa fa-check"></i><b>8.1.11</b> Prediction for multiple datasets</a></li>
<li class="chapter" data-level="8.1.12" data-path="regression.html"><a href="regression.html#ANOVA"><i class="fa fa-check"></i><b>8.1.12</b> ANOVA</a></li>
<li class="chapter" data-level="8.1.13" data-path="regression.html"><a href="regression.html#bayeslm"><i class="fa fa-check"></i><b>8.1.13</b> Bayesian estimation of linear models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="regression.html"><a href="regression.html#ethical-issues-in-regression-modelling"><i class="fa fa-check"></i><b>8.2</b> Ethical issues in regression modelling</a></li>
<li class="chapter" data-level="8.3" data-path="regression.html"><a href="regression.html#generalised-linear-models"><i class="fa fa-check"></i><b>8.3</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="regression.html"><a href="regression.html#logreg"><i class="fa fa-check"></i><b>8.3.1</b> Modelling proportions: Logistic regression</a></li>
<li class="chapter" data-level="8.3.2" data-path="regression.html"><a href="regression.html#bootstrap-confidence-intervals-1"><i class="fa fa-check"></i><b>8.3.2</b> Bootstrap confidence intervals</a></li>
<li class="chapter" data-level="8.3.3" data-path="regression.html"><a href="regression.html#model-diagnostics-1"><i class="fa fa-check"></i><b>8.3.3</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.3.4" data-path="regression.html"><a href="regression.html#prediction-1"><i class="fa fa-check"></i><b>8.3.4</b> Prediction</a></li>
<li class="chapter" data-level="8.3.5" data-path="regression.html"><a href="regression.html#modelling-count-data"><i class="fa fa-check"></i><b>8.3.5</b> Modelling count data</a></li>
<li class="chapter" data-level="8.3.6" data-path="regression.html"><a href="regression.html#modelling-rates"><i class="fa fa-check"></i><b>8.3.6</b> Modelling rates</a></li>
<li class="chapter" data-level="8.3.7" data-path="regression.html"><a href="regression.html#bayesian-estimation-of-generalised-linear-models"><i class="fa fa-check"></i><b>8.3.7</b> Bayesian estimation of generalised linear models</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="regression.html"><a href="regression.html#mixedmodels"><i class="fa fa-check"></i><b>8.4</b> Mixed models</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="regression.html"><a href="regression.html#fitting-a-linear-mixed-model"><i class="fa fa-check"></i><b>8.4.1</b> Fitting a linear mixed model</a></li>
<li class="chapter" data-level="8.4.2" data-path="regression.html"><a href="regression.html#model-diagnostics-2"><i class="fa fa-check"></i><b>8.4.2</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.4.3" data-path="regression.html"><a href="regression.html#lmmbootstrap"><i class="fa fa-check"></i><b>8.4.3</b> Bootstrapping</a></li>
<li class="chapter" data-level="8.4.4" data-path="regression.html"><a href="regression.html#nested-random-effects-and-multilevelhierarchical-models"><i class="fa fa-check"></i><b>8.4.4</b> Nested random effects and multilevel/hierarchical models</a></li>
<li class="chapter" data-level="8.4.5" data-path="regression.html"><a href="regression.html#anova-with-random-effects"><i class="fa fa-check"></i><b>8.4.5</b> ANOVA with random effects</a></li>
<li class="chapter" data-level="8.4.6" data-path="regression.html"><a href="regression.html#generalised-linear-mixed-models"><i class="fa fa-check"></i><b>8.4.6</b> Generalised linear mixed models</a></li>
<li class="chapter" data-level="8.4.7" data-path="regression.html"><a href="regression.html#bayesian-estimation-of-mixed-models"><i class="fa fa-check"></i><b>8.4.7</b> Bayesian estimation of mixed models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="regression.html"><a href="regression.html#survival"><i class="fa fa-check"></i><b>8.5</b> Survival analysis</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="regression.html"><a href="regression.html#comparing-groups"><i class="fa fa-check"></i><b>8.5.1</b> Comparing groups</a></li>
<li class="chapter" data-level="8.5.2" data-path="regression.html"><a href="regression.html#the-cox-proportional-hazards-model"><i class="fa fa-check"></i><b>8.5.2</b> The Cox proportional hazards model</a></li>
<li class="chapter" data-level="8.5.3" data-path="regression.html"><a href="regression.html#accelerated-failure-time-models"><i class="fa fa-check"></i><b>8.5.3</b> Accelerated failure time models</a></li>
<li class="chapter" data-level="8.5.4" data-path="regression.html"><a href="regression.html#bayesian-survival-analysis"><i class="fa fa-check"></i><b>8.5.4</b> Bayesian survival analysis</a></li>
<li class="chapter" data-level="8.5.5" data-path="regression.html"><a href="regression.html#multivariate-survival-analysis"><i class="fa fa-check"></i><b>8.5.5</b> Multivariate survival analysis</a></li>
<li class="chapter" data-level="8.5.6" data-path="regression.html"><a href="regression.html#power-estimates-for-the-logrank-test"><i class="fa fa-check"></i><b>8.5.6</b> Power estimates for the logrank test</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="regression.html"><a href="regression.html#left-censored-data-and-nondetects"><i class="fa fa-check"></i><b>8.6</b> Left-censored data and nondetects</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="regression.html"><a href="regression.html#estimation"><i class="fa fa-check"></i><b>8.6.1</b> Estimation</a></li>
<li class="chapter" data-level="8.6.2" data-path="regression.html"><a href="regression.html#tests-of-means"><i class="fa fa-check"></i><b>8.6.2</b> Tests of means</a></li>
<li class="chapter" data-level="8.6.3" data-path="regression.html"><a href="regression.html#censored-regression"><i class="fa fa-check"></i><b>8.6.3</b> Censored regression</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="regression.html"><a href="regression.html#creating-matched-samples"><i class="fa fa-check"></i><b>8.7</b> Creating matched samples</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="regression.html"><a href="regression.html#propensity-score-matching"><i class="fa fa-check"></i><b>8.7.1</b> Propensity score matching</a></li>
<li class="chapter" data-level="8.7.2" data-path="regression.html"><a href="regression.html#stepwise-matching"><i class="fa fa-check"></i><b>8.7.2</b> Stepwise matching</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mlchapter.html"><a href="mlchapter.html"><i class="fa fa-check"></i><b>9</b> Predictive modelling and machine learning</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mlchapter.html"><a href="mlchapter.html#evaluating-predictive-models"><i class="fa fa-check"></i><b>9.1</b> Evaluating predictive models</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="mlchapter.html"><a href="mlchapter.html#evaluating-regression-models"><i class="fa fa-check"></i><b>9.1.1</b> Evaluating regression models</a></li>
<li class="chapter" data-level="9.1.2" data-path="mlchapter.html"><a href="mlchapter.html#test-training-splits"><i class="fa fa-check"></i><b>9.1.2</b> Test-training splits</a></li>
<li class="chapter" data-level="9.1.3" data-path="mlchapter.html"><a href="mlchapter.html#loocv"><i class="fa fa-check"></i><b>9.1.3</b> Leave-one-out cross-validation and <code>caret</code></a></li>
<li class="chapter" data-level="9.1.4" data-path="mlchapter.html"><a href="mlchapter.html#kfoldcv"><i class="fa fa-check"></i><b>9.1.4</b> k-fold cross-validation</a></li>
<li class="chapter" data-level="9.1.5" data-path="mlchapter.html"><a href="mlchapter.html#twinned-observations"><i class="fa fa-check"></i><b>9.1.5</b> Twinned observations</a></li>
<li class="chapter" data-level="9.1.6" data-path="mlchapter.html"><a href="mlchapter.html#bootstrapping"><i class="fa fa-check"></i><b>9.1.6</b> Bootstrapping</a></li>
<li class="chapter" data-level="9.1.7" data-path="mlchapter.html"><a href="mlchapter.html#classifieraccuracy"><i class="fa fa-check"></i><b>9.1.7</b> Evaluating classification models</a></li>
<li class="chapter" data-level="9.1.8" data-path="mlchapter.html"><a href="mlchapter.html#decisionboundaries"><i class="fa fa-check"></i><b>9.1.8</b> Visualising decision boundaries</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="mlchapter.html"><a href="mlchapter.html#ethical-issues-in-predictive-modelling"><i class="fa fa-check"></i><b>9.2</b> Ethical issues in predictive modelling</a></li>
<li class="chapter" data-level="9.3" data-path="mlchapter.html"><a href="mlchapter.html#modellingchallenges"><i class="fa fa-check"></i><b>9.3</b> Challenges in predictive modelling</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mlchapter.html"><a href="mlchapter.html#imbalanced"><i class="fa fa-check"></i><b>9.3.1</b> Handling class imbalance</a></li>
<li class="chapter" data-level="9.3.2" data-path="mlchapter.html"><a href="mlchapter.html#varimportance"><i class="fa fa-check"></i><b>9.3.2</b> Assessing variable importance</a></li>
<li class="chapter" data-level="9.3.3" data-path="mlchapter.html"><a href="mlchapter.html#extrapolation"><i class="fa fa-check"></i><b>9.3.3</b> Extrapolation</a></li>
<li class="chapter" data-level="9.3.4" data-path="mlchapter.html"><a href="mlchapter.html#missing-data-and-imputation"><i class="fa fa-check"></i><b>9.3.4</b> Missing data and imputation</a></li>
<li class="chapter" data-level="9.3.5" data-path="mlchapter.html"><a href="mlchapter.html#endless-waiting"><i class="fa fa-check"></i><b>9.3.5</b> Endless waiting</a></li>
<li class="chapter" data-level="9.3.6" data-path="mlchapter.html"><a href="mlchapter.html#overfittingtestset"><i class="fa fa-check"></i><b>9.3.6</b> Overfitting to the test set</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mlchapter.html"><a href="mlchapter.html#regularised"><i class="fa fa-check"></i><b>9.4</b> Regularised regression models</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="mlchapter.html"><a href="mlchapter.html#ridge-regression"><i class="fa fa-check"></i><b>9.4.1</b> Ridge regression</a></li>
<li class="chapter" data-level="9.4.2" data-path="mlchapter.html"><a href="mlchapter.html#lasso"><i class="fa fa-check"></i><b>9.4.2</b> The lasso</a></li>
<li class="chapter" data-level="9.4.3" data-path="mlchapter.html"><a href="mlchapter.html#elastic-net"><i class="fa fa-check"></i><b>9.4.3</b> Elastic net</a></li>
<li class="chapter" data-level="9.4.4" data-path="mlchapter.html"><a href="mlchapter.html#choosing-the-best-model"><i class="fa fa-check"></i><b>9.4.4</b> Choosing the best model</a></li>
<li class="chapter" data-level="9.4.5" data-path="mlchapter.html"><a href="mlchapter.html#regularised-mixed-models"><i class="fa fa-check"></i><b>9.4.5</b> Regularised mixed models</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="mlchapter.html"><a href="mlchapter.html#mlmethods"><i class="fa fa-check"></i><b>9.5</b> Machine learning models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mlchapter.html"><a href="mlchapter.html#decisiontrees"><i class="fa fa-check"></i><b>9.5.1</b> Decision trees</a></li>
<li class="chapter" data-level="9.5.2" data-path="mlchapter.html"><a href="mlchapter.html#randomforests"><i class="fa fa-check"></i><b>9.5.2</b> Random forests</a></li>
<li class="chapter" data-level="9.5.3" data-path="mlchapter.html"><a href="mlchapter.html#boosted-trees"><i class="fa fa-check"></i><b>9.5.3</b> Boosted trees</a></li>
<li class="chapter" data-level="9.5.4" data-path="mlchapter.html"><a href="mlchapter.html#model-trees"><i class="fa fa-check"></i><b>9.5.4</b> Model trees</a></li>
<li class="chapter" data-level="9.5.5" data-path="mlchapter.html"><a href="mlchapter.html#discriminant-analysis"><i class="fa fa-check"></i><b>9.5.5</b> Discriminant analysis</a></li>
<li class="chapter" data-level="9.5.6" data-path="mlchapter.html"><a href="mlchapter.html#support-vector-machines"><i class="fa fa-check"></i><b>9.5.6</b> Support vector machines</a></li>
<li class="chapter" data-level="9.5.7" data-path="mlchapter.html"><a href="mlchapter.html#nearest-neighbours-classifiers"><i class="fa fa-check"></i><b>9.5.7</b> Nearest neighbours classifiers</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="mlchapter.html"><a href="mlchapter.html#tsforecast"><i class="fa fa-check"></i><b>9.6</b> Forecasting time series</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="mlchapter.html"><a href="mlchapter.html#decomposition"><i class="fa fa-check"></i><b>9.6.1</b> Decomposition</a></li>
<li class="chapter" data-level="9.6.2" data-path="mlchapter.html"><a href="mlchapter.html#forecasting-using-arima-models"><i class="fa fa-check"></i><b>9.6.2</b> Forecasting using ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="mlchapter.html"><a href="mlchapter.html#deploying-models"><i class="fa fa-check"></i><b>9.7</b> Deploying models</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="mlchapter.html"><a href="mlchapter.html#creating-apis-with-plumber"><i class="fa fa-check"></i><b>9.7.1</b> Creating APIs with <code>plumber</code></a></li>
<li class="chapter" data-level="9.7.2" data-path="mlchapter.html"><a href="mlchapter.html#different-types-of-output"><i class="fa fa-check"></i><b>9.7.2</b> Different types of output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="advancedchapter.html"><a href="advancedchapter.html"><i class="fa fa-check"></i><b>10</b> Advanced topics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="advancedchapter.html"><a href="advancedchapter.html#moreonpackages"><i class="fa fa-check"></i><b>10.1</b> More on packages</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="advancedchapter.html"><a href="advancedchapter.html#loading-and-auto-installing-packages"><i class="fa fa-check"></i><b>10.1.1</b> Loading and auto-installing packages</a></li>
<li class="chapter" data-level="10.1.2" data-path="advancedchapter.html"><a href="advancedchapter.html#updating-r-and-your-packages"><i class="fa fa-check"></i><b>10.1.2</b> Updating R and your packages</a></li>
<li class="chapter" data-level="10.1.3" data-path="advancedchapter.html"><a href="advancedchapter.html#alternative-repositories"><i class="fa fa-check"></i><b>10.1.3</b> Alternative repositories</a></li>
<li class="chapter" data-level="10.1.4" data-path="advancedchapter.html"><a href="advancedchapter.html#removing-packages"><i class="fa fa-check"></i><b>10.1.4</b> Removing packages</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="advancedchapter.html"><a href="advancedchapter.html#parallel"><i class="fa fa-check"></i><b>10.2</b> Speeding up computations with parallelisation</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="advancedchapter.html"><a href="advancedchapter.html#parallelising-for-loops"><i class="fa fa-check"></i><b>10.2.1</b> Parallelising <code>for</code> loops</a></li>
<li class="chapter" data-level="10.2.2" data-path="advancedchapter.html"><a href="advancedchapter.html#parallelising-functionals"><i class="fa fa-check"></i><b>10.2.2</b> Parallelising functionals</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="advancedchapter.html"><a href="advancedchapter.html#linearalgebra"><i class="fa fa-check"></i><b>10.3</b> Linear algebra and matrices</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="advancedchapter.html"><a href="advancedchapter.html#creating-matrices"><i class="fa fa-check"></i><b>10.3.1</b> Creating matrices</a></li>
<li class="chapter" data-level="10.3.2" data-path="advancedchapter.html"><a href="advancedchapter.html#sparse-matrices"><i class="fa fa-check"></i><b>10.3.2</b> Sparse matrices</a></li>
<li class="chapter" data-level="10.3.3" data-path="advancedchapter.html"><a href="advancedchapter.html#matrix-operations"><i class="fa fa-check"></i><b>10.3.3</b> Matrix operations</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="advancedchapter.html"><a href="advancedchapter.html#integration"><i class="fa fa-check"></i><b>10.4</b> Integration with other programming languages</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-c"><i class="fa fa-check"></i><b>10.4.1</b> Integration with C++</a></li>
<li class="chapter" data-level="10.4.2" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-python"><i class="fa fa-check"></i><b>10.4.2</b> Integration with Python</a></li>
<li class="chapter" data-level="10.4.3" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-tensorflow-and-pytorch"><i class="fa fa-check"></i><b>10.4.3</b> Integration with Tensorflow and PyTorch</a></li>
<li class="chapter" data-level="10.4.4" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-spark"><i class="fa fa-check"></i><b>10.4.4</b> Integration with Spark</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="errorchapter.html"><a href="errorchapter.html"><i class="fa fa-check"></i><b>11</b> Debugging</a>
<ul>
<li class="chapter" data-level="11.1" data-path="errorchapter.html"><a href="errorchapter.html#debugging"><i class="fa fa-check"></i><b>11.1</b> Debugging</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="errorchapter.html"><a href="errorchapter.html#find-out-where-the-error-occured-with-traceback"><i class="fa fa-check"></i><b>11.1.1</b> Find out where the error occured with <code>traceback</code></a></li>
<li class="chapter" data-level="11.1.2" data-path="errorchapter.html"><a href="errorchapter.html#interactive-debugging-of-functions-with-debug"><i class="fa fa-check"></i><b>11.1.2</b> Interactive debugging of functions with <code>debug</code></a></li>
<li class="chapter" data-level="11.1.3" data-path="errorchapter.html"><a href="errorchapter.html#investigate-the-environment-with-recover"><i class="fa fa-check"></i><b>11.1.3</b> Investigate the environment with <code>recover</code></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="errorchapter.html"><a href="errorchapter.html#commonerrors"><i class="fa fa-check"></i><b>11.2</b> Common error messages</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="errorchapter.html"><a href="errorchapter.html#section-1"><i class="fa fa-check"></i><b>11.2.1</b> <code>+</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="errorchapter.html"><a href="errorchapter.html#could-not-find-function"><i class="fa fa-check"></i><b>11.2.2</b> <code>could not find function</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="errorchapter.html"><a href="errorchapter.html#object-not-found"><i class="fa fa-check"></i><b>11.2.3</b> <code>object not found</code></a></li>
<li class="chapter" data-level="11.2.4" data-path="errorchapter.html"><a href="errorchapter.html#cannot-open-the-connection-and-no-such-file-or-directory"><i class="fa fa-check"></i><b>11.2.4</b> <code>cannot open the connection</code> and <code>No such file or directory</code></a></li>
<li class="chapter" data-level="11.2.5" data-path="errorchapter.html"><a href="errorchapter.html#invalid-description-argument"><i class="fa fa-check"></i><b>11.2.5</b> <code>invalid 'description' argument</code></a></li>
<li class="chapter" data-level="11.2.6" data-path="errorchapter.html"><a href="errorchapter.html#missing-value-where-truefalse-needed"><i class="fa fa-check"></i><b>11.2.6</b> <code>missing value where TRUE/FALSE needed</code></a></li>
<li class="chapter" data-level="11.2.7" data-path="errorchapter.html"><a href="errorchapter.html#unexpected-in-..."><i class="fa fa-check"></i><b>11.2.7</b> <code>unexpected '=' in ...</code></a></li>
<li class="chapter" data-level="11.2.8" data-path="errorchapter.html"><a href="errorchapter.html#attempt-to-apply-non-function"><i class="fa fa-check"></i><b>11.2.8</b> <code>attempt to apply non-function</code></a></li>
<li class="chapter" data-level="11.2.9" data-path="errorchapter.html"><a href="errorchapter.html#undefined-columns-selected"><i class="fa fa-check"></i><b>11.2.9</b> <code>undefined columns selected</code></a></li>
<li class="chapter" data-level="11.2.10" data-path="errorchapter.html"><a href="errorchapter.html#subscript-out-of-bounds"><i class="fa fa-check"></i><b>11.2.10</b> <code>subscript out of bounds</code></a></li>
<li class="chapter" data-level="11.2.11" data-path="errorchapter.html"><a href="errorchapter.html#object-of-type-closure-is-not-subsettable"><i class="fa fa-check"></i><b>11.2.11</b> <code>Object of type ‘closure’ is not subsettable</code></a></li>
<li class="chapter" data-level="11.2.12" data-path="errorchapter.html"><a href="errorchapter.html#operator-is-invalid-for-atomic-vectors"><i class="fa fa-check"></i><b>11.2.12</b> <code>$ operator is invalid for atomic vectors</code></a></li>
<li class="chapter" data-level="11.2.13" data-path="errorchapter.html"><a href="errorchapter.html#list-object-cannot-be-coerced-to-type-double"><i class="fa fa-check"></i><b>11.2.13</b> <code>(list) object cannot be coerced to type ‘double’</code></a></li>
<li class="chapter" data-level="11.2.14" data-path="errorchapter.html"><a href="errorchapter.html#arguments-imply-differing-number-of-rows"><i class="fa fa-check"></i><b>11.2.14</b> <code>arguments imply differing number of rows</code></a></li>
<li class="chapter" data-level="11.2.15" data-path="errorchapter.html"><a href="errorchapter.html#non-numeric-argument-to-a-binary-operator"><i class="fa fa-check"></i><b>11.2.15</b> <code>non-numeric argument to a binary operator</code></a></li>
<li class="chapter" data-level="11.2.16" data-path="errorchapter.html"><a href="errorchapter.html#non-numeric-argument-to-mathematical-function"><i class="fa fa-check"></i><b>11.2.16</b> <code>non-numeric argument to mathematical function</code></a></li>
<li class="chapter" data-level="11.2.17" data-path="errorchapter.html"><a href="errorchapter.html#cannot-allocate-vector-of-size-..."><i class="fa fa-check"></i><b>11.2.17</b> <code>cannot allocate vector of size ...</code></a></li>
<li class="chapter" data-level="11.2.18" data-path="errorchapter.html"><a href="errorchapter.html#error-in-plot.new-figure-margins-too-large"><i class="fa fa-check"></i><b>11.2.18</b> <code>Error in plot.new() : figure margins too large</code></a></li>
<li class="chapter" data-level="11.2.19" data-path="errorchapter.html"><a href="errorchapter.html#error-in-.call.graphicsc_palette2-.callc_palette2-null-invalid-graphics-state"><i class="fa fa-check"></i><b>11.2.19</b> <code>Error in .Call.graphics(C_palette2, .Call(C_palette2, NULL)) : invalid graphics state</code></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="errorchapter.html"><a href="errorchapter.html#commonwarnings"><i class="fa fa-check"></i><b>11.3</b> Common warning messages</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="errorchapter.html"><a href="errorchapter.html#replacement-has-...-rows-..."><i class="fa fa-check"></i><b>11.3.1</b> <code>replacement has ... rows ...</code></a></li>
<li class="chapter" data-level="11.3.2" data-path="errorchapter.html"><a href="errorchapter.html#iferror"><i class="fa fa-check"></i><b>11.3.2</b> <code>the condition has length &gt; 1 and only the first element will be used</code></a></li>
<li class="chapter" data-level="11.3.3" data-path="errorchapter.html"><a href="errorchapter.html#number-of-items-to-replace-is-not-a-multiple-of-replacement-length"><i class="fa fa-check"></i><b>11.3.3</b> <code>number of items to replace is not a multiple of replacement length</code></a></li>
<li class="chapter" data-level="11.3.4" data-path="errorchapter.html"><a href="errorchapter.html#longer-object-length-is-not-a-multiple-of-shorter-object-length"><i class="fa fa-check"></i><b>11.3.4</b> <code>longer object length is not a multiple of shorter object length</code></a></li>
<li class="chapter" data-level="11.3.5" data-path="errorchapter.html"><a href="errorchapter.html#nas-introduced-by-coercion"><i class="fa fa-check"></i><b>11.3.5</b> <code>NAs introduced by coercion</code></a></li>
<li class="chapter" data-level="11.3.6" data-path="errorchapter.html"><a href="errorchapter.html#package-is-not-available-for-r-version-4.x.x"><i class="fa fa-check"></i><b>11.3.6</b> <code>package is not available (for R version 4.x.x)</code></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="errorchapter.html"><a href="errorchapter.html#installationmessages"><i class="fa fa-check"></i><b>11.4</b> Messages printed when installing <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mathschap.html"><a href="mathschap.html"><i class="fa fa-check"></i><b>12</b> Mathematical appendix</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mathschap.html"><a href="mathschap.html#bootstrapcimaths"><i class="fa fa-check"></i><b>12.1</b> Bootstrap confidence intervals</a></li>
<li class="chapter" data-level="12.2" data-path="mathschap.html"><a href="mathschap.html#confintequal"><i class="fa fa-check"></i><b>12.2</b> The equivalence between confidence intervals and hypothesis tests</a></li>
<li class="chapter" data-level="12.3" data-path="mathschap.html"><a href="mathschap.html#twotypesofpvalues"><i class="fa fa-check"></i><b>12.3</b> Two types of p-values</a></li>
<li class="chapter" data-level="12.4" data-path="mathschap.html"><a href="mathschap.html#deviance"><i class="fa fa-check"></i><b>12.4</b> Deviance tests</a></li>
<li class="chapter" data-level="12.5" data-path="mathschap.html"><a href="mathschap.html#regreg"><i class="fa fa-check"></i><b>12.5</b> Regularised regression</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>13</b> Solutions to exercises</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutionsch2"><i class="fa fa-check"></i>Chapter 2</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutionsch3"><i class="fa fa-check"></i>Chapter 3</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutionsch4"><i class="fa fa-check"></i>Chapter 4</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch5solutions"><i class="fa fa-check"></i>Chapter 5</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch6solutions"><i class="fa fa-check"></i>Chapter 6</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch7solutions"><i class="fa fa-check"></i>Chapter 7</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch7bsolutions"><i class="fa fa-check"></i>Chapter 8</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch8solutions"><i class="fa fa-check"></i>Chapter 9</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>Bibliography</a>
<ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references1"><i class="fa fa-check"></i>Further reading</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references2"><i class="fa fa-check"></i>Online resources</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references3"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="divider"></li>
<li>&copy; 2021 Mans Thulin.</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modern Statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="advancedchapter" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">10</span> Advanced topics<a href="advancedchapter.html#advancedchapter" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter contains brief descriptions of more advanced uses of R. First, we cover more details surrounding packages. We then deal with two topics that are important for computational speed: parallelisation and matrix operations. Finally, there are some tips for how to play well with others (which in this case means using R in combination with programming languages like Python and C++).</p>
<p>After reading this chapter, you will know how to:</p>
<ul>
<li>Update and remove R packages,</li>
<li>Install R packages from other repositories than CRAN,</li>
<li>Run computations in parallel,</li>
<li>Perform matrix computations using R,</li>
<li>Integrate R with other programming languages.</li>
</ul>
<div id="moreonpackages" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> More on packages<a href="advancedchapter.html#moreonpackages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="loading-and-auto-installing-packages" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Loading and auto-installing packages<a href="advancedchapter.html#loading-and-auto-installing-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The best way to load R packages is usually to use <code>library</code>, as we’ve done in the examples in this book. If the package that you’re trying to load isn’t installed, this will return an error message:</p>
<div class="sourceCode" id="cb1055"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1055-1"><a href="advancedchapter.html#cb1055-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;theWrongPackageName&quot;</span>)</span></code></pre></div>
<p>Alternatively, you can use <code>require</code> to load packages. This will only display a warning, but won’t cause your code to stop executing, which usually would be a problem if the rest of the code depends on the package<a href="#fn62" class="footnote-ref" id="fnref62"><sup>62</sup></a>!</p>
<p>However, <code>require</code> also returns a <code>logical</code>: <code>TRUE</code> if the package is installed, and <code>FALSE</code> otherwise. This is useful if you want to load a package, and automatically install it if it doesn’t exist.</p>
<p>To load the <code>beepr</code> package, and install it if it doesn’t already exist, we can use <code>require</code> inside an <code>if</code> condition, as in the code chunk below. If the package exists, the package will be loaded (by <code>require</code>) and <code>TRUE</code> will be returned, and otherwise <code>FALSE</code> will be returned. By using <code>!</code> to turn <code>FALSE</code> into <code>TRUE</code> and vice versa, we can make R install the package if it is missing:</p>
<div class="sourceCode" id="cb1056"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1056-1"><a href="advancedchapter.html#cb1056-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;beepr&quot;</span>)) { <span class="fu">install.packages</span>(<span class="st">&quot;beepr&quot;</span>); <span class="fu">library</span>(beepr) }</span>
<span id="cb1056-2"><a href="advancedchapter.html#cb1056-2" aria-hidden="true" tabindex="-1"></a><span class="fu">beep</span>(<span class="dv">4</span>)</span></code></pre></div>
</div>
<div id="updating-r-and-your-packages" class="section level3 hasAnchor" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> Updating R and your packages<a href="advancedchapter.html#updating-r-and-your-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can download new versions of R and RStudio following the same steps as in Section <a href="#installation"><strong>??</strong></a>. On Windows, you can have multiple versions of R installed simultaneously.</p>
<p>To update a specific R package, you can use <code>install.packages</code>. For instance, to update the <code>beepr</code> package, you’d run:</p>
<div class="sourceCode" id="cb1057"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1057-1"><a href="advancedchapter.html#cb1057-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;beepr&quot;</span>)</span></code></pre></div>
<p>If you make a major update of R, you may have to update most or all of your packages. To update all your packages, you simply run <code>update.packages()</code>. If this fails, you can try the following instead:</p>
<div class="sourceCode" id="cb1058"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1058-1"><a href="advancedchapter.html#cb1058-1" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> <span class="fu">installed.packages</span>()</span>
<span id="cb1058-2"><a href="advancedchapter.html#cb1058-2" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> pkgs[<span class="fu">is.na</span>(pkgs[, <span class="st">&quot;Priority&quot;</span>]), <span class="dv">1</span>]</span>
<span id="cb1058-3"><a href="advancedchapter.html#cb1058-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(pkgs)</span></code></pre></div>
</div>
<div id="alternative-repositories" class="section level3 hasAnchor" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> Alternative repositories<a href="advancedchapter.html#alternative-repositories" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In addition to CRAN, two important sources for R packages are Bioconductor, which contains a large number of packages for bioinformatics, and GitHub, where many developers post development versions of their R packages (which often contain functions and features not yet included in the version of the package that has been posted on CRAN).</p>
<p>To install packages from GitHub, you need the <code>devtools</code> package. You can install it using:</p>
<div class="sourceCode" id="cb1059"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1059-1"><a href="advancedchapter.html#cb1059-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span></code></pre></div>
<p>If you for instance want to install the development version of <code>dplyr</code> (which you can find at <a href="https://github.com/tidyverse/dplyr">https://github.com/tidyverse/dplyr</a>), you can then run the following:</p>
<div class="sourceCode" id="cb1060"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1060-1"><a href="advancedchapter.html#cb1060-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1060-2"><a href="advancedchapter.html#cb1060-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">&quot;tidyverse/dplyr&quot;</span>)</span></code></pre></div>
<p>Using development versions of packages can be great, because it gives you the most up-to-date version of packages. Bear in mind that they are development versions though, which means that they can be less stable and have more bugs.</p>
<p>To install packages from Bioconductor, you can start by running this code chunk, which installs the <code>BiocManager</code> package that is used to install Bioconductor packages:</p>
<div class="sourceCode" id="cb1061"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1061-1"><a href="advancedchapter.html#cb1061-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>)</span>
<span id="cb1061-2"><a href="advancedchapter.html#cb1061-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Install core packages:</span></span>
<span id="cb1061-3"><a href="advancedchapter.html#cb1061-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BiocManager)</span>
<span id="cb1061-4"><a href="advancedchapter.html#cb1061-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install</span>()</span></code></pre></div>
<p>You can have a look at the list of packages at</p>
<p><a href="https://www.bioconductor.org/packages/release/BiocViews.html#___Software">https://www.bioconductor.org/packages/release/BiocViews.html#___Software</a></p>
<p>If you for instance find the <code>affyio</code> package interesting, you can then install it using:</p>
<div class="sourceCode" id="cb1062"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1062-1"><a href="advancedchapter.html#cb1062-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BiocManager)</span>
<span id="cb1062-2"><a href="advancedchapter.html#cb1062-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install</span>(<span class="st">&quot;affyio&quot;</span>)</span></code></pre></div>
</div>
<div id="removing-packages" class="section level3 hasAnchor" number="10.1.4">
<h3><span class="header-section-number">10.1.4</span> Removing packages<a href="advancedchapter.html#removing-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is probably not something that you’ll find yourself doing often, but if you need to uninstall a package, you can do so using <code>remove.packages</code>. Perhaps you’ve installed the development version of a package and want to remove it, so that you can install the stable version again? If you for instance want to uninstall the <code>beepr</code> package<a href="#fn63" class="footnote-ref" id="fnref63"><sup>63</sup></a>, you’d run the following:</p>
<div class="sourceCode" id="cb1063"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1063-1"><a href="advancedchapter.html#cb1063-1" aria-hidden="true" tabindex="-1"></a><span class="fu">remove.packages</span>(<span class="st">&quot;beepr&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="parallel" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Speeding up computations with parallelisation<a href="advancedchapter.html#parallel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Modern computers have CPU’s with multiple cores and threads, which allows us to speed up computations by performing them in parallel. Some functions in R do this by default, but far from all do. In this section, we’ll have a look at how to run parallel versions of <code>for</code> loops and functionals.</p>
<div id="parallelising-for-loops" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Parallelising <code>for</code> loops<a href="advancedchapter.html#parallelising-for-loops" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we’ll have a look at how to parallelise a <code>for</code> loop. We’ll use the <code>foreach</code>, <code>parallel</code>, and <code>doParallel</code> packages, so let’s install them if you haven’t already:</p>
<div class="sourceCode" id="cb1064"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1064-1"><a href="advancedchapter.html#cb1064-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;foreach&quot;</span>, <span class="st">&quot;parallel&quot;</span>, <span class="st">&quot;doParallel&quot;</span>))</span></code></pre></div>
<p>To see how many cores that are available on your machine, you can use <code>detectCores</code>:</p>
<div class="sourceCode" id="cb1065"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1065-1"><a href="advancedchapter.html#cb1065-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb1065-2"><a href="advancedchapter.html#cb1065-2" aria-hidden="true" tabindex="-1"></a><span class="fu">detectCores</span>()</span></code></pre></div>
<p>It is unwise to use all available cores for your parallel computation - you’ll always need to reserve at least one for running RStudio and other applications.</p>
<p>To run the steps of a <code>for</code> loop in parallel, we must first use <code>registerDoParallel</code> to <em>register</em> the parallel backend to be used. Here is an example where we create 3 workers (and so use 3 cores in parallel<a href="#fn64" class="footnote-ref" id="fnref64"><sup>64</sup></a>) using <code>registerDoParallel</code>. When we then use <code>foreach</code> to create a <code>for</code> loop, these three workers will execute different steps of the loop in parallel. Note that this wouldn’t work if each step of the loop depended on output from the previous step. <code>foreach</code> returns the output created at the end of each step of the loop in a <code>list</code> (Section <a href="messychapter.html#lists2">5.2</a>):</p>
<div class="sourceCode" id="cb1066"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1066-1"><a href="advancedchapter.html#cb1066-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb1066-2"><a href="advancedchapter.html#cb1066-2" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(<span class="dv">3</span>)</span>
<span id="cb1066-3"><a href="advancedchapter.html#cb1066-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1066-4"><a href="advancedchapter.html#cb1066-4" aria-hidden="true" tabindex="-1"></a>loop_output <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">%dopar%</span></span>
<span id="cb1066-5"><a href="advancedchapter.html#cb1066-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1066-6"><a href="advancedchapter.html#cb1066-6" aria-hidden="true" tabindex="-1"></a>      i<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1066-7"><a href="advancedchapter.html#cb1066-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1066-8"><a href="advancedchapter.html#cb1066-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1066-9"><a href="advancedchapter.html#cb1066-9" aria-hidden="true" tabindex="-1"></a>loop_output</span>
<span id="cb1066-10"><a href="advancedchapter.html#cb1066-10" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(loop_output) <span class="co"># Convert the list to a vector</span></span></code></pre></div>
<p>If the output created at the end of each iteration is a vector, we can collect the output in a <code>matrix</code> object as follows:</p>
<div class="sourceCode" id="cb1067"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1067-1"><a href="advancedchapter.html#cb1067-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb1067-2"><a href="advancedchapter.html#cb1067-2" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(<span class="dv">3</span>)</span>
<span id="cb1067-3"><a href="advancedchapter.html#cb1067-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1067-4"><a href="advancedchapter.html#cb1067-4" aria-hidden="true" tabindex="-1"></a>loop_output <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">%dopar%</span></span>
<span id="cb1067-5"><a href="advancedchapter.html#cb1067-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1067-6"><a href="advancedchapter.html#cb1067-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(i, i<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1067-7"><a href="advancedchapter.html#cb1067-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1067-8"><a href="advancedchapter.html#cb1067-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1067-9"><a href="advancedchapter.html#cb1067-9" aria-hidden="true" tabindex="-1"></a>loop_output</span>
<span id="cb1067-10"><a href="advancedchapter.html#cb1067-10" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">unlist</span>(loop_output), <span class="dv">9</span>, <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>If you have nested loops, you should run the outer loop in parallel, but not the inner loops. The reason for this is that parallelisation only really helps if each step of the loop takes a comparatively long time to run. In fact, there is a small overhead cost associated with assigning different iterations to different cores, meaning that parallel loops can be slower than regular loops if each iteration runs quickly.</p>
<p>An example where each step often takes a while to run is simulation studies. Let’s rewrite the simulation we used to compute the type I error rates of different versions of the t-test in Section <a href="modchapter.html#simtypeI">7.5.2</a> using a parallel <code>for</code> loop instead. First, we define the function as in Section <a href="modchapter.html#simtypeI">7.5.2</a> (minus the progress bar):</p>
<div class="sourceCode" id="cb1068"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1068-1"><a href="advancedchapter.html#cb1068-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load package used for permutation t-test:</span></span>
<span id="cb1068-2"><a href="advancedchapter.html#cb1068-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MKinfer)</span>
<span id="cb1068-3"><a href="advancedchapter.html#cb1068-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1068-4"><a href="advancedchapter.html#cb1068-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function for running the simulation:</span></span>
<span id="cb1068-5"><a href="advancedchapter.html#cb1068-5" aria-hidden="true" tabindex="-1"></a>simulate_type_I <span class="ot">&lt;-</span> <span class="cf">function</span>(n1, n2, distr, <span class="at">level =</span> <span class="fl">0.05</span>, <span class="at">B =</span> <span class="dv">999</span>,</span>
<span id="cb1068-6"><a href="advancedchapter.html#cb1068-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, ...)</span>
<span id="cb1068-7"><a href="advancedchapter.html#cb1068-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1068-8"><a href="advancedchapter.html#cb1068-8" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create a data frame to store the results in:</span></span>
<span id="cb1068-9"><a href="advancedchapter.html#cb1068-9" aria-hidden="true" tabindex="-1"></a>      p_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">p_t_test =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, B),</span>
<span id="cb1068-10"><a href="advancedchapter.html#cb1068-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">p_perm_t_test =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, B),</span>
<span id="cb1068-11"><a href="advancedchapter.html#cb1068-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">p_wilcoxon =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, B))</span>
<span id="cb1068-12"><a href="advancedchapter.html#cb1068-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1068-13"><a href="advancedchapter.html#cb1068-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B)</span>
<span id="cb1068-14"><a href="advancedchapter.html#cb1068-14" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb1068-15"><a href="advancedchapter.html#cb1068-15" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Generate data:</span></span>
<span id="cb1068-16"><a href="advancedchapter.html#cb1068-16" aria-hidden="true" tabindex="-1"></a>            x <span class="ot">&lt;-</span> <span class="fu">distr</span>(n1, ...)</span>
<span id="cb1068-17"><a href="advancedchapter.html#cb1068-17" aria-hidden="true" tabindex="-1"></a>            y <span class="ot">&lt;-</span> <span class="fu">distr</span>(n2, ...)</span>
<span id="cb1068-18"><a href="advancedchapter.html#cb1068-18" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1068-19"><a href="advancedchapter.html#cb1068-19" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Compute p-values:</span></span>
<span id="cb1068-20"><a href="advancedchapter.html#cb1068-20" aria-hidden="true" tabindex="-1"></a>            p_values[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, y,</span>
<span id="cb1068-21"><a href="advancedchapter.html#cb1068-21" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alternative =</span> alternative)<span class="sc">$</span>p.value</span>
<span id="cb1068-22"><a href="advancedchapter.html#cb1068-22" aria-hidden="true" tabindex="-1"></a>            p_values[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">perm.t.test</span>(x, y,</span>
<span id="cb1068-23"><a href="advancedchapter.html#cb1068-23" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alternative =</span> alternative,</span>
<span id="cb1068-24"><a href="advancedchapter.html#cb1068-24" aria-hidden="true" tabindex="-1"></a>                               <span class="at">R =</span> <span class="dv">999</span>)<span class="sc">$</span>perm.p.value</span>
<span id="cb1068-25"><a href="advancedchapter.html#cb1068-25" aria-hidden="true" tabindex="-1"></a>            p_values[i, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(x, y,</span>
<span id="cb1068-26"><a href="advancedchapter.html#cb1068-26" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alternative =</span> alternative)<span class="sc">$</span>p.value</span>
<span id="cb1068-27"><a href="advancedchapter.html#cb1068-27" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1068-28"><a href="advancedchapter.html#cb1068-28" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1068-29"><a href="advancedchapter.html#cb1068-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Return the type I error rates:</span></span>
<span id="cb1068-30"><a href="advancedchapter.html#cb1068-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">colMeans</span>(p_values <span class="sc">&lt;</span> level))</span>
<span id="cb1068-31"><a href="advancedchapter.html#cb1068-31" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Next, we create a parallel version:</p>
<div class="sourceCode" id="cb1069"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1069-1"><a href="advancedchapter.html#cb1069-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Register parallel backend:</span></span>
<span id="cb1069-2"><a href="advancedchapter.html#cb1069-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb1069-3"><a href="advancedchapter.html#cb1069-3" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(<span class="dv">3</span>)</span>
<span id="cb1069-4"><a href="advancedchapter.html#cb1069-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1069-5"><a href="advancedchapter.html#cb1069-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function for running the simulation in parallel:</span></span>
<span id="cb1069-6"><a href="advancedchapter.html#cb1069-6" aria-hidden="true" tabindex="-1"></a>simulate_type_I_parallel <span class="ot">&lt;-</span> <span class="cf">function</span>(n1, n2, distr, <span class="at">level =</span> <span class="fl">0.05</span>,</span>
<span id="cb1069-7"><a href="advancedchapter.html#cb1069-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">B =</span> <span class="dv">999</span>,</span>
<span id="cb1069-8"><a href="advancedchapter.html#cb1069-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, ...)</span>
<span id="cb1069-9"><a href="advancedchapter.html#cb1069-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1069-10"><a href="advancedchapter.html#cb1069-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1069-11"><a href="advancedchapter.html#cb1069-11" aria-hidden="true" tabindex="-1"></a>      results <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>B)  <span class="sc">%dopar%</span> </span>
<span id="cb1069-12"><a href="advancedchapter.html#cb1069-12" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb1069-13"><a href="advancedchapter.html#cb1069-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Generate data:</span></span>
<span id="cb1069-14"><a href="advancedchapter.html#cb1069-14" aria-hidden="true" tabindex="-1"></a>            x <span class="ot">&lt;-</span> <span class="fu">distr</span>(n1, ...)</span>
<span id="cb1069-15"><a href="advancedchapter.html#cb1069-15" aria-hidden="true" tabindex="-1"></a>            y <span class="ot">&lt;-</span> <span class="fu">distr</span>(n2, ...)</span>
<span id="cb1069-16"><a href="advancedchapter.html#cb1069-16" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1069-17"><a href="advancedchapter.html#cb1069-17" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Compute p-values:</span></span>
<span id="cb1069-18"><a href="advancedchapter.html#cb1069-18" aria-hidden="true" tabindex="-1"></a>            p_val1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, y,</span>
<span id="cb1069-19"><a href="advancedchapter.html#cb1069-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alternative =</span> alternative)<span class="sc">$</span>p.value</span>
<span id="cb1069-20"><a href="advancedchapter.html#cb1069-20" aria-hidden="true" tabindex="-1"></a>            p_val2 <span class="ot">&lt;-</span> <span class="fu">perm.t.test</span>(x, y,</span>
<span id="cb1069-21"><a href="advancedchapter.html#cb1069-21" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alternative =</span> alternative,</span>
<span id="cb1069-22"><a href="advancedchapter.html#cb1069-22" aria-hidden="true" tabindex="-1"></a>                               <span class="at">R =</span> <span class="dv">999</span>)<span class="sc">$</span>perm.p.value</span>
<span id="cb1069-23"><a href="advancedchapter.html#cb1069-23" aria-hidden="true" tabindex="-1"></a>            p_val3 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(x, y,</span>
<span id="cb1069-24"><a href="advancedchapter.html#cb1069-24" aria-hidden="true" tabindex="-1"></a>                               <span class="at">alternative =</span> alternative)<span class="sc">$</span>p.value</span>
<span id="cb1069-25"><a href="advancedchapter.html#cb1069-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1069-26"><a href="advancedchapter.html#cb1069-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Return vector with p-values:</span></span>
<span id="cb1069-27"><a href="advancedchapter.html#cb1069-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(p_val1, p_val2, p_val3)</span>
<span id="cb1069-28"><a href="advancedchapter.html#cb1069-28" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1069-29"><a href="advancedchapter.html#cb1069-29" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1069-30"><a href="advancedchapter.html#cb1069-30" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Each element of the results list is now a vector</span></span>
<span id="cb1069-31"><a href="advancedchapter.html#cb1069-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># with three elements.</span></span>
<span id="cb1069-32"><a href="advancedchapter.html#cb1069-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Turn the list into a matrix:</span></span>
<span id="cb1069-33"><a href="advancedchapter.html#cb1069-33" aria-hidden="true" tabindex="-1"></a>      p_values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(results), B, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1069-34"><a href="advancedchapter.html#cb1069-34" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1069-35"><a href="advancedchapter.html#cb1069-35" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Return the type I error rates:</span></span>
<span id="cb1069-36"><a href="advancedchapter.html#cb1069-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">colMeans</span>(p_values <span class="sc">&lt;</span> level))</span>
<span id="cb1069-37"><a href="advancedchapter.html#cb1069-37" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can now compare how long the two functions take to run using the tools from Section <a href="progchapter.html#measureperformance">6.6</a> (we’ll not use <code>mark</code> in this case, as it requires both functions to yield identical output, which won’t be the case for a simulation):</p>
<div class="sourceCode" id="cb1070"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1070-1"><a href="advancedchapter.html#cb1070-1" aria-hidden="true" tabindex="-1"></a>time1 <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">simulate_type_I</span>(<span class="dv">20</span>, <span class="dv">20</span>, rlnorm,</span>
<span id="cb1070-2"><a href="advancedchapter.html#cb1070-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">B =</span> <span class="dv">999</span>, <span class="at">sdlog =</span> <span class="dv">3</span>))</span>
<span id="cb1070-3"><a href="advancedchapter.html#cb1070-3" aria-hidden="true" tabindex="-1"></a>time2 <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">simulate_type_I_parallel</span>(<span class="dv">20</span>, <span class="dv">20</span>, rlnorm,</span>
<span id="cb1070-4"><a href="advancedchapter.html#cb1070-4" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">B =</span> <span class="dv">999</span>, <span class="at">sdlog =</span> <span class="dv">3</span>))</span>
<span id="cb1070-5"><a href="advancedchapter.html#cb1070-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1070-6"><a href="advancedchapter.html#cb1070-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare results:</span></span>
<span id="cb1070-7"><a href="advancedchapter.html#cb1070-7" aria-hidden="true" tabindex="-1"></a>time1; time2; time2<span class="sc">/</span>time1</span></code></pre></div>
<p>As you can see, the parallel function is considerably faster. If you have more cores, you can try increasing the value in <code>registerDoParallel</code> and see how that affects the results.</p>
</div>
<div id="parallelising-functionals" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Parallelising functionals<a href="advancedchapter.html#parallelising-functionals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>parallel</code> package contains parallelised versions of the <code>apply</code> family of functions, with names like <code>parApply</code>, <code>parLapply</code>, and <code>mclapply</code>. Which of these that you should use depends in part on your operating system, as different operating systems handle multicore computations differently. Here is the first example from Section <a href="progchapter.html#purrr">6.5.3</a>, run in parallel with 3 workers:</p>
<div class="sourceCode" id="cb1071"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1071-1"><a href="advancedchapter.html#cb1071-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-parallel version:</span></span>
<span id="cb1071-2"><a href="advancedchapter.html#cb1071-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(airquality, <span class="cf">function</span>(x) { (x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x) })</span>
<span id="cb1071-3"><a href="advancedchapter.html#cb1071-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1071-4"><a href="advancedchapter.html#cb1071-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Parallel version for Linux/Mac:</span></span>
<span id="cb1071-5"><a href="advancedchapter.html#cb1071-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb1071-6"><a href="advancedchapter.html#cb1071-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mclapply</span>(airquality, <span class="cf">function</span>(x) { (x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x) },</span>
<span id="cb1071-7"><a href="advancedchapter.html#cb1071-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">mc.cores =</span> <span class="dv">3</span>)</span>
<span id="cb1071-8"><a href="advancedchapter.html#cb1071-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1071-9"><a href="advancedchapter.html#cb1071-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Parallel version for Windows (a little slower):</span></span>
<span id="cb1071-10"><a href="advancedchapter.html#cb1071-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb1071-11"><a href="advancedchapter.html#cb1071-11" aria-hidden="true" tabindex="-1"></a>myCluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">3</span>)</span>
<span id="cb1071-12"><a href="advancedchapter.html#cb1071-12" aria-hidden="true" tabindex="-1"></a><span class="fu">parLapply</span>(myCluster, airquality, <span class="cf">function</span>(x) { (x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x) })</span>
<span id="cb1071-13"><a href="advancedchapter.html#cb1071-13" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(myCluster)</span></code></pre></div>
<p>Similarly, the <code>furrr</code> package lets just run <code>purrr</code>-functionals in parallel. It relies on a package called <code>future</code>. Let’s install them both:</p>
<div class="sourceCode" id="cb1072"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1072-1"><a href="advancedchapter.html#cb1072-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;future&quot;</span>, <span class="st">&quot;furrr&quot;</span>))</span></code></pre></div>
<p>To run functionals in parallel, we load the <code>furrr</code> package and use <code>plan</code> to set the number of parallel workers:</p>
<div class="sourceCode" id="cb1073"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1073-1"><a href="advancedchapter.html#cb1073-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(furrr)</span>
<span id="cb1073-2"><a href="advancedchapter.html#cb1073-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Use 3 workers:</span></span>
<span id="cb1073-3"><a href="advancedchapter.html#cb1073-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>We can then run parallel versions of functions like <code>map</code> and <code>imap</code>, by using functions from <code>furrr</code> with the same names, only with <code>future_</code> added at the beginning. Here is the first example from Section <a href="progchapter.html#purrr">6.5.3</a>, run in parallel:</p>
<div class="sourceCode" id="cb1074"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1074-1"><a href="advancedchapter.html#cb1074-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1074-2"><a href="advancedchapter.html#cb1074-2" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> <span class="fu">future_map</span>(<span class="sc">~</span>(.<span class="sc">-</span><span class="fu">mean</span>(.))<span class="sc">/</span><span class="fu">sd</span>(.))</span></code></pre></div>
<p>Just as for <code>for</code> loops, parallelisation of functionals only really helps if each iteration of the functional takes a comparatively long time to run (and so there is no benefit to using parallelisation in this particular example).</p>
</div>
</div>
<div id="linearalgebra" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Linear algebra and matrices<a href="advancedchapter.html#linearalgebra" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Linear algebra is the beating heart of many statistical methods. R has a wide range of functions for creating and manipulating matrices, and doing matrix algebra. In this section, we’ll have a look at some of them.</p>
<div id="creating-matrices" class="section level3 hasAnchor" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Creating matrices<a href="advancedchapter.html#creating-matrices" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To create a <code>matrix</code> object, we can use the <code>matrix</code> function. It always coerces all elements to be of the same type (Section <a href="messychapter.html#coercion">5.1</a>):</p>
<div class="sourceCode" id="cb1075"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1075-1"><a href="advancedchapter.html#cb1075-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 3x2 matrix, one column at a time:</span></span>
<span id="cb1075-2"><a href="advancedchapter.html#cb1075-2" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">4</span>), <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb1075-3"><a href="advancedchapter.html#cb1075-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1075-4"><a href="advancedchapter.html#cb1075-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 3x2 matrix, one row at a time:</span></span>
<span id="cb1075-5"><a href="advancedchapter.html#cb1075-5" aria-hidden="true" tabindex="-1"></a><span class="co"># (No real need to include line breaks in the vector with</span></span>
<span id="cb1075-6"><a href="advancedchapter.html#cb1075-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the values, but I like to do so to see what the matrix</span></span>
<span id="cb1075-7"><a href="advancedchapter.html#cb1075-7" aria-hidden="true" tabindex="-1"></a><span class="co"># will look like!)</span></span>
<span id="cb1075-8"><a href="advancedchapter.html#cb1075-8" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb1075-9"><a href="advancedchapter.html#cb1075-9" aria-hidden="true" tabindex="-1"></a>         <span class="dv">3</span>, <span class="dv">1</span>,</span>
<span id="cb1075-10"><a href="advancedchapter.html#cb1075-10" aria-hidden="true" tabindex="-1"></a>        <span class="sc">-</span><span class="dv">2</span>, <span class="dv">4</span>), <span class="dv">3</span>, <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Matrix operations require the dimension of the matrices involved to match. To check the dimension of a <code>matrix</code>, we can use <code>dim</code>:</p>
<div class="sourceCode" id="cb1076"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1076-1"><a href="advancedchapter.html#cb1076-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">4</span>), <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb1076-2"><a href="advancedchapter.html#cb1076-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(A)</span></code></pre></div>
<p>To create a unit matrix (all 1’s) or a zero matrix (all 0’s), we use <code>matrix</code> with a single value in the first argument:</p>
<div class="sourceCode" id="cb1077"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1077-1"><a href="advancedchapter.html#cb1077-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 3x3 unit matrix:</span></span>
<span id="cb1077-2"><a href="advancedchapter.html#cb1077-2" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb1077-3"><a href="advancedchapter.html#cb1077-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1077-4"><a href="advancedchapter.html#cb1077-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 2x3 zero matrix:</span></span>
<span id="cb1077-5"><a href="advancedchapter.html#cb1077-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
<p>The <code>diag</code> function has three uses. First, it can be used to create a diagonal matrix (if we supply a vector as input). Second, it can be used to create an identity matrix (if we supply a single number as input). Third, it can be used to extract the diagonal from a square matrix (if we supply a matrix as input). Let’s give it a go:</p>
<div class="sourceCode" id="cb1078"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1078-1"><a href="advancedchapter.html#cb1078-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a diagonal matrix with 2, 4, 6 along the diagonal:</span></span>
<span id="cb1078-2"><a href="advancedchapter.html#cb1078-2" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>))</span>
<span id="cb1078-3"><a href="advancedchapter.html#cb1078-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1078-4"><a href="advancedchapter.html#cb1078-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 9x9 identity matrix:</span></span>
<span id="cb1078-5"><a href="advancedchapter.html#cb1078-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(<span class="dv">9</span>)</span>
<span id="cb1078-6"><a href="advancedchapter.html#cb1078-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1078-7"><a href="advancedchapter.html#cb1078-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a square matrix and then extract its diagonal:</span></span>
<span id="cb1078-8"><a href="advancedchapter.html#cb1078-8" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb1078-9"><a href="advancedchapter.html#cb1078-9" aria-hidden="true" tabindex="-1"></a>A</span>
<span id="cb1078-10"><a href="advancedchapter.html#cb1078-10" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(A)</span></code></pre></div>
<p>Similarly, we can use <code>lower.tri</code> and <code>upper.tri</code> to extract a matrix of <code>logical</code> values, describing the location of the lower and upper triangular part of a matrix:</p>
<div class="sourceCode" id="cb1079"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1079-1"><a href="advancedchapter.html#cb1079-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a matrix_</span></span>
<span id="cb1079-2"><a href="advancedchapter.html#cb1079-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb1079-3"><a href="advancedchapter.html#cb1079-3" aria-hidden="true" tabindex="-1"></a>A</span>
<span id="cb1079-4"><a href="advancedchapter.html#cb1079-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1079-5"><a href="advancedchapter.html#cb1079-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Which are the elements in the lower triangular part?</span></span>
<span id="cb1079-6"><a href="advancedchapter.html#cb1079-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lower.tri</span>(A)</span>
<span id="cb1079-7"><a href="advancedchapter.html#cb1079-7" aria-hidden="true" tabindex="-1"></a>A[<span class="fu">lower.tri</span>(A)]</span>
<span id="cb1079-8"><a href="advancedchapter.html#cb1079-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1079-9"><a href="advancedchapter.html#cb1079-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the lower triangular part to 0:</span></span>
<span id="cb1079-10"><a href="advancedchapter.html#cb1079-10" aria-hidden="true" tabindex="-1"></a>A[<span class="fu">lower.tri</span>(A)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1079-11"><a href="advancedchapter.html#cb1079-11" aria-hidden="true" tabindex="-1"></a>A</span></code></pre></div>
<p>To transpose a matrix, use <code>t</code>:</p>
<div class="sourceCode" id="cb1080"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1080-1"><a href="advancedchapter.html#cb1080-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(A)</span></code></pre></div>
<p>Matrices can be combined using <code>cbind</code> and <code>rbind</code>:</p>
<div class="sourceCode" id="cb1081"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1081-1"><a href="advancedchapter.html#cb1081-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)  <span class="co"># 3x3</span></span>
<span id="cb1081-2"><a href="advancedchapter.html#cb1081-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">4</span>), <span class="dv">3</span>, <span class="dv">2</span>)               <span class="co"># 3x2</span></span>
<span id="cb1081-3"><a href="advancedchapter.html#cb1081-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1081-4"><a href="advancedchapter.html#cb1081-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add B to the right of A:</span></span>
<span id="cb1081-5"><a href="advancedchapter.html#cb1081-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(A, B)</span>
<span id="cb1081-6"><a href="advancedchapter.html#cb1081-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1081-7"><a href="advancedchapter.html#cb1081-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the transpose of B below A:</span></span>
<span id="cb1081-8"><a href="advancedchapter.html#cb1081-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(A, <span class="fu">t</span>(B))</span>
<span id="cb1081-9"><a href="advancedchapter.html#cb1081-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1081-10"><a href="advancedchapter.html#cb1081-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding B below A doesn&#39;t work, because the dimensions</span></span>
<span id="cb1081-11"><a href="advancedchapter.html#cb1081-11" aria-hidden="true" tabindex="-1"></a><span class="co"># don&#39;t match:</span></span>
<span id="cb1081-12"><a href="advancedchapter.html#cb1081-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(A, B)</span></code></pre></div>
</div>
<div id="sparse-matrices" class="section level3 hasAnchor" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> Sparse matrices<a href="advancedchapter.html#sparse-matrices" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>Matrix</code> package contains functions for creating and speeding up computations with sparse matrices (i.e. matrices with lots of 0’s), as well as for creating matrices with particular structures. You likely already have it installed, as many other packages rely on it. <code>Matrix</code> distinguishes between sparse and dense matrices:</p>
<div class="sourceCode" id="cb1082"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1082-1"><a href="advancedchapter.html#cb1082-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load or/and install Matrix:</span></span>
<span id="cb1082-2"><a href="advancedchapter.html#cb1082-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;Matrix&quot;</span>)) { <span class="fu">install.packages</span>(<span class="st">&quot;Matrix&quot;</span>); <span class="fu">library</span>(Matrix) }</span>
<span id="cb1082-3"><a href="advancedchapter.html#cb1082-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1082-4"><a href="advancedchapter.html#cb1082-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dense 8x8 matrix using the Matrix package:</span></span>
<span id="cb1082-5"><a href="advancedchapter.html#cb1082-5" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">Matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">64</span>, <span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb1082-6"><a href="advancedchapter.html#cb1082-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1082-7"><a href="advancedchapter.html#cb1082-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a copy and randomly replace 40 elements by 0:</span></span>
<span id="cb1082-8"><a href="advancedchapter.html#cb1082-8" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> A</span>
<span id="cb1082-9"><a href="advancedchapter.html#cb1082-9" aria-hidden="true" tabindex="-1"></a>B[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">64</span>, <span class="dv">40</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1082-10"><a href="advancedchapter.html#cb1082-10" aria-hidden="true" tabindex="-1"></a>B</span>
<span id="cb1082-11"><a href="advancedchapter.html#cb1082-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1082-12"><a href="advancedchapter.html#cb1082-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Store B as a sparse matrix instead:</span></span>
<span id="cb1082-13"><a href="advancedchapter.html#cb1082-13" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">as</span>(B, <span class="st">&quot;sparseMatrix&quot;</span>)</span>
<span id="cb1082-14"><a href="advancedchapter.html#cb1082-14" aria-hidden="true" tabindex="-1"></a>B</span></code></pre></div>
<p>To visualise the structure of a sparse matrix, we can use <code>image</code>:</p>
<div class="sourceCode" id="cb1083"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1083-1"><a href="advancedchapter.html#cb1083-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(B)</span></code></pre></div>
<p>An example of a slightly larger, <span class="math inline">\(72\times 72\)</span> sparse matrix is given by <code>CAex</code>:</p>
<div class="sourceCode" id="cb1084"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1084-1"><a href="advancedchapter.html#cb1084-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(CAex)</span>
<span id="cb1084-2"><a href="advancedchapter.html#cb1084-2" aria-hidden="true" tabindex="-1"></a>CAex</span>
<span id="cb1084-3"><a href="advancedchapter.html#cb1084-3" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(CAex)</span></code></pre></div>
<p><code>Matrix</code> contains additional classes for e.g. symmetric sparse matrices and triangular matrices. See <code>vignette("Introduction", "Matrix")</code> for further details.</p>
</div>
<div id="matrix-operations" class="section level3 hasAnchor" number="10.3.3">
<h3><span class="header-section-number">10.3.3</span> Matrix operations<a href="advancedchapter.html#matrix-operations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section, we’ll use the following matrices and vectors to show how to perform various matrix operations:</p>
<div class="sourceCode" id="cb1085"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1085-1"><a href="advancedchapter.html#cb1085-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrices:</span></span>
<span id="cb1085-2"><a href="advancedchapter.html#cb1085-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)  <span class="co"># 3x3</span></span>
<span id="cb1085-3"><a href="advancedchapter.html#cb1085-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">4</span>), <span class="dv">3</span>, <span class="dv">2</span>)               <span class="co"># 3x2</span></span>
<span id="cb1085-4"><a href="advancedchapter.html#cb1085-4" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">2</span>)             <span class="co"># Symmetric 2x2</span></span>
<span id="cb1085-5"><a href="advancedchapter.html#cb1085-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1085-6"><a href="advancedchapter.html#cb1085-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Vectors:</span></span>
<span id="cb1085-7"><a href="advancedchapter.html#cb1085-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>                   <span class="co"># Length 9</span></span>
<span id="cb1085-8"><a href="advancedchapter.html#cb1085-8" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">4</span>) <span class="co"># Length 6</span></span>
<span id="cb1085-9"><a href="advancedchapter.html#cb1085-9" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">1</span>                   <span class="co"># Length 9</span></span>
<span id="cb1085-10"><a href="advancedchapter.html#cb1085-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>                   <span class="co"># Length 3</span></span></code></pre></div>
<p>To perform element-wise addition and subtraction with matrices, use <code>+</code> and <code>-</code>:</p>
<div class="sourceCode" id="cb1086"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1086-1"><a href="advancedchapter.html#cb1086-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">+</span> A</span>
<span id="cb1086-2"><a href="advancedchapter.html#cb1086-2" aria-hidden="true" tabindex="-1"></a>A <span class="sc">-</span> <span class="fu">t</span>(A)</span></code></pre></div>
<p>To perform element-wise multiplication, use <code>*</code>:</p>
<div class="sourceCode" id="cb1087"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1087-1"><a href="advancedchapter.html#cb1087-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> A  <span class="co"># Multiply all elements by 2</span></span>
<span id="cb1087-2"><a href="advancedchapter.html#cb1087-2" aria-hidden="true" tabindex="-1"></a>A <span class="sc">*</span> A  <span class="co"># Square all elements</span></span></code></pre></div>
<p>To perform matrix multiplication, use <code>%*%</code>. Remember that matrix multiplication is non-commutative, and so the order of the matrices is important:</p>
<div class="sourceCode" id="cb1088"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1088-1"><a href="advancedchapter.html#cb1088-1" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%*%</span> B  <span class="co"># A is 3x3, B is 3x2</span></span>
<span id="cb1088-2"><a href="advancedchapter.html#cb1088-2" aria-hidden="true" tabindex="-1"></a>B <span class="sc">%*%</span> C  <span class="co"># B is 3x2, C is 2x2</span></span>
<span id="cb1088-3"><a href="advancedchapter.html#cb1088-3" aria-hidden="true" tabindex="-1"></a>B <span class="sc">%*%</span> A  <span class="co"># Won&#39;t work, because B is 3x2 and A 3x3!</span></span></code></pre></div>
<p>Given the vectors <code>a</code>, <code>b</code>, and <code>d</code> defined above, we can compute the outer product <span class="math inline">\(a\otimes b\)</span> using <code>%o%</code> and the dot product <span class="math inline">\(a\cdot d\)</span> by using <code>%*%</code> and <code>t</code> in the right manner:</p>
<div class="sourceCode" id="cb1089"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1089-1"><a href="advancedchapter.html#cb1089-1" aria-hidden="true" tabindex="-1"></a>a <span class="sc">%o%</span> b  <span class="co"># Outer product</span></span>
<span id="cb1089-2"><a href="advancedchapter.html#cb1089-2" aria-hidden="true" tabindex="-1"></a>a <span class="sc">%*%</span> <span class="fu">t</span>(b) <span class="co"># Alternative way of getting the outer product</span></span>
<span id="cb1089-3"><a href="advancedchapter.html#cb1089-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(a) <span class="sc">%*%</span> d <span class="co"># Dot product</span></span></code></pre></div>
<p>To find the inverse of a square matrix, we can use <code>solve</code>. To find the generalised Moore-Penrose inverse of any matrix, we can use <code>ginv</code> from <code>MASS</code>:</p>
<div class="sourceCode" id="cb1090"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1090-1"><a href="advancedchapter.html#cb1090-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(A)</span>
<span id="cb1090-2"><a href="advancedchapter.html#cb1090-2" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(B)  <span class="co"># Doesn&#39;t work because B isn&#39;t square</span></span>
<span id="cb1090-3"><a href="advancedchapter.html#cb1090-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1090-4"><a href="advancedchapter.html#cb1090-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1090-5"><a href="advancedchapter.html#cb1090-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ginv</span>(A)  <span class="co"># Same as solve(A), because A is non-singular and square</span></span>
<span id="cb1090-6"><a href="advancedchapter.html#cb1090-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ginv</span>(B)</span></code></pre></div>
<p><code>solve</code> can also be used to solve equations systems. To solve the equation <span class="math inline">\(Ax = y\)</span>:</p>
<div class="sourceCode" id="cb1091"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1091-1"><a href="advancedchapter.html#cb1091-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(A, y)</span></code></pre></div>
<p>The eigenvalues and eigenvectors of a square matrix can be found using <code>eigen</code>:</p>
<div class="sourceCode" id="cb1092"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1092-1"><a href="advancedchapter.html#cb1092-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(A)</span>
<span id="cb1092-2"><a href="advancedchapter.html#cb1092-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(A)<span class="sc">$</span>values   <span class="co"># Eigenvalues only</span></span>
<span id="cb1092-3"><a href="advancedchapter.html#cb1092-3" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(A)<span class="sc">$</span>vectors  <span class="co"># Eigenvectors only</span></span></code></pre></div>
<p>The singular value decomposition, QR decomposition, and the Choleski factorisation of a matrix are computed as follows:</p>
<div class="sourceCode" id="cb1093"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1093-1"><a href="advancedchapter.html#cb1093-1" aria-hidden="true" tabindex="-1"></a><span class="fu">svd</span>(A)</span>
<span id="cb1093-2"><a href="advancedchapter.html#cb1093-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qr</span>(A)</span>
<span id="cb1093-3"><a href="advancedchapter.html#cb1093-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chol</span>(C)</span></code></pre></div>
<p><code>qr</code> also provides the rank of the matrix:</p>
<div class="sourceCode" id="cb1094"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1094-1"><a href="advancedchapter.html#cb1094-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qr</span>(A)<span class="sc">$</span>rank</span>
<span id="cb1094-2"><a href="advancedchapter.html#cb1094-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qr</span>(B)<span class="sc">$</span>rank</span></code></pre></div>
<p>Finally, you can get the determinant<a href="#fn65" class="footnote-ref" id="fnref65"><sup>65</sup></a> of a matrix using <code>det</code>:</p>
<div class="sourceCode" id="cb1095"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1095-1"><a href="advancedchapter.html#cb1095-1" aria-hidden="true" tabindex="-1"></a><span class="fu">det</span>(A)</span></code></pre></div>
<p>As a P.S., I’ll also mention the <code>matlab</code> package, which contains functions for running computations using MATLAB-like function calls. This is useful if you want to reuse MATLAB code in R without translating it row-by-row. Incidentally, this also brings us nicely into the next section.</p>
</div>
</div>
<div id="integration" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Integration with other programming languages<a href="advancedchapter.html#integration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R is great for a lot of things, but it is obviously not the best choice for every task. There are a number of packages that can be used to harvest the power of other languages, or to integrate your R code with code that you or others have developed in other programming languages. In this section, we’ll mention a few of them.</p>
<div id="integration-with-c" class="section level3 hasAnchor" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Integration with C++<a href="advancedchapter.html#integration-with-c" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>C++ is commonly used to speed up functions, for instance involving loops that can’t be vectorised or parallelised due to dependencies between different iterations. The <code>Rcpp</code> package (Eddelbuettel &amp; Balamuta, 2018) allows you to easily call C++ functions from R, as well as calling R functions from C++. See <code>vignette("Rcpp-introduction", "Rcpp")</code> for details.</p>
<p>An important difference between R and C++ that you should be aware of is that the indexing of vectors (and similar objects) in C++ starts with 0. So the first element of the vector is element 0, the second is element 1, and so forth. Bear this in mind if you pass a vector and a list of indices to C++ functions.</p>
</div>
<div id="integration-with-python" class="section level3 hasAnchor" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Integration with Python<a href="advancedchapter.html#integration-with-python" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>reticulate</code> package can be used to call Python functions from R. See <code>vignette("calling_python", "reticulate")</code> for some examples.</p>
<p>Some care has to be taken when sending data back and forth between R and Python. In R <code>NA</code> is used to represent missing data and <code>NaN</code> (not a number) is used to represent things that should be numbers but aren’t (e.g. the result of computing <code>0/0</code>). Perfectly reasonable! However, for reasons unknown to humanity, popular Python packages like Pandas, NumPy and SciKit-Learn use <code>NaN</code> instead of <code>NA</code> to represent missing data - but only for <code>double</code> (<code>numeric</code>) variables. <code>integer</code> and <code>logical</code> variables have no way to represent missing data in Pandas. Tread gently if there are <code>NA</code> or <code>NaN</code> values in your data.</p>
<p>Like in C++, the indexing of vectors (and similar objects) in Python starts with 0.</p>
</div>
<div id="integration-with-tensorflow-and-pytorch" class="section level3 hasAnchor" number="10.4.3">
<h3><span class="header-section-number">10.4.3</span> Integration with Tensorflow and PyTorch<a href="advancedchapter.html#integration-with-tensorflow-and-pytorch" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Tensorflow, Keras and PyTorch are popular frameworks for deep learning. To use Tensorflow or Keras with R, you can use the <code>keras</code> package. See <code>vignette("index", "keras")</code> for an introduction and Chollet &amp; Allaire (2018) for a thorough treatise. Similarly, to use PyTorch with R, use the <code>torch</code> package. In both cases, it can take some tampering to get the frameworks to run on a GPU.</p>
</div>
<div id="integration-with-spark" class="section level3 hasAnchor" number="10.4.4">
<h3><span class="header-section-number">10.4.4</span> Integration with Spark<a href="advancedchapter.html#integration-with-spark" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you need to process large datasets using Spark, you can do so from R using the <code>sparklyr</code> package. It can be used both with local and cloud clusters, and (as the name seems to imply) is easy to integrate with <code>dplyr</code>.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="62">
<li id="fn62"><p>And why else would you load it…?<a href="advancedchapter.html#fnref62" class="footnote-back">↩︎</a></p></li>
<li id="fn63"><p>Why though?!<a href="advancedchapter.html#fnref63" class="footnote-back">↩︎</a></p></li>
<li id="fn64"><p>If your CPU has 3 or fewer cores, you should lower this number.<a href="advancedchapter.html#fnref64" class="footnote-back">↩︎</a></p></li>
<li id="fn65"><p>Do you <em>really</em> need it, though?<a href="advancedchapter.html#fnref65" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mlchapter.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="errorchapter.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
