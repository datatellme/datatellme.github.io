<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Transforming, summarising, and analysing data | Modern Statistics with R</title>
  <meta name="description" content="3 Transforming, summarising, and analysing data | Modern Statistics with R" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Transforming, summarising, and analysing data | Modern Statistics with R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Transforming, summarising, and analysing data | Modern Statistics with R" />
  
  
  

<meta name="author" content="Mans Thulin" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="thebasics.html"/>
<link rel="next" href="eda.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="preamble.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modern Statistics with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="Introduction.html"><a href="Introduction.html"><i class="fa fa-check"></i><b>1</b> 들어가며</a>
<ul>
<li class="chapter" data-level="1.1" data-path="Introduction.html"><a href="Introduction.html#whatR"><i class="fa fa-check"></i><b>1.1</b> R이란?</a></li>
<li class="chapter" data-level="1.2" data-path="Introduction.html"><a href="Introduction.html#Rinstallation"><i class="fa fa-check"></i><b>1.2</b> R 설치하기</a></li>
<li class="chapter" data-level="1.3" data-path="Introduction.html"><a href="Introduction.html#RStudioinstallation"><i class="fa fa-check"></i><b>1.3</b> RStudio 설치하기</a></li>
<li class="chapter" data-level="1.4" data-path="Introduction.html"><a href="Introduction.html#LaTeXinstallation"><i class="fa fa-check"></i><b>1.4</b> 레이텍 설치하기</a></li>
<li class="chapter" data-level="1.5" data-path="Introduction.html"><a href="Introduction.html#packageinstallation"><i class="fa fa-check"></i><b>1.5</b> Packages 설치하기</a></li>
<li class="chapter" data-level="1.6" data-path="Introduction.html"><a href="Introduction.html#aboutbook"><i class="fa fa-check"></i><b>1.6</b> 이 책에 대하여</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="thebasics.html"><a href="thebasics.html"><i class="fa fa-check"></i><b>2</b> The basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="thebasics.html"><a href="thebasics.html#a-first-look-at-rstudio"><i class="fa fa-check"></i><b>2.1</b> A first look at RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="thebasics.html"><a href="thebasics.html#runningcode"><i class="fa fa-check"></i><b>2.2</b> Running R code</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="thebasics.html"><a href="thebasics.html#r-scripts"><i class="fa fa-check"></i><b>2.2.1</b> R scripts</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="thebasics.html"><a href="thebasics.html#varsandfuncs"><i class="fa fa-check"></i><b>2.3</b> Variables and functions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="thebasics.html"><a href="thebasics.html#storing-data"><i class="fa fa-check"></i><b>2.3.1</b> Storing data</a></li>
<li class="chapter" data-level="2.3.2" data-path="thebasics.html"><a href="thebasics.html#whats-in-a-name"><i class="fa fa-check"></i><b>2.3.2</b> What’s in a name?</a></li>
<li class="chapter" data-level="2.3.3" data-path="thebasics.html"><a href="thebasics.html#vectors-and-data-frames"><i class="fa fa-check"></i><b>2.3.3</b> Vectors and data frames</a></li>
<li class="chapter" data-level="2.3.4" data-path="thebasics.html"><a href="thebasics.html#functions"><i class="fa fa-check"></i><b>2.3.4</b> Functions</a></li>
<li class="chapter" data-level="2.3.5" data-path="thebasics.html"><a href="thebasics.html#maths"><i class="fa fa-check"></i><b>2.3.5</b> Mathematical operations</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="thebasics.html"><a href="thebasics.html#descstats"><i class="fa fa-check"></i><b>2.4</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="thebasics.html"><a href="thebasics.html#numerical-data"><i class="fa fa-check"></i><b>2.4.1</b> Numerical data</a></li>
<li class="chapter" data-level="2.4.2" data-path="thebasics.html"><a href="thebasics.html#catdata1"><i class="fa fa-check"></i><b>2.4.2</b> Categorical data</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="thebasics.html"><a href="thebasics.html#plotting-numerical-data"><i class="fa fa-check"></i><b>2.5</b> Plotting numerical data</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="thebasics.html"><a href="thebasics.html#our-first-plot"><i class="fa fa-check"></i><b>2.5.1</b> Our first plot</a></li>
<li class="chapter" data-level="2.5.2" data-path="thebasics.html"><a href="thebasics.html#colours-shapes-and-axis-labels"><i class="fa fa-check"></i><b>2.5.2</b> Colours, shapes and axis labels</a></li>
<li class="chapter" data-level="2.5.3" data-path="thebasics.html"><a href="thebasics.html#axis-limits-and-scales"><i class="fa fa-check"></i><b>2.5.3</b> Axis limits and scales</a></li>
<li class="chapter" data-level="2.5.4" data-path="thebasics.html"><a href="thebasics.html#comparinggroups"><i class="fa fa-check"></i><b>2.5.4</b> Comparing groups</a></li>
<li class="chapter" data-level="2.5.5" data-path="thebasics.html"><a href="thebasics.html#boxplots"><i class="fa fa-check"></i><b>2.5.5</b> Boxplots</a></li>
<li class="chapter" data-level="2.5.6" data-path="thebasics.html"><a href="thebasics.html#histograms"><i class="fa fa-check"></i><b>2.5.6</b> Histograms</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="thebasics.html"><a href="thebasics.html#catdata2"><i class="fa fa-check"></i><b>2.6</b> Plotting categorical data</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="thebasics.html"><a href="thebasics.html#bar-charts"><i class="fa fa-check"></i><b>2.6.1</b> Bar charts</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="thebasics.html"><a href="thebasics.html#saving-your-plot"><i class="fa fa-check"></i><b>2.7</b> Saving your plot</a></li>
<li class="chapter" data-level="2.8" data-path="thebasics.html"><a href="thebasics.html#troubleshooting"><i class="fa fa-check"></i><b>2.8</b> Troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datachapter.html"><a href="datachapter.html"><i class="fa fa-check"></i><b>3</b> Transforming, summarising, and analysing data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="datachapter.html"><a href="datachapter.html#data-frames-and-data-types"><i class="fa fa-check"></i><b>3.1</b> Data frames and data types</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="datachapter.html"><a href="datachapter.html#types-and-structures"><i class="fa fa-check"></i><b>3.1.1</b> Types and structures</a></li>
<li class="chapter" data-level="3.1.2" data-path="datachapter.html"><a href="datachapter.html#typesoftables"><i class="fa fa-check"></i><b>3.1.2</b> Types of tables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datachapter.html"><a href="datachapter.html#findingpoints"><i class="fa fa-check"></i><b>3.2</b> Vectors in data frames</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="datachapter.html"><a href="datachapter.html#accessingelements"><i class="fa fa-check"></i><b>3.2.1</b> Accessing vectors and elements</a></li>
<li class="chapter" data-level="3.2.2" data-path="datachapter.html"><a href="datachapter.html#use-your-dollars"><i class="fa fa-check"></i><b>3.2.2</b> Use your dollars</a></li>
<li class="chapter" data-level="3.2.3" data-path="datachapter.html"><a href="datachapter.html#conditionsintro"><i class="fa fa-check"></i><b>3.2.3</b> Using conditions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="datachapter.html"><a href="datachapter.html#paths"><i class="fa fa-check"></i><b>3.3</b> Importing data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="datachapter.html"><a href="datachapter.html#importing-csv-files"><i class="fa fa-check"></i><b>3.3.1</b> Importing csv files</a></li>
<li class="chapter" data-level="3.3.2" data-path="datachapter.html"><a href="datachapter.html#file-paths"><i class="fa fa-check"></i><b>3.3.2</b> File paths</a></li>
<li class="chapter" data-level="3.3.3" data-path="datachapter.html"><a href="datachapter.html#importing-excel-files"><i class="fa fa-check"></i><b>3.3.3</b> Importing Excel files</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="datachapter.html"><a href="datachapter.html#saving-and-exporting-your-data"><i class="fa fa-check"></i><b>3.4</b> Saving and exporting your data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="datachapter.html"><a href="datachapter.html#exporting-data"><i class="fa fa-check"></i><b>3.4.1</b> Exporting data</a></li>
<li class="chapter" data-level="3.4.2" data-path="datachapter.html"><a href="datachapter.html#saving-and-loading-r-data"><i class="fa fa-check"></i><b>3.4.2</b> Saving and loading R data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="datachapter.html"><a href="datachapter.html#rstudio-projects"><i class="fa fa-check"></i><b>3.5</b> RStudio projects</a></li>
<li class="chapter" data-level="3.6" data-path="datachapter.html"><a href="datachapter.html#firstttest"><i class="fa fa-check"></i><b>3.6</b> Running a t-test</a></li>
<li class="chapter" data-level="3.7" data-path="datachapter.html"><a href="datachapter.html#firstlm"><i class="fa fa-check"></i><b>3.7</b> Fitting a linear regression model</a></li>
<li class="chapter" data-level="3.8" data-path="datachapter.html"><a href="datachapter.html#grouped"><i class="fa fa-check"></i><b>3.8</b> Grouped summaries</a></li>
<li class="chapter" data-level="3.9" data-path="datachapter.html"><a href="datachapter.html#pipes"><i class="fa fa-check"></i><b>3.9</b> Using <code>%&gt;%</code> pipes</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="datachapter.html"><a href="datachapter.html#ceci-nest-pas-une-pipe"><i class="fa fa-check"></i><b>3.9.1</b> <em>Ceci n’est pas une pipe</em></a></li>
<li class="chapter" data-level="3.9.2" data-path="datachapter.html"><a href="datachapter.html#aliases-and-placeholders"><i class="fa fa-check"></i><b>3.9.2</b> Aliases and placeholders</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="datachapter.html"><a href="datachapter.html#flavours-of-r-base-and-tidyverse"><i class="fa fa-check"></i><b>3.10</b> Flavours of R: base and tidyverse</a></li>
<li class="chapter" data-level="3.11" data-path="datachapter.html"><a href="datachapter.html#ethicalguidelines"><i class="fa fa-check"></i><b>3.11</b> Ethics and good statistical practice</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>4</b> Exploratory data analysis and unsupervised learning</a>
<ul>
<li class="chapter" data-level="4.1" data-path="eda.html"><a href="eda.html#rmarkdown"><i class="fa fa-check"></i><b>4.1</b> Reports with R Markdown</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="eda.html"><a href="eda.html#a-first-example"><i class="fa fa-check"></i><b>4.1.1</b> A first example</a></li>
<li class="chapter" data-level="4.1.2" data-path="eda.html"><a href="eda.html#formatting-text"><i class="fa fa-check"></i><b>4.1.2</b> Formatting text</a></li>
<li class="chapter" data-level="4.1.3" data-path="eda.html"><a href="eda.html#lists-tables-and-images"><i class="fa fa-check"></i><b>4.1.3</b> Lists, tables, and images</a></li>
<li class="chapter" data-level="4.1.4" data-path="eda.html"><a href="eda.html#code-chunks"><i class="fa fa-check"></i><b>4.1.4</b> Code chunks</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="eda.html"><a href="eda.html#themes"><i class="fa fa-check"></i><b>4.2</b> Customising <code>ggplot2</code> plots</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="eda.html"><a href="eda.html#using-themes"><i class="fa fa-check"></i><b>4.2.1</b> Using themes</a></li>
<li class="chapter" data-level="4.2.2" data-path="eda.html"><a href="eda.html#colourpalettes"><i class="fa fa-check"></i><b>4.2.2</b> Colour palettes</a></li>
<li class="chapter" data-level="4.2.3" data-path="eda.html"><a href="eda.html#theme-settings"><i class="fa fa-check"></i><b>4.2.3</b> Theme settings</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="eda.html"><a href="eda.html#exploring-distributions"><i class="fa fa-check"></i><b>4.3</b> Exploring distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="eda.html"><a href="eda.html#density-plots-and-frequency-polygons"><i class="fa fa-check"></i><b>4.3.1</b> Density plots and frequency polygons</a></li>
<li class="chapter" data-level="4.3.2" data-path="eda.html"><a href="eda.html#asking-questions"><i class="fa fa-check"></i><b>4.3.2</b> Asking questions</a></li>
<li class="chapter" data-level="4.3.3" data-path="eda.html"><a href="eda.html#violin-plots"><i class="fa fa-check"></i><b>4.3.3</b> Violin plots</a></li>
<li class="chapter" data-level="4.3.4" data-path="eda.html"><a href="eda.html#patchwork"><i class="fa fa-check"></i><b>4.3.4</b> Combine multiple plots into a single graphic</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="eda.html"><a href="eda.html#outliers-and-missing-data"><i class="fa fa-check"></i><b>4.4</b> Outliers and missing data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="eda.html"><a href="eda.html#detecting-outliers"><i class="fa fa-check"></i><b>4.4.1</b> Detecting outliers</a></li>
<li class="chapter" data-level="4.4.2" data-path="eda.html"><a href="eda.html#labelling-outliers"><i class="fa fa-check"></i><b>4.4.2</b> Labelling outliers</a></li>
<li class="chapter" data-level="4.4.3" data-path="eda.html"><a href="eda.html#missing-data"><i class="fa fa-check"></i><b>4.4.3</b> Missing data</a></li>
<li class="chapter" data-level="4.4.4" data-path="eda.html"><a href="eda.html#exploring-data"><i class="fa fa-check"></i><b>4.4.4</b> Exploring data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="eda.html"><a href="eda.html#trends-in-scatterplots"><i class="fa fa-check"></i><b>4.5</b> Trends in scatterplots</a></li>
<li class="chapter" data-level="4.6" data-path="eda.html"><a href="eda.html#tsplots"><i class="fa fa-check"></i><b>4.6</b> Exploring time series</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="eda.html"><a href="eda.html#annotations-and-reference-lines"><i class="fa fa-check"></i><b>4.6.1</b> Annotations and reference lines</a></li>
<li class="chapter" data-level="4.6.2" data-path="eda.html"><a href="eda.html#longitudinal-data"><i class="fa fa-check"></i><b>4.6.2</b> Longitudinal data</a></li>
<li class="chapter" data-level="4.6.3" data-path="eda.html"><a href="eda.html#path-plots"><i class="fa fa-check"></i><b>4.6.3</b> Path plots</a></li>
<li class="chapter" data-level="4.6.4" data-path="eda.html"><a href="eda.html#spaghetti-plots"><i class="fa fa-check"></i><b>4.6.4</b> Spaghetti plots</a></li>
<li class="chapter" data-level="4.6.5" data-path="eda.html"><a href="eda.html#stlsec"><i class="fa fa-check"></i><b>4.6.5</b> Seasonal plots and decompositions</a></li>
<li class="chapter" data-level="4.6.6" data-path="eda.html"><a href="eda.html#detecting-changepoints"><i class="fa fa-check"></i><b>4.6.6</b> Detecting changepoints</a></li>
<li class="chapter" data-level="4.6.7" data-path="eda.html"><a href="eda.html#interactivets"><i class="fa fa-check"></i><b>4.6.7</b> Interactive time series plots</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="eda.html"><a href="eda.html#polar"><i class="fa fa-check"></i><b>4.7</b> Using polar coordinates</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="eda.html"><a href="eda.html#visualising-periodic-data"><i class="fa fa-check"></i><b>4.7.1</b> Visualising periodic data</a></li>
<li class="chapter" data-level="4.7.2" data-path="eda.html"><a href="eda.html#pie-charts"><i class="fa fa-check"></i><b>4.7.2</b> Pie charts</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="eda.html"><a href="eda.html#visualising-multiple-variables"><i class="fa fa-check"></i><b>4.8</b> Visualising multiple variables</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="eda.html"><a href="eda.html#scatterplotmatrix"><i class="fa fa-check"></i><b>4.8.1</b> Scatterplot matrices</a></li>
<li class="chapter" data-level="4.8.2" data-path="eda.html"><a href="eda.html#d-scatterplots"><i class="fa fa-check"></i><b>4.8.2</b> 3D scatterplots</a></li>
<li class="chapter" data-level="4.8.3" data-path="eda.html"><a href="eda.html#correlograms"><i class="fa fa-check"></i><b>4.8.3</b> Correlograms</a></li>
<li class="chapter" data-level="4.8.4" data-path="eda.html"><a href="eda.html#adding-more-variables-to-scatterplots"><i class="fa fa-check"></i><b>4.8.4</b> Adding more variables to scatterplots</a></li>
<li class="chapter" data-level="4.8.5" data-path="eda.html"><a href="eda.html#overplotting"><i class="fa fa-check"></i><b>4.8.5</b> Overplotting</a></li>
<li class="chapter" data-level="4.8.6" data-path="eda.html"><a href="eda.html#categorical-data"><i class="fa fa-check"></i><b>4.8.6</b> Categorical data</a></li>
<li class="chapter" data-level="4.8.7" data-path="eda.html"><a href="eda.html#putting-it-all-together"><i class="fa fa-check"></i><b>4.8.7</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="eda.html"><a href="eda.html#pca"><i class="fa fa-check"></i><b>4.9</b> Principal component analysis</a></li>
<li class="chapter" data-level="4.10" data-path="eda.html"><a href="eda.html#clustering"><i class="fa fa-check"></i><b>4.10</b> Cluster analysis</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="eda.html"><a href="eda.html#hierarchical-clustering"><i class="fa fa-check"></i><b>4.10.1</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="4.10.2" data-path="eda.html"><a href="eda.html#heatmaps-and-clustering-variables"><i class="fa fa-check"></i><b>4.10.2</b> Heatmaps and clustering variables</a></li>
<li class="chapter" data-level="4.10.3" data-path="eda.html"><a href="eda.html#centroid"><i class="fa fa-check"></i><b>4.10.3</b> Centroid-based clustering</a></li>
<li class="chapter" data-level="4.10.4" data-path="eda.html"><a href="eda.html#fuzzy-clustering"><i class="fa fa-check"></i><b>4.10.4</b> Fuzzy clustering</a></li>
<li class="chapter" data-level="4.10.5" data-path="eda.html"><a href="eda.html#modelbasedclustering"><i class="fa fa-check"></i><b>4.10.5</b> Model-based clustering</a></li>
<li class="chapter" data-level="4.10.6" data-path="eda.html"><a href="eda.html#comparing-clusters"><i class="fa fa-check"></i><b>4.10.6</b> Comparing clusters</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="eda.html"><a href="eda.html#exploratory-factor-analysis"><i class="fa fa-check"></i><b>4.11</b> Exploratory factor analysis</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="eda.html"><a href="eda.html#factor-analysis"><i class="fa fa-check"></i><b>4.11.1</b> Factor analysis</a></li>
<li class="chapter" data-level="4.11.2" data-path="eda.html"><a href="eda.html#lca"><i class="fa fa-check"></i><b>4.11.2</b> Latent class analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="messychapter.html"><a href="messychapter.html"><i class="fa fa-check"></i><b>5</b> Dealing with messy data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="messychapter.html"><a href="messychapter.html#coercion"><i class="fa fa-check"></i><b>5.1</b> Changing data types</a></li>
<li class="chapter" data-level="5.2" data-path="messychapter.html"><a href="messychapter.html#lists2"><i class="fa fa-check"></i><b>5.2</b> Working with lists</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="messychapter.html"><a href="messychapter.html#splitvector"><i class="fa fa-check"></i><b>5.2.1</b> Splitting vectors into lists</a></li>
<li class="chapter" data-level="5.2.2" data-path="messychapter.html"><a href="messychapter.html#collapsing-lists-into-vectors"><i class="fa fa-check"></i><b>5.2.2</b> Collapsing lists into vectors</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="messychapter.html"><a href="messychapter.html#working-with-numbers"><i class="fa fa-check"></i><b>5.3</b> Working with numbers</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="messychapter.html"><a href="messychapter.html#rounding-numbers"><i class="fa fa-check"></i><b>5.3.1</b> Rounding numbers</a></li>
<li class="chapter" data-level="5.3.2" data-path="messychapter.html"><a href="messychapter.html#sums-and-means-in-data-frames"><i class="fa fa-check"></i><b>5.3.2</b> Sums and means in data frames</a></li>
<li class="chapter" data-level="5.3.3" data-path="messychapter.html"><a href="messychapter.html#rle"><i class="fa fa-check"></i><b>5.3.3</b> Summaries of series of numbers</a></li>
<li class="chapter" data-level="5.3.4" data-path="messychapter.html"><a href="messychapter.html#scientific-notation-1e-03"><i class="fa fa-check"></i><b>5.3.4</b> Scientific notation <code>1e-03</code></a></li>
<li class="chapter" data-level="5.3.5" data-path="messychapter.html"><a href="messychapter.html#floatingpoints"><i class="fa fa-check"></i><b>5.3.5</b> Floating point arithmetics</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="messychapter.html"><a href="messychapter.html#factors"><i class="fa fa-check"></i><b>5.4</b> Working with factors</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="messychapter.html"><a href="messychapter.html#creating-factors"><i class="fa fa-check"></i><b>5.4.1</b> Creating factors</a></li>
<li class="chapter" data-level="5.4.2" data-path="messychapter.html"><a href="messychapter.html#factorlevels"><i class="fa fa-check"></i><b>5.4.2</b> Changing factor levels</a></li>
<li class="chapter" data-level="5.4.3" data-path="messychapter.html"><a href="messychapter.html#changing-the-order-of-levels"><i class="fa fa-check"></i><b>5.4.3</b> Changing the order of levels</a></li>
<li class="chapter" data-level="5.4.4" data-path="messychapter.html"><a href="messychapter.html#combining-levels"><i class="fa fa-check"></i><b>5.4.4</b> Combining levels</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="messychapter.html"><a href="messychapter.html#strings"><i class="fa fa-check"></i><b>5.5</b> Working with strings</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="messychapter.html"><a href="messychapter.html#concatenating-strings"><i class="fa fa-check"></i><b>5.5.1</b> Concatenating strings</a></li>
<li class="chapter" data-level="5.5.2" data-path="messychapter.html"><a href="messychapter.html#changing-case"><i class="fa fa-check"></i><b>5.5.2</b> Changing case</a></li>
<li class="chapter" data-level="5.5.3" data-path="messychapter.html"><a href="messychapter.html#regexp"><i class="fa fa-check"></i><b>5.5.3</b> Finding patterns using regular expressions</a></li>
<li class="chapter" data-level="5.5.4" data-path="messychapter.html"><a href="messychapter.html#sub"><i class="fa fa-check"></i><b>5.5.4</b> Substitution</a></li>
<li class="chapter" data-level="5.5.5" data-path="messychapter.html"><a href="messychapter.html#splitting-strings"><i class="fa fa-check"></i><b>5.5.5</b> Splitting strings</a></li>
<li class="chapter" data-level="5.5.6" data-path="messychapter.html"><a href="messychapter.html#variable-names"><i class="fa fa-check"></i><b>5.5.6</b> Variable names</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="messychapter.html"><a href="messychapter.html#datetime"><i class="fa fa-check"></i><b>5.6</b> Working with dates and times</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="messychapter.html"><a href="messychapter.html#date-formats"><i class="fa fa-check"></i><b>5.6.1</b> Date formats</a></li>
<li class="chapter" data-level="5.6.2" data-path="messychapter.html"><a href="messychapter.html#plotting-with-dates"><i class="fa fa-check"></i><b>5.6.2</b> Plotting with dates</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="messychapter.html"><a href="messychapter.html#data-manipulation-with-data.table-dplyr-and-tidyr"><i class="fa fa-check"></i><b>5.7</b> Data manipulation with <code>data.table</code>, <code>dplyr</code>, and <code>tidyr</code></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="messychapter.html"><a href="messychapter.html#dtbasics"><i class="fa fa-check"></i><b>5.7.1</b> <code>data.table</code> and tidyverse syntax basics</a></li>
<li class="chapter" data-level="5.7.2" data-path="messychapter.html"><a href="messychapter.html#modifyvar"><i class="fa fa-check"></i><b>5.7.2</b> Modifying a variable</a></li>
<li class="chapter" data-level="5.7.3" data-path="messychapter.html"><a href="messychapter.html#computing-a-new-variable-based-on-existing-variables"><i class="fa fa-check"></i><b>5.7.3</b> Computing a new variable based on existing variables</a></li>
<li class="chapter" data-level="5.7.4" data-path="messychapter.html"><a href="messychapter.html#renaming-a-variable"><i class="fa fa-check"></i><b>5.7.4</b> Renaming a variable</a></li>
<li class="chapter" data-level="5.7.5" data-path="messychapter.html"><a href="messychapter.html#removing-a-variable"><i class="fa fa-check"></i><b>5.7.5</b> Removing a variable</a></li>
<li class="chapter" data-level="5.7.6" data-path="messychapter.html"><a href="messychapter.html#recodedplyr"><i class="fa fa-check"></i><b>5.7.6</b> Recoding <code>factor</code> levels</a></li>
<li class="chapter" data-level="5.7.7" data-path="messychapter.html"><a href="messychapter.html#grouped2"><i class="fa fa-check"></i><b>5.7.7</b> Grouped summaries</a></li>
<li class="chapter" data-level="5.7.8" data-path="messychapter.html"><a href="messychapter.html#fillNA"><i class="fa fa-check"></i><b>5.7.8</b> Filling in missing values</a></li>
<li class="chapter" data-level="5.7.9" data-path="messychapter.html"><a href="messychapter.html#chaining-commands-together"><i class="fa fa-check"></i><b>5.7.9</b> Chaining commands together</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="messychapter.html"><a href="messychapter.html#filtering"><i class="fa fa-check"></i><b>5.8</b> Filtering: select rows</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="messychapter.html"><a href="messychapter.html#filtering-using-row-numbers"><i class="fa fa-check"></i><b>5.8.1</b> Filtering using row numbers</a></li>
<li class="chapter" data-level="5.8.2" data-path="messychapter.html"><a href="messychapter.html#conditions2"><i class="fa fa-check"></i><b>5.8.2</b> Filtering using conditions</a></li>
<li class="chapter" data-level="5.8.3" data-path="messychapter.html"><a href="messychapter.html#selecting-rows-at-random"><i class="fa fa-check"></i><b>5.8.3</b> Selecting rows at random</a></li>
<li class="chapter" data-level="5.8.4" data-path="messychapter.html"><a href="messychapter.html#using-regular-expressions-to-select-rows"><i class="fa fa-check"></i><b>5.8.4</b> Using regular expressions to select rows</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="messychapter.html"><a href="messychapter.html#subsetting-select-columns"><i class="fa fa-check"></i><b>5.9</b> Subsetting: select columns</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="messychapter.html"><a href="messychapter.html#selecting-a-single-column"><i class="fa fa-check"></i><b>5.9.1</b> Selecting a single column</a></li>
<li class="chapter" data-level="5.9.2" data-path="messychapter.html"><a href="messychapter.html#selecting-multiple-columns"><i class="fa fa-check"></i><b>5.9.2</b> Selecting multiple columns</a></li>
<li class="chapter" data-level="5.9.3" data-path="messychapter.html"><a href="messychapter.html#using-regular-expressions-to-select-columns"><i class="fa fa-check"></i><b>5.9.3</b> Using regular expressions to select columns</a></li>
<li class="chapter" data-level="5.9.4" data-path="messychapter.html"><a href="messychapter.html#subsetusingcn"><i class="fa fa-check"></i><b>5.9.4</b> Subsetting using column numbers</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="messychapter.html"><a href="messychapter.html#sorting"><i class="fa fa-check"></i><b>5.10</b> Sorting</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="messychapter.html"><a href="messychapter.html#changing-the-column-order"><i class="fa fa-check"></i><b>5.10.1</b> Changing the column order</a></li>
<li class="chapter" data-level="5.10.2" data-path="messychapter.html"><a href="messychapter.html#changing-the-row-order"><i class="fa fa-check"></i><b>5.10.2</b> Changing the row order</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="messychapter.html"><a href="messychapter.html#reshaping"><i class="fa fa-check"></i><b>5.11</b> Reshaping data</a>
<ul>
<li class="chapter" data-level="5.11.1" data-path="messychapter.html"><a href="messychapter.html#from-long-to-wide"><i class="fa fa-check"></i><b>5.11.1</b> From long to wide</a></li>
<li class="chapter" data-level="5.11.2" data-path="messychapter.html"><a href="messychapter.html#from-wide-to-long"><i class="fa fa-check"></i><b>5.11.2</b> From wide to long</a></li>
<li class="chapter" data-level="5.11.3" data-path="messychapter.html"><a href="messychapter.html#splittingcolumns"><i class="fa fa-check"></i><b>5.11.3</b> Splitting columns</a></li>
<li class="chapter" data-level="5.11.4" data-path="messychapter.html"><a href="messychapter.html#merging-columns"><i class="fa fa-check"></i><b>5.11.4</b> Merging columns</a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="messychapter.html"><a href="messychapter.html#mergedata"><i class="fa fa-check"></i><b>5.12</b> Merging data from multiple tables</a>
<ul>
<li class="chapter" data-level="5.12.1" data-path="messychapter.html"><a href="messychapter.html#binds"><i class="fa fa-check"></i><b>5.12.1</b> Binds</a></li>
<li class="chapter" data-level="5.12.2" data-path="messychapter.html"><a href="messychapter.html#merging-tables-using-keys"><i class="fa fa-check"></i><b>5.12.2</b> Merging tables using keys</a></li>
<li class="chapter" data-level="5.12.3" data-path="messychapter.html"><a href="messychapter.html#inner-and-outer-joins"><i class="fa fa-check"></i><b>5.12.3</b> Inner and outer joins</a></li>
<li class="chapter" data-level="5.12.4" data-path="messychapter.html"><a href="messychapter.html#semijoins"><i class="fa fa-check"></i><b>5.12.4</b> Semijoins and antijoins</a></li>
</ul></li>
<li class="chapter" data-level="5.13" data-path="messychapter.html"><a href="messychapter.html#scraping-data-from-websites"><i class="fa fa-check"></i><b>5.13</b> Scraping data from websites</a></li>
<li class="chapter" data-level="5.14" data-path="messychapter.html"><a href="messychapter.html#commontasks"><i class="fa fa-check"></i><b>5.14</b> Other commons tasks</a>
<ul>
<li class="chapter" data-level="5.14.1" data-path="messychapter.html"><a href="messychapter.html#deleting-variables"><i class="fa fa-check"></i><b>5.14.1</b> Deleting variables</a></li>
<li class="chapter" data-level="5.14.2" data-path="messychapter.html"><a href="messychapter.html#foreign"><i class="fa fa-check"></i><b>5.14.2</b> Importing data from other statistical packages</a></li>
<li class="chapter" data-level="5.14.3" data-path="messychapter.html"><a href="messychapter.html#importing-data-from-databases"><i class="fa fa-check"></i><b>5.14.3</b> Importing data from databases</a></li>
<li class="chapter" data-level="5.14.4" data-path="messychapter.html"><a href="messychapter.html#importing-data-from-json-files"><i class="fa fa-check"></i><b>5.14.4</b> Importing data from JSON files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="progchapter.html"><a href="progchapter.html"><i class="fa fa-check"></i><b>6</b> R programming</a>
<ul>
<li class="chapter" data-level="6.1" data-path="progchapter.html"><a href="progchapter.html#functions-1"><i class="fa fa-check"></i><b>6.1</b> Functions</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="progchapter.html"><a href="progchapter.html#createfunctions"><i class="fa fa-check"></i><b>6.1.1</b> Creating functions</a></li>
<li class="chapter" data-level="6.1.2" data-path="progchapter.html"><a href="progchapter.html#local-and-global-variables"><i class="fa fa-check"></i><b>6.1.2</b> Local and global variables</a></li>
<li class="chapter" data-level="6.1.3" data-path="progchapter.html"><a href="progchapter.html#willfunctionwork"><i class="fa fa-check"></i><b>6.1.3</b> Will your function work?</a></li>
<li class="chapter" data-level="6.1.4" data-path="progchapter.html"><a href="progchapter.html#more-on-arguments"><i class="fa fa-check"></i><b>6.1.4</b> More on arguments</a></li>
<li class="chapter" data-level="6.1.5" data-path="progchapter.html"><a href="progchapter.html#namespaces"><i class="fa fa-check"></i><b>6.1.5</b> Namespaces</a></li>
<li class="chapter" data-level="6.1.6" data-path="progchapter.html"><a href="progchapter.html#sourcing-other-scripts"><i class="fa fa-check"></i><b>6.1.6</b> Sourcing other scripts</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="progchapter.html"><a href="progchapter.html#morepipes"><i class="fa fa-check"></i><b>6.2</b> More on pipes</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="progchapter.html"><a href="progchapter.html#ce-ne-sont-pas-non-plus-des-pipes"><i class="fa fa-check"></i><b>6.2.1</b> <em>Ce ne sont pas non plus des pipes</em></a></li>
<li class="chapter" data-level="6.2.2" data-path="progchapter.html"><a href="progchapter.html#writing-functions-with-pipes"><i class="fa fa-check"></i><b>6.2.2</b> Writing functions with pipes</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="progchapter.html"><a href="progchapter.html#conditions"><i class="fa fa-check"></i><b>6.3</b> Checking conditions</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="progchapter.html"><a href="progchapter.html#if-and-else"><i class="fa fa-check"></i><b>6.3.1</b> <code>if</code> and <code>else</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="progchapter.html"><a href="progchapter.html#section"><i class="fa fa-check"></i><b>6.3.2</b> <code>&amp;</code> &amp; <code>&amp;&amp;</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="progchapter.html"><a href="progchapter.html#ifelse"><i class="fa fa-check"></i><b>6.3.3</b> <code>ifelse</code></a></li>
<li class="chapter" data-level="6.3.4" data-path="progchapter.html"><a href="progchapter.html#switch"><i class="fa fa-check"></i><b>6.3.4</b> <code>switch</code></a></li>
<li class="chapter" data-level="6.3.5" data-path="progchapter.html"><a href="progchapter.html#failing-gracefully"><i class="fa fa-check"></i><b>6.3.5</b> Failing gracefully</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="progchapter.html"><a href="progchapter.html#loopsection"><i class="fa fa-check"></i><b>6.4</b> Iteration using loops</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="progchapter.html"><a href="progchapter.html#forloops"><i class="fa fa-check"></i><b>6.4.1</b> <code>for</code> loops</a></li>
<li class="chapter" data-level="6.4.2" data-path="progchapter.html"><a href="progchapter.html#nestedloops"><i class="fa fa-check"></i><b>6.4.2</b> Loops within loops</a></li>
<li class="chapter" data-level="6.4.3" data-path="progchapter.html"><a href="progchapter.html#beepr"><i class="fa fa-check"></i><b>6.4.3</b> Keeping track of what’s happening</a></li>
<li class="chapter" data-level="6.4.4" data-path="progchapter.html"><a href="progchapter.html#lists"><i class="fa fa-check"></i><b>6.4.4</b> Loops and lists</a></li>
<li class="chapter" data-level="6.4.5" data-path="progchapter.html"><a href="progchapter.html#whileloop"><i class="fa fa-check"></i><b>6.4.5</b> <code>while</code> loops</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="progchapter.html"><a href="progchapter.html#vectorloops"><i class="fa fa-check"></i><b>6.5</b> Iteration using vectorisation and functionals</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="progchapter.html"><a href="progchapter.html#a-first-example-with-apply"><i class="fa fa-check"></i><b>6.5.1</b> A first example with <code>apply</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="progchapter.html"><a href="progchapter.html#variations-on-a-theme"><i class="fa fa-check"></i><b>6.5.2</b> Variations on a theme</a></li>
<li class="chapter" data-level="6.5.3" data-path="progchapter.html"><a href="progchapter.html#purrr"><i class="fa fa-check"></i><b>6.5.3</b> <code>purrr</code></a></li>
<li class="chapter" data-level="6.5.4" data-path="progchapter.html"><a href="progchapter.html#specialised-functions"><i class="fa fa-check"></i><b>6.5.4</b> Specialised functions</a></li>
<li class="chapter" data-level="6.5.5" data-path="progchapter.html"><a href="progchapter.html#exploring-data-with-functionals"><i class="fa fa-check"></i><b>6.5.5</b> Exploring data with functionals</a></li>
<li class="chapter" data-level="6.5.6" data-path="progchapter.html"><a href="progchapter.html#keep-calm-and-carry-on"><i class="fa fa-check"></i><b>6.5.6</b> Keep calm and carry on</a></li>
<li class="chapter" data-level="6.5.7" data-path="progchapter.html"><a href="progchapter.html#multiiter"><i class="fa fa-check"></i><b>6.5.7</b> Iterating over multiple variables</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="progchapter.html"><a href="progchapter.html#measureperformance"><i class="fa fa-check"></i><b>6.6</b> Measuring code performance</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="progchapter.html"><a href="progchapter.html#timing-functions"><i class="fa fa-check"></i><b>6.6.1</b> Timing functions</a></li>
<li class="chapter" data-level="6.6.2" data-path="progchapter.html"><a href="progchapter.html#measuring-memory-usage---and-a-note-on-compilation"><i class="fa fa-check"></i><b>6.6.2</b> Measuring memory usage - and a note on compilation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modchapter.html"><a href="modchapter.html"><i class="fa fa-check"></i><b>7</b> Modern classical statistics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modchapter.html"><a href="modchapter.html#simulation"><i class="fa fa-check"></i><b>7.1</b> Simulation and distributions</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="modchapter.html"><a href="modchapter.html#generating-random-numbers"><i class="fa fa-check"></i><b>7.1.1</b> Generating random numbers</a></li>
<li class="chapter" data-level="7.1.2" data-path="modchapter.html"><a href="modchapter.html#distfunctions"><i class="fa fa-check"></i><b>7.1.2</b> Some common distributions</a></li>
<li class="chapter" data-level="7.1.3" data-path="modchapter.html"><a href="modchapter.html#assessing-distributional-assumptions"><i class="fa fa-check"></i><b>7.1.3</b> Assessing distributional assumptions</a></li>
<li class="chapter" data-level="7.1.4" data-path="modchapter.html"><a href="modchapter.html#monte-carlo-integration"><i class="fa fa-check"></i><b>7.1.4</b> Monte Carlo integration</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="modchapter.html"><a href="modchapter.html#ttest"><i class="fa fa-check"></i><b>7.2</b> Student’s t-test revisited</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="modchapter.html"><a href="modchapter.html#oldschoolt"><i class="fa fa-check"></i><b>7.2.1</b> The old-school t-test</a></li>
<li class="chapter" data-level="7.2.2" data-path="modchapter.html"><a href="modchapter.html#permutation-tests"><i class="fa fa-check"></i><b>7.2.2</b> Permutation tests</a></li>
<li class="chapter" data-level="7.2.3" data-path="modchapter.html"><a href="modchapter.html#the-bootstrap"><i class="fa fa-check"></i><b>7.2.3</b> The bootstrap</a></li>
<li class="chapter" data-level="7.2.4" data-path="modchapter.html"><a href="modchapter.html#saving-the-output"><i class="fa fa-check"></i><b>7.2.4</b> Saving the output</a></li>
<li class="chapter" data-level="7.2.5" data-path="modchapter.html"><a href="modchapter.html#multipletesting"><i class="fa fa-check"></i><b>7.2.5</b> Multiple testing</a></li>
<li class="chapter" data-level="7.2.6" data-path="modchapter.html"><a href="modchapter.html#hotellingst2"><i class="fa fa-check"></i><b>7.2.6</b> Multivariate testing with Hotelling’s <span class="math inline">\(T^2\)</span></a></li>
<li class="chapter" data-level="7.2.7" data-path="modchapter.html"><a href="modchapter.html#sample-size-computations-for-the-t-test"><i class="fa fa-check"></i><b>7.2.7</b> Sample size computations for the t-test</a></li>
<li class="chapter" data-level="7.2.8" data-path="modchapter.html"><a href="modchapter.html#a-bayesian-approach"><i class="fa fa-check"></i><b>7.2.8</b> A Bayesian approach</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="modchapter.html"><a href="modchapter.html#other-common-hypothesis-tests-and-confidence-intervals"><i class="fa fa-check"></i><b>7.3</b> Other common hypothesis tests and confidence intervals</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="modchapter.html"><a href="modchapter.html#nonparametric-tests-of-location"><i class="fa fa-check"></i><b>7.3.1</b> Nonparametric tests of location</a></li>
<li class="chapter" data-level="7.3.2" data-path="modchapter.html"><a href="modchapter.html#tests-for-correlation"><i class="fa fa-check"></i><b>7.3.2</b> Tests for correlation</a></li>
<li class="chapter" data-level="7.3.3" data-path="modchapter.html"><a href="modchapter.html#chi2-tests"><i class="fa fa-check"></i><b>7.3.3</b> <span class="math inline">\(\chi^2\)</span>-tests</a></li>
<li class="chapter" data-level="7.3.4" data-path="modchapter.html"><a href="modchapter.html#confprop"><i class="fa fa-check"></i><b>7.3.4</b> Confidence intervals for proportions</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="modchapter.html"><a href="modchapter.html#ethicsinference"><i class="fa fa-check"></i><b>7.4</b> Ethical issues in statistical inference</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="modchapter.html"><a href="modchapter.html#p-hacking-and-the-file-drawer-problem"><i class="fa fa-check"></i><b>7.4.1</b> p-hacking and the file-drawer problem</a></li>
<li class="chapter" data-level="7.4.2" data-path="modchapter.html"><a href="modchapter.html#reproducibility"><i class="fa fa-check"></i><b>7.4.2</b> Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="modchapter.html"><a href="modchapter.html#simeval"><i class="fa fa-check"></i><b>7.5</b> Evaluating statistical methods using simulation</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="modchapter.html"><a href="modchapter.html#comparing-estimators"><i class="fa fa-check"></i><b>7.5.1</b> Comparing estimators</a></li>
<li class="chapter" data-level="7.5.2" data-path="modchapter.html"><a href="modchapter.html#simtypeI"><i class="fa fa-check"></i><b>7.5.2</b> Type I error rate of hypothesis tests</a></li>
<li class="chapter" data-level="7.5.3" data-path="modchapter.html"><a href="modchapter.html#simpower"><i class="fa fa-check"></i><b>7.5.3</b> Power of hypothesis tests</a></li>
<li class="chapter" data-level="7.5.4" data-path="modchapter.html"><a href="modchapter.html#powerlocation"><i class="fa fa-check"></i><b>7.5.4</b> Power of some tests of location</a></li>
<li class="chapter" data-level="7.5.5" data-path="modchapter.html"><a href="modchapter.html#simadvice"><i class="fa fa-check"></i><b>7.5.5</b> Some advice on simulation studies</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="modchapter.html"><a href="modchapter.html#sscus"><i class="fa fa-check"></i><b>7.6</b> Sample size computations using simulation</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="modchapter.html"><a href="modchapter.html#simcorpower"><i class="fa fa-check"></i><b>7.6.1</b> Writing your own simulation</a></li>
<li class="chapter" data-level="7.6.2" data-path="modchapter.html"><a href="modchapter.html#the-wilcoxon-mann-whitney-test"><i class="fa fa-check"></i><b>7.6.2</b> The Wilcoxon-Mann-Whitney test</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="modchapter.html"><a href="modchapter.html#bootstrap"><i class="fa fa-check"></i><b>7.7</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="modchapter.html"><a href="modchapter.html#a-general-approach"><i class="fa fa-check"></i><b>7.7.1</b> A general approach</a></li>
<li class="chapter" data-level="7.7.2" data-path="modchapter.html"><a href="modchapter.html#bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>7.7.2</b> Bootstrap confidence intervals</a></li>
<li class="chapter" data-level="7.7.3" data-path="modchapter.html"><a href="modchapter.html#intervalinversion"><i class="fa fa-check"></i><b>7.7.3</b> Bootstrap hypothesis tests</a></li>
<li class="chapter" data-level="7.7.4" data-path="modchapter.html"><a href="modchapter.html#parametricbootstrap"><i class="fa fa-check"></i><b>7.7.4</b> The parametric bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="modchapter.html"><a href="modchapter.html#reporting-statistical-results"><i class="fa fa-check"></i><b>7.8</b> Reporting statistical results</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="modchapter.html"><a href="modchapter.html#what-should-you-include"><i class="fa fa-check"></i><b>7.8.1</b> What should you include?</a></li>
<li class="chapter" data-level="7.8.2" data-path="modchapter.html"><a href="modchapter.html#citing-r-packages"><i class="fa fa-check"></i><b>7.8.2</b> Citing R packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>8</b> Regression models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="regression.html"><a href="regression.html#linearmodels"><i class="fa fa-check"></i><b>8.1</b> Linear models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="regression.html"><a href="regression.html#fitting-linear-models"><i class="fa fa-check"></i><b>8.1.1</b> Fitting linear models</a></li>
<li class="chapter" data-level="8.1.2" data-path="regression.html"><a href="regression.html#interactions-and-polynomial-terms"><i class="fa fa-check"></i><b>8.1.2</b> Interactions and polynomial terms</a></li>
<li class="chapter" data-level="8.1.3" data-path="regression.html"><a href="regression.html#dummy-variables"><i class="fa fa-check"></i><b>8.1.3</b> Dummy variables</a></li>
<li class="chapter" data-level="8.1.4" data-path="regression.html"><a href="regression.html#model-diagnostics"><i class="fa fa-check"></i><b>8.1.4</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.1.5" data-path="regression.html"><a href="regression.html#transformations"><i class="fa fa-check"></i><b>8.1.5</b> Transformations</a></li>
<li class="chapter" data-level="8.1.6" data-path="regression.html"><a href="regression.html#alternatives-to-lm"><i class="fa fa-check"></i><b>8.1.6</b> Alternatives to <code>lm</code></a></li>
<li class="chapter" data-level="8.1.7" data-path="regression.html"><a href="regression.html#regbootstrap"><i class="fa fa-check"></i><b>8.1.7</b> Bootstrap confidence intervals for regression coefficients</a></li>
<li class="chapter" data-level="8.1.8" data-path="regression.html"><a href="regression.html#broom"><i class="fa fa-check"></i><b>8.1.8</b> Alternative summaries with <code>broom</code></a></li>
<li class="chapter" data-level="8.1.9" data-path="regression.html"><a href="regression.html#stepwise"><i class="fa fa-check"></i><b>8.1.9</b> Variable selection</a></li>
<li class="chapter" data-level="8.1.10" data-path="regression.html"><a href="regression.html#prediction"><i class="fa fa-check"></i><b>8.1.10</b> Prediction</a></li>
<li class="chapter" data-level="8.1.11" data-path="regression.html"><a href="regression.html#multipredict"><i class="fa fa-check"></i><b>8.1.11</b> Prediction for multiple datasets</a></li>
<li class="chapter" data-level="8.1.12" data-path="regression.html"><a href="regression.html#ANOVA"><i class="fa fa-check"></i><b>8.1.12</b> ANOVA</a></li>
<li class="chapter" data-level="8.1.13" data-path="regression.html"><a href="regression.html#bayeslm"><i class="fa fa-check"></i><b>8.1.13</b> Bayesian estimation of linear models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="regression.html"><a href="regression.html#ethical-issues-in-regression-modelling"><i class="fa fa-check"></i><b>8.2</b> Ethical issues in regression modelling</a></li>
<li class="chapter" data-level="8.3" data-path="regression.html"><a href="regression.html#generalised-linear-models"><i class="fa fa-check"></i><b>8.3</b> Generalised linear models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="regression.html"><a href="regression.html#logreg"><i class="fa fa-check"></i><b>8.3.1</b> Modelling proportions: Logistic regression</a></li>
<li class="chapter" data-level="8.3.2" data-path="regression.html"><a href="regression.html#bootstrap-confidence-intervals-1"><i class="fa fa-check"></i><b>8.3.2</b> Bootstrap confidence intervals</a></li>
<li class="chapter" data-level="8.3.3" data-path="regression.html"><a href="regression.html#model-diagnostics-1"><i class="fa fa-check"></i><b>8.3.3</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.3.4" data-path="regression.html"><a href="regression.html#prediction-1"><i class="fa fa-check"></i><b>8.3.4</b> Prediction</a></li>
<li class="chapter" data-level="8.3.5" data-path="regression.html"><a href="regression.html#modelling-count-data"><i class="fa fa-check"></i><b>8.3.5</b> Modelling count data</a></li>
<li class="chapter" data-level="8.3.6" data-path="regression.html"><a href="regression.html#modelling-rates"><i class="fa fa-check"></i><b>8.3.6</b> Modelling rates</a></li>
<li class="chapter" data-level="8.3.7" data-path="regression.html"><a href="regression.html#bayesian-estimation-of-generalised-linear-models"><i class="fa fa-check"></i><b>8.3.7</b> Bayesian estimation of generalised linear models</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="regression.html"><a href="regression.html#mixedmodels"><i class="fa fa-check"></i><b>8.4</b> Mixed models</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="regression.html"><a href="regression.html#fitting-a-linear-mixed-model"><i class="fa fa-check"></i><b>8.4.1</b> Fitting a linear mixed model</a></li>
<li class="chapter" data-level="8.4.2" data-path="regression.html"><a href="regression.html#model-diagnostics-2"><i class="fa fa-check"></i><b>8.4.2</b> Model diagnostics</a></li>
<li class="chapter" data-level="8.4.3" data-path="regression.html"><a href="regression.html#lmmbootstrap"><i class="fa fa-check"></i><b>8.4.3</b> Bootstrapping</a></li>
<li class="chapter" data-level="8.4.4" data-path="regression.html"><a href="regression.html#nested-random-effects-and-multilevelhierarchical-models"><i class="fa fa-check"></i><b>8.4.4</b> Nested random effects and multilevel/hierarchical models</a></li>
<li class="chapter" data-level="8.4.5" data-path="regression.html"><a href="regression.html#anova-with-random-effects"><i class="fa fa-check"></i><b>8.4.5</b> ANOVA with random effects</a></li>
<li class="chapter" data-level="8.4.6" data-path="regression.html"><a href="regression.html#generalised-linear-mixed-models"><i class="fa fa-check"></i><b>8.4.6</b> Generalised linear mixed models</a></li>
<li class="chapter" data-level="8.4.7" data-path="regression.html"><a href="regression.html#bayesian-estimation-of-mixed-models"><i class="fa fa-check"></i><b>8.4.7</b> Bayesian estimation of mixed models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="regression.html"><a href="regression.html#survival"><i class="fa fa-check"></i><b>8.5</b> Survival analysis</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="regression.html"><a href="regression.html#comparing-groups"><i class="fa fa-check"></i><b>8.5.1</b> Comparing groups</a></li>
<li class="chapter" data-level="8.5.2" data-path="regression.html"><a href="regression.html#the-cox-proportional-hazards-model"><i class="fa fa-check"></i><b>8.5.2</b> The Cox proportional hazards model</a></li>
<li class="chapter" data-level="8.5.3" data-path="regression.html"><a href="regression.html#accelerated-failure-time-models"><i class="fa fa-check"></i><b>8.5.3</b> Accelerated failure time models</a></li>
<li class="chapter" data-level="8.5.4" data-path="regression.html"><a href="regression.html#bayesian-survival-analysis"><i class="fa fa-check"></i><b>8.5.4</b> Bayesian survival analysis</a></li>
<li class="chapter" data-level="8.5.5" data-path="regression.html"><a href="regression.html#multivariate-survival-analysis"><i class="fa fa-check"></i><b>8.5.5</b> Multivariate survival analysis</a></li>
<li class="chapter" data-level="8.5.6" data-path="regression.html"><a href="regression.html#power-estimates-for-the-logrank-test"><i class="fa fa-check"></i><b>8.5.6</b> Power estimates for the logrank test</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="regression.html"><a href="regression.html#left-censored-data-and-nondetects"><i class="fa fa-check"></i><b>8.6</b> Left-censored data and nondetects</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="regression.html"><a href="regression.html#estimation"><i class="fa fa-check"></i><b>8.6.1</b> Estimation</a></li>
<li class="chapter" data-level="8.6.2" data-path="regression.html"><a href="regression.html#tests-of-means"><i class="fa fa-check"></i><b>8.6.2</b> Tests of means</a></li>
<li class="chapter" data-level="8.6.3" data-path="regression.html"><a href="regression.html#censored-regression"><i class="fa fa-check"></i><b>8.6.3</b> Censored regression</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="regression.html"><a href="regression.html#creating-matched-samples"><i class="fa fa-check"></i><b>8.7</b> Creating matched samples</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="regression.html"><a href="regression.html#propensity-score-matching"><i class="fa fa-check"></i><b>8.7.1</b> Propensity score matching</a></li>
<li class="chapter" data-level="8.7.2" data-path="regression.html"><a href="regression.html#stepwise-matching"><i class="fa fa-check"></i><b>8.7.2</b> Stepwise matching</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mlchapter.html"><a href="mlchapter.html"><i class="fa fa-check"></i><b>9</b> Predictive modelling and machine learning</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mlchapter.html"><a href="mlchapter.html#evaluating-predictive-models"><i class="fa fa-check"></i><b>9.1</b> Evaluating predictive models</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="mlchapter.html"><a href="mlchapter.html#evaluating-regression-models"><i class="fa fa-check"></i><b>9.1.1</b> Evaluating regression models</a></li>
<li class="chapter" data-level="9.1.2" data-path="mlchapter.html"><a href="mlchapter.html#test-training-splits"><i class="fa fa-check"></i><b>9.1.2</b> Test-training splits</a></li>
<li class="chapter" data-level="9.1.3" data-path="mlchapter.html"><a href="mlchapter.html#loocv"><i class="fa fa-check"></i><b>9.1.3</b> Leave-one-out cross-validation and <code>caret</code></a></li>
<li class="chapter" data-level="9.1.4" data-path="mlchapter.html"><a href="mlchapter.html#kfoldcv"><i class="fa fa-check"></i><b>9.1.4</b> k-fold cross-validation</a></li>
<li class="chapter" data-level="9.1.5" data-path="mlchapter.html"><a href="mlchapter.html#twinned-observations"><i class="fa fa-check"></i><b>9.1.5</b> Twinned observations</a></li>
<li class="chapter" data-level="9.1.6" data-path="mlchapter.html"><a href="mlchapter.html#bootstrapping"><i class="fa fa-check"></i><b>9.1.6</b> Bootstrapping</a></li>
<li class="chapter" data-level="9.1.7" data-path="mlchapter.html"><a href="mlchapter.html#classifieraccuracy"><i class="fa fa-check"></i><b>9.1.7</b> Evaluating classification models</a></li>
<li class="chapter" data-level="9.1.8" data-path="mlchapter.html"><a href="mlchapter.html#decisionboundaries"><i class="fa fa-check"></i><b>9.1.8</b> Visualising decision boundaries</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="mlchapter.html"><a href="mlchapter.html#ethical-issues-in-predictive-modelling"><i class="fa fa-check"></i><b>9.2</b> Ethical issues in predictive modelling</a></li>
<li class="chapter" data-level="9.3" data-path="mlchapter.html"><a href="mlchapter.html#modellingchallenges"><i class="fa fa-check"></i><b>9.3</b> Challenges in predictive modelling</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mlchapter.html"><a href="mlchapter.html#imbalanced"><i class="fa fa-check"></i><b>9.3.1</b> Handling class imbalance</a></li>
<li class="chapter" data-level="9.3.2" data-path="mlchapter.html"><a href="mlchapter.html#varimportance"><i class="fa fa-check"></i><b>9.3.2</b> Assessing variable importance</a></li>
<li class="chapter" data-level="9.3.3" data-path="mlchapter.html"><a href="mlchapter.html#extrapolation"><i class="fa fa-check"></i><b>9.3.3</b> Extrapolation</a></li>
<li class="chapter" data-level="9.3.4" data-path="mlchapter.html"><a href="mlchapter.html#missing-data-and-imputation"><i class="fa fa-check"></i><b>9.3.4</b> Missing data and imputation</a></li>
<li class="chapter" data-level="9.3.5" data-path="mlchapter.html"><a href="mlchapter.html#endless-waiting"><i class="fa fa-check"></i><b>9.3.5</b> Endless waiting</a></li>
<li class="chapter" data-level="9.3.6" data-path="mlchapter.html"><a href="mlchapter.html#overfittingtestset"><i class="fa fa-check"></i><b>9.3.6</b> Overfitting to the test set</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mlchapter.html"><a href="mlchapter.html#regularised"><i class="fa fa-check"></i><b>9.4</b> Regularised regression models</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="mlchapter.html"><a href="mlchapter.html#ridge-regression"><i class="fa fa-check"></i><b>9.4.1</b> Ridge regression</a></li>
<li class="chapter" data-level="9.4.2" data-path="mlchapter.html"><a href="mlchapter.html#lasso"><i class="fa fa-check"></i><b>9.4.2</b> The lasso</a></li>
<li class="chapter" data-level="9.4.3" data-path="mlchapter.html"><a href="mlchapter.html#elastic-net"><i class="fa fa-check"></i><b>9.4.3</b> Elastic net</a></li>
<li class="chapter" data-level="9.4.4" data-path="mlchapter.html"><a href="mlchapter.html#choosing-the-best-model"><i class="fa fa-check"></i><b>9.4.4</b> Choosing the best model</a></li>
<li class="chapter" data-level="9.4.5" data-path="mlchapter.html"><a href="mlchapter.html#regularised-mixed-models"><i class="fa fa-check"></i><b>9.4.5</b> Regularised mixed models</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="mlchapter.html"><a href="mlchapter.html#mlmethods"><i class="fa fa-check"></i><b>9.5</b> Machine learning models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="mlchapter.html"><a href="mlchapter.html#decisiontrees"><i class="fa fa-check"></i><b>9.5.1</b> Decision trees</a></li>
<li class="chapter" data-level="9.5.2" data-path="mlchapter.html"><a href="mlchapter.html#randomforests"><i class="fa fa-check"></i><b>9.5.2</b> Random forests</a></li>
<li class="chapter" data-level="9.5.3" data-path="mlchapter.html"><a href="mlchapter.html#boosted-trees"><i class="fa fa-check"></i><b>9.5.3</b> Boosted trees</a></li>
<li class="chapter" data-level="9.5.4" data-path="mlchapter.html"><a href="mlchapter.html#model-trees"><i class="fa fa-check"></i><b>9.5.4</b> Model trees</a></li>
<li class="chapter" data-level="9.5.5" data-path="mlchapter.html"><a href="mlchapter.html#discriminant-analysis"><i class="fa fa-check"></i><b>9.5.5</b> Discriminant analysis</a></li>
<li class="chapter" data-level="9.5.6" data-path="mlchapter.html"><a href="mlchapter.html#support-vector-machines"><i class="fa fa-check"></i><b>9.5.6</b> Support vector machines</a></li>
<li class="chapter" data-level="9.5.7" data-path="mlchapter.html"><a href="mlchapter.html#nearest-neighbours-classifiers"><i class="fa fa-check"></i><b>9.5.7</b> Nearest neighbours classifiers</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="mlchapter.html"><a href="mlchapter.html#tsforecast"><i class="fa fa-check"></i><b>9.6</b> Forecasting time series</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="mlchapter.html"><a href="mlchapter.html#decomposition"><i class="fa fa-check"></i><b>9.6.1</b> Decomposition</a></li>
<li class="chapter" data-level="9.6.2" data-path="mlchapter.html"><a href="mlchapter.html#forecasting-using-arima-models"><i class="fa fa-check"></i><b>9.6.2</b> Forecasting using ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="mlchapter.html"><a href="mlchapter.html#deploying-models"><i class="fa fa-check"></i><b>9.7</b> Deploying models</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="mlchapter.html"><a href="mlchapter.html#creating-apis-with-plumber"><i class="fa fa-check"></i><b>9.7.1</b> Creating APIs with <code>plumber</code></a></li>
<li class="chapter" data-level="9.7.2" data-path="mlchapter.html"><a href="mlchapter.html#different-types-of-output"><i class="fa fa-check"></i><b>9.7.2</b> Different types of output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="advancedchapter.html"><a href="advancedchapter.html"><i class="fa fa-check"></i><b>10</b> Advanced topics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="advancedchapter.html"><a href="advancedchapter.html#moreonpackages"><i class="fa fa-check"></i><b>10.1</b> More on packages</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="advancedchapter.html"><a href="advancedchapter.html#loading-and-auto-installing-packages"><i class="fa fa-check"></i><b>10.1.1</b> Loading and auto-installing packages</a></li>
<li class="chapter" data-level="10.1.2" data-path="advancedchapter.html"><a href="advancedchapter.html#updating-r-and-your-packages"><i class="fa fa-check"></i><b>10.1.2</b> Updating R and your packages</a></li>
<li class="chapter" data-level="10.1.3" data-path="advancedchapter.html"><a href="advancedchapter.html#alternative-repositories"><i class="fa fa-check"></i><b>10.1.3</b> Alternative repositories</a></li>
<li class="chapter" data-level="10.1.4" data-path="advancedchapter.html"><a href="advancedchapter.html#removing-packages"><i class="fa fa-check"></i><b>10.1.4</b> Removing packages</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="advancedchapter.html"><a href="advancedchapter.html#parallel"><i class="fa fa-check"></i><b>10.2</b> Speeding up computations with parallelisation</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="advancedchapter.html"><a href="advancedchapter.html#parallelising-for-loops"><i class="fa fa-check"></i><b>10.2.1</b> Parallelising <code>for</code> loops</a></li>
<li class="chapter" data-level="10.2.2" data-path="advancedchapter.html"><a href="advancedchapter.html#parallelising-functionals"><i class="fa fa-check"></i><b>10.2.2</b> Parallelising functionals</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="advancedchapter.html"><a href="advancedchapter.html#linearalgebra"><i class="fa fa-check"></i><b>10.3</b> Linear algebra and matrices</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="advancedchapter.html"><a href="advancedchapter.html#creating-matrices"><i class="fa fa-check"></i><b>10.3.1</b> Creating matrices</a></li>
<li class="chapter" data-level="10.3.2" data-path="advancedchapter.html"><a href="advancedchapter.html#sparse-matrices"><i class="fa fa-check"></i><b>10.3.2</b> Sparse matrices</a></li>
<li class="chapter" data-level="10.3.3" data-path="advancedchapter.html"><a href="advancedchapter.html#matrix-operations"><i class="fa fa-check"></i><b>10.3.3</b> Matrix operations</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="advancedchapter.html"><a href="advancedchapter.html#integration"><i class="fa fa-check"></i><b>10.4</b> Integration with other programming languages</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-c"><i class="fa fa-check"></i><b>10.4.1</b> Integration with C++</a></li>
<li class="chapter" data-level="10.4.2" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-python"><i class="fa fa-check"></i><b>10.4.2</b> Integration with Python</a></li>
<li class="chapter" data-level="10.4.3" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-tensorflow-and-pytorch"><i class="fa fa-check"></i><b>10.4.3</b> Integration with Tensorflow and PyTorch</a></li>
<li class="chapter" data-level="10.4.4" data-path="advancedchapter.html"><a href="advancedchapter.html#integration-with-spark"><i class="fa fa-check"></i><b>10.4.4</b> Integration with Spark</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="errorchapter.html"><a href="errorchapter.html"><i class="fa fa-check"></i><b>11</b> Debugging</a>
<ul>
<li class="chapter" data-level="11.1" data-path="errorchapter.html"><a href="errorchapter.html#debugging"><i class="fa fa-check"></i><b>11.1</b> Debugging</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="errorchapter.html"><a href="errorchapter.html#find-out-where-the-error-occured-with-traceback"><i class="fa fa-check"></i><b>11.1.1</b> Find out where the error occured with <code>traceback</code></a></li>
<li class="chapter" data-level="11.1.2" data-path="errorchapter.html"><a href="errorchapter.html#interactive-debugging-of-functions-with-debug"><i class="fa fa-check"></i><b>11.1.2</b> Interactive debugging of functions with <code>debug</code></a></li>
<li class="chapter" data-level="11.1.3" data-path="errorchapter.html"><a href="errorchapter.html#investigate-the-environment-with-recover"><i class="fa fa-check"></i><b>11.1.3</b> Investigate the environment with <code>recover</code></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="errorchapter.html"><a href="errorchapter.html#commonerrors"><i class="fa fa-check"></i><b>11.2</b> Common error messages</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="errorchapter.html"><a href="errorchapter.html#section-1"><i class="fa fa-check"></i><b>11.2.1</b> <code>+</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="errorchapter.html"><a href="errorchapter.html#could-not-find-function"><i class="fa fa-check"></i><b>11.2.2</b> <code>could not find function</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="errorchapter.html"><a href="errorchapter.html#object-not-found"><i class="fa fa-check"></i><b>11.2.3</b> <code>object not found</code></a></li>
<li class="chapter" data-level="11.2.4" data-path="errorchapter.html"><a href="errorchapter.html#cannot-open-the-connection-and-no-such-file-or-directory"><i class="fa fa-check"></i><b>11.2.4</b> <code>cannot open the connection</code> and <code>No such file or directory</code></a></li>
<li class="chapter" data-level="11.2.5" data-path="errorchapter.html"><a href="errorchapter.html#invalid-description-argument"><i class="fa fa-check"></i><b>11.2.5</b> <code>invalid 'description' argument</code></a></li>
<li class="chapter" data-level="11.2.6" data-path="errorchapter.html"><a href="errorchapter.html#missing-value-where-truefalse-needed"><i class="fa fa-check"></i><b>11.2.6</b> <code>missing value where TRUE/FALSE needed</code></a></li>
<li class="chapter" data-level="11.2.7" data-path="errorchapter.html"><a href="errorchapter.html#unexpected-in-..."><i class="fa fa-check"></i><b>11.2.7</b> <code>unexpected '=' in ...</code></a></li>
<li class="chapter" data-level="11.2.8" data-path="errorchapter.html"><a href="errorchapter.html#attempt-to-apply-non-function"><i class="fa fa-check"></i><b>11.2.8</b> <code>attempt to apply non-function</code></a></li>
<li class="chapter" data-level="11.2.9" data-path="errorchapter.html"><a href="errorchapter.html#undefined-columns-selected"><i class="fa fa-check"></i><b>11.2.9</b> <code>undefined columns selected</code></a></li>
<li class="chapter" data-level="11.2.10" data-path="errorchapter.html"><a href="errorchapter.html#subscript-out-of-bounds"><i class="fa fa-check"></i><b>11.2.10</b> <code>subscript out of bounds</code></a></li>
<li class="chapter" data-level="11.2.11" data-path="errorchapter.html"><a href="errorchapter.html#object-of-type-closure-is-not-subsettable"><i class="fa fa-check"></i><b>11.2.11</b> <code>Object of type ‘closure’ is not subsettable</code></a></li>
<li class="chapter" data-level="11.2.12" data-path="errorchapter.html"><a href="errorchapter.html#operator-is-invalid-for-atomic-vectors"><i class="fa fa-check"></i><b>11.2.12</b> <code>$ operator is invalid for atomic vectors</code></a></li>
<li class="chapter" data-level="11.2.13" data-path="errorchapter.html"><a href="errorchapter.html#list-object-cannot-be-coerced-to-type-double"><i class="fa fa-check"></i><b>11.2.13</b> <code>(list) object cannot be coerced to type ‘double’</code></a></li>
<li class="chapter" data-level="11.2.14" data-path="errorchapter.html"><a href="errorchapter.html#arguments-imply-differing-number-of-rows"><i class="fa fa-check"></i><b>11.2.14</b> <code>arguments imply differing number of rows</code></a></li>
<li class="chapter" data-level="11.2.15" data-path="errorchapter.html"><a href="errorchapter.html#non-numeric-argument-to-a-binary-operator"><i class="fa fa-check"></i><b>11.2.15</b> <code>non-numeric argument to a binary operator</code></a></li>
<li class="chapter" data-level="11.2.16" data-path="errorchapter.html"><a href="errorchapter.html#non-numeric-argument-to-mathematical-function"><i class="fa fa-check"></i><b>11.2.16</b> <code>non-numeric argument to mathematical function</code></a></li>
<li class="chapter" data-level="11.2.17" data-path="errorchapter.html"><a href="errorchapter.html#cannot-allocate-vector-of-size-..."><i class="fa fa-check"></i><b>11.2.17</b> <code>cannot allocate vector of size ...</code></a></li>
<li class="chapter" data-level="11.2.18" data-path="errorchapter.html"><a href="errorchapter.html#error-in-plot.new-figure-margins-too-large"><i class="fa fa-check"></i><b>11.2.18</b> <code>Error in plot.new() : figure margins too large</code></a></li>
<li class="chapter" data-level="11.2.19" data-path="errorchapter.html"><a href="errorchapter.html#error-in-.call.graphicsc_palette2-.callc_palette2-null-invalid-graphics-state"><i class="fa fa-check"></i><b>11.2.19</b> <code>Error in .Call.graphics(C_palette2, .Call(C_palette2, NULL)) : invalid graphics state</code></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="errorchapter.html"><a href="errorchapter.html#commonwarnings"><i class="fa fa-check"></i><b>11.3</b> Common warning messages</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="errorchapter.html"><a href="errorchapter.html#replacement-has-...-rows-..."><i class="fa fa-check"></i><b>11.3.1</b> <code>replacement has ... rows ...</code></a></li>
<li class="chapter" data-level="11.3.2" data-path="errorchapter.html"><a href="errorchapter.html#iferror"><i class="fa fa-check"></i><b>11.3.2</b> <code>the condition has length &gt; 1 and only the first element will be used</code></a></li>
<li class="chapter" data-level="11.3.3" data-path="errorchapter.html"><a href="errorchapter.html#number-of-items-to-replace-is-not-a-multiple-of-replacement-length"><i class="fa fa-check"></i><b>11.3.3</b> <code>number of items to replace is not a multiple of replacement length</code></a></li>
<li class="chapter" data-level="11.3.4" data-path="errorchapter.html"><a href="errorchapter.html#longer-object-length-is-not-a-multiple-of-shorter-object-length"><i class="fa fa-check"></i><b>11.3.4</b> <code>longer object length is not a multiple of shorter object length</code></a></li>
<li class="chapter" data-level="11.3.5" data-path="errorchapter.html"><a href="errorchapter.html#nas-introduced-by-coercion"><i class="fa fa-check"></i><b>11.3.5</b> <code>NAs introduced by coercion</code></a></li>
<li class="chapter" data-level="11.3.6" data-path="errorchapter.html"><a href="errorchapter.html#package-is-not-available-for-r-version-4.x.x"><i class="fa fa-check"></i><b>11.3.6</b> <code>package is not available (for R version 4.x.x)</code></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="errorchapter.html"><a href="errorchapter.html#installationmessages"><i class="fa fa-check"></i><b>11.4</b> Messages printed when installing <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mathschap.html"><a href="mathschap.html"><i class="fa fa-check"></i><b>12</b> Mathematical appendix</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mathschap.html"><a href="mathschap.html#bootstrapcimaths"><i class="fa fa-check"></i><b>12.1</b> Bootstrap confidence intervals</a></li>
<li class="chapter" data-level="12.2" data-path="mathschap.html"><a href="mathschap.html#confintequal"><i class="fa fa-check"></i><b>12.2</b> The equivalence between confidence intervals and hypothesis tests</a></li>
<li class="chapter" data-level="12.3" data-path="mathschap.html"><a href="mathschap.html#twotypesofpvalues"><i class="fa fa-check"></i><b>12.3</b> Two types of p-values</a></li>
<li class="chapter" data-level="12.4" data-path="mathschap.html"><a href="mathschap.html#deviance"><i class="fa fa-check"></i><b>12.4</b> Deviance tests</a></li>
<li class="chapter" data-level="12.5" data-path="mathschap.html"><a href="mathschap.html#regreg"><i class="fa fa-check"></i><b>12.5</b> Regularised regression</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>13</b> Solutions to exercises</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutionsch2"><i class="fa fa-check"></i>Chapter 2</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutionsch3"><i class="fa fa-check"></i>Chapter 3</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutionsch4"><i class="fa fa-check"></i>Chapter 4</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch5solutions"><i class="fa fa-check"></i>Chapter 5</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch6solutions"><i class="fa fa-check"></i>Chapter 6</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch7solutions"><i class="fa fa-check"></i>Chapter 7</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch7bsolutions"><i class="fa fa-check"></i>Chapter 8</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#ch8solutions"><i class="fa fa-check"></i>Chapter 9</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>Bibliography</a>
<ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references1"><i class="fa fa-check"></i>Further reading</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references2"><i class="fa fa-check"></i>Online resources</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#references3"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="divider"></li>
<li>&copy; 2021 Mans Thulin.</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modern Statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datachapter" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Transforming, summarising, and analysing data<a href="datachapter.html#datachapter" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Most datasets are stored as tables, with rows and columns. In this chapter we’ll see how you can import and export such data, and how it is stored in R. We’ll also discuss how you can transform, summarise, and analyse your data.</p>
<p>After working with the material in this chapter, you will be able to use R to:</p>
<ul>
<li>Distinguish between different data types,</li>
<li>Import data from Excel spreadsheets and csv text files,</li>
<li>Compute descriptive statistics for subgroups in your data,</li>
<li>Find interesting points in your data,</li>
<li>Add new variables to your data,</li>
<li>Modify variables in your data,</li>
<li>Remove variables from your data,</li>
<li>Save and export your data,</li>
<li>Work with RStudio projects,</li>
<li>Run t-tests and fit linear models,</li>
<li>Use <code>%&gt;%</code> pipes to chain functions together.</li>
</ul>
<p>The chapter ends with a discussion of ethical guidelines for statistical work.</p>
<div id="data-frames-and-data-types" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Data frames and data types<a href="datachapter.html#data-frames-and-data-types" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="types-and-structures" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Types and structures<a href="datachapter.html#types-and-structures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have already seen that different kinds of data require different kinds of statistical methods. For numeric data we create boxplots and compute means, but for categorical data we don’t. Instead we produce bar charts and display the data in tables. It is no surprise then, that what R also treats different kinds of data differently.</p>
<p>In programming, a variable’s_data type_ describes what kind of object is assigned to it. We can assign many different types of objects to the variable <code>a</code>: it could for instance contain a number, text, or a data frame. In order to treat <code>a</code> correctly, R needs to know what data type its assigned object has. In some programming languages, you have to explicitly state what data type a variable has, but not in R. This makes programming R simpler and faster, but can cause problems if a variable turns out to have a different data type than what you thought<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a>.</p>
<p>R has six basic data types. For most people, it suffices to know about the first three in the list below:</p>
<ul>
<li><code>numeric</code>: numbers like <code>1</code> and <code>16.823</code> (sometimes also called <code>double</code>).</li>
<li><code>logical</code>: true/false values (boolean): either <code>TRUE</code> or <code>FALSE</code>.</li>
<li><code>character</code>: text, e.g. <code>"a"</code>, <code>"Hello! I'm Ada."</code> and <code>"name@domain.com"</code>.</li>
<li><code>integer</code>: integer numbers, denoted in R by the letter <code>L</code>: <code>1L</code>, <code>55L</code>.</li>
<li><code>complex</code>: complex numbers, like <code>2+3i</code>. Rarely used in statistical work.</li>
<li><code>raw</code>: used to hold raw bytes. Don’t fret if you don’t know what that means. You can have a long and meaningful career in statistics, data science, or pretty much any other field without ever having to worry about raw bytes. We won’t discuss <code>raw</code> objects again in this book.</li>
</ul>
<p>In addition, these can be combined into special data types sometimes called <em>data structures</em>, examples of which include vectors and data frames. Important data structures include <code>factor</code>, which is used to store categorical data, and the awkwardly named <code>POSIXct</code> which is used to store date and time data.</p>
<p>To check what type of object a variable is, you can use the <code>class</code> function:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="datachapter.html#cb88-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb88-2"><a href="datachapter.html#cb88-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">&quot;Scotland&quot;</span></span>
<span id="cb88-3"><a href="datachapter.html#cb88-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb88-4"><a href="datachapter.html#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="datachapter.html#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span>
<span id="cb88-6"><a href="datachapter.html#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(y)</span>
<span id="cb88-7"><a href="datachapter.html#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(z)</span></code></pre></div>
<p>What happens if we use <code>class</code> on a vector?</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="datachapter.html#cb89-1" aria-hidden="true" tabindex="-1"></a>numbers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>)</span>
<span id="cb89-2"><a href="datachapter.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(numbers)</span></code></pre></div>
<p><code>class</code> returns the data type of the elements of the vector. So what happens if we put objects of different type together in a vector?</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="datachapter.html#cb90-1" aria-hidden="true" tabindex="-1"></a>all_together <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y, z)</span>
<span id="cb90-2"><a href="datachapter.html#cb90-2" aria-hidden="true" tabindex="-1"></a>all_together</span>
<span id="cb90-3"><a href="datachapter.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(all_together)</span></code></pre></div>
<p>In this case, R has coerced the objects in the vector to all be of the same type. Sometimes that is desirable, and sometimes it is not. The lesson here is to be careful when you create a vector from different objects. We’ll learn more about coercion and how to change data types in Section <a href="messychapter.html#coercion">5.1</a>.</p>
</div>
<div id="typesoftables" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Types of tables<a href="datachapter.html#typesoftables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The basis for most data analyses in R are data frames: spreadsheet-like tables with rows and columns containing data. You encountered some data frames in the previous chapter. Have a quick look at them to remind yourself of what they look like:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="datachapter.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bookstore example</span></span>
<span id="cb91-2"><a href="datachapter.html#cb91-2" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">48</span>, <span class="dv">47</span>, <span class="dv">71</span>, <span class="dv">22</span>, <span class="dv">80</span>, <span class="dv">48</span>, <span class="dv">30</span>, <span class="dv">31</span>)</span>
<span id="cb91-3"><a href="datachapter.html#cb91-3" aria-hidden="true" tabindex="-1"></a>purchase <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">59</span>, <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">160</span>, <span class="dv">34</span>, <span class="dv">34</span>, <span class="dv">29</span>)</span>
<span id="cb91-4"><a href="datachapter.html#cb91-4" aria-hidden="true" tabindex="-1"></a>bookstore <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(age, purchase)</span>
<span id="cb91-5"><a href="datachapter.html#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(bookstore)</span>
<span id="cb91-6"><a href="datachapter.html#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="datachapter.html#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Animal sleep data</span></span>
<span id="cb91-8"><a href="datachapter.html#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb91-9"><a href="datachapter.html#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(msleep)</span>
<span id="cb91-10"><a href="datachapter.html#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="datachapter.html#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Diamonds data</span></span>
<span id="cb91-12"><a href="datachapter.html#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(diamonds)</span></code></pre></div>
<p>Notice that all three data frames follow the same format: each column represents a <em>variable</em> (e.g. age) and each row represents an <em>observation</em> (e.g. an individual). This is the standard way to store data in R (as well as the standard format in statistics in general). In what follows, we will use the terms column and variable interchangeably, to describe the columns/variables in a data frame.</p>
<p>This kind of table can be stored in R as different types of objects - that is, in several different ways. As you’d expect, the different types of objects have different properties and can be used with different functions. Here’s the run-down of four common types:</p>
<ul>
<li><code>matrix</code>: a table where all columns must contain objects of the same type (e.g. all <code>numeric</code> or all <code>character</code>). Uses less memory than other types and allows for much faster computations, but is difficult to use for certain types of data manipulation, plotting and analyses.</li>
<li><code>data.frame</code>: the most common type, where different columns can contain different types (e.g. one <code>numeric</code> column, one <code>character</code> column).</li>
<li><code>data.table</code>: an enhanced version of <code>data.frame</code>.</li>
<li><code>tbl_df</code> (“tibble”): another enhanced version of <code>data.frame</code>.</li>
</ul>
<p>First of all, in most cases it doesn’t matter which of these four that you use to store your data. In fact, they all look similar to the user. Have a look at the following datasets (<code>WorldPhones</code> and <code>airquality</code> come with base R):</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="datachapter.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, an example of data stored in a matrix:</span></span>
<span id="cb92-2"><a href="datachapter.html#cb92-2" aria-hidden="true" tabindex="-1"></a>?WorldPhones</span>
<span id="cb92-3"><a href="datachapter.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(WorldPhones)</span>
<span id="cb92-4"><a href="datachapter.html#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(WorldPhones)</span>
<span id="cb92-5"><a href="datachapter.html#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="datachapter.html#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Next, an example of data stored in a data frame:</span></span>
<span id="cb92-7"><a href="datachapter.html#cb92-7" aria-hidden="true" tabindex="-1"></a>?airquality</span>
<span id="cb92-8"><a href="datachapter.html#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(airquality)</span>
<span id="cb92-9"><a href="datachapter.html#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(airquality)</span>
<span id="cb92-10"><a href="datachapter.html#cb92-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-11"><a href="datachapter.html#cb92-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, an example of data stored in a tibble:</span></span>
<span id="cb92-12"><a href="datachapter.html#cb92-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb92-13"><a href="datachapter.html#cb92-13" aria-hidden="true" tabindex="-1"></a>?msleep</span>
<span id="cb92-14"><a href="datachapter.html#cb92-14" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(msleep)</span>
<span id="cb92-15"><a href="datachapter.html#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(msleep)</span></code></pre></div>
<p>That being said, in some cases it <em>really</em> matters which one you use. Some functions require that you input a matrix, while others may break or work differently from what was intended if you input a tibble instead of an ordinary data frame. Luckily, you can convert objects into other types:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="datachapter.html#cb93-1" aria-hidden="true" tabindex="-1"></a>WorldPhonesDF <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(WorldPhones)</span>
<span id="cb93-2"><a href="datachapter.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(WorldPhonesDF)</span>
<span id="cb93-3"><a href="datachapter.html#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="datachapter.html#cb93-4" aria-hidden="true" tabindex="-1"></a>airqualityMatrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(airquality)</span>
<span id="cb93-5"><a href="datachapter.html#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(airqualityMatrix)</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch3exc1" class="exercise"><strong>Exercise 3.1  </strong></span>The following tasks are all related to data types and data structures:</p>
<ol style="list-style-type: decimal">
<li><p>Create a text variable using e.g. <code>a &lt;- "A rainy day in Edinburgh"</code>. Check that it gets the correct type. What happens if you use single quotes marks instead of double quotes when you create the variable?</p></li>
<li><p>What data types are the sums <code>1 + 2</code>, <code>1L + 2</code> and <code>1L + 2L</code>?</p></li>
<li><p>What happens if you add a <code>numeric</code> to a <code>character</code>, e.g. <code>"Hello" + 1</code>?</p></li>
<li><p>What happens if you perform mathematical operations involving a <code>numeric</code> and a <code>logical</code>, e.g. <code>FALSE * 2</code> or <code>TRUE + 1</code>?</p></li>
</ol>
</div>
<p><a href="solutions.html#ch3solutions1">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch3exc1c" class="exercise"><strong>Exercise 3.2  </strong></span>What do the functions <code>ncol</code>, <code>nrow</code>, <code>dim</code>, <code>names</code>, and <code>row.names</code> return when applied to a data frame?</p>
</div>
<p><a href="solutions.html#ch3solutions1c">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch3exc1b" class="exercise"><strong>Exercise 3.3  </strong></span><code>matrix</code> tables can be created from vectors using the function of the same name. Using the vector <code>x &lt;- 1:6</code> use <code>matrix</code> to create the following matrices:</p>
<p><span class="math display">\[\begin{pmatrix}
  1 &amp; 2 &amp; 3\\
  4 &amp; 5 &amp; 6
\end{pmatrix}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{pmatrix}
  1 &amp; 4\\
  2 &amp; 5\\
  3 &amp; 6
\end{pmatrix}.\]</span></p>
<p>Remember to check <code>?matrix</code> to find out how to set the dimensions of the matrix, and how it is filled with the numbers from the vector!</p>
</div>
<p><a href="solutions.html#ch3solutions1b">(Click here to go to the solution.)</a></p>
</div>
</div>
<div id="findingpoints" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Vectors in data frames<a href="datachapter.html#findingpoints" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the next few sections, we will explore the <code>airquality</code> dataset. It contains daily air quality measurements from New York during a period of five months:</p>
<ul>
<li><code>Ozone</code>: mean ozone concentration (ppb),</li>
<li><code>Solar.R</code>: solar radiation (Langley),</li>
<li><code>Wind</code>: average wind speed (mph),</li>
<li><code>Temp</code>: maximum daily temperature in degrees Fahrenheit,</li>
<li><code>Month</code>: numeric month (May=5, June=6, and so on),</li>
<li><code>Day</code>: numeric day of the month (1-31).</li>
</ul>
<p>There are lots of things that would be interesting to look at in this dataset. What was the mean temperature during the period? Which day was the hottest? Which was the windiest? What days were the temperature more than 90 degrees Fahrenheit? To answer these questions, we need to be able to access the vectors inside the data frame. We also need to be able to quickly and automatically screen the data in order to find interesting observations (e.g. the hottest day)</p>
<div id="accessingelements" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Accessing vectors and elements<a href="datachapter.html#accessingelements" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Section <a href="thebasics.html#descstats">2.4</a>, we learned how to compute the mean of a vector. We also learned that to compute the mean of a vector <em>that is stored inside a data frame</em><a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> we could use a dollar sign: <code>data_frame_name$vector_name</code>. Here is an example with the <code>airquality</code> data:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="datachapter.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the Temp vector:</span></span>
<span id="cb94-2"><a href="datachapter.html#cb94-2" aria-hidden="true" tabindex="-1"></a>airquality<span class="sc">$</span>Temp</span>
<span id="cb94-3"><a href="datachapter.html#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="datachapter.html#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the mean temperature:</span></span>
<span id="cb94-5"><a href="datachapter.html#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(airquality<span class="sc">$</span>Temp)</span></code></pre></div>
<p>If we want to grab a particular element from a vector, we must use its <em>index</em> within square brackets: <code>[index]</code>. The first element in the vector has index 1, the second has index 2, the third index 3, and so on. To access the fifth element in the <code>Temp</code> vector in the <code>airquality</code> data frame, we can use:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="datachapter.html#cb95-1" aria-hidden="true" tabindex="-1"></a>airquality<span class="sc">$</span>Temp[<span class="dv">5</span>]</span></code></pre></div>
<p>The square brackets can also be applied directly to the data frame. The syntax for this follows that used for matrices in mathematics: <code>airquality[i, j]</code> means the element at the i:th row and j:th column of <code>airquality</code>. We can also leave out either <code>i</code> or <code>j</code> to extract an entire row or column from the data frame. Here are some examples:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="datachapter.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, we check the order of the columns:</span></span>
<span id="cb96-2"><a href="datachapter.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(airquality)</span>
<span id="cb96-3"><a href="datachapter.html#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We see that Temp is the 4th column.</span></span>
<span id="cb96-4"><a href="datachapter.html#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="datachapter.html#cb96-5" aria-hidden="true" tabindex="-1"></a>airquality[<span class="dv">5</span>, <span class="dv">4</span>]    <span class="co"># The 5th element from the 4th column,</span></span>
<span id="cb96-6"><a href="datachapter.html#cb96-6" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># i.e. the same as airquality$Temp[5]</span></span>
<span id="cb96-7"><a href="datachapter.html#cb96-7" aria-hidden="true" tabindex="-1"></a>airquality[<span class="dv">5</span>,]      <span class="co"># The 5th row of the data</span></span>
<span id="cb96-8"><a href="datachapter.html#cb96-8" aria-hidden="true" tabindex="-1"></a>airquality[, <span class="dv">4</span>]     <span class="co"># The 4th column of the data, like airquality$Temp</span></span>
<span id="cb96-9"><a href="datachapter.html#cb96-9" aria-hidden="true" tabindex="-1"></a>airquality[[<span class="dv">4</span>]]     <span class="co"># The 4th column of the data, like airquality$Temp</span></span>
<span id="cb96-10"><a href="datachapter.html#cb96-10" aria-hidden="true" tabindex="-1"></a>airquality[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)] <span class="co"># The 2nd, 4th and 6th columns of the data</span></span>
<span id="cb96-11"><a href="datachapter.html#cb96-11" aria-hidden="true" tabindex="-1"></a>airquality[, <span class="sc">-</span><span class="dv">2</span>]    <span class="co"># All columns except the 2nd one</span></span>
<span id="cb96-12"><a href="datachapter.html#cb96-12" aria-hidden="true" tabindex="-1"></a>airquality[, <span class="fu">c</span>(<span class="st">&quot;Temp&quot;</span>, <span class="st">&quot;Wind&quot;</span>)] <span class="co"># The Temp and Wind columns</span></span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch3exc2" class="exercise"><strong>Exercise 3.4  </strong></span>The following tasks all involve using the the <code>[i, j]</code> notation for extracting data from data frames:</p>
<ol style="list-style-type: decimal">
<li><p>Why does <code>airquality[, 3]</code> not return the third row of <code>airquality</code>?</p></li>
<li><p>Extract the first five rows from <code>airquality</code>. <em>Hint:</em> a fast way of creating the vector <code>c(1, 2, 3, 4, 5)</code> is to write <code>1:5</code>.</p></li>
<li><p>Compute the correlation between the <code>Temp</code> and <code>Wind</code> vectors of <code>airquality</code> without refering to them using <code>$</code>.</p></li>
<li><p>Extract all columns from <code>airquality</code> <em>except</em> <code>Temp</code> and <code>Wind</code>.</p></li>
</ol>
</div>
<p><a href="solutions.html#ch3solutions2">(Click here to go to the solution.)</a></p>
</div>
<div id="use-your-dollars" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Use your dollars<a href="datachapter.html#use-your-dollars" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>$</code> operator can be used not just to extract data from a data frame, but also to manipulate it. Let’s return to our <code>bookstore</code> data frame, and see how we can make changes to it using the dollar sign.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="datachapter.html#cb97-1" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">48</span>, <span class="dv">47</span>, <span class="dv">71</span>, <span class="dv">22</span>, <span class="dv">80</span>, <span class="dv">48</span>, <span class="dv">30</span>, <span class="dv">31</span>)</span>
<span id="cb97-2"><a href="datachapter.html#cb97-2" aria-hidden="true" tabindex="-1"></a>purchase <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">59</span>, <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">160</span>, <span class="dv">34</span>, <span class="dv">34</span>, <span class="dv">29</span>)</span>
<span id="cb97-3"><a href="datachapter.html#cb97-3" aria-hidden="true" tabindex="-1"></a>bookstore <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(age, purchase)</span></code></pre></div>
<p>Perhaps there was a data entry error - the second customer was actually 18 years old and not 48. We can assign a new value to that element by referring to it in either of two ways:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="datachapter.html#cb98-1" aria-hidden="true" tabindex="-1"></a>bookstore<span class="sc">$</span>age[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">18</span></span>
<span id="cb98-2"><a href="datachapter.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb98-3"><a href="datachapter.html#cb98-3" aria-hidden="true" tabindex="-1"></a>bookstore[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">18</span></span></code></pre></div>
<p>We could also change an entire column if we like. For instance, if we wish to change the <code>age</code> vector to months instead of years, we could use</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="datachapter.html#cb99-1" aria-hidden="true" tabindex="-1"></a>bookstore<span class="sc">$</span>age <span class="ot">&lt;-</span> bookstore<span class="sc">$</span>age <span class="sc">*</span> <span class="dv">12</span></span></code></pre></div>
<p>What if we want to add another variable to the data, for instance the length of the customers’ visits in minutes? There are several ways to accomplish this, one of which involves the dollar sign:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="datachapter.html#cb100-1" aria-hidden="true" tabindex="-1"></a>bookstore<span class="sc">$</span>visit_length <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">12</span>, <span class="dv">31</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb100-2"><a href="datachapter.html#cb100-2" aria-hidden="true" tabindex="-1"></a>bookstore</span></code></pre></div>
<p>As you see, the new data has now been added to a new column in the data frame.</p>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch3exc2p5" class="exercise"><strong>Exercise 3.5  </strong></span>Use the <code>bookstore</code> data frame to do the following:</p>
<ol style="list-style-type: decimal">
<li><p>Add a new variable <code>rev_per_minute</code> which is the ratio between purchase and the visit length.</p></li>
<li><p>Oh no, there’s been an error in the data entry! Replace the purchase amount for the 80-year old customer with <code>16</code>.</p></li>
</ol>
</div>
<p><a href="solutions.html#ch3solutions2p5">(Click here to go to the solution.)</a></p>
</div>
<div id="conditionsintro" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Using conditions<a href="datachapter.html#conditionsintro" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A few paragraphs ago, we were asking which was the hottest day in the <code>airquality</code> data. Let’s find out! We already know how to find the maximum value in the <code>Temp</code> vector:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="datachapter.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(airquality<span class="sc">$</span>Temp)</span></code></pre></div>
<p>But can we find out which day this corresponds to? We could of course manually go through all 153 days e.g. by using <code>View(airquality)</code>, but that seems tiresome and wouldn’t even be possible in the first place if we’d had more observations. A better option is therefore to use the function <code>which.max</code>:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="datachapter.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(airquality<span class="sc">$</span>Temp)</span></code></pre></div>
<p><code>which.max</code> returns the index of the observation with the maximum value. If there is more than one observation attaining this value, it only returns the first of these.</p>
<p>We’ve just used <code>which.max</code> to find out that day <code>120</code> was the hottest during the period. If we want to have a look at the entire row for that day, we can use</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="datachapter.html#cb103-1" aria-hidden="true" tabindex="-1"></a>airquality[<span class="dv">120</span>,]</span></code></pre></div>
<p>Alternatively, we could place the call to <code>which.max</code> inside the brackets. Because <code>which.max(airquality$Temp)</code> returns the number <code>120</code>, this yields the same result as the previous line:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="datachapter.html#cb104-1" aria-hidden="true" tabindex="-1"></a>airquality[<span class="fu">which.max</span>(airquality<span class="sc">$</span>Temp),]</span></code></pre></div>
<p>Were we looking for the day with the lowest temperature, we’d use <code>which.min</code> analogously. In fact, we could use any function or computation that returns an index in the same way, placing it inside the brackets to get the corresponding rows or columns. This is extremely useful is we want to extract observations with certain properties, for instance all days where the temperature was above 90 degrees. We do this using <em>conditions</em>, i.e. by giving statements that we wish to be fulfilled.</p>
<p>As a first example of a condition, we use the following, which checks if the temperature exceeds 90 degrees:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="datachapter.html#cb105-1" aria-hidden="true" tabindex="-1"></a>airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span></span></code></pre></div>
<p>For each element in <code>airquality$Temp</code> this returns either <code>TRUE</code> (if the condition is fulfilled, i.e. when the temperature is greater than 90) or <code>FALSE</code> (if the conditions isn’t fulfilled, i.e. when the temperature is 90 or lower). If we place the condition inside brackets following the name of the data frame, we will extract only the rows corresponding to those elements which were marked with <code>TRUE</code>:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="datachapter.html#cb106-1" aria-hidden="true" tabindex="-1"></a>airquality[airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span>, ]</span></code></pre></div>
<p>If you prefer, you can also store the <code>TRUE</code> or <code>FALSE</code> values in a new variable:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="datachapter.html#cb107-1" aria-hidden="true" tabindex="-1"></a>airquality<span class="sc">$</span>Hot <span class="ot">&lt;-</span> airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span></span></code></pre></div>
<p>There are several logical operators and functions which are useful when stating conditions in R. Here are some examples:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="datachapter.html#cb108-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb108-2"><a href="datachapter.html#cb108-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb108-3"><a href="datachapter.html#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="datachapter.html#cb108-4" aria-hidden="true" tabindex="-1"></a>a <span class="sc">==</span> b     <span class="co"># Check if a equals b</span></span>
<span id="cb108-5"><a href="datachapter.html#cb108-5" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&gt;</span> b      <span class="co"># Check if a is greater than b</span></span>
<span id="cb108-6"><a href="datachapter.html#cb108-6" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&lt;</span> b      <span class="co"># Check if a is less than b</span></span>
<span id="cb108-7"><a href="datachapter.html#cb108-7" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&gt;=</span> b     <span class="co"># Check if a is equal to or greater than b</span></span>
<span id="cb108-8"><a href="datachapter.html#cb108-8" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&lt;=</span> b     <span class="co"># Check if a is equal to or less than b</span></span>
<span id="cb108-9"><a href="datachapter.html#cb108-9" aria-hidden="true" tabindex="-1"></a>a <span class="sc">!=</span> b     <span class="co"># Check if a is not equal to b</span></span>
<span id="cb108-10"><a href="datachapter.html#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(a)   <span class="co"># Check if a is NA</span></span>
<span id="cb108-11"><a href="datachapter.html#cb108-11" aria-hidden="true" tabindex="-1"></a>a <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>) <span class="co"># Check if a equals at least one of 1, 4, 9</span></span></code></pre></div>
<p>When checking a conditions for all elements in a vector, we can use <code>which</code> to get the indices of the elements that fulfill the condition:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="datachapter.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span>)</span></code></pre></div>
<p>If we want to know if all elements in a vector fulfill the condition, we can use <code>all</code>:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="datachapter.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span>)</span></code></pre></div>
<p>In this case, it returns <code>FALSE</code>, meaning that not all days had a temperature above 90 (phew!). Similarly, if we wish to know whether <em>at least one</em> day had a temperature above 90, we can use <code>any</code>:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="datachapter.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span>)</span></code></pre></div>
<p>To find how many elements that fulfill a condition, we can use <code>sum</code>:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="datachapter.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span>)</span></code></pre></div>
<p>Why does this work? Remember that <code>sum</code> computes the sum of the elements in a vector, and that when <code>logical</code> values are used in computations, they are treated as <code>0</code> (<code>FALSE</code>) or <code>1</code> (<code>TRUE</code>). Because the condition returns a vector of <code>logical</code> values, the sum of them becomes the number of 1’s - the number of <code>TRUE</code> values - i.e. the number of elements that fulfill the condition.</p>
<p>To find the proportion of elements that fulfill a condition, we can count how many elements fulfill it and then divide by how many elements are in the vector. This is exactly what happens if we use <code>mean</code>:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="datachapter.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span>)</span></code></pre></div>
<p>Finally, we can combine conditions by using the logical operators <code>&amp;</code> (AND), <code>|</code> (OR), and, less frequently, <code>xor</code> (exclusive or, XOR). Here are some examples:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="datachapter.html#cb114-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb114-2"><a href="datachapter.html#cb114-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb114-3"><a href="datachapter.html#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="datachapter.html#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Is a less than b and greater than 1?</span></span>
<span id="cb114-5"><a href="datachapter.html#cb114-5" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&lt;</span> b <span class="sc">&amp;</span> a <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb114-6"><a href="datachapter.html#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="datachapter.html#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Is a less than b and equal to 4?</span></span>
<span id="cb114-8"><a href="datachapter.html#cb114-8" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&lt;</span> b <span class="sc">&amp;</span> a <span class="sc">==</span> <span class="dv">4</span></span>
<span id="cb114-9"><a href="datachapter.html#cb114-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-10"><a href="datachapter.html#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Is a less than b and/or equal to 4?</span></span>
<span id="cb114-11"><a href="datachapter.html#cb114-11" aria-hidden="true" tabindex="-1"></a>a <span class="sc">&lt;</span> b <span class="sc">|</span> a <span class="sc">==</span> <span class="dv">4</span></span>
<span id="cb114-12"><a href="datachapter.html#cb114-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-13"><a href="datachapter.html#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Is a equal to 4 and/or equal to 5?</span></span>
<span id="cb114-14"><a href="datachapter.html#cb114-14" aria-hidden="true" tabindex="-1"></a>a <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> a <span class="sc">==</span> <span class="dv">5</span></span>
<span id="cb114-15"><a href="datachapter.html#cb114-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-16"><a href="datachapter.html#cb114-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Is a less than b XOR equal to 4?</span></span>
<span id="cb114-17"><a href="datachapter.html#cb114-17" aria-hidden="true" tabindex="-1"></a><span class="co"># I.e. is one and only one of these satisfied?</span></span>
<span id="cb114-18"><a href="datachapter.html#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="fu">xor</span>(a <span class="sc">&lt;</span> b, a <span class="sc">==</span> <span class="dv">4</span>)</span></code></pre></div>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch3exc3" class="exercise"><strong>Exercise 3.6  </strong></span>The following tasks all involve checking conditions for the <code>airquality</code> data:</p>
<ol style="list-style-type: decimal">
<li><p>Which was the coldest day during the period?</p></li>
<li><p>How many days was the wind speed greater than 17 mph?</p></li>
<li><p>How many missing values are there in the <code>Ozone</code> vector?</p></li>
<li><p>How many days are there for which the temperature was below 70 and the wind speed was above 10?</p></li>
</ol>
</div>
<p><a href="solutions.html#ch3solutions3">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch3exc3b" class="exercise"><strong>Exercise 3.7  </strong></span>The function <code>cut</code> can be used to create a categorical variable from a numerical variable, by dividing it into categories corresponding to different intervals. Reads its documentation and then create a new categorical variable in the <code>airquality</code> data, <code>TempCat</code>, which divides <code>Temp</code> into the three intervals <code>(50, 70]</code>, <code>(70, 90]</code>, <code>(90, 110]</code><a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>.</p>
</div>
<p><a href="solutions.html#ch3solutions3b">(Click here to go to the solution.)</a></p>
</div>
</div>
<div id="paths" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Importing data<a href="datachapter.html#paths" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far, we’ve looked at examples of data they either came shipped with base R or <code>ggplot2</code>, or simple toy examples that we created ourselves, like <code>bookstore</code>. While you can do all your data entry work in R, <code>bookstore</code> style, it is much more common to load data from other sources. Two important types of files are <em>comma-separated value files</em>, <code>.csv</code>, and Excel spreadsheets, <code>.xlsx</code>. <code>.csv</code> files are spreadsheets stored as text files - basically Excel files stripped down to the bare minimum - no formatting, no formulas, no macros. You can open and edit them in spreadsheet software like LibreOffice Calc, Google Sheets or Microsoft Excel. Many devices and databases can export data in <code>.csv</code> format, making it a commonly used file format that you are likely to encounter sooner rather than later.</p>
<div id="importing-csv-files" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Importing csv files<a href="datachapter.html#importing-csv-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In order to load data from a file into R, you need its <em>path</em> - that is, you need to tell R where to find the file. Unless you specify otherwise, R will look for files in its current <em>working directory</em>. To see what your current working directory is, run the following code in the Console panel:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="datachapter.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code></pre></div>
<p>In RStudio, your working directory will usually be shown in the Files panel. If you have opened RStudio by opening a <code>.R</code> file, the working directory will be the directory in which the file is stored. You can change the working directory by using the function <code>setwd</code> or selecting <em>Session &gt; Set Working Directory &gt; Choose Directory</em> in the RStudio menu.</p>
<p>Before we discuss paths further, let’s look at how you can import data from a file that is in your working directory. <a href="http://www.modernstatisticswithr.com/data.zip">The data files that we’ll use in examples in this book can be downloaded from the book’s web page</a>. They are stored in a zip file (<code>data.zip</code>) - open it an copy/extract the files to the folder that is your current working directory. Open <code>philosophers.csv</code> with a spreadsheet software to have a quick look at it. Then open it in a text editor (for instance Notepad for Windows, TextEdit for Mac or Gedit for Linux). Note how commas are used to separate the columns of the data:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="datachapter.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Name&quot;</span>,<span class="st">&quot;Description&quot;</span>,<span class="st">&quot;Born&quot;</span>,<span class="st">&quot;Deceased&quot;</span>,<span class="st">&quot;Rating&quot;</span></span>
<span id="cb116-2"><a href="datachapter.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Aristotle&quot;</span>,<span class="st">&quot;Pretty influential, as philosophers go.&quot;</span>,<span class="sc">-</span><span class="dv">384</span>,<span class="st">&quot;322 BC&quot;</span>,</span>
<span id="cb116-3"><a href="datachapter.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;4.8&quot;</span></span>
<span id="cb116-4"><a href="datachapter.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Basilides&quot;</span>,<span class="st">&quot;Denied the existence of incorporeal entities.&quot;</span>,<span class="sc">-</span><span class="dv">175</span>,</span>
<span id="cb116-5"><a href="datachapter.html#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;125 BC&quot;</span>,<span class="dv">4</span></span>
<span id="cb116-6"><a href="datachapter.html#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Cercops&quot;</span>,<span class="st">&quot;An Orphic poet&quot;</span>,,,<span class="st">&quot;3.2&quot;</span></span>
<span id="cb116-7"><a href="datachapter.html#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Dexippus&quot;</span>,<span class="st">&quot;Neoplatonic!&quot;</span>,<span class="dv">235</span>,<span class="st">&quot;375 AD&quot;</span>,<span class="st">&quot;2.7&quot;</span></span>
<span id="cb116-8"><a href="datachapter.html#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Epictetus&quot;</span>,<span class="st">&quot;A stoic philosopher&quot;</span>,<span class="dv">50</span>,<span class="st">&quot;135 AD&quot;</span>,<span class="dv">5</span></span>
<span id="cb116-9"><a href="datachapter.html#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Favorinus&quot;</span>,<span class="st">&quot;Sceptic&quot;</span>,<span class="dv">80</span>,<span class="st">&quot;160 AD&quot;</span>,<span class="st">&quot;4.7&quot;</span></span></code></pre></div>
<p>Then run the following code to import the data using the <code>read.csv</code> function and store it in a variable named <code>imported_data</code>:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="datachapter.html#cb117-1" aria-hidden="true" tabindex="-1"></a>imported_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;philosophers.csv&quot;</span>)</span></code></pre></div>
<p>If you get an error message that says:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="datachapter.html#cb118-1" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">file</span>(file, <span class="st">&quot;rt&quot;</span>) <span class="sc">:</span> cannot open the connection</span>
<span id="cb118-2"><a href="datachapter.html#cb118-2" aria-hidden="true" tabindex="-1"></a>In addition<span class="sc">:</span> Warning message<span class="sc">:</span></span>
<span id="cb118-3"><a href="datachapter.html#cb118-3" aria-hidden="true" tabindex="-1"></a>In <span class="fu">file</span>(file, <span class="st">&quot;rt&quot;</span>) <span class="sc">:</span></span>
<span id="cb118-4"><a href="datachapter.html#cb118-4" aria-hidden="true" tabindex="-1"></a>  cannot open file <span class="st">&#39;philosophers.csv&#39;</span><span class="sc">:</span> No such file or directory</span></code></pre></div>
<p>…it means that <code>philosophers.csv</code> is not in your working directory. Either move the file to the right directory (remember, you can use run <code>getwd()</code> to see what your working directory is) or change your working directory, as described above.</p>
<p>Now, let’s have a look at <code>imported_data</code>:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="datachapter.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(imported_data)</span>
<span id="cb119-2"><a href="datachapter.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(imported_data)</span></code></pre></div>
<p>The columns <code>Name</code> and <code>Description</code> both contain text, and have been imported as <code>character</code> vectors<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a>. The <code>Rating</code> column contains numbers with decimals and has been imported as a <code>numeric</code> vector. The column <code>Born</code> only contain integer values, and has been imported as an <code>integer</code> vector. The missing value is represented by an <code>NA</code>. The <code>Deceased</code> column contains years formatted like <code>125 BC</code> and <code>135 AD</code>. These have been imported into a <code>character</code> vector - because numbers and letters are mixed in this column, R treats is as a text string (in Chapter <a href="messychapter.html#messychapter">5</a> we will see how we can convert it to numbers or proper dates). In this case, the missing value is represented by an empty string, <code>""</code>, rather than by <code>NA</code>.</p>
<p>So, what can you do in case you need to import data from a file that is not in your working directory? This is a common problem, as many of us store script files and data files in separate folders (or even on separate drives). One option is to use <code>file.choose</code>, which opens a pop-up window that lets you choose which file to open using a graphical interface:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="datachapter.html#cb120-1" aria-hidden="true" tabindex="-1"></a>imported_data2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.choose</span>())</span></code></pre></div>
<p>A third option is not to write any code at all. Instead, you can import the data using RStudio’s graphical interface by choosing <em>File &gt; Import dataset &gt; From Text (base)</em> and then choosing <code>philosophers.csv</code>. This will generate the code needed to import the data (using <code>read.csv</code>) and run it in the Console window.</p>
<p>The latter two solutions work just fine if you just want to open a single file once. But if you want to reuse your code or run it multiple times, you probably don’t want to have to click and select your file each time. Instead, you can specify the path to your file in the call to <code>read.csv</code>.</p>
</div>
<div id="file-paths" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> File paths<a href="datachapter.html#file-paths" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>File paths look different in different operating systems. If the user <code>Mans</code> has a file named <code>philosophers.csv</code> stored in a folder called <code>MyData</code> on his desktop, its path on an English-language Windows system would be:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="datachapter.html#cb121-1" aria-hidden="true" tabindex="-1"></a>C<span class="sc">:</span>\Users\Mans\Desktop\MyData\philosophers.csv</span></code></pre></div>
<p>On a Mac it would be:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="datachapter.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span>Users<span class="sc">/</span>Mans<span class="sc">/</span>Desktop<span class="sc">/</span>MyData<span class="sc">/</span>philosophers.csv</span></code></pre></div>
<p>And on Linux:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="datachapter.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="sc">/</span>home<span class="sc">/</span>Mans<span class="sc">/</span>Desktop<span class="sc">/</span>MyData<span class="sc">/</span>philosophers.csv</span></code></pre></div>
<p>You can copy the path of the file from your file browser: Explorer<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a> (Windows), Finder<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a> (Mac) or Nautilus/similar<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a> (Linux). Once you have copied the path, you can store it in R as a <code>character</code> string.</p>
<p>Here’s how to do this on Mac and Linux:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="datachapter.html#cb124-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">&quot;/Users/Mans/Desktop/MyData/philosophers.csv&quot;</span> <span class="co"># Mac</span></span>
<span id="cb124-2"><a href="datachapter.html#cb124-2" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">&quot;/home/Mans/Desktop/MyData/philosophers.csv&quot;</span>  <span class="co"># Linux</span></span></code></pre></div>
<p>If you’re working on a Windows system, file paths are written using backslashes, <code>\</code>, like so:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="datachapter.html#cb125-1" aria-hidden="true" tabindex="-1"></a>C<span class="sc">:</span>\Users\Mans\Desktop\MyData\file.csv</span></code></pre></div>
<p>You have to be careful when using backslashes in <code>character</code> strings in R, because they are used to create special characters (see Section <a href="messychapter.html#strings">5.5</a>). If we place the above path in a string, R won’t recognise it as a path. Instead we have to reformat it into one of the following two formats:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="datachapter.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Windows example 1:</span></span>
<span id="cb126-2"><a href="datachapter.html#cb126-2" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">&quot;C:/Users/Mans/Desktop/MyData/philosophers.csv&quot;</span></span>
<span id="cb126-3"><a href="datachapter.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Windows example 2:</span></span>
<span id="cb126-4"><a href="datachapter.html#cb126-4" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">&quot;C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Mans</span><span class="sc">\\</span><span class="st">Desktop</span><span class="sc">\\</span><span class="st">MyData</span><span class="sc">\\</span><span class="st">philosophers.csv&quot;</span></span></code></pre></div>
<p>If you’ve copied the path to your clipboard, you can also get the path in the second of the formats above by using</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="datachapter.html#cb127-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">readClipboard</span>()   <span class="co"># Windows example 3</span></span></code></pre></div>
<p>Once the path is stored in <code>file_path</code>, you can then make a call to <code>read.csv</code> to import the data:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="datachapter.html#cb128-1" aria-hidden="true" tabindex="-1"></a>imported_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file_path)</span></code></pre></div>
<p>Try this with your <code>philosophers.csv</code> file, to make sure that you know how it works.</p>
<p>Finally, you can read a file directly from a URL, by giving the URL as the file path. Here is an example with data from <a href="https://www.who.int/tb/country/data/download/en/">the WHO Global Tuberculosis Report</a>:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="datachapter.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download WHO tuberculosis burden data:</span></span>
<span id="cb129-2"><a href="datachapter.html#cb129-2" aria-hidden="true" tabindex="-1"></a>tb_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://tinyurl.com/whotbdata&quot;</span>)</span></code></pre></div>
<p><code>.csv</code> files can differ slightly in how they are formatted - for instance, different symbols can be used to delimit the columns. You will learn how to handle this in the exercises below.</p>
<p>A downside to <code>read.csv</code> is that it is very slow when reading large (50 MB or more) csv files. Faster functions are available in add-on packages; see Section <a href="messychapter.html#dtbasics">5.7.1</a>. In addition, it is also possible to import data from other statistical software packages such as SAS and SPSS, from other file formats like JSON, and from databases. We’ll discuss most of these in Section <a href="messychapter.html#commontasks">5.14</a></p>
</div>
<div id="importing-excel-files" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Importing Excel files<a href="datachapter.html#importing-excel-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One common file format we will discuss right away though - <code>.xlsx</code> - Excel spreadsheet files. There are several packages that can be used to import Excel files to R. I like the <code>openxlsx</code> package, so let’s install that:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="datachapter.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;openxlsx&quot;</span>)</span></code></pre></div>
<p>Now, <a href="http://www.modernstatisticswithr.com/data.zip">download the <code>philosophers.xlsx</code> file from the book’s web page</a> and save it in a folder of your choice. Then set <code>file_path</code> to the path of the file, just as you did for the <code>.csv</code> file. To import data from the Excel file, you can then use:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="datachapter.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb131-2"><a href="datachapter.html#cb131-2" aria-hidden="true" tabindex="-1"></a>imported_from_Excel <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(file_path)</span>
<span id="cb131-3"><a href="datachapter.html#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="datachapter.html#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(imported_from_Excel)</span>
<span id="cb131-5"><a href="datachapter.html#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(imported_from_Excel)</span></code></pre></div>
<p>As with <code>read.csv</code>, you can replace the file path with <code>file.choose()</code> in order to select the file manually.</p>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch3exc4" class="exercise"><strong>Exercise 3.8  </strong></span>The abbreviation CSV stands for <em>Comma Separated Values</em>, i.e. that commas <code>,</code> are used to separate the data columns. Unfortunately, the <code>.csv</code> format is not standardised, and <code>.csv</code> files can use different characters to delimit the columns. Examples include semicolons (<code>;</code>) and tabs (multiple spaces, denoted <code>\t</code> in strings in R). Moreover, decimal points can be given either as points (<code>.</code>) or as commas (<code>,</code>). <a href="http://www.modernstatisticswithr.com/data.zip">Download the <code>vas.csv</code> file from the book’s web page</a>. In this dataset, a number of patients with chronic pain have recorded how much pain they experience each day during a period, using the Visual Analogue Scale (VAS, ranging from 0 - no pain - to 10 - worst imaginable pain). Inspect the file in a spreadsheet software and a text editor - check which symbol is used to separate the columns and whether a decimal point or a decimal comma is used. Then set <code>file_path</code> to its path and import the data from it using the code below:</p>
</div>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="datachapter.html#cb132-1" aria-hidden="true" tabindex="-1"></a>vas <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file_path, <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="at">dec =</span> <span class="st">&quot;,&quot;</span>, <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb132-2"><a href="datachapter.html#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="datachapter.html#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(vas)</span>
<span id="cb132-4"><a href="datachapter.html#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(vas)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Why are there two variables named <code>X</code> and <code>X.1</code> in the data frame?</p></li>
<li><p>What happens if you remove the <code>sep = ";"</code> argument?</p></li>
<li><p>What happens if you instead remove the <code>dec = ","</code> argument?</p></li>
<li><p>What happens if you instead remove the <code>skip = 4</code> argument?</p></li>
<li><p>What happens if you change <code>skip = 4</code> to <code>skip = 5</code>?</p></li>
</ol>
<p><a href="solutions.html#ch3solutions4">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch3exc5" class="exercise"><strong>Exercise 3.9  </strong></span><a href="http://www.modernstatisticswithr.com/data.zip">Download the <code>projects-email.xlsx</code> file from the book’s web page</a> and have a look at it in a spreadsheet software. Note that it has three sheet: <em>Projects</em>, <em>Email</em>, and <em>Contact</em>.</p>
<ol style="list-style-type: decimal">
<li><p>Read the documentation for <code>read.xlsx</code>. How can you import the data from the second sheet, <em>Email</em>?</p></li>
<li><p>Some email addresses are repeated more than once. Read the documentation for <code>unique</code>. How can you use it to obtain a vector containing the email addresses without any duplicates?</p></li>
</ol>
</div>
<p><a href="solutions.html#ch3solutions5">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch3exc6" class="exercise"><strong>Exercise 3.10  </strong></span><a href="http://www.modernstatisticswithr.com/data.zip">Download the <code>vas-transposed.csv</code> file from the book’s web page</a> and have a look at it in a spreadsheet software. It is a <em>transposed</em> version of <code>vas.csv</code>, where rows represent variables and columns represent observations (instead of the other way around, as is the case in data frames in R). How can we import this data into R?</p>
<ol style="list-style-type: decimal">
<li><p>Import the data using <code>read.csv</code>. What does the resulting data frame look like?</p></li>
<li><p>Read the documentation for <code>read.csv</code>. How can you make it read the row names that can be found in the first column of the <code>.csv</code> file?</p></li>
<li><p>The function <code>t</code> can be applied to transpose (i.e. rotate) your data frame. Try it out on your imported data. Is the resulting object what you were looking for? What happens if you make a call to <code>as.data.frame</code> with your data after transposing it?</p></li>
</ol>
</div>
<p><a href="solutions.html#ch3solutions6">(Click here to go to the solution.)</a></p>
</div>
</div>
<div id="saving-and-exporting-your-data" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Saving and exporting your data<a href="datachapter.html#saving-and-exporting-your-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In many a case, data manipulation is a huge part of statistical work, and of course you want to be able to save a data frame after manipulating it. There are two options for doing this in R - you can either export the data as e.g. a <code>.csv</code> or a <code>.xlsx</code> file, or save it in R format as an <code>.RData</code> file.</p>
<div id="exporting-data" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Exporting data<a href="datachapter.html#exporting-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Just as we used the functions <code>read.csv</code> and <code>read.xlsx</code> to import data, we can use <code>write.csv</code> and <code>write.xlsx</code> to export it. The code below saves the <code>bookstore</code> data frame as a <code>.csv</code> file and an <code>.xlsx</code> file. Both files will be created in the current working directory. If you wish to store them somewhere else, you can replace the <code>"bookstore.csv"</code> bit with a full path, e.g. <code>"/home/mans/my-business/bookstore.csv"</code>.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="datachapter.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bookstore example</span></span>
<span id="cb133-2"><a href="datachapter.html#cb133-2" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">48</span>, <span class="dv">47</span>, <span class="dv">71</span>, <span class="dv">22</span>, <span class="dv">80</span>, <span class="dv">48</span>, <span class="dv">30</span>, <span class="dv">31</span>)</span>
<span id="cb133-3"><a href="datachapter.html#cb133-3" aria-hidden="true" tabindex="-1"></a>purchase <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">59</span>, <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">160</span>, <span class="dv">34</span>, <span class="dv">34</span>, <span class="dv">29</span>)</span>
<span id="cb133-4"><a href="datachapter.html#cb133-4" aria-hidden="true" tabindex="-1"></a>bookstore <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(age, purchase)</span>
<span id="cb133-5"><a href="datachapter.html#cb133-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-6"><a href="datachapter.html#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Export to .csv:</span></span>
<span id="cb133-7"><a href="datachapter.html#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(bookstore, <span class="st">&quot;bookstore.csv&quot;</span>)</span>
<span id="cb133-8"><a href="datachapter.html#cb133-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-9"><a href="datachapter.html#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Export to .xlsx (Excel):</span></span>
<span id="cb133-10"><a href="datachapter.html#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb133-11"><a href="datachapter.html#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(bookstore, <span class="st">&quot;bookstore.xlsx&quot;</span>)</span></code></pre></div>
</div>
<div id="saving-and-loading-r-data" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Saving and loading R data<a href="datachapter.html#saving-and-loading-r-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Being able to export to different spreadsheet formats is very useful, but sometimes you want to save an object that can’t be saved in a spreadsheet format. For instance, you may wish to save a machine learning model that you’ve created. <code>.RData</code> files can be used to store one or more R objects.</p>
<p>To save the objects <code>bookstore</code> and <code>age</code> in a <code>.Rdata</code> file, we can use the <code>save</code> function:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="datachapter.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(bookstore, age, <span class="at">file =</span> <span class="st">&quot;myData.RData&quot;</span>)</span></code></pre></div>
<p>To save all objects in your environment, you can use <code>save.image</code>:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="datachapter.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="at">file =</span> <span class="st">&quot;allMyData.RData&quot;</span>)</span></code></pre></div>
<p>When we wish to load the stored objects, we use the <code>load</code> function:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="datachapter.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;myData.RData&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="rstudio-projects" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> RStudio projects<a href="datachapter.html#rstudio-projects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is good practice to create a new folder for each new data analysis project that you are working on, where you store code, data and the output from the analysis. In RStudio you can associate a folder with a Project, which lets you start RStudio with that folder as your working directory. Moreover, by opening another Project you can have several RStudio sessions, each with their separate variables and working directories, running simultaneously.</p>
<p>To create a new Project, click <em>File &gt; New Project</em> in the RStudio menu. You then get to choose whether to create a Project associated with a folder that already exists, or to create a Project in a new folder. After you’ve created the Project, it will be saved as an <code>.Rproj</code> file. You can launch RStudio with the Project folder as the working directory by double-clicking the <code>.Rproj</code> file. If you already have an active RStudio session, this will open another session in a separate window.</p>
<p>When working in a Project, I recommend that you store your data in a subfolder of the Project folder. You can the use <em>relative paths</em> to access your data files, i.e. paths that are relative to you working directory. For instance, if the file <code>bookstore.csv</code> is in a folder in your working directory called <code>Data</code>, it’s relative path is:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="datachapter.html#cb137-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">&quot;Data/bookstore.csv&quot;</span></span></code></pre></div>
<p>Much simpler that having to write the entire path, isn’t it?</p>
<p>If instead your working directory is contained inside the folder where <code>bookstore.csv</code> is stored, its relative path would be</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="datachapter.html#cb138-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="st">&quot;../bookstore.csv&quot;</span></span></code></pre></div>
<p>The beauty of using relative paths is that they are simpler to write, and if you transfer the entire project folder to another computer, your code will still run, because the relative paths will stay the same.</p>
</div>
<div id="firstttest" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Running a t-test<a href="datachapter.html#firstttest" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R has thousands of functions for running different statistical hypothesis tests. We’ll delve deeper into that in Chapter <a href="modchapter.html#modchapter">7</a>, but we’ll have a look at one of them right away: <code>t.test</code>, which (yes, you guessed it!) can be used to run Student’s t-test, which can be used to test whether the mean of two populations are equal.</p>
<p>Let’s say that we want to compare the mean sleeping times of carnivores and herbivores, using the <code>msleep</code> data. <code>t.test</code> takes two vectors as input, corresponding to the measurements from the two groups:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="datachapter.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb139-2"><a href="datachapter.html#cb139-2" aria-hidden="true" tabindex="-1"></a>carnivores <span class="ot">&lt;-</span> msleep[msleep<span class="sc">$</span>vore <span class="sc">==</span> <span class="st">&quot;carni&quot;</span>,]</span>
<span id="cb139-3"><a href="datachapter.html#cb139-3" aria-hidden="true" tabindex="-1"></a>herbivores <span class="ot">&lt;-</span> msleep[msleep<span class="sc">$</span>vore <span class="sc">==</span> <span class="st">&quot;herbi&quot;</span>,]</span>
<span id="cb139-4"><a href="datachapter.html#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(carnivores<span class="sc">$</span>sleep_total, herbivores<span class="sc">$</span>sleep_total)</span></code></pre></div>
<p>The output contains a lot of useful information, including the p-value (<span class="math inline">\(0.53\)</span>) and a 95 % confidence interval. <code>t.test</code> contains a number of useful arguments that we can use to tailor the test to our taste. For instance, we can change the confidence level of the confidence interval (to 90 %, say), use a one-sided alternative hypothesis (“carnivores sleep more than herbivores”, i.e. the mean of the first group is <em>greater</em> than that of the second group) and perform the test under the assumption of equal variances in the two samples:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="datachapter.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(carnivores<span class="sc">$</span>sleep_total, herbivores<span class="sc">$</span>sleep_total,</span>
<span id="cb140-2"><a href="datachapter.html#cb140-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">conf.level =</span> <span class="fl">0.90</span>,</span>
<span id="cb140-3"><a href="datachapter.html#cb140-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>,</span>
<span id="cb140-4"><a href="datachapter.html#cb140-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>We’ll explore <code>t.test</code> and related functions further in Section <a href="modchapter.html#ttest">7.2</a>.</p>
</div>
<div id="firstlm" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Fitting a linear regression model<a href="datachapter.html#firstlm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>mtcars</code> data from Henderson and Velleman (1981) has become one of the classic datasets in R, and a part of the initiation rite for new R users is to use the <code>mtcars</code> data to fit a linear regression model. The data describes fuel consumption, number of cylinders and other information about cars from the 1970’s:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="datachapter.html#cb141-1" aria-hidden="true" tabindex="-1"></a>?mtcars</span>
<span id="cb141-2"><a href="datachapter.html#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(mtcars)</span></code></pre></div>
<p>Let’s have a look at the relationship between gross horsepower (<code>hp</code>) and fuel consumption (<code>mpg</code>):</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="datachapter.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb142-2"><a href="datachapter.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(hp, mpg)) <span class="sc">+</span></span>
<span id="cb142-3"><a href="datachapter.html#cb142-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()</span></code></pre></div>
<p>The relationship doesn’t appear to be perfectly linear, but nevertheless, we can try fitting a linear regression model to the data. This can be done using <code>lm</code>. We fit a model with <code>mpg</code> as the response variable and <code>hp</code> as the explanatory variable:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="datachapter.html#cb143-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp, <span class="at">data =</span> mtcars)</span></code></pre></div>
<p>The first argument is a formula, saying that <code>mpg</code> is a function of <code>hp</code>, i.e.</p>
<p><span class="math display">\[mpg=\beta_0 +\beta_1 \cdot hp.\]</span></p>
<p>A summary of the model is obtained using <code>summary</code>. Among other things, it includes the estimated parameters, p-values and the coefficient of determination <span class="math inline">\(R^2\)</span>.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="datachapter.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code></pre></div>
<p>We can add the fitted line to the scatterplot by using <code>geom_abline</code>, which lets us add a straight line with a given intercept and slope - we take these to be the coefficients from the fitted model, given by <code>coef</code>:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="datachapter.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check model coefficients:</span></span>
<span id="cb145-2"><a href="datachapter.html#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m)</span>
<span id="cb145-3"><a href="datachapter.html#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="datachapter.html#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add regression line to plot:</span></span>
<span id="cb145-5"><a href="datachapter.html#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(hp, mpg)) <span class="sc">+</span></span>
<span id="cb145-6"><a href="datachapter.html#cb145-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb145-7"><a href="datachapter.html#cb145-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(m)[<span class="dv">1</span>], <span class="at">slope =</span> <span class="fu">coef</span>(m)[<span class="dv">2</span>]),</span>
<span id="cb145-8"><a href="datachapter.html#cb145-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>Diagnostic plots for the residuals are obtained using <code>plot</code>:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="datachapter.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span></code></pre></div>
<p>If we wish to add further variables to the model, we simply add them to the right-hand-side of the formula in the function call:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="datachapter.html#cb147-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb147-2"><a href="datachapter.html#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div>
<p>In this case, the model becomes</p>
<p><span class="math display">\[mpg=\beta_0 +\beta_1 \cdot hp + \beta_2\cdot wt.\]</span></p>
<p>There is much more to be said about linear models in R. We’ll return to them in Section <a href="regression.html#linearmodels">8.1</a>.</p>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch3exc6bb" class="exercise"><strong>Exercise 3.11  </strong></span>Fit a linear regression model to the <code>mtcars</code> data, using <code>mpg</code> as the response variable and <code>hp</code>, <code>wt</code>, <code>cyl</code>, and <code>am</code> as explanatory variables. Are all four explanatory variables significant?</p>
</div>
<p><a href="solutions.html#ch3solutions6bb">(Click here to go to the solution.)</a></p>
</div>
<div id="grouped" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Grouped summaries<a href="datachapter.html#grouped" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Being able to compute the mean temperature for the <code>airquality</code> data during the entire period is great, but it would be even better if we also had a way to compute it for each month. The <code>aggregate</code> function can be used to create that kind of <em>grouped summary</em>.</p>
<p>To begin with, let’s compute the mean temperature for each month. Using <code>aggregate</code>, we do this as follows:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="datachapter.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Temp <span class="sc">~</span> Month, <span class="at">data =</span> airquality, <span class="at">FUN =</span> mean)</span></code></pre></div>
<p>The first argument is a formula, similar to what we used for <code>lm</code>, saying that we want a summary of <code>Temp</code> grouped by <code>Month</code>. Similar formulas are used also in other R functions, for instance when building regression models. In the second argument, <code>data</code>, we specify in which data frame the variables are found, and in the third, <code>FUN</code>, we specify which function should be used to compute the summary.</p>
<p>By default, <code>mean</code> returns <code>NA</code> if there are missing values. In <code>airquality</code>, <code>Ozone</code> contains missing values, but when we compute the grouped means the results are not <code>NA</code>:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="datachapter.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Ozone <span class="sc">~</span> Month, <span class="at">data =</span> airquality, <span class="at">FUN =</span> mean)</span></code></pre></div>
<p>By default, <code>aggregate</code> removes <code>NA</code> values before computing the grouped summaries.</p>
<p>It is also possible to compute summaries for multiple variables at the same time. For instance, we can compute the standard deviations (using <code>sd</code>) of <code>Temp</code> and <code>Wind</code>, grouped by <code>Month</code>:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="datachapter.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="fu">cbind</span>(Temp, Wind) <span class="sc">~</span> Month, <span class="at">data =</span> airquality, <span class="at">FUN =</span> sd)</span></code></pre></div>
<p><code>aggregate</code> can also be used to count the number of observations in the groups. For instance, we can count the number of days in each month. In order to do so, we put a variable with no <code>NA</code> values on the left-hand side in the formula, and use <code>length</code>, which returns the length of a vector:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="datachapter.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Temp <span class="sc">~</span> Month, <span class="at">data =</span> airquality, <span class="at">FUN =</span> length)</span></code></pre></div>
<p>Another function that can be used to compute grouped summaries is <code>by</code>. The results are the same, but the output is not as nicely formatted. Here’s how to use it to compute the mean temperature grouped by month:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="datachapter.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(airquality<span class="sc">$</span>Temp, airquality<span class="sc">$</span>Month, mean)</span></code></pre></div>
<p>What makes <code>by</code> useful is that unlike <code>aggregate</code> it is easy to use with functions that take more than one variable as input. If we want to compute the correlation between <code>Wind</code> and <code>Temp</code> grouped by month, we can do that as follows:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="datachapter.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(airquality)  <span class="co"># Check that Wind and Temp are in columns 3 and 4</span></span>
<span id="cb153-2"><a href="datachapter.html#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(airquality[, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>], airquality<span class="sc">$</span>Month, cor)</span></code></pre></div>
<p>For each month, this outputs a <em>correlation matrix</em>, which shows both the correlation between <code>Wind</code> and <code>Temp</code> and the correlation of the variables with themselves (which always is 1).</p>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch3exc8" class="exercise"><strong>Exercise 3.12  </strong></span>Load the VAS pain data <code>vas.csv</code> from Exercise <a href="datachapter.html#exr:ch3exc4">3.8</a>. Then do the following:</p>
<ol style="list-style-type: decimal">
<li><p>Compute the mean VAS for each patient.</p></li>
<li><p>Compute the lowest and highest VAS recorded for each patient.</p></li>
<li><p>Compute the number of high-VAS days, defined as days where the VAS was at least 7, for each patient.</p></li>
</ol>
</div>
<p><a href="solutions.html#ch3solutions8">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch3exc9" class="exercise"><strong>Exercise 3.13  </strong></span>Install the <code>datasauRus</code> package using <code>install.packages("datasauRus")</code> (note the capital R!). It contains the dataset <code>datasaurus_dozen</code>. Check its structure and then do the following:</p>
<ol style="list-style-type: decimal">
<li><p>Compute the mean of <code>x</code>, mean of <code>y</code>, standard deviation of <code>x</code>, standard deviation of <code>y</code>, and correlation between <code>x</code> and <code>y</code>, grouped by <code>dataset</code>. Are there any differences between the 12 datasets?</p></li>
<li><p>Make a scatterplot of <code>x</code> against <code>y</code> for each dataset (use facetting!). Are there any differences between the 12 datasets?</p></li>
</ol>
</div>
<p><a href="solutions.html#ch3solutions9">(Click here to go to the solution.)</a></p>
</div>
<div id="pipes" class="section level2 hasAnchor" number="3.9">
<h2><span class="header-section-number">3.9</span> Using <code>%&gt;%</code> pipes<a href="datachapter.html#pipes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider the code you used to solve part 1 of Exercise <a href="datachapter.html#exr:ch3exc2p5">3.5</a>:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="datachapter.html#cb154-1" aria-hidden="true" tabindex="-1"></a>bookstore<span class="sc">$</span>rev_per_minute <span class="ot">&lt;-</span> bookstore<span class="sc">$</span>purchase <span class="sc">/</span> bookstore<span class="sc">$</span>visit_length</span></code></pre></div>
<p>Wouldn’t it be more convenient if you didn’t have to write the <code>bookstore$</code> part each time? To just say once that you are manipulating <code>bookstore</code>, and have R implicitly understand that all the variables involved reside in that data frame? Yes. Yes, it would. Fortunately, R has tools that will let you do just that.</p>
<div id="ceci-nest-pas-une-pipe" class="section level3 hasAnchor" number="3.9.1">
<h3><span class="header-section-number">3.9.1</span> <em>Ceci n’est pas une pipe</em><a href="datachapter.html#ceci-nest-pas-une-pipe" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>magrittr</code> package<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a> adds a set of tools called <em>pipes</em> to R. Pipes are operators that let you improve your code’s readability and restructure your code so that it is read from the left to the right instead of from the inside out. Let’s start by installing the package:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="datachapter.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;magrittr&quot;</span>)</span></code></pre></div>
<p>Now, let’s say that we are interested in finding out what the mean wind speed (in m/s rather than mph) on hot days (temperature above 80, say) in the <code>airquality</code> data is, aggregated by month. We could do something like this:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="datachapter.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract hot days:</span></span>
<span id="cb156-2"><a href="datachapter.html#cb156-2" aria-hidden="true" tabindex="-1"></a>airquality2 <span class="ot">&lt;-</span> airquality[airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">80</span>, ]</span>
<span id="cb156-3"><a href="datachapter.html#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert wind speed to m/s:</span></span>
<span id="cb156-4"><a href="datachapter.html#cb156-4" aria-hidden="true" tabindex="-1"></a>airquality2<span class="sc">$</span>Wind <span class="ot">&lt;-</span> airquality2<span class="sc">$</span>Wind <span class="sc">*</span> <span class="fl">0.44704</span></span>
<span id="cb156-5"><a href="datachapter.html#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute mean wind speed for each month:</span></span>
<span id="cb156-6"><a href="datachapter.html#cb156-6" aria-hidden="true" tabindex="-1"></a>hot_wind_means <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Wind <span class="sc">~</span> Month, <span class="at">data =</span> airquality2,</span>
<span id="cb156-7"><a href="datachapter.html#cb156-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">FUN =</span> mean)</span></code></pre></div>
<p>There is nothing wrong with this code per se. We create a copy of <code>airquality</code> (because we don’t want to change the original data), change the units of the wind speed, and then compute the grouped means. A downside is that we end up with a copy of <code>airquality</code> that we maybe won’t need again. We could avoid that by putting all the operations inside of <code>aggregate</code>:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="datachapter.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># More compact:</span></span>
<span id="cb157-2"><a href="datachapter.html#cb157-2" aria-hidden="true" tabindex="-1"></a>hot_wind_means <span class="ot">&lt;-</span>  <span class="fu">aggregate</span>(Wind<span class="sc">*</span><span class="fl">0.44704</span> <span class="sc">~</span> Month,</span>
<span id="cb157-3"><a href="datachapter.html#cb157-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> airquality[airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">80</span>, ],</span>
<span id="cb157-4"><a href="datachapter.html#cb157-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">FUN =</span> mean)</span></code></pre></div>
<p>The problem with this is that it is a little difficult to follow because we have to read the code from the inside out. When we run the code, R will first extract the hot days, then convert the wind speed to m/s, and then compute the grouped means - so the operations happen in an order that is the opposite of the order in which we wrote them.</p>
<p><code>magrittr</code> introduces a new operator, <code>%&gt;%</code>, called a <em>pipe</em>, which can be used to chain functions together. Calls that you would otherwise write as</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="datachapter.html#cb158-1" aria-hidden="true" tabindex="-1"></a>new_variable <span class="ot">&lt;-</span> <span class="fu">function_2</span>(<span class="fu">function_1</span>(your_data))</span></code></pre></div>
<p>can be written as</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="datachapter.html#cb159-1" aria-hidden="true" tabindex="-1"></a>your_data <span class="sc">%&gt;%</span> function_1 <span class="sc">%&gt;%</span> function_2 <span class="ot">-&gt;</span> new_variable</span></code></pre></div>
<p>so that the operations are written in the order they are performed. Some prefer the former style, which is more like mathematics, but many prefer the latter, which is more like natural language (particularly for those of us who are used to reading from left to right).</p>
<p>Three operations are required to solve the <code>airquality</code> wind speed problem:</p>
<ol style="list-style-type: decimal">
<li>Extract the hot days,</li>
<li>Convert the wind speed to m/s,</li>
<li>Compute the grouped means.</li>
</ol>
<p>Where before we used function-less operations like <code>airquality2$Wind &lt;- airquality2$Wind * 0.44704</code>, we would now require functions that carried out the same operations if we wanted to solve this problem using pipes.</p>
<p>A function that lets us extract the hot days is <code>subset</code>:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="datachapter.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(airquality, Temp <span class="sc">&gt;</span> <span class="dv">80</span>)</span></code></pre></div>
<p>The <code>magrittr</code> function <code>inset</code> lets us convert the wind speed:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="datachapter.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb161-2"><a href="datachapter.html#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inset</span>(airquality, <span class="st">&quot;Wind&quot;</span>, <span class="at">value =</span> airquality<span class="sc">$</span>Wind <span class="sc">*</span> <span class="fl">0.44704</span>)</span></code></pre></div>
<p>And finally, <code>aggregate</code> can be used to compute the grouped means. We could use these functions step-by-step:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="datachapter.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract hot days:</span></span>
<span id="cb162-2"><a href="datachapter.html#cb162-2" aria-hidden="true" tabindex="-1"></a>airquality2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(airquality, Temp <span class="sc">&gt;</span> <span class="dv">80</span>)</span>
<span id="cb162-3"><a href="datachapter.html#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert wind speed to m/s:</span></span>
<span id="cb162-4"><a href="datachapter.html#cb162-4" aria-hidden="true" tabindex="-1"></a>airquality2 <span class="ot">&lt;-</span> <span class="fu">inset</span>(airquality2, <span class="st">&quot;Wind&quot;</span>,</span>
<span id="cb162-5"><a href="datachapter.html#cb162-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">value =</span> airquality2<span class="sc">$</span>Wind <span class="sc">*</span> <span class="fl">0.44704</span>)</span>
<span id="cb162-6"><a href="datachapter.html#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute mean wind speed for each month:</span></span>
<span id="cb162-7"><a href="datachapter.html#cb162-7" aria-hidden="true" tabindex="-1"></a>hot_wind_means <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Wind <span class="sc">~</span> Month, <span class="at">data =</span> airquality2,</span>
<span id="cb162-8"><a href="datachapter.html#cb162-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">FUN =</span> mean)</span></code></pre></div>
<p>But, because we have functions to perform the operations, we can instead use <code>%&gt;%</code> pipes to chain them together in a <em>pipeline</em>. Pipes automatically send the output from the previous function as the first argument to the next, so that the data flows from left to right, which make the code more concise. They also let us refer to the output from the previous function as <code>.</code>, which saves even more space. The resulting code is:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="datachapter.html#cb163-1" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span></span>
<span id="cb163-2"><a href="datachapter.html#cb163-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">subset</span>(Temp <span class="sc">&gt;</span> <span class="dv">80</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb163-3"><a href="datachapter.html#cb163-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">inset</span>(<span class="st">&quot;Wind&quot;</span>, <span class="at">value =</span> .<span class="sc">$</span>Wind <span class="sc">*</span> <span class="fl">0.44704</span>) <span class="sc">%&gt;%</span></span>
<span id="cb163-4"><a href="datachapter.html#cb163-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aggregate</span>(Wind <span class="sc">~</span> Month, <span class="at">data =</span> ., <span class="at">FUN =</span> mean) <span class="ot">-&gt;</span></span>
<span id="cb163-5"><a href="datachapter.html#cb163-5" aria-hidden="true" tabindex="-1"></a>      hot_wind_means</span></code></pre></div>
<p>You can read the <code>%&gt;%</code> operator as <em>then</em>: take the <code>airquality</code> data, <em>then</em> subset it, <em>then</em> convert the <code>Wind</code> variable, <em>then</em> compute the grouped means. Once you wrap your head around the idea of reading the operations from left to right, this code is arguably clearer and easier to read. Note that we used the right-assignment operator <code>-&gt;</code> to assign the result to <code>hot_wind_means</code>, to keep in line with the idea that the data flows from the left to the right.</p>
</div>
<div id="aliases-and-placeholders" class="section level3 hasAnchor" number="3.9.2">
<h3><span class="header-section-number">3.9.2</span> Aliases and placeholders<a href="datachapter.html#aliases-and-placeholders" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the remainder of the book, we will use pipes in some situations where they make the code easier to write or read. Pipes don’t always make code easier to read though, as can be seen if we use them to compute <span class="math inline">\(\exp(\log(2))\)</span>:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="datachapter.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard solution:</span></span>
<span id="cb164-2"><a href="datachapter.html#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">log</span>(<span class="dv">2</span>))</span>
<span id="cb164-3"><a href="datachapter.html#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="co"># magrittr solution:</span></span>
<span id="cb164-4"><a href="datachapter.html#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">%&gt;%</span> log <span class="sc">%&gt;%</span> exp</span></code></pre></div>
<p>If you need to use binary operators like <code>+</code>, <code>^</code> and <code>&lt;</code>, <code>magrittr</code> has a number of <em>aliases</em> that you can use. For instance, <code>add</code> works as an alias for <code>+</code>:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="datachapter.html#cb165-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb165-2"><a href="datachapter.html#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(x <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb165-3"><a href="datachapter.html#cb165-3" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%&gt;%</span> <span class="fu">add</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> exp</span></code></pre></div>
<p>Here are a few more examples:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="datachapter.html#cb166-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb166-2"><a href="datachapter.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Base solution;          magrittr solution</span></span>
<span id="cb166-3"><a href="datachapter.html#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(x <span class="sc">-</span> <span class="dv">2</span>);               x <span class="sc">%&gt;%</span> <span class="fu">subtract</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> exp</span>
<span id="cb166-4"><a href="datachapter.html#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(x <span class="sc">*</span> <span class="dv">2</span>);               x <span class="sc">%&gt;%</span> <span class="fu">multiply_by</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> exp</span>
<span id="cb166-5"><a href="datachapter.html#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(x <span class="sc">/</span> <span class="dv">2</span>);               x <span class="sc">%&gt;%</span> <span class="fu">divide_by</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> exp</span>
<span id="cb166-6"><a href="datachapter.html#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(x<span class="sc">^</span><span class="dv">2</span>);                 x <span class="sc">%&gt;%</span> <span class="fu">raise_to_power</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> exp</span>
<span id="cb166-7"><a href="datachapter.html#cb166-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airquality[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]);   airquality <span class="sc">%&gt;%</span> <span class="fu">extract</span>(,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> head</span>
<span id="cb166-8"><a href="datachapter.html#cb166-8" aria-hidden="true" tabindex="-1"></a>airquality<span class="sc">$</span>Temp[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>];     airquality <span class="sc">%&gt;%</span></span>
<span id="cb166-9"><a href="datachapter.html#cb166-9" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">use_series</span>(Temp) <span class="sc">%&gt;%</span> <span class="fu">extract</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<p>In simple cases like these it is usually preferable to use the base R solution - the point here is that if you need to perform this kind of operation inside a pipeline, the aliases make it easy to do so. For a complete list of aliases, see <code>?extract</code>.</p>
<p>If the function does not take the output from the previous function as its first argument, you can use <code>.</code> as a placeholder, just as we did in the <code>airquality</code> problem. Here is another example:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="datachapter.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;The current time is &quot;</span>, <span class="fu">Sys.time</span>()))<span class="er">)</span></span>
<span id="cb167-2"><a href="datachapter.html#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="sc">%&gt;%</span> <span class="fu">paste</span>(<span class="st">&quot;The current time is&quot;</span>, .) <span class="sc">%&gt;%</span> cat</span></code></pre></div>
<p>If the data only appears inside parentheses, you need to wrap the function in curly brackets <code>{}</code>, or otherwise <code>%&gt;%</code> will try to pass it as the first argument to the function:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="datachapter.html#cb168-1" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> <span class="fu">cat</span>(<span class="st">&quot;Number of rows in data:&quot;</span>, <span class="fu">nrow</span>(.)) <span class="co"># Doesn&#39;t work</span></span>
<span id="cb168-2"><a href="datachapter.html#cb168-2" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> {<span class="fu">cat</span>(<span class="st">&quot;Number of rows in data:&quot;</span>, <span class="fu">nrow</span>(.))} <span class="co"># Works!</span></span></code></pre></div>
<p>In addition to the <code>magrittr</code> pipes, from version 4.1 R also offers a native pipe, <code>|&gt;</code>, which can be used in lieu of <code>%&gt;%</code> without loading any packages. Nevertheless, we’ll use <code>%&gt;%</code> pipes in the remainder of the book, partially because they are more commonly used (meaning that you are more likely to encounter them when looking at other people’s code), and partially because <code>magrittr</code> also offers some other useful pipe operators. You’ll see plenty of examples of how pipes can be used in Chapters <a href="messychapter.html#messychapter">5</a>-<a href="mlchapter.html#mlchapter">9</a>, and learn about other pipe operators in Section <a href="progchapter.html#morepipes">6.2</a>.</p>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch3exc10" class="exercise"><strong>Exercise 3.14  </strong></span>Rewrite the following function calls using pipes, with <code>x &lt;- 1:8</code>:</p>
<ol style="list-style-type: decimal">
<li><p><code>sqrt(mean(x))</code></p></li>
<li><p><code>mean(sqrt(x))</code></p></li>
<li><p><code>sort(x^2-5)[1:2]</code></p></li>
</ol>
</div>
<p><a href="solutions.html#ch3solutions10">(Click here to go to the solution.)</a></p>
<p><br></p>
<div class="exercise">
<p><span id="exr:ch3exc11" class="exercise"><strong>Exercise 3.15  </strong></span>Using the <code>bookstore</code> data:</p>
</div>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="datachapter.html#cb169-1" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">48</span>, <span class="dv">47</span>, <span class="dv">71</span>, <span class="dv">22</span>, <span class="dv">80</span>, <span class="dv">48</span>, <span class="dv">30</span>, <span class="dv">31</span>)</span>
<span id="cb169-2"><a href="datachapter.html#cb169-2" aria-hidden="true" tabindex="-1"></a>purchase <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">59</span>, <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">160</span>, <span class="dv">34</span>, <span class="dv">34</span>, <span class="dv">29</span>)</span>
<span id="cb169-3"><a href="datachapter.html#cb169-3" aria-hidden="true" tabindex="-1"></a>visit_length <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">12</span>, <span class="dv">31</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb169-4"><a href="datachapter.html#cb169-4" aria-hidden="true" tabindex="-1"></a>bookstore <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(age, purchase, visit_length)</span></code></pre></div>
<p>Add a new variable <code>rev_per_minute</code> which is the ratio between purchase and the visit length, using a pipe.</p>
<p><a href="solutions.html#ch3solutions11">(Click here to go to the solution.)</a></p>
</div>
</div>
<div id="flavours-of-r-base-and-tidyverse" class="section level2 hasAnchor" number="3.10">
<h2><span class="header-section-number">3.10</span> Flavours of R: base and tidyverse<a href="datachapter.html#flavours-of-r-base-and-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R is a programming <em>language</em>, and just like any language, it has different dialects. When you read about R online, you’ll frequently see people mentioning the words “base” and “tidyverse”. These are the two most common dialects of R. Base R is just that, R in its purest form. The tidyverse is a collection of add-on packages for working with different types of data. The two are fully compatible, and you can mix and match as much as you like. Both <code>ggplot2</code> and <code>magrittr</code> are part of the tidyverse.</p>
<p>In recent years, the tidyverse has been heavily promoted as being “modern” R which “makes data science faster, easier and more fun”. You should believe the hype. The tidyverse is marvellous. But if you only learn tidyverse R, you will miss out on much of what R has to offer. Base R is just as marvellous, and can definitely make data science as fast, easy and fun as the tidyverse. Besides, nobody uses just base R anyway - there are a ton of non-tidyverse packages that extend and enrich R in exciting new ways. Perhaps “extended R” or “superpowered R” would be better names for the non-tidyverse dialect.</p>
<p>Anyone who tells you to just learn one of these dialects is wrong. Both are great, they work extremely well together, and they are similar enough that you shouldn’t limit yourself to just mastering one of them. This book will show you both base R and tidyverse solutions to problems, so that you can decide for yourself which is faster, easier, and more fun.</p>
<p>A defining property of the tidyverse is that there are separate functions for everything, which is perfect for code that relies on pipes. In contrast, base R uses fewer functions, but with more parameters, to perform the same tasks. If you use tidyverse solutions there is a good chance that there exists a function which performs exactly the task you’re going to do with its default settings. This is great (once again, especially if you want to use pipes), but it means that there are many more functions to master for tidyverse users, whereas you can make do with much fewer in base R. You will spend more time looking up function arguments when working with base R (which fortunately is fairly straightforward using the <code>?</code> documentation), but on the other hand, looking up arguments for a function that you know the name of is easier than finding a function that does something very specific that you don’t know the name of. There are advantages and disadvantages to both approaches.</p>
</div>
<div id="ethicalguidelines" class="section level2 hasAnchor" number="3.11">
<h2><span class="header-section-number">3.11</span> Ethics and good statistical practice<a href="datachapter.html#ethicalguidelines" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Throughout this book, there will be sections devoted to ethics. Good statistical practice is intertwined with good ethical practice. Both require transparent assumptions, reproducible results, and valid interpretations.</p>
<p>One of the most commonly cited ethical guidelines for statistical work is The American Statistical Association’s <em>Ethical Guidelines for Statistical Practice</em> (Committee on Professional Ethics of the American Statistical Association, 2018), a shortened version of which is presented below<a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a>. The full ethical guidelines are available at <a href="https://www.amstat.org/ASA/Your-Career/Ethical-Guidelines-for-Statistical-Practice.aspx" class="uri">https://www.amstat.org/ASA/Your-Career/Ethical-Guidelines-for-Statistical-Practice.aspx</a></p>
<ul>
<li><strong>Professional Integrity and Accountability</strong>. The ethical statistician uses methodology and data that are relevant and appropriate; without favoritism or prejudice; and in a manner intended to produce valid, interpretable, and reproducible results. The ethical statistician does not knowingly accept work for which he/she is not sufficiently qualified, is honest with the client about any limitation of expertise, and consults other statisticians when necessary or in doubt. It is essential that statisticians treat others with respect.</li>
<li><strong>Integrity of data and methods</strong>. The ethical statistician is candid about any known or suspected limitations, defects, or biases in the data that may affect the integrity or reliability of the statistical analysis. Objective and valid interpretation of the results requires that the underlying analysis recognizes and acknowledges the degree of reliability and integrity of the data.</li>
<li><strong>Responsibilities to Science/Public/Funder/Client</strong>. The ethical statistician supports valid inferences, transparency, and good science in general, keeping the interests of the public, funder, client, or customer in mind (as well as professional colleagues, patients, the public, and the scientific community).</li>
<li><strong>Responsibilities to Research Subjects</strong>. The ethical statistician protects and respects the rights and interests of human and animal subjects at all stages of their involvement in a project. This includes respondents to the census or to surveys, those whose data are contained in administrative records, and subjects of physically or psychologically invasive research.</li>
<li><strong>Responsibilities to Research Team Colleagues</strong>. Science and statistical practice are often conducted in teams made up of professionals with different professional standards. The statistician must know how to work ethically in this environment.</li>
<li><strong>Responsibilities to Other Statisticians or Statistics Practitioners</strong>. The practice of statistics requires consideration of the entire range of possible explanations for observed phenomena, and distinct observers drawing on their own unique sets of experiences can arrive at different and potentially diverging judgments about the plausibility of different explanations. Even in adversarial settings, discourse tends to be most successful when statisticians treat one another with mutual respect and focus on scientific principles, methodology, and the substance of data interpretations.</li>
<li><strong>Responsibilities Regarding Allegations of Misconduct</strong>. The ethical statistician understands the differences between questionable statistical, scientific, or professional practices and practices that constitute misconduct. The ethical statistician avoids all of the above and knows how each should be handled.</li>
<li><strong>Responsibilities of Employers, Including Organizations, Individuals, Attorneys, or Other Clients Employing Statistical Practitioners</strong>. Those employing any person to analyze data are implicitly relying on the profession’s reputation for objectivity. However, this creates an obligation on the part of the employer to understand and respect statisticians’ obligation of objectivity.</li>
</ul>
<p>Similar ethical guidelines for statisticians have been put forward by the International Statistical Institute (<a href="https://www.isi-web.org/about-isi/policies/professional-ethics" class="uri">https://www.isi-web.org/about-isi/policies/professional-ethics</a>), the United Nations Statistics Division (<a href="https://unstats.un.org/unsd/dnss/gp/fundprinciples.aspx" class="uri">https://unstats.un.org/unsd/dnss/gp/fundprinciples.aspx</a>), and the Data Science Association (<a href="http://www.datascienceassn.org/code-of-conduct.html" class="uri">http://www.datascienceassn.org/code-of-conduct.html</a>). For further reading on ethics in statistics, see Franks (2020) and Fleming &amp; Bruce (2021).</p>
<p><span class="math display">\[\sim\]</span></p>
<div class="exercise">
<p><span id="exr:ch3ethics1" class="exercise"><strong>Exercise 3.16  </strong></span><em>Discuss the following.</em> In the introduction to American Statistical Association’s <em>Ethical Guidelines for Statistical Practice</em>, it is stated that “using statistics in pursuit of unethical ends is inherently unethical”. What is considered unethical depends on social, moral, political, and religious values, and ultimately you must decide for yourself what you consider to be unethical ends. Which (if any) of the following do you consider to be unethical?</p>
<ol style="list-style-type: decimal">
<li>Using statistical analysis to help a company that harm the environment through their production processes. Does it matter to you what the purpose of the analysis is?</li>
<li>Using statistical analysis to help a tobacco or liquor manufacturing company. Does it matter to you what the purpose of the analysis is?</li>
<li>Using statistical analysis to help a bank identify which loan applicants that are likely to default on their loans.</li>
<li>Using statistical analysis of social media profiles to identify terrorists.</li>
<li>Using statistical analysis of social media profiles to identify people likely to protest against the government.</li>
<li>Using statistical analysis of social media profiles to identify people to target with political adverts.</li>
<li>Using statistical analysis of social media profiles to target ads at people likely to buy a bicycle.</li>
<li>Using statistical analysis of social media profiles to target ads at people likely to gamble at a new online casino. Does it matter to you if it’s an ad for the casino or for help for gambling addiction?</li>
</ol>
</div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="13">
<li id="fn13"><p>And the subsequent troubleshooting makes programming R more difficult and slower.<a href="datachapter.html#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>This works regardless of whether this is a regular <code>data.frame</code>, a <code>data.table</code> or a tibble.<a href="datachapter.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>In interval notation, <code>(50, 70]</code> means that the interval contains all values between 50 and 70, excluding 50 but including 70; the intervals is <em>open</em> on the left but <em>closed</em> to the right.<a href="datachapter.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>If you are running an older version of R (specifically, a version older than the 4.0.0 version released in April 2020), the <code>character</code> vectors will have been imported as <code>factor</code> vectors instead. You can change that behaviour by adding a <code>stringsAsFactors = FALSE</code> argument to <code>read.csv</code>.<a href="datachapter.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p>To copy the path, navigate to the file in Explorer. Hold down the Shift key and right-click the file, selecting <em>Copy as path</em>.<a href="datachapter.html#fnref17" class="footnote-back">↩︎</a></p></li>
<li id="fn18"><p>To copy the path, navigate to the file in Finder and right-click/Control+click/two-finger click on the file. Hold down the Option key, and then select <em>Copy “file name” as Pathname</em>.<a href="datachapter.html#fnref18" class="footnote-back">↩︎</a></p></li>
<li id="fn19"><p>To copy the path from Nautilus, navigate to the file and press Ctrl+L to show the path, then copy it. If you are using some other file browser or the terminal, my guess is that you’re tech-savvy enough that you don’t need me to tell you how to find the path of a file.<a href="datachapter.html#fnref19" class="footnote-back">↩︎</a></p></li>
<li id="fn20"><p>Arguably the <a href="https://en.wikipedia.org/wiki/The_Treachery_of_Images">best-named</a> R package.<a href="datachapter.html#fnref20" class="footnote-back">↩︎</a></p></li>
<li id="fn21"><p>The excerpt is from the version of the guidelines dated April 2018, and presented here with permission from the ASA.<a href="datachapter.html#fnref21" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="thebasics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="eda.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
